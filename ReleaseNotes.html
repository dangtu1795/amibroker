<html><head>
<style type="text/css">
<!--
body {  font-family: Arial, Helvetica, sans-serif; font-size: x-small}
-->
</style>

<meta http-equiv="Content-Type"
content="text/html; charset=iso-8859-1">
<meta name="GENERATOR" content="Microsoft FrontPage 12.0">
<title>AmiBroker Release Notes</title>
</head>

<body bgcolor="#FFFFFF">

<table border="0" width="100%" bgcolor="#C00000">
    <tr>
        
    <td><font color="#FFFFFF" size="6" face="Arial"><strong>AmiBroker Change
      Log </strong></font></td>
    </tr>
</table>



<p><strong>CHANGES FOR VERSION 6.20.1 (as compared to 6.20.0)</strong></p>
<ul>
  <li>Batch: DataImportASCII command allows to automate imports via batch. The
    parameter is file name to be imported. The importer uses file extension to
    determine format file used, so if you are importing File.aqh then aqh.format
  definition file will be used</li>
  <li>Default for time compression timestamping changed
    to recommended value, i.e. 'start time of interval' </li>
  <li>GetExtraDataEx to support
    pad&amp;align<br>
    <br>
    struct ExtraData<br>
    {<br>
int	nStructSize;<br>
int	nArraySize;<br>
int	nPeriodicity;<br>
DATE_TIME_INT	*anTimestamps;<br>
void*	(*pfAlloc)(size_t nSize);<br>
};
<p> typedef Variant (* GetExtraDataPtr) ( LPCTSTR pszTicker, LPCTSTR pszName,
  int nArraySize, int nPeriodicity, void* (*pfAlloc)(size_t nSize) );</p>
<p></p>
<p>/////////////<br>
  PLUGINAPI AmiVar GetExtraDataEx( LPCTSTR pszTicker, LPCTSTR pszName, struct
    ExtraData *pData )<br>
  {<br>
  AmiVar var;</p>
<p> var.type = VAR_ARRAY;<br>
  var.array = (float *)pData-&gt;pfAlloc( pData-&gt;nArraySize * sizeof( float
  ) );</p>
<p> for( int i = 0; i &lt; pData-&gt;nArraySize; i++ )<br>
  {<br>
  AmiDate dt;<br>
  <br>
  dt.Date = pData-&gt;anTimestamps[ i ];</p>
<p> // this simple example produces DateNums synced with current selection<br>
  var.array[ i ] = (dt.PackDate.Year - 1900) * 10000 + dt.PackDate.Month * 100
    + dt.PackDate.Day;<br>
  }</p>
<p> return var;<br>
  }</p>
<p>NOTE:<br>
  Contrary to legacy GetExtraData call which is always called only from UI thread,
    a new function - GetExtraDataEx can be called from both UI and worker (non-UI)
    threads</p>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 6.20.0 (as compared to 6.19.0)</strong></p>
<ul>
  <li>AFL: new function GetExtraDataForeign( &quot;fieldname&quot;, &quot;symbol&quot;)
    - the same as GetExtraData but works with user-specified ticker instead of
    current one<br>
  </li>
  <li>AFL: ShellExecute supports &quot;runbatch&quot; command. After running
    batch batch and analysis windows that were opened by batch are automatically
    closed. ShellExecute( &quot;runbatch&quot;, &quot;path_to_batch.abb&quot;, &quot;&quot; );</li>
  <li>Batch: new command DataPluginCmd - calls data plugin DataPluginCmd function
    (if it is exported from your data DLL) - allows custom actions to be peformed
    by the plugin from the batch (like maintenance)<br>
      <br>
    This function allows automation/batch support for any kind of user-provided
    features, such as maintenance, for example a batch could use<br>
    DataPluginCmd maintenance
    <p>to run internal database maintenance by the plugin. This functionality
      is likely to be used by data vendors such as Premium Data to provide maintenace
      runs automation.<br>
      Ask your vendor for more info on available data plugin commands.</p>
    <p>PRELIMINARY INFORMATION SUBJECT TO CHANGE</p>
    <p>To support this feature in your plugin you would need to export DataPluginCmd
      function</p>
    <p>#define DPC_INVALID_COMMAND	-1<br>
      #define DPC_NOT_IMPLEMENTED	0<br>
      #define DPC_SUCCESS	1<br>
      #define DPC_STARTED_IN_THREAD	2</p>
    <p><br>
      struct CommandData<br>
      {<br>
      int	nStructSize;<br>
      HWND	hNotifyWnd;<br>
      LPCTSTR	pszDatabasePath;<br>
      struct	_Workspace	*pWorkspace;<br>
      struct InfoSite	*pInfoSite;<br>
      };</p>
    <p>int DataPluginCmd( LPCTSTR pszCommand, struct CommandData *pCmdData )<br>
      {<br>
      if( strcmp( &quot;mycommand&quot;, pszCommand ) == 0 )<br>
      {<br>
      // do something<br>
      return DPC_SUCCESS;<br>
      }<br>
      else<br>
      {<br>
      return DPC_ INVALID_COMMAND;<br>
      }<br>
      }</p>
    <p>return values<br>
      DPC_INVALID_COMMAND = -1<br>
      The command passed is invalid / does not exist</p>
    <p>DPC_NOT_IMPLEMENTED = 0<br>
      Plugin does NOT implement any commands (this is automatically set by AMiBroker
        prior to calling Notify())</p>
    <p>DPC_SUCCESS = 1<br>
      Command completed successfully (command executed and completed)</p>
    <p>DPC_STARTED_IN_THREAD = 2<br>
      (For future use - not implemented yet)<br>
      Command recognized but launched by the plugin in separate thread. Its completion
      will be signalised by sending proper finalize message .<br>
      When starting in separate thread you should NOT use pCmdData pointer after
      function returns as it is temporary and will be destroyed as soon DataPluginCmd
      returns.</p>
  </li>
  <li>Batch: new command ExecuteAndWait - allows to execute external program
    and wait for its completion (allows among other things launching AmiQuote
    download and waiting until it is complete)<br>
      <br>
    Example:<br>
    Launches AmiQuote, loads &quot;YourTickerList.tls&quot;, performs download
    and closes AmiQuote:
    <p><strong>ExecuteAndWait &nbsp; amiquote\quote.exe YourTickerList.tls /download
        /close</strong></p>
  </li>
  <li>New Analysis: changed forced refresh frequency of result list to every
    250ms when analysis is in progress (since 6.16 when messaging system has
    changed it was refreshed &quot;on idle&quot;)</li>
  <li>New Analysis: when user specified symbol with NO quotes at all as a reference
    symbol AND used &quot;last N days&quot; range AND used Exploration then it
    would lead to crash. Protection implemented against this scenario.</li>
  <li>OLE: AnalysisDoc.Export supports now extra (optional) parameter WhatToExport
    and it allows now to export not only result list but also walkforward tab
    Analysis.Export(&quot;file&quot;, 1 );<br>
        <br>
    Export( Filepath, WhatToExport = 0 )
    <p>WhatToExport decides what data should be exported:<br>
      = 0 - exports result list (the default behavior when this parameter is
        not provided)<br>
      = 1 - exports walkforward tab</p>
  </li>
  <li>UI: In 64 bit version File Dialog was not resizable due to differences
    in Microsoft runtime. Now it is made resizable.</li>
</ul>
<p><strong>CHANGES FOR VERSION 6.19.0 (as compared to 6.18.0)</strong></p>
<ul>
  <li><b>Batch Scheduler</b> implemented (Tools-&gt;Scheduler) - integrated tool
    to schedule automated runs of your batches<br>
      <br>
    Batch scheduler runs user-defined batches. <br>
    Check period is every 10 seconds, so if you schedule something for 12:14:47,
    it will actually run on 12:14:50.<br>
    If multiple tasks are scheduled on the same time they will be run in order
    of appearance in the Scheduler list.<br>
    Scheduled tasks are run sequentially and next one would not start if previous
    did not finish.<br>
    For this reason avoid batches that require user intervention such as use
    of &quot;PAUSE&quot; command.<br>
    Scheduled tasks are only started when UI is not in the modal state, i.e.
    UI is NOT waiting for user input (such as File open dialog, or any other
    modal input dialog).<br>
    Once modal dialog is closed, missed tasks will be run.<br>
    Scheduled tasks are only run when AmIbroker is running. AmiBroker does not
    create background / hidden processes. <br>
    Windows already have too many wasteful processes running all the time.<br>
    If you need 24/7 operation, just do not close AmiBroker.<br>
    If you close AmiBroker, it won't run any tasks until you start AmiBroker
    again. <br>
    Then all missed tasks will be run once and afterwards they will be run on
    normal schedule (if repeat option is used).<br>
  </li>
  <li>Batch: ExportWalkForward command added</li>
  <li>Batch: Pause command added</li>
  <li>AFL: GetOption supports all fields available in SetOption call</li>
  <li>AFL: new function: AddMultiTextColumn - adds a text column to the exploration
    where text displayed is choosen based on array value<br>
      <br>
    AddMultiTextColumn( ARRAY, &quot;TextList&quot;, &quot;Caption&quot;, format
    = 1.2, fgcolor = colorDefault, bkcolor = colorDefault, width = -1 )
    <p>ARRAY - parameter decides on bar-by-bar basis which item from TextList
      is choosen<br>
      TextList - newline-separated list of texts to be displayed depending on
      ARRAY value. Note: newline is a &quot;\n&quot; symbol</p>
    <p>This work so, when ARRAY value is zero, then first item from TextList
      is choosen and displayed, when ARRAY value is 1 then second item is choosen
      and so on.</p>
    <p>This allows outputting conditional text in the exploration output, like
      this:</p>
    <p><CODE><b>Buy</b> = <font color='#0000ff'>Cross</font>( <font color='#0000ff'>MACD</font>(), <font color='#0000ff'>Signal</font>()
        ); <br>
          <b>Sell</b> = <font color='#0000ff'>Cross</font>( <font color='#0000ff'>Signal</font>(), <font color='#0000ff'>MACD</font>()
          ); <br>
          <br>
          <b>Filter</b> = <font color='#800080'>1</font>; <font color='#008000'>//
          all bars <br>
          </font> <br>
          <font color='#0000ff'>AddColumn</font>( <b>Buy</b>, <font color='#800080'>"Buy"</font> ); <br>
          <font color='#0000ff'>AddColumn</font>( <b>Sell</b>, <font color='#800080'>"Sell"</font> ); <br>
          <br>
      TextList = <font color='#800080'>"No signal\nBuy\nSell\nBuy and Sell"</font>; <br>
      TextSelector = <font color='#800080'>1</font> * <b>Buy</b> + <font color='#800080'>2</font> * <b>Sell</b>; <font color='#008000'>/*
      would give 0 if no signal, 1 if a buy, 2 if a sell, 3 if both buy and sell
      */</font> <br>
      <font color='#0000ff'>AddMultiTextColumn</font>( TextSelector, TextList, <font color='#800080'>"Which
      signal"</font> );</CODE></p>
    <p>Note this feature works only in new Analysis window.</p>
  </li>
  <li>AFL: new function: MxSum - calculates sum of all elements of matrix (grand
    sum)</li>
  <li>AFL: StDev added support for variable period (faster and more accurate
    than formula-based solutions)</li>
  <li>AFL: Title now accepts {{VOLUME}} and {{FULLNAME}} special tokens that
    get replaced by current volume and full name of the symbol. Example Title
    = &quot;{{VOLUME}}&quot;;</li>
  <li>AFL: updated text of Error 62 message to list newly supported sequence
    %s</li>
  <li>AFL: variable period Sum() now returns NULL if range is greater than current
    bar index (previously returned partial sum)</li>
  <li>Analysis: WalkForward settings including IS/OS dates are no longer global,
    they are now per-project and saved in APX file</li>
  <li>ASCII importer: added $RAWCLOSE2AUX1 and $RAWCLOSE2AUX2 commands that allow
    to put raw close into aux1/aux2 fields when using ADJCLOSE in 'close' field</li>
  <li>Changed wording to &quot;Free upgrade period expired.&quot; (from &quot;License
    expired&quot;)</li>
  <li>Date/Time fields in XML files now use ISO format always (not regional format),
    for better file exchangability accross regions</li>
  <li>Debugger: Watch window: added ability to display values of static variables
    in watch window - just append '$' (dollar) prefix before static variable
    name</li>
  <li>Default report chart dimensions (new instals) increased to 800x480px</li>
  <li>On HiDPI (&gt;=150dpi) screens icons in menus were small, now they are
    bigger</li>
  <li>On HiDPI screens XYCharts and MonteCarlo charts could have axis labels
    partially truncated depending on choosen font size. Now it is fixed.</li>
  <li>UI: Performance Monitor shows now the number of static variables used and
    the amount of memory consumed by them (Tools-&gt;Performance Monitor)</li>
  <li>UI: Plugin data access time is now displayed with microsecond precision</li>
  <li>UI: Symbol and interval combo boxes in toolbar are made larger on HiDPI
    screens</li>
</ul>
<p><strong>CHANGES FOR VERSION 6.18.0 (as compared to 6.17.0)</strong></p>
<ul>
  <li>AFL: GetFnData/GetFnDataForeign added support for &quot;PointValue&quot; and &quot;FullName&quot; fields</li>
  <li>Batch processor: In 6.17.0 Export to file command was executed properly
    but never marked as completed. Fixed.</li>
  <li>Batch window checks if there is any other batch running and refuses to
    start when the other batch has not finished.</li>
  <li>Batch: Added command line parameter to exit AmiBroker after running batch
    file (/exit)</li>
  <li>Batch: Added command line parameter to run batch files: /runbatch &quot;full
    path to batch file<br>
      <br>
    Example 1:<br>
    broker.exe /runbatch &quot;C:\yourbatch.abb&quot;
    <p>Example 2:<br>
      run batch and exit program when batch is finished<br>
      broker.exe /runbatch &quot;C:\yourbatch.abb&quot; /exit</p>
    <p>Example 3:<br>
      load database from specified path, run batch and exit<br>
      broker.exe /database &quot;C:\program files\amibroker\mydatabase&quot; /runbatch &quot;C:\yourbatch.abb&quot; /exit</p>
  </li>
  <li>Batch: Load Database &quot;path to workspace/database&quot; - warning this
    function may be RISKY because it may interfere with other running operations,
    use it with care</li>
  <li>Batch: new command: Save Database </li>
  <li>Batch: new command: Set log filename &quot;filename&quot;</li>
  <li>Batch: new command: Write text to log &quot;text&quot;</li>
  <li>OLE: added new method to AnalysisDoc object: Abort() - will abort any running
    Analysis scan/exploration/backtest</li>
  <li>UI: File-&gt;Database Setings displayed underestimated memory usage per
    symbol (32 bytes per quote instead of 40). Corrected.</li>
</ul>
<p><strong>CHANGES FOR VERSION 6.17.0 (as compared to 6.16.0)</strong></p>
<ul>
  <li>AFL: Changed default number formatting string from &quot;%g&quot; to &quot;%.7g&quot; (so
    7 significant digits are now displayed instead of 6)</li>
  <li>AFL: new function GetFnDataForeign( &quot;field&quot;, &quot;symbol&quot; )
    - the same as GetFnData but retrieves non-current symbol's data</li>
  <li>AFL: new function InternetClose( handle )</li>
  <li>AFL: new function InternetOpenURL( &quot;url&quot; )</li>
  <li>AFL: new function InternetReadString( handle ) - read a string (line) from
    internet resource<br>
        <br>
    NOTE: <br>
    If End-Of-File has been reached, the function returns empty string (&quot;&quot;)<br>
    If End-of-File has NOT been reached, the function always returns non-empty
    string because each line read by this function ends with new line character &quot;\n&quot;,<br>
    so if server has sent empty line it will be read as &quot;\n&quot;<br>
    You can trim new line characters using StrTrim
    <p>Internet* functions open wide area of applications including:<br>
      1. querying web APIs for extra data<br>
      2. using web/rest APIs for communication ( sending messages/alerts to Twitter,
      SMS gateways, etc)</p>
    <p>Example:</p>
    <p><CODE>ih = <font color="#0000FF">InternetOpenURL</font>( <font color='#800080'>"https://www.quandl.com/api/v3/datasets/SEC/AAPL_SALESREVENUENET_Q.csv?api_key="</font> ); <br>
          <font color='#0000ff'>printf</font>( <font color='#800080'>"AAPL Revenue:\n"</font> ); <br>
          <font color='#800000'><b>if</b></font>( ih ) <br>
      { <br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color='#800000'><b>while</b></font>( ( str = <font color="#0000FF">InternetReadString</font>(
ih ) ) != <font color='#800080'>""</font> ) <br>
&nbsp;&nbsp;&nbsp;&nbsp; { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000ff'>printf</font>( <font color='#800080'>"%s"</font>,
str ); <br>
&nbsp;&nbsp;&nbsp;&nbsp; } <br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">InternetClose</font>( ih ); <br>
      }</CODE></p>
  </li>
  <li>AFL: printf/StrFormat/TRACEF support now &quot;%s&quot; (string specifier)
    and accept string arguments passed and made faster too</li>
  <li>Data: Gics.txt classification updated (thanks to PremiumData)</li>
  <li>New Batch processor - allows to define sequences of scans/explorations/backtests/optimizations
    using different project files that are then run automatically. Detailed documentation
    on Batch window can be found here <a href="http://www.amibroker.com/guide/h_batch.html">http://www.amibroker.com/guide/h_batch.html</a></li>
  <li>OLE Automation: individual backtest is now supported via OLE automation</li>
  <li>OLE: Interval property of Document object is now writable so you can set
    chart interval from OLE<br>
    AB = new ActiveXObject(&quot;Broker.Application&quot;);<br>
    doc = AB.ActiveDocument;<br>
    doc.Interval = 60; // interval is given in SECONDS (60 second is 1-minute
    interval)<br>
  </li>
  <li>Startup is made faster </li>
  <li>UI: AFL Editor MDI UI did not get immediate refresh after file name change
    when main window was in modal state due to the way how MFC works. Fixed.</li>
  <li>UI: File-&gt;Database Settings, default maximum &quot;number of bars&quot; increased
    to 1 million</li>
  <li>UI: New Analysis Settings submenu is now duplicated in main window Analysis-&gt;Options
    menu for easier access for beginners</li>
  <li>Watch window: added support for modulo (%) operator in watches</li>
</ul>
<p><strong>CHANGES FOR VERSION 6.16.0 (as compared to 6.15.0)</strong></p>
<ul>
  <li>New Analysis: implemented entirely new inter-thread communication method
    that does not strain main thread message queue. This gives tremendous improvement
    in responsivity of UI when Analysis is running.</li>
</ul>
<ul>
  <li>New Analysis: removed forced message pumping when AFL finished as it was
    causing issues with proper MDI tab refreshes in Windows 10 while Analysis
    was running</li>
  <li>New Analysis: UI: added an option to keep using existing AFL file on opening
    APX project instead of asking the user what to do when differences are found
    between AFL file and content of APX project.</li>
  <li>AFL: changed the way how custom-backtest reports &quot;stocknum&quot;.
    Previously Status(&quot;stocknum&quot;) was equal to zero on custom backtest
    phase and this may have caused parts that use if(Status(&quot;stocknum&quot;)==0)
    to be excecuted during custom backtest phase. Now custom backtest run gives
    Status(&quot;stocknum&quot;) equal to -1 (minus one).</li>
  <li>AFL: DateTimeConvert supports now more formats, format = 6 - day, 7 - month,
    8 - year, 9 - day of week, 10 - day of year, 11 - quarter (1..4)</li>
  <li>Charts: as apparently single pixel geometric pens are 8 times slower than
    DC pen, the optimization has been implemented that uses DC single pixel pen
    instead of geometric pen when bar width is 1, giving 8x faster 1-pixel bar
    charts</li>
  <li>Since 6.15 when $AUTOADD was set to 0 (zero), then symbols not existing
    in the database but present in the imported file were not logged into import.log
    as earlier. Fixed.</li>
  <li>UI: when AM/PM (12 hour format) was used in list views 12:00AM was interpreted
    as 12:00 (noon), instead of 00:00 (midnight). Fixed.<br>
    When backtesting Short only strategy and using backtestRegular mode and using
    HoldMinBars &gt; 1, a disabled stop could trigger if it was enabled in previous
    backtest run. Fixed.</li>
  <li>Support for Windows 98 and Millenium is dropped. If anybody needs that
    back please let us know (email to support)!</li>
</ul>
<p><strong>CHANGES FOR VERSION 6.15.0 (as compared to 6.14.0)</strong></p>
<ul>
  <li>AFL: DateTimeFormat( &quot;formatstr&quot;, datetime ) - converts datetime
    to string according to user-specified format<br>
    formatstr argument contains formatting string that specifies how date time
    should be converted to string.<br>
    For example to get full week day name of date time use
    <p>DateTimeFormat( &quot;%A&quot;, dt );</p>
    <p>To get YYYYMMDD without separtors use:</p>
    <p>DateTimeFormat(&quot;%Y%m%d&quot;, dt );</p>
    <p>Available formatting sequences are exactly like in strftime() C-runtime
      functionstrftime :</p>
    <p>%a</p>
    <p>Abbreviated weekday name</p>
    <p>%A</p>
    <p>Full weekday name</p>
    <p>%b</p>
    <p>Abbreviated month name</p>
    <p>%B</p>
    <p>Full month name</p>
    <p>%c</p>
    <p>Date and time representation appropriate for locale</p>
    <p>%d</p>
    <p>Day of month as decimal number (01 &#8211; 31)</p>
    <p>%H</p>
    <p>Hour in 24-hour format (00 &#8211; 23)</p>
    <p>%I</p>
    <p>Hour in 12-hour format (01 &#8211; 12)</p>
    <p>%j</p>
    <p>Day of year as decimal number (001 &#8211; 366)</p>
    <p>%m</p>
    <p>Month as decimal number (01 &#8211; 12)</p>
    <p>%M</p>
    <p>Minute as decimal number (00 &#8211; 59)</p>
    <p>%p</p>
    <p>Current locale&#8217;s A.M./P.M. indicator for 12-hour clock</p>
    <p>%S</p>
    <p>Second as decimal number (00 &#8211; 59)</p>
    <p>%U</p>
    <p>Week of year as decimal number, with Sunday as first day of week (00 &#8211; 53)</p>
    <p>%w</p>
    <p>Weekday as decimal number (0 &#8211; 6; Sunday is 0)</p>
    <p>%W</p>
    <p>Week of year as decimal number, with Monday as first day of week (00 &#8211; 53)</p>
    <p>%x</p>
    <p>Date representation for current locale</p>
    <p>%X</p>
    <p>Time representation for current locale</p>
    <p>%y</p>
    <p>Year without century, as decimal number (00 &#8211; 99)</p>
    <p>%Y</p>
    <p>Year with century, as decimal number</p>
    <p>%z, %Z</p>
    <p>Time-zone name or abbreviation; no characters if time zone is unknown</p>
    <p>%%</p>
    <p>Percent sign</p>
    <p>Extra # flag may prefix any formatting code. In that case, the meaning
      of the format code is changed as follows.</p>
    <p>Format Code Meaning <br>
      %#a, %#A, %#b, %#B, %#p, %#X, %#z, %#Z, %#% # flag is ignored. <br>
      %#c Long date and time representation, appropriate for current locale.
      For example: &#8220;Tuesday, March 14, 1995, 12:41:29&#8221;. <br>
      %#x Long date representation, appropriate to current locale. For example: &#8220;Tuesday,
      March 14, 1995&#8221;. <br>
      %#d, %#H, %#I, %#j, %#m, %#M, %#S, %#U, %#w, %#W, %#y, %#Y Remove leading
      zeros (if any). </p>
    <p></p>
  </li>
  <li>AFL: new function Kurtosis( ARRAY, range, population = True )<br>
      <br>
    Kurtosis( ARRAY, range, False ) - works the same as Excel's KURT function<br>
    Kurtosis( ARRAY, range, True ) - gives population Kurtosis (Excel does not
    have equivalent KURT.P function yet)
    <p>Note that these functions calculate excess kurtosis, so for normal distribution
      it is 0.</p>
    <p>There is some controversy about what kurtosis really tells about distribution. </p>
    <p>Most sources say that<br>
      The kurtosis of a data set provides a measure of the peakedness of the
        distribution of the data, relative to the normal distribution.<br>
      A positive kurtosis value indicates a relatively peaked distribution and
      a negative kurtosis value indicates a relatively flat distribution.</p>
    <p>but Dr. Peter Westfall published an article that addresses why kurtosis
      does not measure peakedness<br>
      http://www.ncbi.nlm.nih.gov/pmc/articles/PMC4321753/ </p>
    <p>He says that &quot;The kurtosis [...] is a measure of the combined weight
      of the tails relative to the rest of the distribution.&quot;</p>
    <p></p>
  </li>
  <li>AFL: new function Skewness( ARRAY, range, population = True )<br>
      <br>
    Skewness( ARRAY, range, False ) - works the same as Excel's SKEW function<br>
    Skewness( ARRAY, range, True ) - works the same as Excel's SKEW.P function
    <p>The Skewness of a data set is a measurement of the asymmetry of the distribution
      about the mean.</p>
    <p>A Skewness of zero indicates perfect symmetry;<br>
      A positive Skewness indicates that more values lie below the mean and the
        distribution has a 'tail' which extends towards the higher values;<br>
      A negative Skewness indicates that more values lie above the mean and the
      distribution has a 'tail' which extends towards the lower values.</p>
    <p>&nbsp; </p>
  </li>
  <li>AFL: new modes added to DateTimeToStr() that use ISO regardless of regional
    settings mode = 3 (iso date and time YYYY-MM-DD HH:MM:SS) HH:MM:SS part is
    only included for non-EOD records, 4 (iso date only YYYY-MM-DD), 5 (iso time
    only HH:MM:SS)</li>
  <li>AFL: NumToStr could crash if format parameter was greater than 127. Fixed.
    Now an error message is displayed when format parameter is too large</li>
  <li>AFL: NumToStr now supports formatDateTimeISO</li>
  <li>AFL: StDev function added 3rd argument &quot;Population = True&quot;, when
    Population is True it calculates population based stdev, otherwise sample
    based<br>
      <br>
    StDev( Array, range, False ) - works the same as Excel's STDEV<br>
    StDev( Array, range, True ) - works the same as Excel's STDEV.P<br>
  </li>
  <li>ASCII import: from version 6.11 importer always added new symbols even
    if $AUTOADD 0 was used. Fixed.</li>
  <li>UI: Charts window - an attempt to rename a file or directory to something
    that already exists is now prevented and results in error message box.</li>
  <li>UI: in 6.14 when New Analysis was switched to 'floating' mode, it could
    crash on attempt to run analysis. Fixed.</li>
  <li>UI: Quote editor - in single-symbol mode &quot;ticker&quot; field sometimes
    was not updated. Fixed.</li>
  <li>UI: Symbol-&gt;Quick Find menu command brings focus to Symbol's window
    search box. New installations use F3 key assignment for Quick Find. Old installations
    use old assignment (you can change F3 assignment in Tools-&gt;Customize-&gt;Keyboard)</li>
</ul>
<p><strong>CHANGES FOR VERSION 6.14.0 (as compared to 6.13.0)</strong></p>
<ul>
  <li>AFL: ParamDate() added support for format=2 to return datetime instead
    of datenum/string</li>
  <li>AFL: PercentRank function now accepts variable period (range)</li>
  <li>AFL: PriceVolDistribution crashed if startbar argument was negative. Fixed
    by implementing protection against negative bar indexes.</li>
  <li>AFL: PriceVolDistribution sometimes produced some random values in 6.13.
    Fixed.</li>
  <li>ASCII importer now supports microsecond resolution timestamps (HH:MM:SS.mmmuuu)
    where mmm - milliseconds 000..999, uuu - microseconds 000..999</li>
  <li>New Analysis: new feature a PAUSE button to temporarily pause/resume any
    running analysis. Note that already running threads are not interrupted,
    they are allowed to complete gracefully and then pause state is entered.</li>
  <li>UI: A warning message is displayed when user attempts to close AmiBroker
    while Analysis is in progress</li>
  <li>UI: QuoteEditor in some cases did not properly round fractional part of
    millisecond down to microsecond. Fixed</li>
  <li>UI: QuoteEditor: Edit fields for OHLC prices, Volume, OpenInt and Aux now
    check for proper entry as you type and display red background if entered
    string is not proper numer. Also those edit fields don't accept characters
    other than digits (0..9), decimal</li>
  <li>UI: Toolbar icons are set to &quot;Large icons&quot; mode automatically
    on HighDPI screens</li>
  <li>When broker.workspace file was corrupted or truncated, the file remained
    open which eventually prevented from writing it on close. Fixed.</li>
</ul>
<p><strong>CHANGES FOR VERSION 6.13.0 (as compared to 6.12.0)</strong></p>
<ul>
  <li>AFL Editor: calling SetForeign thousands of times followed by RestorePriceArrays()
    could cause exception during code verify when number of symbols exceeded
    cache size. Fixed.</li>
  <li>AFL Editor: changes made in 6.11 to the way how automatic names for new
    formulas are assigned have been removed and replaced by new method that is
    faster and more reliable. </li>
  <li>AFL Editor: if clipboard is locked by another application the editor would
    retry opening clipboard upto 8 times before giving up</li>
  <li>AFL Editor: when formula was open cursor was located at the end. Now it
    is located at the top.</li>
  <li>AFL: GfxSetCoordsMode( mode ) accepts now four different modes<br>
    mode parameter now accepts values 0, 1, 2, 3 with the following meaning:
      <p>0 - X and Y coordinates are expressed in screen pixels<br>
      1 - X coordinate is bar index, Y coordinate is price<br>
      2 - X coordinate is pixel, Y coordinate is price<br>
      3 - X coordinate is bar index, Y is pixel </p>
  </li>
  <li>AFL: MA function made upto 2 times faster, StDev function made 20% faster,
    Correlation made 40% faster</li>
  <li>AFL: NormDist( x, mean = 0, sigma = 1, cumulative = True ) function. Implements
    hi-precision algorithm.<br>
        <br>
    The function uses hi-precision algorithm that gives accurate results even
    for extreme left and right tails (&lt;-5 and &gt;+5)<br>
    The results are compatible with Excel 2003 and later which introduced higher
    precision NORMDIST than previous versions (Excel 2002 and earlier).
    <p><br>
      x = 19;<br>
      m = 2;<br>
      s = 9;</p>
    <p>printf(&quot;PDF %g CDF %g&quot;, NormDist( x, m, s, False ), NormDist(
      x, m, s, True ) );</p>
    <p><br>
      x = -7;<br>
      m = 0;<br>
      s = 1;</p>
    <p>printf(&quot;PDF %g CDF %g&quot;, NormDist( x, m, s, False ), NormDist(
      x, m, s, True ) );</p>
  </li>
  <li>AFL: PriceVolDistribution( priceH, priceL, vol, bins, absolute = False,
    startbar = 0, endbar = -1 )<br>
        <br>
    // a demo showing<br>
    // re-implementation of VAP overlay using<br>
    // PriceVolDistribution and low-level graphics<br>
    bi = BarIndex();<br>
    fvb = FirstVisibleValue( bi );<br>
    lvb = LastVisibleValue( bi );
    <p>mx = PriceVolDistribution( H, L, V, 100, False, fvb, lvb );</p>
    <p>GfxSetCoordsMode( 1 );</p>
    <p>GfxSelectPen( colorRed );</p>
    <p>bins = MxGetSize( mx, 0 );<br>
      for( i = 0; i &lt; bins; i++ )<br>
      {<br>
      price = mx[ i ][ 0 ]; // price level<br>
      relvolume = mx[ i ][ 1 ]; // relative volume 0..1<br>
      relbar = relvolume * (lvb-fvb+1);<br>
      GfxMoveTo( fvb, price );<br>
      GfxLineTo( fvb + relbar, price );<br>
      }</p>
    <p>Plot( C, &quot;Price&quot;, colorDefault, styleBar ); </p>
    <p>if( ParamToggle(&quot;BuildinVAP&quot;, &quot;No|Yes&quot;) ) PlotVAPOverlay(
      100, 100, colorGreen, 2 );</p>
  </li>
  <li>AFL: 64-bit version AFL Correlation() produced slightly different values
    (+/-0.00001 typ) than 32-bit version due to compiler differencies. Now 64-bit
    version produces same values as produced by all 32-bit versions.</li>
  <li>Charting: new feature - Snap to Tick grid. Snap drawing tool end points
    to TickSize-spaced grid (if TickSize &gt; 0 for given symbol)</li>
  <li>Plugin loading routine displays a message box when plugins with incorrect
    bitness are found</li>
  <li>Plugin loading routine writes detailed error message to the broker.log
    in case of problem of DLL loading (must enable plugin log to use this feature)<br>
    To enable plugin loading messages you need to create the following key in
    the registry:<br>
    HKEY_CURRENT_USER\Software\TJP\Broker\Diagnostics<br>
    and add<br>
    Flags <br>
    (DWORD 32bit) key with value = 5
    <p>Example error codes:<br>
      Loading 'AmiBroker\Plugins\FT.dll' - failed. Error code: 126: The specified
        module could not be found.. (0.63 ms)<br>
      - this means that the FT.DLL could not be loaded because it depends on
      other DLL that is missing (or not found in search path)</p>
    <p>Loading 'AmiBroker\Plugins\TC2K.dll' - failed. Error code: 1114: A dynamic
      link library (DLL) initialization routine failed.. (0.23 ms)<br>
      - this means that TC2K.DLL was loaded fine but its InitInstance function
      exited with error code. In that case it was because Telechart was not installed
      and/or its OLE server not registerd</p>
    <p>Loading 'F:\AmiBroker\Plugins\Sample.dll' - failed. Error code: 193: Not
      a valid 32-bit DLL. (0.14 ms)<br>
      - this means that you attempted to use 64-bit DLL with 32-bit application
      (not supported by OS) <br>
    </p>
  </li>
  <li>When drawn study is being modified, Y distance shown in the status bar
    accounts for activated snap-to-price and/or snap-to-tick mode now.</li>
</ul>
<p><strong>CHANGES FOR VERSION 6.12.0 (as compared to 6.11.0)</strong></p>
<ul>
  <li>AFL: new function GfxDrawImage( &quot;filename&quot;, x, y )<br>
      <br>
    Notes:<br>
    The function currently supports BMP and PNG files.<br>
    Per-pixel transparency (alpha channel) is supported ONLY for 32-bit PNG files.<br>
    PNG files with 32-bit depth are rendered with AlphaBlend which is not be
    available on oldest systems (Win95).<br>
    BMP files PNG files of lower depths are rendered without transparency using
    BitBlt (fast and always available)
    <p>Loading and drawing BMP files is much faster than PNG (as much as 10 times
      faster), approx load and rendering time is 0.3 ms for BMP, 3 ms for PNG
      (alphablended).<br>
      Timings that you get from Code check and profile are misleading for Gfx
      functions because they don't include actual on-screen rendering. </p>
    <p>GfxDrawImage( &quot;wizard.bmp&quot;, 100, 0 ); // bitmap - fast<br>
      GfxDrawImage( &quot;logo.png&quot;, 30, 30 ); // png - supports per-pixel
      alpha channel / transparency</p>
    <br>
  </li>
  <li>AFL: new function ProdSince( condition, array ) - cumulative product of
    array elements since condition is met<br>
    On bar when condition is met, initial product value is 1.<br>
  </li>
  <li>AFL: new function Prod( array, range ) - cumulative product of array elements
    over specified number of bars (range)<br>
    Note: when range is less or equal zero, product is equal 1.<br>
  </li>
  <li>AFL: new function CumProd( factor ) - cumulative product of array elements<br>
    y = CumProd( 1.05 ); // 1% per-bar growth
      <p>Plot( y, &quot;exponential growth&quot;, colorRed );</p>
  </li>
  <li>AFL: new function VoiceCount( ) - returns number of available SAPI (Speech
    API) voices - to be used with Say() command</li>
  <li>AFL: new function VoiceSelect( num ) - select SAPI (Speech API) voice to
    be used with Say() function, num is a numerical index of installed voices.
    By default Windows comes with just one voice, but one can add countless 3rd
    party voices</li>
  <li>AFL: StaticVarAdd with non-array input produced incorrect results. Fixed.</li>
  <li>UI: Symbols with COMMA (,) caused problems with multiple-selection operations.
    Now it is handled properly.</li>
  <li>UI: Symbol Information - date fields (like last split date, div date or
    delisting date) can now be cleared (select all and press DELETE) to set Empty/Null
    date</li>
  <li>UI: Realtime quote window: a RMB context menu items are grayed when local
    data is used and an empty message is set to inform the user that he/she needs
    realtime data source to use this window</li>
  <li>UI: Quote Editor allows now immediate search for matching date - just type
    digits in format YYYYMMDD and list will automatically scroll and mark to
    quote that most closely matches entered date</li>
  <li>UI: New Analysis: Alt+Enter shortcut added to bring up settings window</li>
</ul>
<p><strong>CHANGES FOR VERSION 6.11.0 (as compared to 6.10.0)</strong></p>
<ul>
  <li>AFL: added formatDateTimeISO for ISO formatting regardless of locale settings,
    example:<br>
        <CODE><b>Filter</b> = <font color='#800080'>1</font>; <br>
        <font color='#0000ff'>AddColumn</font>( <font color='#0000ff'>DateTime</font>(), <font color='#800080'>"DT
        ISO"</font>, formatDateTimeISO ); <font color='#008000'>// generate a
        date/time column that is always in ISO format regardless of regional
        settings in Windows</font></CODE><br>
  </li>
  <li>AFL: MxFromString was slow on very large matrices (&gt;100000 cells) due
    to poor performance of strtod function from Microsoft C runtime. Now MxFromString
    does not use it and is even 1000 times faster on 100K+ cell matrices (5ms
    vs 5second)</li>
  <li>ASCII importer can now be even 20 times faster when importing NEW (non
    existing) data that were oddly sorted (like for example in reverse order
    - descending dates instead of ascending). </li>
  <li>ASCII importer is now twice as fast when updating already existing quotes
    thanks to using in-house code instead of msvcrt functions.</li>
  <li>Charting: Fibonacci maximum user-definable level increased to 9000% (from
    1000%)</li>
  <li>Idle processing is forced now every 125 ms (instead of 250ms) in Analysis
    window to update UI components more frequently under heavy CPU load </li>
  <li>Ruin stop is identified by Short(ruin) / Sell(ruin) instead of Short(6)
    / Sell(6)</li>
  <li>Startup splash screen is displayed a little sooner now and some pre-loading
    of editor components is done at start to save time to open editor later</li>
  <li>When there were thousands of files in &quot;Formulas&quot; folder opening
    editor for the first time could take some time. Now this time is significantly
    reduced. </li>
</ul>
<p></p>
<p><strong>CHANGES FOR VERSION 6.10.0 (as compared to 6.09.0)</strong></p>
<ul>
  <li>SetOption new fields for Monte Carlo<br>
    MCUseEquityChanges - use equity changes instead of trade list <br>
    MCChartEquityScale - 1 for log scale, 0 for linear scale <br>
    MCLogScaleFinalEquity - 1 for log scale, 0 for linear scale <br>
    MCLogScaleDrawdown - 1 for log scale, 0 for linear scale <br>
    MCNegativeDrawdown - 1 - use negative numbers for drawdown (reverse drawdown
    CDF) </li>
  <li>QuickData cache was not flushed when double clicking on Analysis result
    list to display chart. Fixed.</li>
  <li> MonteCarlo: added an option to use negative number for drawdowns (on by
    default). This reverses the ordering of &quot;drawdown&quot; column in the
    MC table and reverses the meaning (i.e. 10% percentile value means that there
    is 10% chance of drawdowns being equal or worse (more negative) than presented
    value). Wwith this option turned off (as in old versions), drawdowns are
    reported as numbers greater than zero and 10% percentile value means 10%
    chance of drawdowns being equal or better (smaller) than presented amount. </li>
  <li> AFL: Gfx: low-level graphic recorded on layer 128 was played prematurely.
    Fixed.</li>
  <li>Added error message when user attempts to write value to BarCount (read-only
    symbol)</li>
  <li>More documentation updates</li>
</ul>
<p><strong>CHANGES FOR VERSION 6.09.0 (as compared to 6.08.0)</strong></p>
<ul>
  <li>AFL Editor: an error message box displayed when @link file was not found
    caused main frame to get focus. Fixed.</li>
  <li>AFL Editor: auto-complete and parameter tooltips poped up when adding/editing
    Doxygen/JavaDoc comment sections. Fixed.</li>
  <li>AFL: new function fgetcwd - get current working directory</li>
  <li>Analysis: Monte Carlo - semi logarithmic scale can be now used for Equity,
    Final Equity and $ Drawdown distribution charts (see Settings)</li>
  <li>Analysis: Monte Carlo simulation has now a few mode &quot;Simulate usign
    equity changes&quot;. This uses bar-per-bar percent portfolio equity changes
    to generate permutations instead of trade list.</li>
  <li>Docs: updated help files</li>
  <li>UI: Enlarged crash recovery window because people send us screenshots instead
    of clicking &quot;Send report&quot; button. Please click &quot;SEND REPORT&quot; instead
    of sending screenshots. Screenshots unfortunatelly do not contain all information,
    so now at least some more</li>
  <li>UI: On Windows Vista and higher all tree views now use double buffering
    to avoid flicker</li>
  <li>UI: XY charts and Monte Carlo charts axes use M suffix for numbers bigger
    than one million</li>
</ul>
<p><strong>CHANGES FOR VERSION 6.08.0 (as compared to 6.07.0)</strong></p>
<ul>
  <li>AFL Editor: Implemented clickable JavaDoc/Doxygen-style links in doc comments<br>
    To use links in comments you have to put @link command followed by path to
      file or URL inside JavaDoc/Doxygen style comment:<br>
    a) multiline comment that begins with<br>
    /** <br>
    @link readme.html<br>
    @link http://www.amibroker.com<br>
    */<br>
    (note double asterisk after initial slash)<br>
    b) single line comment that begins with triple slash <br>
    /// @link readme.html<br>
    /// @link c:\program files\amibroker\readme.html<br>
    /// @link http://www.amibroker.com
    <p>Now when you hover the mouse over @link command you will see the underline
      that indicates it is clickable.<br>
      It reacts to DOUBLE CLICK (not single click). When you double click it
      linked document will be open</p>
    <p>@link command can open web pages, local files (both relative and absolute
      paths are supported) with Windows-registered program<br>
      to open given file type. So if you use<br>
      /// @link something.doc</p>
    <p>then MS word would be used.</p>
    <p>/// @link test.xls</p>
    <p>would open test.xls in Excel.</p>
    <p>Relative paths refer to AmiBroker working directory. <br>
      Html files are open with default browser, txt files are usually open with
        Notepad (or whatever application you use).</p>
    <p>If file does not exist then you will get an error message.<br>
    </p>
  </li>
  <li>AFL: Unary minus and NOT operator could cause crash when applied to result
    of undefined function or variable of non-numeric type. Fixed.</li>
  <li>64-bit stack walker does not use Microsoft symbol server anymore so it
    can init a lot faster. Also initialization of stack walker is moved to startup
    sequence because doing it after exception is risky and unreliable</li>
  <li>64-bit: access violations during Analysis run do not result in 'application
    not responding' freeze. Instead bug report is displayed with proper call
    stack.</li>
  <li>After change in 6.02 exception dialog displayed first error in the formula
    even if exception was really caused not by first but last error. Fixed.</li>
  <li>Exception info could get mixed up when multiple threads generated them
    at the same time. Fixed.</li>
  <li>New Analysis: Auto-size column functionality re-displayed hidden columns.
    Fixed.</li>
  <li>UI: AmiBroker now prevents piling on &quot;Bug recovery&quot; dialogs when
    multiple exceptions are thrown from multiple threads. First dialog is displayed,
    other exceptions are logged into DebugView as long as &quot;Bug recovery&quot; is
    not dismissed.</li>
  <li>&quot;Rename&quot; and backup functions in several places could fail if
    new file name already existed. Fixed.</li>
  <li>Support for Windows 95 is dropped</li>
</ul>
<p><strong>CHANGES FOR VERSION 6.07.0 (as compared to 6.06.0)</strong></p>
<ul>
  <li>AFL: compression for array Static variables implemented to save memory
    and file size: StaticVarSet has additional parameter that controls compression<br>
    compressMode parameter decides whenever given variable will be compressed
    or not.<br>
    By default only persistent static variables will be compressed (cmDefault).<br>
    You can turn it off completely compressionMode = cmNever, or turn it on for
    persitent and non-persistent variables using<br>
    compressionMode = cmAlways
    <p>Compression is done by removing repeated values from the sequence as repeated
      values<br>
      are restored when doing StaticVarGet.<br>
      Compression is NOT compatible with non-aligned mode of StaticVarGet.<br>
      If compressed array is retrieved by StaticVarGet with align=False, then
      repeated values found in original array would not be retrieved.</p>
    <p>Turning compression on slows down StaticVarSet (as it needs to do some
      extra processing), but does not affect performance of other functions,<br>
      so StaticVarGet is equally fast with or without compression.<br>
    </p>
  </li>
  <li>AFL: printf/StrFormat check for %s, %c, %d, %x, %i, %u, %x, %p sequences
    that are not supported now and prints Error 62 when they are found.</li>
  <li>AFL: printf/StrFormat now implement a check for correct formatting string
    as sometimes users passed strings with % that is special marker for formatting
    string instead of %% to print actual percent sign<br>
        <br>
    When check failes, &quot;Error 61. The number of % formatting specifier(s)
    does not match the number of arguments passed.&quot; is displayed<br>
  </li>
  <li>AFL: Some variable period functions such as Ref/Sum/MA incorrectly accepted
    matrix as a 'period'. Fixed (proper error message is displayed now).</li>
  <li>AFL: StaticVarGet/StaticVarSet functions now support matrices including
    persistency (so matrices can be written to disk and loaded back between AmiBroker
    runs)</li>
  <li>AFL: VarSet/VarGet officially accept matrices (allow dynamic variables
    of matrix type). (FWIW they were accepted in previous versions but implementation
    was incomplete.)</li>
  <li>Charting: Candlestick wicks thickness is now user definable as % of candle
    width with a max. pixel width (Tools-&gt;Preferences, &quot;Bars and Candles&quot; tab).
    Also by default wick thickness is now 25%/5px max instead of constant 1 pixel.</li>
  <li>Charting: Cycles tool in weekly chart produced incorrect lines when it
    went past 2038. Fixed.</li>
  <li>Charting: Horizontal line tool level is now displayed with number of decimals
    as defined in Preferences (Misc tab, &quot;decimal places in chart titles/tools&quot;).
    Note that this setting is used when you draw a new line or modify old.</li>
  <li>Debugger: Added F5 key as keyboard shortcut for &quot;Debug / Go&quot;</li>
</ul>
<p><strong>CHANGES FOR VERSION 6.06.0 (as compared to 6.05.0)</strong></p>
<ul>
  <li>AFL Editor: Bookmarks implemented (Ctrl+F2 - toggle bookmark, F2 - go to
    next bookmark, Shift+F2 - go to previous bookmark</li>
  <li>AFL Editor: Find in Files - when file name contained braces () double click
    on it would not open it. Fixed.</li>
  <li>AFL Editor: Line comment puts double // comments on lines that appear after
    empty line. Fixed. Now empty lines are left untouched.</li>
  <li>AFL: extra parameter for DateTimeToStr function mode (mode = 0 - convert
    both date and time portion, 1 - only date, 2 - only time ) Note that mode
    2 would give you empty string when applied on chart with daily or longer
    interval</li>
  <li>AFL: new function GfxFillSolidRect( x1, y1, x2, y2, color ) - it is fastest
    method to fill solid rectangle with single color (faster than GfxRectangle)<br>
    pw = Status(&quot;pxwidth&quot;);<br>
    ph = Status(&quot;pxheight&quot;);
    <p>GfxFillSolidRect( 0, 0, pw, ph, colorBlack );</p>
  </li>
  <li>AFL: new function SumSince - a fast sum of array elements since condition
    was true, works like Cum( array ) - ValueWhen( condition, Cum( array ) )
    or Sum( array, BarsSince( condition ), but much faster<br>
    Syntax: SumSince( condition, array )<br>
  </li>
  <li>AFL: Variable period Sum() performance improved significantly when period
    changes +/-1 on bar by bar basis</li>
  <li>Categories dialog: added ability to re-arrange the order of markets/groups/sectors/industries
    and watch lists using &quot;Move Up&quot; / &quot;Move down&quot; buttons<br>
    This is non-trivial task as all symbols must be synchronized with the change
    as when the ordering of categories change then all symbols data must be re-indexed
    to reflect new order as symbols refer to oridinal position of category. </li>
  <li>New Analysis: Added an option &quot;Auto-size columns to fit content&quot; -
    OFF by default. When turned on, column widths are adjusted to fit the content
    after analysis is complete. Note that this means that any widths specified
    in width parameter in AddColumn width will be ignored when this is turned
    ON.</li>
  <li>New Analysis: when &quot;Wait for backfill&quot; was turned ON and some
    symbols in the &quot;Apply to&quot; list were wrong (non-existing) then Analysis
    attempted to run code for symbol without quotes causing trouble. Fixed.</li>
</ul>
<p><strong>CHANGES FOR VERSION 6.05.0 (as compared to 6.04.0)</strong></p>
<ul>
  <li>AFL Editor Find in Files implemented - on the output list you can double
    click on line to open the file in the editor</li>
  <li>AFL Editor/Debugger: Code Check and Profile stopped working when it was
    run after debugging session. Fixed.</li>
  <li>AFL: Null is accepted by MxFromString now</li>
  <li>AFL: performance of printf() for large volume output (&gt;60000 characters)
    improved ~60 times.</li>
  <li>Charts: reduced tearing when resizing the chart window</li>
  <li>Debugger now can use either base time interval or current chart interval
    (Tools-&gt;Preferences, Debugger tab, &quot;Bar interval&quot; setting)</li>
  <li>Debugger: implemented Output window (for printf() output during debugging)</li>
  <li>Removed old-style legacy AFL editor from the code, removed &quot;use new
    editor&quot; checkbox from the preferences. A new editor is used always now.</li>
  <li>UI: Unfold triangles in tree views and checkboxes in Layers list were hard
    to click on HighDPI screens because icons were too small. Fixed. Now larger
    icons (32x32) are used instead of small (16x16) on small tablets like 8''
    Windows with righ resolution (such as 1920x1200) that have very high DPI
    (approx 200DPI).</li>
  <li>Watch window: now expressions with 2D subscripts to access elements of
    matrix matrix[ x ][ y ] are supported<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 6.04.0 (as compared to 6.03.0)</strong></p>
<ul>
  <li>AFL Editor &amp; Watch Window: the contents of matrices is now displayed
    in value tooltips and watch window</li>
  <li>Debugger state (watch variables/expressions and breakpoint locations) is
    now saved between AFL editor sessions (formula-wise so each formula has its
    own &quot;debug state&quot;). The data are saved in XML file with .dbg extension</li>
  <li>Debugger: MDI mode implemented. In 6.0.3 AFL Editor did not support 'MDI
    mode' (even crashed), now this functionality is back. Also Watch window is
    available in MDI mode and debugger is working in MDI mode too.</li>
  <li>Preferences: added new page with Debugger settings. <br>
    The settings are as follows:<br>
    + Limit BarCount to - defines maximum number of bars in arrays (BarCount)
    used during debugging<br>
    + Auto-scroll to first changed item - when this is ON, the &quot;Arrays&quot; list
    in the Watch window is scrolled automatically to first array item that has
    changed (so you don't need to locate elementsm that changed manually)<br>
    + Keep debugging state - when this is ON, AFL editor saves the debug state
    (breakpoints and watches) in the .dbg file along with the formula when closing
    the editor and restores the state when formula is reopened.<br>
  </li>
  <li>Preferences: 'Editor' tab moved so 'AFL', 'Editor', and 'Debugger' tabs
    are next to each other, also 'Alerts' and 'Currencies' tabs moved before
    'Miscellaneous'</li>
  <li>Watch window: a new tab &quot;Arrays&quot; shows exploration-like array
    output for detailed examination of array contents (first 20 arrays from watch
    window are reported)</li>
  <li>Watch window: implemented array item change highlighting and auto-scrolling
    so first changed item is always visible in the 'Arrays' tab</li>
  <li>Watch window: implemented expression evaluator, so you can not only display
    variables, but also expressions involving variables such as (high+low)/2
    or individual array elements such as myvariable[ i ] where i is dynamic loop
    counter</li>
  <li>Watch window: implemented value change highlighting: changed values are
    displayed with light yellow background, additionally numeric (scalar) values
    are displayed in green when they increased or red if they are decreased</li>
  <li>Watch window: pressing DELETE key while editing variable name caused deletion
    of variable from watch. Fixed.</li>
  <li>Watch window: variables can now be drag-dropped from AFL editor window<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 6.03.0 (as compared to 6.02.0)</strong></p>
<ul>
  <li>AFL Editor: Implemented brand new fully integrated Visual AFL Debugger<br>
    NOTES: this the work-in-progress more features will be added in later betas<br>
  </li>
  <li>Debugger: Implemented breakpoints (including those set before compilation
    as well as adding/removing breakpoints during debugging)<br>
      <br>
    To add/remove breakpoint use red circle toolbar button or press F9<br>
    Breakpoints can be added and removed at any time (during editing, when debugger
    is in 'running' state or stopped at breakpoint)<br>
    Breakpoints are implemented statement-wise (as single-stepping). Keep in
    mind that there can be only one breakpoint in any single line so if line
    has more than one statements<br>
    like this:<br>
    x=1;y=1;<br>
    the breakpoint will trigger before first statement in this line.
    <p>Breakpoints currently work with:<br>
      a) regular statements (that end with semicolon). For multi-line statements
        place breakpoint at the beginning line of the statement<br>
      b) for loops<br>
      c) while loops<br>
      d) do-while loops (you need to place breakpoint where 'while' clause is
      located, it won't break at the 'do' line as it essentially is no-op, if
      you want to break at the beginning<br>
      of do, just place breakpoint on first statement inside { block }<br>
      d) if statements<br>
      e) return statements<br>
      f) switch/case statements<br>
      g) break statements</p>
    <p>Breakpoints that you place on other lines, won't trigger. The AFL editor
      won't allow to place breakpoint on empty line, or line that beginnins with
      // comment or sole brace</p>
    <p></p>
  </li>
  <li>Debugger: Implemented single-stepping Step Into, Step Over<br>
      <br>
    Single-stepping is done statement-wise. So it works on single statement at
    a time. So for example, empty lines are skipped and statements spanning multiple
    rows like below are treated as one step.
    <p>x = &quot;test&quot; +<br>
&quot; second row&quot; +<br>
&quot; third row&quot;;</p>
    <p>But if you put two statements in single line like this:<br>
      x = 1; y = 2;</p>
    <p>Then this line would be treated as two steps (each expression x =1; and
      y=2; separately).</p>
    <p>Keyboard shortcuts:<br>
      Step Over F10<br>
      Step Into F11</p>
    <p></p>
  </li>
  <li>Debugger: Implemented variable value inspection tooltips (hover mouse over
    variable to see its value)<br>
  </li>
  <li>Debugger: Implemented Watch window with variable value display automatically
    updating when debugger single-steps or reaches breakpoint<br>
          <br>
    To add variable to watch window simply double click on the list (at the end
    to add new variable).<br>
    You can also change variable name by double clicking on existing item<br>
  </li>
  <li>Renaming of PersistVars.temp to PersistVars.bin failed on some versions
    of OS. Fixed.</li>
  <li>RT Quote window: drag-drop list view shows small arrow marker for the drop
    point now.</li>
  <li>RT Quote window: when moving items using drag-drop, moved items image was
    flickering. Fixed</li>
  <li>UI: Chart zoom via Ctrl+mouse wheel now works so it attempts to current
    mouse position as a &quot;center&quot; point of zoom when possible. (Previously
    it always worked so right border was the 'center').</li>
  <li>AFL: Sum(array,N) outputs NULL values for indices starting from 0 upto
    index N-1 instead of N</li>
  <li>When intraday data were used timestamp of 00:00:00 was not displayed in
    data tooltip (empty field was shown). Fixed.<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 6.02.0 (as compared to 6.01.0)</strong></p>
<ul>
  <li>AFL Editor: Implemented Line comment/uncomment feature (Edit-&gt;Line Comment,
    Ctrl+Q) to automatically add/remove // line comments from single or multiple
    lines. If multiple lines are selected, the content of the first selected
    line is deciding whenever block of lines is to be commented or uncommented</li>
  <li>AFL: If any matrix cell has Null value then matrix product operator @ produces
    Null respective row/column of the result matrix.</li>
  <li>AFL: if user called (a) GetPerfomanceCounter( 1 ) then (b) GetPerformanceCounter(
    0 ) then subsequent call to GetPerformanceCounter(0) returned cumulated time
    not from call (a) but from system boot. Fixed.</li>
  <li>AFL: matrix identifier can now be used in if-else statement. Such condition
    checks whenever very first element of matrix [0][0] is NOT NULL. This is
    useful for checking output of functions like MxInverse/MxSolve that would
    return NULL in all cells if matrix is singular<br>
    So
    <p><CODE>m = <font color='#0000ff'>Matrix</font>( <font color='#800080'>10</font>, <font color='#800080'>10</font>, <font color='#800080'>0</font> ); <br>
          <br>
          <font color='#008000'>// do something with matrix </font><br>
          <font color='#800000'><b>if</b></font>( m ) <br>
      { <br>
      <font color='#008000'>// some code <br>
      </font>} <br>
      <br>
      is equivalent to <br>
      <br>
      <font color='#800000'><b>if</b></font>( <font color='#800000'><b>NOT</b></font> <font color='#0000ff'>IsNull</font>(
      m[ <font color='#800080'>0</font> ][ <font color='#800080'>0</font> ] )
      ) <br>
      { <br>
      <font color='#008000'>// some code <br>
    </font>}</CODE></p>
  </li>
  <li>AFL: MxSolve/MxInverse now return a matrix filled with Nulls as a result
    if source matrix can not be inverted and produce warning level 2 instead
    of an error. </li>
  <li>AFL: On Windows Vista and higher static variables use slim read-write (SRW)
    lock instead of critical section. This gives 5% performance increase in multithreading
    scenarios.</li>
  <li>AFL: StaticVarAdd( &quot;name&quot;, value, keepAll = True, persistent
    = False ) - an atomic addition (interlocked read-add-write) operation for
    static variables<br>
      <br>
    It is multithreading safe addition for static variables that are shared by
    multiple threads. This function is atomic with respect to calls to other
    static variable functions.
    <p>KeepAll flag when it is set to true emulates the behavior of AddToComposite.
      It keeps all values that are already present, so if data holes exists in
      current symbol,<br>
      the bars that are present in static variable but not present in current
      symbol remain untouched.<br>
      When KeepAll is set to false then only bars that are present in current
      symbol are kept. Any other bars that were present in static variable but
      not present in currently<br>
      processed symbols are removed. That is what normally happens with StaticVarSet().</p>
    <p>In fact when KeepAll is set to False, StaticVarAdd can be seen as the
      following pseudo code:<br>
          <code>EnterCriticalSection<br>
      x = Nz( StaticVarGet( &quot;name&quot; ) ); // read exisiting value (and
      convert Nulls to zero)<br>
      x += Nz( value ); // add value to existing<br>
      StaticVarSet( &quot;name&quot;, x ); // store updated value<br>
      LeaveCriticalSection</code></p>
    <p>The function can be used to create composites like this:</p>
    <p><CODE><font color='#800000'><b>if</b></font>( <font color='#0000ff'>status</font>(<font color='#800080'>"stocknum"</font>)
        == <font color='#800080'>0</font> ) <br>
      { <br>
&nbsp;&nbsp;&nbsp; <font color='#008000'>// remove any earier composite values <br>
      </font>&nbsp;&nbsp;&nbsp;<font color='#0000ff'>StaticVarRemove</font>(<font color='#800080'>"~Composite"</font>); <br>
      } <br>
      <br>
      <font color="#0000FF">StaticVarAdd</font>( <font color='#800080'>"~Composite"</font>, <font color='#0000ff'>MACD</font>() &gt; <font color='#0000ff'>Signal</font>()
      ); <br>
          <b>Buy</b> = <font color='#800080'>0</font>;</CODE></p>
    <p>NOTES:<br>
      1. StaticVarAdd automatically converts all Nulls to zeros (as AddToComposite
        does).<br>
      2. If you want to replace AddToComposite with StaticVarAdd, keep in mind
      that by default AddToComposite skips symbols in group 253. This is done
      so composite symbols<br>
      are not added to themselves. If you have composite symbols in your database
      and want to skip symbols in group 253 you can use<br>
      if( GroupID() != 253 ) StaticVarAdd(&quot;~Composite&quot;, values );<br>
      3. Thanks to extensive code tuning, StaticVarAdd generally offers better
      performance than AddToComposite which was already blazing fast. Single
      threaded StaticVarAdd may be twice as fast as ATC. With 8 threads running
      StaticVarAdd may be 4x as fast (it does not scale as much as naive person
      may think, because critical section limits performance due to lock contention).
      To illustrate the amount of fine tuning applied it can be said that first
      'straightforward' version of StaticVarAdd was actually 20 times slower
      than ATC.<br>
      4. Be careful when using &quot;quickafl&quot; as StaticVarAdd would not
      increase 'required bars' (as ATC does), so if you want to actually add
      all bars and quick afl is turned on in analysis, it is better to add SetBarsRequired(sbrAll,
      sbrAll)</p>
    <p></p>
  </li>
  <li>AFL: Study() returned NULL array when line's start date was greater than
    end date. Fixed (now it works for lines drawn from right to left too).</li>
  <li>Docs: Example polynomial fit formula shows how to gracefully handle singular
    matrix and overflow/not-a-numbers in polynomial calcs<br>
      <br>
      <CODE>order = <font color='#0000ff'>Param</font>( <font color='#800080'>"n-th
      Order"</font>, <font color='#800080'>10</font>, <font color='#800080'>1</font>, <font color='#800080'>16</font>, <font color='#800080'>1</font> ); <br>
    length = <font color='#800080'>60</font>; <br>
    <br>
    lvb = <b>BarCount</b> - <font color='#800080'>1</font>; <br>
    fvb = lvb - length; <br>
    <br>
    yy = <font color='#0000ff'>Matrix</font>( length + <font color='#800080'>1</font>, <font color='#800080'>1</font>, <font color='#800080'>0</font> ); <br>
    xx = <font color='#0000ff'>Matrix</font>( length + <font color='#800080'>1</font>,
    order + <font color='#800080'>1</font>, <font color='#800080'>1</font> ); <br>
      <br>
    yy = <font color='#0000ff'>MxSetBlock</font>( yy, <font color='#800080'>0</font>,
    length, <font color='#800080'>0</font>, <font color='#800080'>0</font>, <font color='#0000ff'>Ref</font>( <b>C</b>,
    fvb ) ); <br>
      <br>
    x = <font color='#0000ff'>BarIndex</font>() - length/<font color='#800080'>2</font>; <br>
    <br>
    <font color='#800000'><b>for</b></font>( j = <font color='#800080'>1</font>;
    j &lt;= order; j++ ) <br>
    { <br>
&nbsp;&nbsp;&nbsp;&nbsp; xx = <font color='#0000ff'>MxSetBlock</font>( xx, <font color='#800080'>0</font>,
length, j, j, x ^ j ); <br>
    } <br>
    <br>
    xxt = <font color='#0000ff'>MxTranspose</font>( xx ); <br>
    aa = <font color='#0000ff'>MxSolve</font>( xxt @ xx, xxt ) @ yy; <br>
    <font color='#008000'>//aa = MxInverse( xxt @ xx ) @ xxt @ yy; // alternative
    way <br>
    </font>&nbsp;&nbsp;&nbsp; <br>
    <font color='#800000'><b>if</b></font>( aa ) <font color='#008000'>// check
    if matrix is not null (so solution exists) <br>
    </font>{ <br>
&nbsp;&nbsp;&nbsp; rr = <b>Null</b>; <font color='#008000'>// store the fit in
rr <br>
    </font>&nbsp;&nbsp;&nbsp;<font color='#800000'><b>for</b></font>( i = fvb;
    i &lt;= lvb; i++ ) <br>
&nbsp;&nbsp;&nbsp; { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rr[i] = aa[<font color='#800080'>0</font>][<font color='#800080'>0</font>]; <br>
    <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color='#800000'><b>for</b></font>(
j = <font color='#800080'>1</font>; j &lt;= order; j++ ) <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rr[i] += aa[j][<font color='#800080'>0</font>]
* x[ i - fvb ] ^ j; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <br>
&nbsp;&nbsp;&nbsp; } <br>
    <br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color='#800000'><b>if</b></font>( <font color='#0000ff'>IsNan</font>(
rr[ fvb ] ) ) <br>
&nbsp;&nbsp;&nbsp;&nbsp; { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color='#008000'>// our polynomial
yields infinite or not-a-number result due to overflow/underflow <br>
    </font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>Title</b> = <font color='#800080'>"Polyfit
    failed. The order of polynomial is too High"</font>; <br>
&nbsp;&nbsp;&nbsp;&nbsp; } <br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color='#800000'><b>else</b></font> <br>
&nbsp;&nbsp;&nbsp;&nbsp; { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000ff'>SetChartOptions</font>( <font color='#800080'>0</font>, <b>chartShowDates</b> ); <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000ff'>SetBarFillColor</font>( <font color='#0000ff'>IIf</font>( <b>C</b> &gt; <b>O</b>, <font color='#0000ff'>ColorRGB</font>( <font color='#800080'>0</font>, <font color='#800080'>75</font>, <font color='#800080'>0</font> ), <font color='#0000ff'>IIf</font>( <b>C</b> &lt;= <b>O</b>, <font color='#0000ff'>ColorRGB</font>( <font color='#800080'>75</font>, <font color='#800080'>0</font>, <font color='#800080'>0</font> ), <b>colorLightGrey</b> )
) ); <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000ff'>Plot</font>( rr, <font color='#800080'>"rr"</font>, <b>colorWhite</b>, <b>styleLine</b> | <b>styleThick</b>); <br>
&nbsp;&nbsp;&nbsp; } <br>
    } <br>
    <font color='#800000'><b>else</b></font> <br>
    { <br>
&nbsp;&nbsp; <b>Title</b> = <font color='#800080'>"Matrix is singular. The order
of polynomial is too high"</font>; <br>
    } <br>
    <br>
    <font color='#0000ff'>Plot</font>( <b>C</b>, <font color='#800080'>""</font>, <font color='#0000ff'>IIf</font>( <b>C</b> &gt; <b>O</b>, <font color='#0000ff'>ColorRGB</font>( <font color='#800080'>0</font>, <font color='#800080'>255</font>, <font color='#800080'>0</font> ), <font color='#0000ff'>IIf</font>( <b>C</b> &lt;= <b>O</b>, <font color='#0000ff'>ColorRGB</font>( <font color='#800080'>255</font>, <font color='#800080'>0</font>, <font color='#800080'>0</font> ), <b>colorLightGrey</b> )
    ), <b>styleDots</b> | <b>styleNoLine</b> ); </CODE><br>
  </li>
  <li>Persistent static variables are now saved to PersistVars.temp and once
    write is successful the file is renamed to PersistVars.bin. This is to prevent
    data loss when writing very large sets of persistent variables.</li>
  <li>When more than one error is detected in single line of the formula then
    the first error message is displayed instead of last one in chart/commentary/analysis.<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 6.01.0 (as compared to 6.00.0)</strong></p>
<ul>
  <li>AFL: MxDet( mx, method = 0 ) - calculates determinant of the matrix<br>
    method = 0 - auto (use slow method for matrices of upto and including 5x5,
      fast for larger matrices)<br>
    method = 1 - slow (slow, more accurate)<br>
    method = 2 - fast (LU decomposition, less accurate )
    <p>&quot;slow&quot; method uses Laplace expansion <br>
&quot; fast&quot; method uses LU decomposition<br>
&quot; Slow&quot; method for small matrices (1x1, 2x2, 3x3, 4x4) is actually
faster than &quot;fast&quot;, equally fast for matrix 5x5 and<br>
      slower than &quot;fast&quot; method for matrices larger than 5x5 </p>
    <p>For this reason &quot;auto&quot; method uses &quot;fast&quot; LU method
      only for matrices larger than 5x5</p>
    <p>LU decomposition is fast but subject to higher numerical errors. &quot;Slow&quot; method
      is slower yet produces much more reliable results.<br>
      For example Octave/MatLab that use LU decomposition would say that determinant
      of singular matrix like this<br>
      { {16, 2, 3, 13}, { 5, 11, 10, 8}, {9, 7, 6, 12}, {4, 14, 15, 1 } }<br>
      is -1.4495e-012 due to roundoff errors of LU method.</p>
    <p>If you want to calculate determinant using fast (LU decomposition) method,
      call MxDet with fast parameter set to 2.</p>
    <p>CAVEAT: Laplace method has complexity of O(N!) and for this reason, even
      if you use method = 1, the maximum dimension for this method is limited
      to 10x10.<br>
      Matrices larger than that are always calculated using LU method</p>
    <br>
  </li>
  <li>AFL: MxFromString() - creates a new matrix out of string in Mathematica/Wolfram
    list-style: &quot;{ { 1, 2, 3 }, { 4, 5, 6 } }&quot; or Matlab/Maple style &quot;[
    [ 1, 2, 3 ], [ 4, 5, 6 ] ]&quot; or GNU Octave comma-semicolon style [ 1,
    2, 3; 4, 5, 6 ]</li>
  <li>AFL: MxGetBlock( matrix, startrow, endrow, startcol, endcol, asArray =
    False )<br>
      <br>
    Retrieves items from rectangular submatrix (block) and returns either smaller
    matrix (when asArray is set to False)<br>
    or &quot;normal&quot; AFL array (when asArray is set to True). If array has
    different number of bars, unused elements are filled with Null.
    <p>z = Matrix( 2, 20, 0 );<br>
      // first row<br>
      z = MxSetBlock( z, 0, 0, 0, 19, Close );<br>
      // second row<br>
      z = MxSetBlock( z, 1, 1, 0, 19, RSI( 5 ) );<br>
      printf(&quot;Matrix z\n&quot;);<br>
      printf( MxToString( z ) );</p>
    <p>x = MxGetBlock( z, 0, 1, 0, 19, True );</p>
    <p>printf(&quot;Items are now in regular array (data series):\n&quot; );<br>
      for( i = 0; i &lt; 20; i++ )<br>
      printf( NumToStr( x[ i ] ) + &quot;\n&quot; );</p>
    <p>z = MxGetBlock( z, 0, 1, 0, 1 ); // retrieve upper 2x2 submatrix<br>
      printf(&quot;Upper submatrix z\n&quot;);<br>
      printf( MxToString( z ) );<br>
    </p>
  </li>
  <li>AFL: MxInverse( mx ) - calculates inverse of the matrix (see comments to
    MxSolve for more info)<br>
      <br>
  </li>
  <li>AFL: MxSetBlock( matrix, startrow, endrow, startcol, endcol, values = 0
    ) <br>
    Sets values in the rectangular block of cells (rows in the range startrow..endrow
    and columns in the range startcol..endcol inclusive).<br>
    This allows to fill entire or partial rows, columns and all other kind of
    rectangular areas in the matrix with user specified data<br>
    Row and column numbers are zero based.<br>
    If values parameter is scalar, all cells in specified block are filled with
    that value.<br>
    If values parameter is an array, cells in the block are filled from left
    to right and from top to bottom with consecutive values taken from that array.<br>
    If there are more cells in the block than values in the array, the array
    item counter wraps around to zero and starts taking values from the beginning
    <p>Note: the function creates new matrix as a result (so source matrix is
      unaffected unless you do the assignment of the result back to the original
      variable)</p>
    <p>Example 1:<br>
      // Create a matrix 6x6<br>
      // and fill 4x4 interior (except edges with consecutively increasing numbers)</p>
    <p>y = Matrix( 6, 6, 0 );<br>
      y = MxSetBlock( y, 1, 4, 1, 4, Cum(1));<br>
      printf(&quot;Matrix y\n&quot;);<br>
      printf( MxToString( y ) );</p>
    <p>Example 2:<br>
      // Create a matrix 2 rows x 20 columns and fill rows 0, 1 with first 20
        values of Close and RSI(5) arrays respectively </p>
    <p>z = Matrix( 2, 20, 0 );<br>
      // first row<br>
      z = MxSetBlock( z, 0, 0, 0, 19, Close );<br>
      // second row<br>
      z = MxSetBlock( z, 1, 1, 0, 19, RSI( 5 ) );<br>
      printf(&quot;Matrix z\n&quot;);<br>
      printf( MxToString( z ) );</p>
  </li>
  <li>AFL: MxSolve( A, B ) - solves linear equation system A@X = B <br>
      <br>
    A needs to be square matrix NxN <br>
    B has to have N rows and at least one column (vertical vector).<br>
    Then calling<br>
    X = MxSolve( A, B ) would give vertical vector holding solution of the system
    of equations A @ X = B
    <p>B can also be a matrix,with each of its column representing different
      vector B. This way single call to MxSolve can solve several systems with
      same matrix A but different right hand vectors.<br>
      If B is a matrix NxM then MxSolve will produce result also having NxM cells
      with each column representing single solution.</p>
    <p>Example 1:</p>
    <p>A = MxFromString(&quot;[ 1, 1, 1, 1; 0, 2, 5, -1; 2, 5, -1, 1; 2, 2, 2,
      1 ]&quot;);<br>
      B = MxFromString(&quot;[ 7; -5; 28; 13 ]&quot; ); // single vertical vector
      B</p>
    <p>printf( &quot;Solving A * X = B\n&quot; );<br>
      printf(&quot;Matrix A\n&quot;);<br>
      printf( MxToString( A ) );<br>
      printf(&quot;\nMatrix B\n&quot;);<br>
      printf( MxToString( B ) );<br>
      <br>
      X = MxSolve( A, B );</p>
    <p>printf(&quot;\nSolution X\n&quot;);</p>
    <p>Example 2:</p>
    <p>A = MxFromString(&quot;[ 1, 1, 1, 1; 0, 2, 5, -1; 2, 5, -1, 1; 2, 2, 2,
      1 ]&quot;);<br>
      B = MxFromString(&quot;[ 7, 14 ; -5, -10; 28, 56; 13, 26 ]&quot; ); //
      2 right-hand side vertical vectors</p>
    <p>printf( &quot;Solving A * X = B\n&quot; );<br>
      printf(&quot;Matrix A\n&quot;);<br>
      printf( MxToString( A ) );<br>
      printf(&quot;\nMatrix B\n&quot;);<br>
      printf( MxToString( B ) );<br>
      <br>
      X = MxSolve( A, B );</p>
    <p>printf(&quot;\nSolutions X\n&quot;);</p>
    <p>printf( MxToString( X ) ); // two solutions</p>
    <p>(Highly) Technical note about numerical precision:</p>
    <p>Despite the fact that both MxSolve and MxInverse use double precision
      arithmetic solving/inverting matrices is subject to numerical precision
      of double IEEE <br>
      and for example zero result may come up as something like 1.4355e-16 (0.0000000000000001)
      due to the fact that double precision is still limited in accuracy (16
      digits).</p>
    <p>The result of <br>
      X = MxInverse( A ) @ B;<br>
      although mathematically the same as solving the system of equations, would
      yield slightly different result because if you do the inverse the returned
      matrix is converted back<br>
      to single precision and matrix product is performed with single precision.
      When you use MxSolve you are performing all calcs using 64-bit (double)
      precision and<br>
      only end result is converted back to single precision. So for example polynomial
      fit code works better with MxSolve than MxInverse</p>
    <br>
    <CODE><font color='#008000'>// Least Squares Polynomial Fit test <br>
    </font> <br>
    order = <font color='#0000ff'>Param</font>( <font color='#800080'>"n-th Order"</font>, <font color='#800080'>15</font>, <font color='#800080'>1</font>, <font color='#800080'>25</font>, <font color='#800080'>1</font> ); <br>
    length = <font color='#800080'>60</font>; <br>
    <br>
    lvb = <b>BarCount</b> - <font color='#800080'>1</font>; <br>
    fvb = lvb - length; <br>
    <br>
    yy = <font color='#0000ff'>Matrix</font>( length + <font color='#800080'>1</font>, <font color='#800080'>1</font>, <font color='#800080'>0</font> ); <br>
    xx = <font color='#0000ff'>Matrix</font>( length + <font color='#800080'>1</font>,
    order + <font color='#800080'>1</font>, <font color='#800080'>1</font> ); <br>
      <br>
    yy = <font color='#0000ff'>MxSetBlock</font>( yy, <font color='#800080'>0</font>,
    length, <font color='#800080'>0</font>, <font color='#800080'>0</font>, <font color='#0000ff'>Ref</font>( <b>C</b>,
    fvb ) ); <br>
      <br>
    x = <font color='#0000ff'>BarIndex</font>() - length/<font color='#800080'>2</font>; <br>
    <br>
    <font color='#800000'><b>for</b></font>( j = <font color='#800080'>1</font>;
    j &lt;= order; j++ ) <br>
    { <br>
&nbsp;&nbsp;&nbsp;&nbsp; xx = <font color='#0000ff'>MxSetBlock</font>( xx, <font color='#800080'>0</font>,
length, j, j, x ^ j ); <br>
    } <br>
    <br>
    xxt = <font color='#0000ff'>MxTranspose</font>( xx ); <br>
    aa = <font color='#0000ff'>MxSolve</font>( xxt @ xx, xxt ) @ yy; <br>
    <font color='#008000'>//aa = MxInverse( xxt @ xx ) @ xxt @ yy; // alternative
    way <br>
    </font> <br>
    rr = <b>Null</b>; <font color='#008000'>// store the fit in rr <br>
    </font><font color='#800000'><b>for</b></font>( i = fvb; i &lt;= lvb; i++
    ) <br>
    { <br>
&nbsp;&nbsp;&nbsp;&nbsp; rr[i] = aa[<font color='#800080'>0</font>][<font color='#800080'>0</font>]; <br>
    <br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color='#800000'><b>for</b></font>( j = <font color='#800080'>1</font>;
j &lt;= order; j++ ) <br>
&nbsp;&nbsp;&nbsp;&nbsp; { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rr[i] += aa[j][<font color='#800080'>0</font>]
* x[ i - fvb ] ^ j; <br>
&nbsp;&nbsp;&nbsp;&nbsp; } <br>
    } <br>
    <br>
    <font color='#0000ff'>SetChartOptions</font>( <font color='#800080'>0</font>, <b>chartShowDates</b> ); <br>
    <font color='#0000ff'>SetBarFillColor</font>( <font color='#0000ff'>IIf</font>( <b>C</b> &gt; <b>O</b>, <font color='#0000ff'>ColorRGB</font>( <font color='#800080'>0</font>, <font color='#800080'>75</font>, <font color='#800080'>0</font> ), <font color='#0000ff'>IIf</font>( <b>C</b> &lt;= <b>O</b>, <font color='#0000ff'>ColorRGB</font>( <font color='#800080'>75</font>, <font color='#800080'>0</font>, <font color='#800080'>0</font> ), <b>colorLightGrey</b> )
    ) ); <br>
      <font color='#0000ff'>Plot</font>( rr, <font color='#800080'>"rr"</font>, <b>colorWhite</b>, <b>styleLine</b> | <b>styleThick</b>); <br>
      <font color='#0000ff'>Plot</font>( <b>C</b>, <font color='#800080'>""</font>, <font color='#0000ff'>IIf</font>( <b>C</b> &gt; <b>O</b>, <font color='#0000ff'>ColorRGB</font>( <font color='#800080'>0</font>, <font color='#800080'>255</font>, <font color='#800080'>0</font> ), <font color='#0000ff'>IIf</font>( <b>C</b> &lt;= <b>O</b>, <font color='#0000ff'>ColorRGB</font>( <font color='#800080'>255</font>, <font color='#800080'>0</font>, <font color='#800080'>0</font> ), <b>colorLightGrey</b> )
      ), <b>styleDots</b> | <b>styleNoLine</b> ); <br>
  </CODE></li>
  <li>AFL: MxSort( mx, dim = -1, ascening = True ) - sorts the matrix<br>
      <br>
    Sorts all items in a matrix <br>
    When dim == -1 (the default) it would sort:<br>
    a) a row if there is only one row (vector is horizontal)<br>
    b) a column if there is only one column (vector is vertical)<br>
    c) each column separately if there are more rows and columns than one (so
    we have actual 2D matrix).<br>
        <br>
    When dim == 0 the function sorts the items in each row separately <br>
    When dim == 1 the function sorts the items in each column separately
    <p><br>
      // example<br>
      m = MxFromString(&quot;[ 9, 5, 6; 8, 7, 3 ]&quot;);</p>
    <p>printf( MxToString( m ) + &quot;\n\n&quot; );</p>
    <p>printf(&quot;%g, %g\n\n&quot;, MxGetSize( m, 0 ), MxGetSize( m, 1 ) );</p>
    <p>m2 = MxSort( m, 0 ) ;</p>
    <p>printf( MxToString( m2 ) + &quot;\n\n&quot; );</p>
    <p>m3 = MxSort( m, 1 ) ;</p>
    <p>printf( MxToString( m3 ) + &quot;\n\n&quot; );<br>
    </p>
  </li>
  <li>AFL: MxSortRows( mx, ascending = True, col1 = 0, col2 = -1, col3 = -1 )<br>
      <br>
    Sorts the rows of the matrix in ascending/descending order of the col1 column.
    When the col1 column has equal values, SortRows sorts according to the col2
    and col3 columns in succession (if col2 and col3 are specified and &gt;=
    0 ).<br>
    Column numbers are zero based.
    <p>Hint: if you want to sort columns instead you can Transpose/Sort rows/Transpose
      back.</p>
    <p>m = MxFromString(&quot;[ 9, 1, 6; 40, 30, 20; 8, 7, 3; 3, 5, 1 ]&quot;);</p>
    <p>printf(&quot;Input matrix\n&quot;);</p>
    <p>printf( MxToString( m ) + &quot;\n\n&quot; );</p>
    <p>printf(&quot;Rows %g, Cols %g\n\n&quot;, MxGetSize( m, 0 ), MxGetSize(
      m, 1 ) );</p>
    <p>printf(&quot;Sorting every row separately\n&quot;);<br>
      m2 = MxSort( m, 0 ) ;</p>
    <p>printf( MxToString( m2 ) + &quot;\n\n&quot; );</p>
    <p>printf(&quot;Sorting every column separately\n&quot;);<br>
      m3 = MxSort( m, 1 ) ;</p>
    <p>printf( MxToString( m3 )+ &quot;\n\n&quot;);</p>
    <p>printf(&quot;Sorting rows by contents of first column\n&quot;);<br>
      m4 = MxSortRows( m, True, 0 ) ;</p>
    <p>printf(MxToString( m4 )+ &quot;\n\n&quot;);</p>
    <p>printf(&quot;Sorting rows by contents of second column\n&quot;);<br>
      m5 = MxSortRows( m, True, 1 ) ;</p>
    <p>printf(MxToString( m5 )+ &quot;\n\n&quot;);</p>
  </li>
  <li>AFL: MxToString - creates string out of matrix variable in the Wolfram
    list style like this (for 3x3 matrix): { { x00, x01, x02 }, { x10, x11, x12
    }, { x20, x21, x22 } }<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 6.00.2 (as compared to 6.00.1)</strong></p>
<ul>
  <li>AFL: An &quot;Error 60: Requested matrix size is too large&quot; message
  is displayed now when MxCreate is called with ( rows * cols ) &gt; 532 million</li>
  <li>Analysis:
    Optimizer allows larger search spaces when using non-exhaustive optimization
  without triggering Error 709</li>
  <li>Charting: you can zoom out using Ctrl+ mouse
  wheel to the max (previously it zoomed out to 2000 bars only)</li>
  <li>Splash screen
    is now centered on default monitor screen when main frame is maximized instead
  of using old co-ordinates.</li>
  <li>Startup steps are logged into the broker.log to
  diagnose rare cases of slow startup and/or crash at startup</li>
  <li>UI: Color picker
  controls were too small on HighDPI display. Fixed.</li>
  <li>UI: New AFL Editor, Analysis
    pages now have Options page in Customize dialog allowing to turn on &quot;Large
    icons&quot; mode for HighDPI displays<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 6.00.1 (as compared to 6.00.0)</strong></p>
<ul>
  <li>A crash could occur if user formula had PlotShapes() with layer argument
    less than zero or greater than 255. Fixed (error 52 is displayed in such
    case)</li>
  <li>AFL: MxTranspose could fail if rows &gt; cols. Fixed.</li>
  <li>Calculate composites could crash if database had incorrectly set up market
    ID for symbols. Fixed.</li>
  <li>UI: a crash could occur if user attempted to open WebReseach with weblinks.cfg
    file missing or empty (could happen if setup program was not run). Fixed.</li>
  <li>UI: Analysis: Progress bar disappeared when user switched from floating
    window to normal while analysis (like optimization) was in progress. Fixed.</li>
  <li>UI: Analysis: when window was in floating mode it was possible to close
    running analysis window without warning. Fixed (now error message is displayed
    and floating window is not closed until you cancel pending analysis)</li>
  <li>UI: Bug recovery window now properly reports Windows 8.1 and Windows 10
    in version info</li>
  <li>UI: Improved font scaling of new splash screen/about window on Windows
    8 and above and screens high DPI screens (&gt;=200)<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 6.00.0 (as compared to 5.99.0)</strong></p>
<ul>
  <li>AFL Editor: Preferences: the default value for &quot;Auto-complete&quot; changed
    to &quot;Immediate&quot;</li>
  <li>AFL: MxGetSize( matrix, dim ) - get matrix size in given dimension<br>
    where<br>
    matrix argument is matrix to query for the sizes<br>
    dim argument is 0 or 1. 0 gets number of rows, 1 gets number of columns.
    <p>MxGetSize( matrix, 0 ) - gives number of rows<br>
      MxGetSize( matrix, 1 ) - gives number of columns</p>
  </li>
  <li>AFL: MxIdentity( size ) - creates an indentity matrix of defined size (square
    matrix with rows and columns equal to size argument filled with ones on the
    main diagonal and zeros elsewhere)</li>
  <li>AFL: MxTranspose( matrix ) - creates transpose of an input matrix</li>
  <li>AFL: Warning 506 is suppressed when formating is 1.0 (integer)<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.99.0 (as compared to 5.98.0)</strong></p>
<ul>
  <li>AFL: added support for matrices (2D tables of numbers). <br>
    Matrix support is preliminary and subject to change.
      <p>To create a matrix use<br>
      my_var_name = Matrix( rows, cols, initvalue)</p>
      <p>To access matrix elements, use:<br>
      my_var_name[ row ][ col ]</p>
      <p>where<br>
      row is a row index (0... number of rows-1)<br>
      and <br>
      col is a column index (0... number of columns-1)</p>
      <p>Matrices and their elements support all scalar (element-wise) arithmetic
        and logical operations</p>
      <p>So you can for example add, subtract, multiply, divide two matrices
        if they have same dimensions with one call.</p>
      <p>x = Matrix( 5, 6, 9 ); // matrix 5 rows 6 columns, initial value 9<br>
      y = Matrix( 5, 6, 10 ); // matrix 5 rows 6 columns, initial value 10</p>
      <p>z = y - z; // will give you matrix 5 rows and 6 columns filled with
        elements holding value 1 (difference between 10 and 9).</p>
      <p>All those operations are performed ELEMENT-WISE.</p>
      <p>You can also apply any arithmetic and logical operation on matrix AND
        scalar value. This would perform element-wise<br>
      operation on each element of source matrix and given scalar value.</p>
      <p>m = Matrix( 10, 10, 0 ); // m will be 10x10 matrix filled with zeros<br>
      z = m; // z is now also a matrix</p>
      <p>for( i = 0; i &lt; 10; i++ )<br>
      {<br>
      z[ i ][ 4 ] = i; // fill z with some other values, note that m will remain
      unaffected.<br>
      }</p>
      <p>for( i = 0; i &lt; 10; i++ )<br>
      _TRACEF( &quot;%g = %g, %g, %g\n&quot;, i, m[i][1], m[ i][4], z[ i][4]);</p>
      <p>// scalar addition (element wise)<br>
      z += 3;<br>
      m += 5;</p>
      <p>for( i = 0; i &lt; 10; i++ )<br>
      _TRACEF( &quot;%g = %g, %g, %g\n&quot;, i, m[i][1], m[ i][4], z[ i][4]);</p>
      <p>Additionally there is a new operator @ that handles matrix product (matrix
        multiplication in the sense used in linear algebra). This operator requies<br>
      that number of columns in first array is the same as number of rows in
      second array.<br>
      </p>
  </li>
  <li>AFL: new Error 59. Too many subscripts - displayed when user attempts to
    use 3 or more subscripts on matrix identifier</li>
  <li>AFL: new function Matrix( rows, cols, init_value = 0 ) - creates 2 dimensional
    table with defined number of rows and column</li>
  <li>AFL: new matrix product (multiplication) operator: @<br>
    a new operator @ that handles matrix product (matrix multiplication in the
      sense used in linear algebra). This operator requires<br>
    that number of columns in first array is the same as number of rows in second
    array.
    <p>A = Matrix( 1, 3 );<br>
      B = Matrix( 3, 2 );</p>
    <p>// matrix A = [ 1, 4, 6 ]<br>
      // matrix B = [ 2, 3 ] <br>
      // [ 5, 8 ]<br>
      // [ 7, 9 ]</p>
    <p>A[ 0 ][ 0 ] = 1; A[ 0 ][ 1 ] = 4; A[ 0 ][ 2 ] = 6;</p>
    <p>B[ 0 ][ 0 ] = 2; B[ 0 ][ 1 ] = 3;<br>
      B[ 1 ][ 0 ] = 5; B[ 1 ][ 1 ] = 8;<br>
      B[ 2 ][ 0 ] = 7; B[ 2 ][ 1 ] = 9;</p>
    <p>X = A @ B;</p>
    <p>_TRACEF(&quot;%g %g&quot;, X[ 0 ][ 0 ], X[ 0 ][ 1 ] );</p>
  </li>
  <li>Charts: when chart is moved vertically by the user so it falls outside
    upper edge, the parts falling outside are not drawn as flat line anymore</li>
  <li>New Analysis: Attempt to run Walk forward on periods without any data for
    any symbols could result in exception. Fixed.</li>
  <li>New Analysis: Show current trade arrows did not show sell arrow after Individual
    backtest. Fixed.</li>
  <li>UI: Color text output in the Interpretation window was sometimes incorrect
    when numbers followed immediately EncodeColor call. Fixed.</li>
  <li>UI: Interval combo dropdown list adapts its width to higher DPI displays
    now</li>
  <li>UI: Notepad is refreshed on sliding back from auto-hide</li>
  <li>UI: Updating Symbol Information after ASCII import</li>
  <li>Upgrade info: Free upgrade only for users who purchased license after May
    31, 2013<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.98.0 (as compared to 5.97.0)</strong></p>
<ul>
  <li>Analysis: Monte Carlo CDF charts use denser X grid (5% stepping)</li>
  <li>Analysis: Monte Carlo min/max/avg equity charts can now be displayed as
    percent change instead of absolute values</li>
  <li>Analysis: Monte Carlo stats are now generated in out-of-sample Walk forward
    steps by default</li>
  <li>Analysis: Walk forward Out-Of-Sample summary report includes Monte Carlo
    simulation from ALL trades of all Out-of-sample periods</li>
  <li>Analysis: Walk forward: A crash could occur when Monte Carlo sim was enabled
    in walk-forward optimization. Fixed.</li>
  <li>Analysis: Walk forward: Buy&amp;Hold stats Max. sys drawdown was too large
    for 2nd and next steps of walk forward OOS. Fixed.<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.97.0 (as compared to 5.96.0)</strong></p>
<ul>
  <li>Analysis: Backtest report uses now client-side script pagination when trade
    list contains more than 1000 trades so it takes less time to display it (3s
    vs 15s for 30K trades). (Experimental, may be removed)</li>
  <li>Analysis: MC: MC Min/Max/Strawbroom equit chart was getting slow when number
    of trades in backtest exceeded 1000. It draws faster now.</li>
  <li>Analysis: Monte Carlo charts are now moved to Reports (so they appear in
    the REPORT as a separate page, not as tabs in Analysis) and generated in
    separate thread</li>
  <li>Analysis: Monte Carlo: numerical values of distributions are now included
    in the Report / Monte Carlo page</li>
  <li>HtmlView: new version 1.3, improved performance of Edit-&gt;Copy Table
    for large tables (&gt;30K rows) by 2 orders of magnitude. Also added support
    for paginated tables.</li>
  <li>In 5.9x single-symbol portfolio backtests were reported as &quot;0-symbols&quot; in
    Report Explorer. Fixed (fix applies to newly run backtests only)</li>
  <li>OLE: added LoadWatchlists() method to Broker.Application object. It allows
    to re-load watchlist files for currently loaded database without re-loading
    entire database. (Just in case you ask for SaveWatchlists - watchlists are
    saved when you call SaveDatabase)</li>
  <li>OLE: splash screen closes automatically after 1 second if program was launched
    from OLE, instead of being displayed as long as OLE object is active</li>
  <li>UI: Added global Analysis-&gt;Report Explorer menu to access Report explorer
    without need to open Analysis window</li>
  <li>UI: small tweaks and fixes to About/Splash screen. <br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.96.0 (as compared to 5.95.0)</strong></p>
<ul>
  <li>AFL Editor: Verify Syntax uses raw symbol quotes, so it is faster and works
    regardless of &quot;mixed data&quot; setting</li>
  <li>AFL Editor: Word wrap - wrapped lines uses same indent as previous line</li>
  <li>AFL: added SetStopPrecedence function</li>
  <li>AFL: ApplyStop() has 2 more parameters: ValidFrom/ValidTo - define starting
    and ending bar since entry when stop is active<br>
    // Applystop( type, mode, amount, exitatstop, volatile, reentrydelay, validfrom,
    validto )
    <p>ValidFrom - defines first bar since entry when stop can generate an exit.
      0 means from the very beginning<br>
      ValidTo - defines last bar since entry when stop can generate an exit.
      -1 means &quot;infinite&quot;.<br>
      By default stops are valid all the time (0/-1).</p>
    <p>So now you can create stops that get actived/deactivated in different
      times. <br>
      This setting is independent for each stop type. It also works in conjunction
      with SetOption(&quot;HoldMinBars&quot;, x ).<br>
      HoldMinBars affects BOTH regular exits and stops, preventing ALL kind of
      exits during defined period.</p>
    <p>ValidFrom/ValidTo works on each stop separately and does not affect regular
      exits.</p>
    <p>For example always have a stopTypeLoss always in affect and only allow
      a trailing stop to become active after so many bars:</p>
    <p>ApplyStop(stopTypeLoss, stopModePercent, 10, 1);<br>
      ApplyStop(stopTypeNBar, stopModeBars, 40, 1);<br>
      ApplyStop(stopTypeTrailing, stopModeRisk, 7, True, True, 0, 4 /* valid
      from 4th bar after entry */ );</p>
    <p>This feature is extended implementation of FC item #514</p>
    <p>IMPORTANT:<br>
      Precedence parameter introduced in 5.95 has been REMOVED.<br>
      That functionality has been replaced by new SetStopPrecedence function.<br>
    </p>
  </li>
  <li>AFL: new function: _TRACEF() - printf-formatted trace<br>
    _TRACEF( &quot;Close %g, Open %g&quot;, Open, Close );<br>
  </li>
  <li>AFL: Param() offers increased stepping precision for small fractional increments</li>
  <li>Analysis: some newly introduced settings (MC mainly) were not saved in
    Analysis project. Now they are saved.</li>
  <li>In 5.95.0 formulas 0, 1, -1, Null constants for Buy/Sell/Short/Cover assignments
    and using Equity() could crash. Fixed. </li>
  <li>In 5.95.0 when ExitAtStop==1 for NBarStop was used it deactivated other
    stops in backtestRegular mode. Fixed.</li>
  <li>In backtestRegular mode (old code path) when HoldMinBars was &gt;=2 and
    exit was triggered on very first bar opening after hold period price was
    not adjusted to open as in other (new) backtest modes. Fixed.</li>
  <li>Monte Carlo: MC can be now enabled in Optimization and Individual Backtest<br>
      <br>
    To enable Monte Carlo simulation in each backtest of optimization process
    and each individual backtest you can use<br>
    SetOption( &quot;MCEnable&quot;, 2 ); // value == 2 forces MC to be enabled
    everywhere (in every mode including optimization).
    <p>the old option:<br>
      SetOption(&quot;MCEnable&quot;, 1 ); // value == 1 enables MC only in portfolio
      backtests (default)</p>
    <p>Note that enabling MC in optimization is highly discouraged unless you
      actually use MC metrics as optimization target via custom backtester<br>
      or otherwise use MC distributions in the optimization process.<br>
      Monte Carlo process is computationally costly and while few hundred milliseconds
      added to one backtest don't matter much, <br>
      in case of optimizations when these are multipled by number of steps you
      can easily increase optimization time by orders of magnitude.<br>
      So unless you REALLY need MC distribution as custom metric and optimization
      target, do NOT enable MC in optimization.</p>
    <br>
  </li>
  <li>UI: added special &quot;meaningful&quot; message on attempt to open the
    .APX file that has invalid format</li>
  <li>UI: Analysis settings are now made newbie-friendly - a new &quot;SCENARIO&quot; combo
    has been added that allows to choose from 4 preset scenarios<br>
      <br>
    If user chooses preset scenario, the application sets properly the following
    fields<br>
    - trade prices &amp; delays<br>
    - exitAtStop modes<br>
    - N-bar stop priority<br>
    - ActivateStopImmediately
    <p>and disables those preset controls from accidential change.</p>
    <p>Using presets prevents beginners from using wrong settings.</p>
    <p>It is still possible to override any setting from the formula level (so
      be careful what you write in your formula).</p>
    <p>A default &quot;CUSTOM&quot; scenario works as in old versions -i.e. all
      fields are enabled for change but it is user responsibility<br>
      to set those fields properly. Flexibility comes at a cost - some combinations
      of settings that are not covered by preset scenarios<br>
      may make no sense and sometimes lead to wrong results. The user should
      consult the manual and/or ask support when in doubt.</p>
    <br>
  </li>
  <li>UI: Analysis Settings: &quot;Activate stops immediately&quot; check box
    has been moved from &quot;General&quot; to &quot;Stops&quot; tab where it
    really belongs functionally</li>
  <li>UI: new About dialog/startup splash screen (asynchronously showing app
    loading info)</li>
  <li>UI: Parameter window: when parameter names are very long, value area is
    shrinked down to give more space for name, but not less than 160px/96DPI<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.95.0 (as compared to 5.94.0)</strong></p>
<ul>
  <li>AFL Editor: Pretiffy formatting fixes and improvements. Also editor attempts
    to keep unchanged scroll position after prettify.</li>
  <li>AFL Editor: Prettify selection now removes extra padding around parenthesis
    and leaves only one space pad inside</li>
  <li>AFL Editor: Word wrap implemented (View-&gt;Word Wrap menu)</li>
  <li>AFL Engine: upsizing certain common scalar values (-1, 0, 1, Null) to array
    is much quicker thanks to caching</li>
  <li><strong>AFL: #pragma maxthreads N</strong> - where N is a natural number
    1...&lt;number of cores&gt;. Allows to lower the number of parallel threads
    using in Analysis. For example to run in just one thread use #pragma maxthreads
    1<br>
    Attention: lowering number of threads degrades performance<br>
  </li>
  <li><strong>AFL: ApplyStop</strong> has new, 7th parameter: precedence that
    defines the order in which stops are triggered if they appear on the very
    same bar<br>
    Accepted values are 0, 1, 2, 3.<br>
    Stops are executed in increasing precedence order, so 0 is executed first,
    1 - second, 2 - third, 3 - as the last.<br>
    Values outside 0..3 range are ignored.<br>
    Specifying -1 means &quot;no change&quot; - use default order.
    <p>Keep in mind that if you are changing ApplyStop order/precedence you<br>
      1. MUST DEFINE ALL APPLYSTOP even if you don't use all stop types. It you
        don't use given stop type use stopModeDisable in mode parameter<br>
      2. There must be NO DUPLICATE in precedence numbers. Otherwise unpredictable
      behavior may occur.<br>
      3. The order of events inside bar is unknown so specifying given order
      of execution of stops<br>
      is based on assumptions that may or may not be correct for given trading
      scenario. It is advised to keep max. loss stop as first one. <br>
      Whenever N-bar stop is executed first or not depends on your trading setup.
      If you trade on open, then Nbar stop may be executed first (even before
      max loss).<br>
      Trailing stop can be excuted before or after profit target depending on
      your setup. Contrary to &quot;gut feeling&quot; executing trailing stop
      before profit target is not necesarily more pessimistic, because<br>
      in several cases leads to increasing CAR instead of decreasing it. Now
      you can test both. Choose whatever fits your trading style. Choo</p>
    <p><br>
      Example:<br>
      // Applystops will be excuted in the following order: loss, trailing, profit,
      n-bar:<br>
      ApplyStop( stopTypeLoss, stopModePercent, 5, True, False, 0, 0 /*precedence*/
      );<br>
      ApplyStop( stopTypeTrailing, stopModePercent, 5, True, False, 0, 1 /*precedence*/
      );<br>
      ApplyStop( stopTypeProfit, stopModePercent, 5, True, False, 0, 2 /*precedence*/
      );<br>
      ApplyStop( stopTypeNBar, stopModeBars, 40, False, False, 0, 3 /*precedence*/
      );</p>
    <p>Note:<br>
      for backward compatibility:<br>
      With stopTypeNBar, when Precedence parameter is provided then ExitAtStop
      setting is ignored. <br>
      When Precedence parameter is not provided for stopTypeNBar<br>
      there are two possible sequences applied by default<br>
      if NBarHasPriority setting is true or you call ApplyStop with ExitAtStop
      set to true then sequence is N-bar, loss, profit, trailing<br>
      otherwise default sequence is loss, profit, trailing, N-bar<br>
      These defaults will be re-applied whenever you call ApplyStop( stopTypeNBar
      ... ) without providing precedence parameter.</p>
    <p>Note 2:<br>
      Fixed ruin stop (99.6% loss) is always executed as last one.<br>
    </p>
  </li>
  <li>AFL: Custom Backtest: Monte Carlo simulation results are now available
    in custom bactester (after backtest or PostProcess()).<br>
      <p>per = Optimize( &quot;period&quot;, 20, 2, 100, 1 );<br>
      Buy = Cross( C, MA( C, per ) );<br>
      Sell = Cross( MA( C, per ) , C );</p>
      <p>SetOption(&quot;MCEnable&quot;, True );<br>
      SetOption(&quot;MCRuns&quot;, 1000 );<br>
      SetPositionSize( 1, spsShares );<br>
      SetCustomBacktestProc(&quot;&quot;); </p>
      <p>if( Status(&quot;action&quot;) == actionPortfolio ) <br>
      { <br>
      bo = GetBacktesterObject(); </p>
      <p> bo.Backtest(); // run default backtest procedure </p>
      <p> // get access to Monte Carlo results<br>
      // note 1: it may be NULL if MC is NOT enabled<br>
      // note 2: MC results are available after Backtest() or PostProcess as
      MC simulation is done in final phase of post processing<br>
      mc = bo.GetMonteCarloSim(); <br>
      <br>
      if( mc )<br>
      {<br>
      // get 25-th percentile of final equity distribution<br>
      bo.AddCustomMetric(&quot;FinalEq25&quot;, mc.GetValue( &quot;FinalEquity&quot;,
      25 ) );<br>
      }</p>
      <p>}</p>
  </li>
  <li><strong>GetMonteCarloSim</strong>() to retrieve MC object to access distributions<br>
    MonteCarloSim object:<br>
    Methods:<br>
    GetValue(&quot;field&quot;, percentile)<br>
  </li>
  <li><strong>AFL: MonteCarloSim GetValue</strong>( &quot;field&quot;, percentile
    )<br>
      <br>
    Available &quot;field&quot; values:<br>
&quot; FinalEquity&quot;<br>
&quot; CAR&quot;<br>
&quot; LowestEquity&quot;<br>
&quot; MaxDrawdown&quot;<br>
&quot; MaxPercDrawdown&quot; <br>
  </li>
  <li><strong>AFL: new function: IIR </strong>- general-purpose Infinite Impulse
    Response filter of order 1-4<br>
    IIR( input, b0 = 1, a1 = 0, b1 = 0, a2 = 0, b2 = 0, a3 = 0, b3 = 0, a4 =
    0, b4 = 0 )
    <p>It implements fast 4th-order infinite impulse response filter. </p>
    <p>Analytically it is:</p>
    <p>y[ n ] = b0 * x[ n ] + b1 * x[ n - 1 ] + b2 * x[ n - 2 ] + b3 * x[ n -
      3 ] + b4 * x[ n - 4 ]<br>
      + a1 * y[ n - 1 ] + a2 * y[ n - 2 ] + a3 * y[ n - 4 ] + a4 * y[ n -4 ];</p>
    <p>AFL equivalent:<br>
      y = x; // init so no glitches at the beginning appear<br>
      for( n = 4; n &lt; BarCount; n++ )<br>
      {<br>
      y[ n ] = b0 * x[ n ] + b1 * x[ n - 1 ] + b2 * x[ n - 2 ] + b3 * x[ n -
      3 ] + b4 * x[ n - 4 ]<br>
      + a1 * y[ n - 1 ] + a2 * y[ n - 2 ] + a3 * y[ n - 4 ] + a4 * y[ n - 4 ];<br>
      }</p>
    <p>Filters of orders 3 and 2 can be implemented by leaving unneeded arguments
      at default value of zero.</p>
    <p>Coefficients b0, b1, b2, b3, b4 multiply the input signal x[n] and are
      referred to as the feedforward coefficients. Coefficients a1, a2, a3, a4
      multiply the output signal y[n] and are referred to as the feedback coefficients.
      Pay careful attention to the sign of the feedback coefficients. Some design
      tools flip the sign of the feedback coefficients. In this case the feedback
      coefficients must be negated.</p>
    <p>This convention is used so feedback coefficients work the same as in AMA2
      in case of first order filter, so </p>
    <p>IIR( array, factor, 1-factor )</p>
    <p>is the same as</p>
    <p>AMA2( array, factor, 1-factor )</p>
    <p>(with very minor difference is that IIR uses internally double precision
      arithmetic while AMA2 uses single precision)</p>
    <p>simple ema:<br>
      factor = 2/(period+1);<br>
      IIR( input, factor, 1- factor );</p>
    <p>wilders:<br>
      factor = 1/period<br>
      IIR( input, factor, 1-factor );</p>
    <p>Ehlers Supersmoother</p>
    <p> <CODE>Periods = <font color='#800080'>10</font>; <br>
          <br>
      c1 = <font color='#800080'>1.41421</font> * <font color='#800080'>3.14159</font> /
      Periods; <br>
      c2 = <font color='#800080'>2.71828</font>^-c1; <br>
      a1 = <font color='#800080'>2</font> * c2 * <font color='#0000ff'>cos</font>(
      c1 ); <br>
      a2 = -c2^<font color='#800080'>2</font>; <br>
      b0 = (<font color='#800080'>1</font> - a1 - a2)/<font color='#800080'>2</font>; <br>
      b1 = b0; <br>
      <br>
      x = <font color='#0000ff'>IIR</font>( <b>Close</b>, b0, a1, b1, a2 ); <br>
      <font color='#0000ff'>Plot</font>( x, <font color='#800080'>"Super Smoother"</font>, <b>colorRed</b> );</CODE><br>
    </p>
  </li>
  <li>AFL: SetOption/GetOption new fields for MC Equity/Straw broom chart, &quot;MCChartEquityCurves&quot; (true/false), &quot;MCStrawBroomLines&quot; (0..100),
    MCPosSizePctEquity (0..100)</li>
  <li>AFL: Status(&quot;ThreadID&quot;) - gets the current thread ID under which
    formula is executed</li>
  <li>Analysis: MCS: new position sizing method: Percent of Equity</li>
  <li>Backtest: fixed ruin stop (99.6% drawdown) in backtestModeRegular is executed
    last as in other modes now.</li>
  <li>Memory usage was larger in 5.94 when lots of chart panes were open. Now
    it is back to previous levels.</li>
  <li>MonteCarlo: Min/Max/Avg Equity + Straw broom chart implemented + Settings</li>
  <li>UI: Enhanced Assignment Organizer: Faster operation, display FULL NAME
    alongside with symbol, sorting by column, alternate row background, proportional
    resizing of both left/right lists<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.94.0 (as compared to 5.93.0)</strong> </p>
<ul>
  <li>Analysis: implemented Monte Carlo simulation (preliminary) produces CDF
    charts of MC Final Equity, MC CAR, MC Max Drawdown $ and %, Lowest Equity<br>
      <br>
    This feature is preliminary and subject to change.
    <p>AmiBroker's built-in Monte Carlo simulator is high speed (30+ million
      trades per second) simulator that runs series of random trade sequences
      based on backtest output.<br>
      It uses high-quality Mersene Twister random number generator. </p>
    <p>It is run automatically after backtest and produces a series of CDF charts
      (see extra tabs in the New Analysis window). These charts are probably
      going to be moved<br>
      to the report at later stage.<br>
      Monte Carlo simulator is by default available only during portfolio backtest
      runs. It is NOT available/running during optimization or individual optimization.<br>
      (I may enable it in the future).</p>
    <p>You can control process of Monte Carlo simulation using new Settings page:</p>
    <p>&quot;Enable Monte Carlo Simulation&quot; - turns on/off MC simulator</p>
    <p>&quot;Number of runs&quot; - defines how many MC simulation runs is done
      (default 1000)</p>
    <p>&quot;Position sizing&quot; - defines position sizing used by Monte Carlo
      simulator.<br>
      Position sizing algorithm used by MC process is independent from that used
      by backtest. To do so MC may apply special processing to trade list obtained
      from backtester depending on this option setting.<br>
      - &quot;Don't change&quot; - uses trades as they are coming from the backtester
      without changing position size and profit as it is reported from the backtester<br>
      - &quot;Fixed size: N shares/contracts&quot; - trade fixed number of shares/contracts.
      It takes per-share profit as reported by backtester and muliplies it by
      N contracts as entered in the settings. Per-share profit is calculated
      by dividing profit reported by the backtester by number of shares/contracts
      reported by the backtester<br>
      - &quot;Constant value: X&quot; - trades fixed amount per trade. Takes
      percent profit reported by backtester and multiplies it by constant value
      entered to get the profit. <br>
    </p>
  </li>
  <li>AFL: SetOption/GetOption support new fields that control Monte Carlo simulation: &quot;MCEnable&quot; (true/false), &quot;MCRuns&quot; -
    default 1000, &quot;MCPosSizeMethod&quot; - 0 - don't change, 1 - fixed size,
    2 - constant amount, &quot;MCPosSizeShares&quot; (number), &quot;MCPosSizeValue&quot; (number)</li>
  <li>AFL: 32-bit round() is 7X faster and now works in &quot;round half to even&quot; (default
    IEEE mode) instead of half towards infinity. Hand written in assembly due
    to slowness of CRT</li>
  <li>AFL: int() and frac() functions are 2X faster now </li>
  <li>AFL: integer division operator \ (experimental)</li>
  <li>AFL: StrMatch() - string pattern/wildcard matching<br>
    StrMatch( &quot;sting&quot;, &quot;searchsting&quot;);
    <p>returns TRUE or FALSE whenever string matches searchstring or not.</p>
    <p>Searchstring is can contain wild-card characters such as:<br>
      * - matches any string, including empty strings<br>
      ? - matches any single character</p>
    <p>This function is case sensitive (of course except wildcard characters). <br>
      If you want case insensitive matching - convert both string and searchstring
        to lowercase or uppercase<br>
      prior to matching (StrLower/StrUpper)</p>
    <p>Example:<br>
      x = StrMatch(&quot;Every breath you take&quot;, &quot;Every * you *&quot;);
      // x will be TRUE<br>
      x = StrMatch(&quot;Every step you make&quot;, &quot;Every * you *&quot;);
      // x will be TRUE<br>
    </p>
  </li>
  <li>AFL: support for UCN (universal character numbers) \uXXXX where XXXX is
    hexadecimal character code. UCN output works in PlotText/PlotTextSetFont,
    GfxDrawText, GfxTextOut, Chart titles, Interpretation and Commentary windows.
    Requires Windows 2000 or higher<br>
      <br>
      <br>
    For example <br>
    heart &quot;\u2764&quot;<br>
    sun &quot;\u2600&quot;<br>
    star &quot;\u2605&quot;<br>
    EURO currency: &quot;\u20ac&quot;<br>
    Sigma (greek): &quot;\u03a3&quot;<br>
    alpha (greek): &quot;\u03b1&quot;<br>
    beta (greek): &quot;\u03b2&quot;<br>
    umbrella: &quot;\u2602&quot;<br>
    telephone: &quot;\u260e&quot;<br>
    hand pointing up &quot;\u261D&quot;
    <p>Tables of all UCN/Unicode characters<br>
        <a href="http://www.unicode.org">http://www.unicode.org</a><br>
        <a href="http://unicode-table.com/">http://unicode-table.com/</a><br>
        <a href="http://unicode-table.com/">http://www.unicodemap.org</a><br>
        <a href="http://en.wikipedia.org/wiki/List_of_Unicode_characters">http://en.wikipedia.org/wiki/List_of_Unicode_characters</a><br>
      Various arrows:<br>
      <a href="http://www.unicode.org/charts/PDF/U2190.pdf">http://www.unicode.org/charts/PDF/U2190.pdf</a><br>
      Enclosed alphanumerics:<br>
      <a href="http://www.unicode.org/charts/PDF/U2460.pdf">http://www.unicode.org/charts/PDF/U2460.pdf</a></p>
    <p>(note: NOT all glyphs (graphical representations of characters) are actually
      present in current font. This depends on your operating system. For example
      Segoe UI in Windows 7 has lots of characters, but Windows 8 has more,<br>
      if a glyph is missing usually an empty rectangle is drawn). DejaVu free
      font has lots of glyphs, Symbola free font has lots of weird shapes.<br>
      Plot( C, &quot;&quot;, colorDefault );<br>
      PlotTextSetFont( &quot;\u2665\u2126\u2191\u21d1\u24ee\u261D&quot;, &quot;Segoe
      UI&quot;, 30, 20, HighestVisibleValue( C )/2 + LowestVisibleValue( C )/2
      , colorRed );<br>
      Title = &quot;A demo of UCN: &quot;+EncodeColor(colorRed)+&quot;\u2665\u2126\u2191\u20ac\u03a3\u03b2\u2602\u260E&quot;;</p>
  </li>
  <li>UI: Charts: when creating a new chart window Interval Lock was often marked
    automatically. Now it is fixed (it is always OFF for new charts).</li>
  <li>UI: XY-charts could enter infinite loop (hang) if ALL Y-coordintates were
    the same. Fixed.</li>
  <li>UI: XYCharts tooltip display shows X/Y point data under the cursor as in
    old version but when it does not find any, it shows data point from relevant
    X position<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.93.0 (as compared to 5.92.0)</strong></p>
<ul>
  <li>AFL Editor provides precise positioning of cursor for errors that occur
    within argument list of function calls</li>
  <li>AFL: Error 5 (incorrect type of argument in function call) is now much
    more precise: it tells what function expects and what type is actually found</li>
  <li>AFL: Low Level Gfx: GfxSelectStockObject() added - allows to select so
    called &quot;stock&quot; GDI objects such as Hollow brush (that allow to
    draw empty circles, polygons and so on)<br>
    Available stock objects:
    <p>WHITE_BRUSH 0<br>
      LTGRAY_BRUSH 1<br>
      GRAY_BRUSH 2<br>
      DKGRAY_BRUSH 3<br>
      BLACK_BRUSH 4<br>
      NULL_BRUSH 5 (the same as hollow brush)<br>
      HOLLOW_BRUSH 5<br>
      WHITE_PEN 6<br>
      BLACK_PEN 7<br>
      NULL_PEN 8<br>
      OEM_FIXED_FONT 10<br>
      ANSI_FIXED_FONT 11<br>
      ANSI_VAR_FONT 12<br>
      SYSTEM_FONT 13<br>
      DEVICE_DEFAULT_FONT 14<br>
      SYSTEM_FIXED_FONT 16<br>
      DEFAULT_GUI_FONT 17</p>
    <p>Example circle with hollow interior:</p>
    <p>GfxSelectPen( colorOrange, 4 );<br>
      GfxSelectStockObject( 5 ); // hollow brush<br>
      GfxCircle(100, 100, 20 );</p>
  </li>
  <li>AFL: Low-Level Gfx: GfxSelectHatchBrush( color, style )<br>
    Supported hatch styles:
      <p>HS_HORIZONTAL 0 /* ----- */<br>
      HS_VERTICAL 1 /* ||||| */<br>
      HS_FDIAGONAL 2 /* \\\\\ */<br>
      HS_BDIAGONAL 3 /* ///// */<br>
      HS_CROSS 4 /* +++++ */<br>
      HS_DIAGCROSS 5 /* xxxxx */</p>
      <p>Hatch color is specified by color parameter, hatch background is specified
        by current background color<br>
      see: GfxSetBkColor()</p>
      <p>GfxSelectPen( colorOrange, 4 );<br>
      GfxSetBkColor( colorLightGrey );<br>
      GfxSelectHatchBrush( colorBlue, Param(&quot;Hatch pattern&quot;, 5, 0,
      5 ) );<br>
      GfxCircle(100, 100, 20 );</p>
      <p><br>
      </p>
  </li>
  <li>AFL: Low-level Gfx: GfxSetZOrder now supports using z-order outside -5...+5
    range, but displays a warning 903 in the editor about possible decrease in
    performance</li>
  <li>AFL: Percentile() function now supports variable period and has default
    value for rank = 50 (such param gives median with average of upper/lower
    median for even periods)<br>
      <br>
    Note that Percentile is very computation intensive function (it involves
    re-sorting arrays every bar)<br>
    and variable-period version (if you call it with period being ARRAY) runs
    slower than scalar version
    <p>bi = BarIndex();<br>
      x = Percentile( Close, bi, 50 );<br>
      Plot( x, &quot;Cumulative 50% Percentile&quot;, colorRed );<br>
      Plot( Close, &quot;Price&quot;, colorDefault, styleCandle );</p>
  </li>
  <li>AFL: XYAddChartPoint has new parameter (linecolor)</li>
  <li>AFL: XYChartSetAxis now supports the following styles: styleLine, styleDots,
    styleHistogram, styleThick and combinations of those styles. Multiple lines
    are possible - to start a new line call add a NULL point - XYAddChartPoint(
    chartname, &quot;&quot;, Null, Null );<br>
      <br>
    chartname=&quot;example&quot;;
    <p>XYChartSetAxis(chartname, &quot;[x]&quot;, &quot;[sinx/x]&quot;, styleLine
      | styleDots ); // bar style<br>
      for( x = -10; x &lt; 10; x += 0.2 ) <br>
      { <br>
      y = sin(x ) / x;<br>
      XYChartAddPoint( chartname, &quot;&quot;, x, y, colorGreen, colorRed ); <br>
      }<br>
      <br>
      XYChartAddPoint( chartname, &quot;&quot;, Null, Null ); // add a NULL point
      to begin new line<br>
        <br>
      for( x = -10; x &lt; 10; x += 0.2 ) <br>
      { <br>
      y = sin( 2 * x ) / x;<br>
      XYChartAddPoint( chartname, &quot;&quot;, x, y, colorOrange, colorBlue
      ); <br>
      }</p>
  </li>
  <li>Backtest: Buy-And-Hold simulation is performed and its statistics are calculated
    and included in the Backtest Report. <br>
    This feature in worst case (single symbol test) may add upto 30% to backtest
    time. In portfolio case the impact is negligible. <br>
    The Buy-and-Hold calculations are turned OFF when detailed reports are not
    generated, for example during optimizations, so there is no slow down,<br>
    unless you turn on report generation during optimization SetOption(&quot;GenerateReport&quot;,
    1 )
    <p>You can turn it off from Settings, Reporting</p>
    <p>Buy-and-hold simulation uses current symbol when doing single-symbol backtests/optimization.<br>
      When doing portfolio backtest for more than one symbol, it uses &quot;Portfolio
      B&amp;H symbol&quot; as a benchmark for buy and hold.</p>
  </li>
  <li>Backtest: Report : numerical values don't get wrapped when report window
    is made small</li>
  <li>Backtester: implemented user-definable interest on account margin loans,
    charged when net cash balance drops below zero. Margin rate (0..100%) is
    definable in Analysis Settings.<br>
    Margin Rate is added ON TOP of interest rate defined in the settings. <br>
    So if interest rate is set to 0.1% and Margin rate is 1%, then effective
    margin loan rate is 1.1%.<br>
    It also works with dynamic Interest rate, so if you define dynamic Interest
    Rate symbol<br>
    then Margin Rate is added ON TOP current value taken from dynamic Interest
    Rate
    <p>Current rates used are listed in the Detailed Log</p>
  </li>
  <li>Backtester: implemented variable interest rate earnings<br>
    To use variable interest rate:
      <p>1. Add a symbol that will hold interest rates. It does not need to have
        quotes every day,<br>
      you can have only quotes on days when interest rate changes.<br>
      Interest rates should be expressed in PERCENTS. So if interest is 5% you
      should enter 5 in &quot;close&quot; price field for particular date</p>
      <p>2. Enter the rate symbol into &quot;Dynamic interest symbol&quot; in
        the Settings.</p>
      <p>3. Enter &quot;Fixed interest rate&quot; in the Settings. It will be
        used for days PRIOR to very first date available in intrest rate symbol.</p>
  </li>
  <li>Backtester: interest earnings on positve cash balance and deductions on
    margin loans are now reported in detail in &quot;Detailed log&quot; mode
    every day</li>
  <li>Filter window enhanced. Now you can select multiple categories of the same
    type (for example even 7 different watch lists) and combine them using &quot;OR&quot; (match
    ANY), or &quot;AND&quot; (match ALL)</li>
  <li>UI: Commentary: added marquee progress bar to give visual clue to the user
    when formula is being executed</li>
  <li>UI: Deletion of symbols is now confirmed with better looking task dialog
    that has explicit button &quot;Yes, delete permanently&quot; to avoid user
    mistakes<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.92.0 (as compared to 5.91.1)</strong></p>
<ul>
  <li>Analysis: Exploration's XYChart now allows bar style in addition to point
    style. </li>
  <li>AFL: New argument for XYChartSetAxis(&quot;chartname&quot;, &quot;xaxis&quot;, &quot;yaxis&quot;,
    chartStyle = 0 )<br>
    Note that XY chart styles are different than regular chart styles and only
    two are supported at the moment: 0 (default) - point style, 1 - bar style
    (new)
    <p>Example of bar style usage (this is EXPLORATION code):</p>
    <p><CODE>chartname = <font color='#800080'>"example"</font>; <br>
          <font color='#0000ff'>XYChartSetAxis</font>( chartname, <font color='#800080'>"[x]"</font>, <font color='#800080'>"[sinx/x]"</font>, <font color='#800080'>1</font> ); <font color='#008000'>//
          bar style <br>
          </font> <font color='#800000'><b>for</b></font> ( x = -<font color='#800080'>10</font>;
          x &lt; <font color='#800080'>10</font>; x += <font color='#800080'>0.2</font> ) <br>
      { <br>
&nbsp;&nbsp;&nbsp;&nbsp; y = <font color='#0000ff'>sin</font>( x ) / x; <br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000ff'>XYChartAddPoint</font>( chartname, <font color='#800080'>""</font>,
x, y, <b>colorGreen</b> ); <br>
      } <br>
      </CODE><br>
      Second example: <br>
      <br>
      <CODE> chartname = <font color='#800080'>"gaussian"</font>; <br>
      <font color='#0000ff'>XYChartSetAxis</font>( chartname, <font color='#800080'>"[x]"</font>, <font color='#800080'>"[gaussian]"</font>, <font color='#800080'>1</font> ); <br>
      <font color='#800000'><b>for</b></font> ( x = -<font color='#800080'>3</font>;
      x &lt; <font color='#800080'>3</font>; x += <font color='#800080'>0.125</font> ) <br>
      { <br>
&nbsp;&nbsp;&nbsp;&nbsp; y = <font color='#0000ff'>exp</font>( - x ^ <font color='#800080'>2</font> ); <br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000ff'>XYChartAddPoint</font>( chartname, <font color='#800080'>""</font>,
x, y, <font color='#0000ff'>IIf</font>( <font color='#0000ff'>abs</font>( x ) &lt;= <font color='#800080'>1</font>, <b>colorGreen</b>, <b>colorRed</b> )
); <br>
      }</CODE><br>
    </p>
    Bar style is useful for displaying probability distribution charts<br>
    <br>
    <p></p>
  </li>
  <br>
  <li>AFL: SetChartBkColor did not change the background behind X-axis text.
    Fixed.</li>
  <li>AFL: WriteVal/NumToStr has now new roundAndPad parameter that controls
    whenever function rounds output beyond 7th significant digit (and pads the
    rest with zeros), By default rounding is OFF now because it was off in 5.90
    and earlier and rounding introduced in 5.91 could confuse old time users</li>
  <li>AFL: WriteVal/NumToStr will display Warning 506 if specified format exceeds
    maximum IEEE precision (7 significant digits) and roundAndPad option is turned
    off</li>
  <li>Analysis: 3D optimization chart was not available after Individual (MT)
    Optimization. Fixed.</li>
  <li>Analysis: a faster Export to CSV routine in 5.91.0 caused memory leak.
    Fixed.</li>
  <li>Analysis: Export to CSV could run out of memory when exporting more than
    2GB. Fixed.</li>
  <li>Log window shows correct path when using &quot;Check AFL syntax&quot; in
    the editor, especially helpful if error is inside #included file</li>
  <li>Log window: double clicking on error line brings up AFL editor and scrolls
    to error line / column automatically</li>
  <li>PersistentVars.bin loading moved to AFTER CWD fix (prevents problem with
    deleting persistent variables when program is started with incorrect working
    directory)<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.91.0 (as compared to 5.90.1)</strong></p>
<ul>
  <li>AFL/Charts: GfxSetCoordsMode( 1 ) now works with logarithmic scale too.</li>
  <li>AFL: added &quot;Warning 505. Division by zero&quot; (level 2 warning).
    It detects divison by zero in arrays too and prints which array element was
    zero</li>
  <li>AFL: failed COM type conversion is reported as a regular error within editor/log
    window instead of displaying message box</li>
  <li>AFL: new field in SetOption(&quot;WarningLevel&quot;, x ); -- allows to
    change warning level. Level 1 is default for all AFL executions with exception
    of AFL editor and commentary where warning level is set to 4<br>
    Warning Level<br>
    1 - report only level 1 warnings (502- too much plots)<br>
    2 - report level 1 and 2 warnings (above plus assignment within conditional,
    division by zero, threadsleep period too long)<br>
    3 - report level 1, 2 and 3 warnings (above plus createobject/createstaticobject
    )<br>
    4- report all warnings (default for the AFL editor)<br>
  </li>
  <li>AFL: new function AddRow(&quot;text&quot;) to add a raw text row to the
    exploration (allows outputing things without respecting Filter and without
    being limited to number of bars). This function is preliminary and its parameters
    are subject to change.<br>
        <br>
        <CODE><font color='#0000ff'>SetOption</font>(<font color='#800080'>"NoDefaultColumns"</font>, <b>True</b> ); <br>
        <b>Filter</b> = <font color='#800080'>1</font>; <br>
        <font color='#0000ff'>AddColumn</font>( <b>Close</b>, <font color='#800080'>"Column1"</font> ); <br>
        <font color='#0000ff'>AddColumn</font>( <b>Null</b>, <font color='#800080'>"Column2"</font> ); <br>
        <br>
        <font color='#800000'><b>for</b></font>( i = <font color='#800080'>0</font>;
        i &lt; <font color='#800080'>10</font>; i++ ) <br>
    { <br>
    <font color='#0000ff'> &nbsp;AddRow</font>( <font color='#0000ff'>StrFormat</font>( <font color='#800080'>"row
    %g\tsecond column"</font>, i ) ); <br>
    }</CODE><br>
  </li>
  <li>AFL: new functions SparseCompress( query_points, data ) /SparseExpand(
    query_points, data )<br>
      <br>
      <CODE>only_when = ( <font color='#0000ff'>Month</font>() % <font color='#800080'>2</font> )
      == <font color='#800080'>0</font>; <font color='#008000'>// even months
      only <br>
      </font> <br>
    x = <font color="#0000FF">SparseCompress</font>( only_when, <b>Close</b> ); <font color='#008000'>//
    compact sparse data <br>
    </font> <br>
    y = <font color='#0000ff'>MA</font>( x, <font color='#800080'>10</font> ); <font color='#008000'>//
    regular calculation <br>
    </font> <br>
    y = <font color='#0000ff'>SparseExpand</font>( only_when, y ); <font color='#008000'>//
    expand sparse data <br>
    </font> <br>
    <font color='#0000ff'>Plot</font>( <b>C</b>, <font color='#800080'>"Price"</font>, <b>colorDefault</b>, <b>styleBar</b> ); <br>
    <font color='#0000ff'>Plot</font>( y, <font color='#800080'>"Sparse MA from
    even months"</font>, <b>colorRed</b> ); <br>
      <br>
      <br>
      <font color='#800000'><b>function</b></font> SparseCompressEquiv( sparse_array,
      data_array ) <br>
    { <br>
&nbsp;&nbsp; result = <b>Null</b>; <br>
&nbsp;&nbsp; <br>
&nbsp;&nbsp; j = <b>BarCount</b> - <font color='#800080'>1</font>; <br>
&nbsp;&nbsp; <font color='#800000'><b>for</b></font>( i = <b>BarCount</b> - <font color='#800080'>1</font>;
i &gt;= <font color='#800080'>0</font>; i-- ) <br>
&nbsp;&nbsp; { <br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color='#800000'><b>if</b></font>( sparse_array[
i ] ) result[ j-- ] = data_array[ i ]; <br>
&nbsp;&nbsp; } <br>
&nbsp;&nbsp; <br>
&nbsp;&nbsp; <font color='#800000'><b>return</b></font> result; <br>
    } <br>
    <br>
    <font color='#800000'><b>function</b></font> SparseExpandEquiv( sparse_array,
    data_array ) <br>
    { <br>
&nbsp;&nbsp; result = <b>Null</b>; <br>
&nbsp;&nbsp; <br>
&nbsp;&nbsp; j = <b>BarCount</b> - <font color='#800080'>1</font>; <br>
&nbsp;&nbsp; <font color='#800000'><b>for</b></font>( i = <b>BarCount</b> - <font color='#800080'>1</font>;
i &gt;= <font color='#800080'>0</font>; i-- ) <br>
&nbsp;&nbsp; { <br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color='#800000'><b>if</b></font>( sparse_array[
i ] ) result[ i ] = data_array[ j-- ]; <br>
&nbsp;&nbsp; } <br>
&nbsp;&nbsp; <br>
&nbsp;&nbsp; <font color='#800000'><b>return</b></font> result; <br>
    } </CODE></li>
  <li>AFL: NumToStr protected against user error of specifying precision higher
    than provided by IEEE standard (display never exceeds 7 significant digits,
    rest is padded with zeros)</li>
  <li>AFL: the engine displays more verbose error in case when GetArraySymbolCopy
    fails</li>
  <li>Analysis: CSV Export speeded up 100+ times. Now exporting large files takes
    seconds instead of hours. Export speeds on ordinary hard disks &gt; 80MB/sec</li>
  <li>Charts: Interval Lock added (so now you can lock symbol or interval or
    both)</li>
  <li>Commentary window - warning level raised to 4 (report all warnings in commentary
    window)</li>
  <li>Sort() could crash with IndexMode = True and start parameter was greater
    than zero. Fixed.</li>
  <li>When chart pane is being resized/dragged, real-time chart refreshes are
    temporarily held to prevent disappearing of tracking rectangle</li>
</ul>
<p><strong>CHANGES FOR VERSION 5.90.0 (as compared to 5.89.0)</strong></p>
<ul>
  <li>AFL Editor: keytrigger expansion wasn't properly undone (via Edit-&gt;undo).
      Fixed.</li>
    <li>AFL Editor: when last document was closed usign tab &quot;X&quot; mark the
      message prompt that asked to save changes could pop up on wrong monitor in
      multiple monitor setups and not disable AFL editor frame making it possible
      to press &quot;X&quot; again and cause re-entrancy problem/crash. Fixed.</li>
    <li>Charts: rarely when chart sheets were switched an attempt to free already freed
      memory could occur. Fixed.</li>
    <li>DB: fixed crash when switching databases while outstanding call for Foreign
      from other thread was attempting to bring up other symbol data.</li>
    <li>IB plugin allowed to trigger backfill even if it was not connected causing
      potential freeze/crash. Fixed. </li>
    <li>New Analysis: added error message when user has incorrect setting for PointValue.
      PointValue MUST be greater than zero.</li>
    <li>OLE: attempt to set negative or zero PointValue results in exception</li>
    <li>Parameter window: when screen size is not enough to fit color popup beneath
      color item, the popup is now displayed above the item</li>
</ul>
<p><strong>CHANGES FOR VERSION 5.89.0 (as compared to 5.88.0)</strong></p>
<ul>
  <li>AFL: Performance of variable-length Sum() improved significantly in some
    common scenarios. Accurracy improved too.</li>
  <li>AFL: Sort displayed an error message if first == last even though this
    case is perfectly fine. Fixed (no error and no sorting of single-element
    array)</li>
  <li>AFL: Sort() with indexmode = True could cause immediate app exit in 64-bit
    version only. Fixed.</li>
  <li>AFL: when negative 'range' was passed to variable-length version of Sum()
    an application exited immediately. Fixed.</li>
  <li>Charts: Left/right extended Trend lines and Rays now use user-definable
    Extension Factor (new field in Study properties) instead of always infinite
    extent. Ext. Factor equal to ZERO means INFINITE, other values 0.1 ... 26
    define how far to the left/right line is extended</li>
  <li>Charts: max zoom achievable via View-&gt;Zoom Out is increased to 5 million
    bars, also Pref/Charting/Default zoom limit set to 5 million. Note that it
    is still possible to zoom to &quot;all&quot; quotes regardless of number
    of bars using View-&gt;Zoom-&gt;All</li>
  <li>Debug: Crash recovery window now requires to enter steps required to reproduce
    problem. Without knowing what you did before it is very difficult to find
    out the reason and fix the problem.</li>
  <li>Debug: Turned off remove frame pointers optimization in 32-bit builds for
    better stack traces</li>
  <li>New Analysis: Exploration: default column width is increased automatically
    to fit %6.2f number when there is a free space available in the right margin</li>
  <li>New Analysis: Optimization: when user-selected &quot;Optimization target&quot; can
    not be found in the backtest results an error 711 is displayed and optimization
    process is stopped</li>
  <li>New Analysis: trying to bring up &quot;Parameters&quot; window when currently
    selected symbol had no quotes resulted in access violation. Fixed.</li>
  <li>New Analysis: Walk forward tab - when you click on result list Begin/End
    column headers - these columns are now sorted by date instead of alphabetically.<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.88.0 (as compared to 5.87.0)</strong></p>
<ul>
  <li>AFL: new function <strong>NullCount</strong>( array, mode = 1 ) - counts
    the number of consecutive nulls at the beginning of the array (mode = 1),
    at the end of the array (mode=2), from both ends (mode=3) and all nulls in
    the array (including non-consecutive) (mode=0)<br>
      <br>
      <CODE>x = <font color='#0000ff'>MA</font>( <b>C</b>, <font color='#800080'>20</font> ); <br>
      <font color='#0000ff'>printf</font>(<font color='#800080'>"Empty values
      at the beginning = "</font> + <font color='#0000ff'>NullCount</font>( x
      ) );</CODE><br>
  </li>
  <li>AFL: <strong>Sort</strong>() now has additional &quot;indexmode&quot;.
    If indexmode is turned on, Sort() function returns array of indexes to the
    sorted values instead of values themselves. So if first returned value is
    2923 it means that input array[ 2923 ] is the smallest element<br>
      <br>
      <CODE><b>Filter</b> = <font color='#800080'>1</font>; <font color='#0000ff'>AddColumn</font>( <font color='#0000ff'>BarIndex</font>(), <font color='#800080'>"Bar
      Index"</font>, <font color='#800080'>1.0</font> ); <br>
      <font color='#0000ff'>AddColumn</font>( <b>Close</b>, <font color='#800080'>"Close"</font> ); <br>
      <font color='#0000ff'>AddColumn</font>( <font color='#0000ff'>Sort</font>( <b>Close</b> ), <font color='#800080'>"Sorted
      Close"</font> ); <br>
      <font color='#0000ff'>AddColumn</font>( <font color='#0000ff'>Sort</font>( <b>Close</b>, <font color='#800080'>0</font>,
      -<font color='#800080'>1</font>, <b>True</b> ), <font color='#800080'>"Index
      of sorted item"</font>, <font color='#800080'>1.0</font> );</CODE><br>
  </li>
  <li>Charts: line drawings now have user definable line width in pixels (new &quot;Line
    width&quot; field in Study Properties dialog). In addition to that &quot;Thick
    line&quot; box makes line twice as wide (so actual width of thick line is
    2 * lineWidth instead of adding 1 pixel to width)</li>
  <li>Charts: when formula causes an exception and Preferences are set NOT to
    catch exceptions within indicator, then further execution of formula that
    caused exception is blocked until Bug recovery window is dismissed (to prevent
    stacking multiple bug recovery windows)</li>
  <li>Debug: 64-bit version now implements invalid parameter handler for catching
    wrong C runtime calls</li>
  <li>Debug: 64-bit version: Crash recovery window now includes call stack to
    allow better debugging of 64-bit app (previously only available in 32-bit)</li>
  <li>Debug: when AFL engine can not allocate memory for variable a proper message
    is displayed instead of plain crash</li>
  <li>Debug: when program can not allocate memory for static variable you will
    get actual message &quot;Out of memory during creation of static variable&quot;);</li>
  <li>New Analysis: program checks From-To dates and if From &gt; To it displays
    error 710 instead of starting analysis</li>
  <li>New Analysis: QuickAFL finally implemented. To turn it on go to Settings
    and check &quot;Use QuickAFL&quot; box. Gives very significant speed-ups
    (&gt;2x) when range is smaller than &quot;All quotes&quot;</li>
  <li>Prefs/Backtest: Number of user-definable currencies in Tools-&gt;Preferences
    increased from 20 to 100.</li>
  <li>Prefs/Charting: &quot;Default zoom (number of bars in a chart)&quot; can
    now be greater than 32767 (previous limit). Now it can be in range from 10
    to 10 000 000.</li>
  <li>UI: when free virtual memory drops below 200 MB a popup is displayed in
    the status area<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.87.0 (as compared to 5.86.0)</strong></p>
<ul>
  <li>AFL Editor: in-line error reporting use bold font to highlight identifiers
    in the error messages for better readability</li>
  <li>AFL: <strong>GetOption</strong> can now read BuyDelay/SellDelay/ShortDelay/CoverDelay
    which makes it easier to write like this:<br>
    InLong = Ref( Buy, GetOption(&quot;BuyDelay&quot;) ); // make sure we delay
    the signal in sync with settings<br>
    ApplyStop( stopTypeLoss, stopModePercent, IIF( InLong, 10, 15 ), True );
    // 10% stop for long 15% stop for short<br>
  </li>
  <li>AFL: new function: <strong>Reverse</strong>( array, first = 0, last = -1
    ) - returns a new array with the order of the elements in specified range
    reversed</li>
  <li>AFL: new function: <strong>Sort</strong>( array, first = 0, last = -1 )
    - sort a numerical array in ascending order starting from 'first' element
    ending at 'last' element. If 'last' is not specified or negative then AmiBroker
    will use BarCount - 1<br>
      <br>
      <CODE><b>Filter</b> = <font color='#800080'>1</font>; <br>
      <font color='#0000ff'>AddColumn</font>( <font color='#0000ff'>BarIndex</font>(), <font color='#800080'>"BI"</font>); <br>
      <font color='#0000ff'>AddColumn</font>( <b>Close</b>, <font color='#800080'>"Close"</font>); <br>
      <font color='#0000ff'>AddColumn</font>( <font color='#0000ff'>Sort</font>( <b>Close</b> ), <font color='#800080'>"Sorted"</font>); <br>
      <font color='#0000ff'>AddColumn</font>( <font color='#0000ff'>Reverse</font>( <font color='#0000ff'>BarIndex</font>()
      ), <font color='#800080'>"Reversed BI"</font> );</CODE><br>
  </li>
  <li>AFL: new function: <strong>StrSort</strong>( &quot;item,list,to,be,sorted&quot;,
    caseSensitive = True, separator = ',' ) - perform sorting of comma-separated
    string (case sensitive/insensitive, separator definable!)</li>
  <li>AFL: new function: <strong>StrTrim</strong>( &quot;string&quot;, &quot;targets&quot;,
    side = 3 ) - a function to trim extra characters (specified in &quot;targets&quot;)
    from either left (1), right(2) or both(3) sides of the string. If &quot;targets&quot; parameter
    is an empty string, then function trims whitespaces (i.e. space, tab, newline)<br>
      <br>
    Here is example of StrSort/StrTrim in per-symbol profit / loss custom metrics
    code. Compared to Knowledge Base article it outputs SORTED list of symbols.<br>
      <br>
      <CODE><font color='#800000'><b>function</b></font> ProcessTrade( trade
      ) <br>
    { <br>
&nbsp;&nbsp; <font color='#800000'><b>global</b></font> tradedSymbols; <br>
&nbsp;&nbsp; symbol = trade.Symbol; <br>
&nbsp;&nbsp; <font color='#008000'>// <br>
    </font>&nbsp;&nbsp; <font color='#800000'><b>if</b></font>( ! <font color='#0000ff'>StrFind</font>(
    tradedSymbols, <font color='#800080'>","</font> + symbol + <font color='#800080'>","</font> )
    ) <br>
&nbsp;&nbsp; { <br>
&nbsp;&nbsp;&nbsp;&nbsp; tradedSymbols += symbol + <font color='#800080'>","</font>; <br>
&nbsp;&nbsp; } <br>
&nbsp;&nbsp; <font color='#008000'>// <br>
    </font>&nbsp;&nbsp; <font color='#008000'>// HINT: you may replace it with
    GetPercentProfit if you wish <br>
    </font>&nbsp;&nbsp; profit = trade.GetProfit(); <br>
&nbsp;&nbsp; <font color='#008000'>// <br>
    </font>&nbsp;&nbsp; <font color='#800000'><b>if</b></font>( trade.IsLong()
    ) <br>
&nbsp;&nbsp; { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; varname = <font color='#800080'>"long_"</font> +
symbol; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000ff'>VarSet</font>( varname, <font color='#0000ff'>Nz</font>( <font color='#0000ff'>VarGet</font>(
varname ) ) + profit ); <br>
&nbsp;&nbsp; } <br>
&nbsp;&nbsp; <font color='#800000'><b>else</b></font> <br>
&nbsp;&nbsp; { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; varname = <font color='#800080'>"short_"</font> +
symbol; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color='#0000ff'>VarSet</font>( varname, <font color='#0000ff'>Nz</font>( <font color='#0000ff'>VarGet</font>(
varname ) ) + profit ); <br>
&nbsp;&nbsp; } <br>
    } <br>
    <font color='#008000'>//&nbsp;&nbsp; <br>
    </font><font color='#0000ff'>SetCustomBacktestProc</font>( <font color='#800080'>""</font> ); <br>
    <font color='#008000'>// <br>
    </font> <font color='#008000'>/* Now custom-backtest procedure follows */</font> <br>
    <font color='#008000'>// <br>
    </font><font color='#800000'><b>if</b></font> ( <font color='#0000ff'>Status</font>( <font color='#800080'>"action"</font> )
    == <b>actionPortfolio</b> ) <br>
    { <br>
&nbsp;&nbsp;&nbsp;&nbsp; bo = <font color='#0000ff'>GetBacktesterObject</font>(); <br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color='#008000'>// <br>
    </font>&nbsp;&nbsp;&nbsp;&nbsp; bo.Backtest(); <font color='#008000'>// run
    default backtest procedure <br>
    </font>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#008000'>// <br>
    </font>&nbsp;&nbsp;&nbsp;&nbsp; tradedSymbols = <font color='#800080'>","</font>; <br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color='#008000'>// <br>
    </font>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#008000'>//iterate through closed
    trades <br>
    </font>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#800000'><b>for</b></font> (
    trade = bo.GetFirstTrade( ); trade; trade = bo.GetNextTrade( ) ) <br>
&nbsp;&nbsp;&nbsp;&nbsp; { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ProcessTrade( trade ); <br>
&nbsp;&nbsp;&nbsp;&nbsp; } <br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color='#008000'>// <br>
    </font>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#008000'>//iterate through open
    positions <br>
    </font>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#800000'><b>for</b></font> (
    trade = bo.GetFirstOpenPos( ); trade; trade = bo.GetNextOpenPos( ) ) <br>
&nbsp;&nbsp;&nbsp;&nbsp; { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ProcessTrade( trade ); <br>
&nbsp;&nbsp;&nbsp;&nbsp; } <br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color='#008000'>// <br>
    </font>&nbsp;&nbsp;&nbsp;&nbsp; tradedSymbols = <font color='#0000ff'>StrTrim</font>(
    tradedSymbols, <font color='#800080'>","</font> ); <br>
&nbsp;&nbsp;&nbsp;&nbsp; tradedSymbols = <font color='#0000ff'>StrSort</font>(
tradedSymbols ); <br>
&nbsp;&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp; <font color='#008000'>//iterate through the list of
traded symbols and generate custom metrics <br>
    </font>&nbsp;&nbsp;&nbsp;&nbsp; <font color='#800000'><b>for</b></font> (
    i = <font color='#800080'>0</font>; ( sym = <font color='#0000ff'>StrExtract</font>(
    tradedSymbols, i ) ) != <font color='#800080'>""</font>; i++ ) <br>
&nbsp;&nbsp;&nbsp;&nbsp; { <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; longprofit = <font color='#0000ff'>VarGet</font>( <font color='#800080'>"long_"</font> +
sym ); <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; shortprofit = <font color='#0000ff'>VarGet</font>( <font color='#800080'>"short_"</font> +
sym ); <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; allprofit = <font color='#0000ff'>Nz</font>(
longprofit ) + <font color='#0000ff'>Nz</font>( shortprofit ); <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color='#008000'>// metric
uses 2 decimal points and <br>
    </font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color='#008000'>//
    3 (calculate sum) as a "combine method" for walk forward out-of-sample <br>
    </font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bo.AddCustomMetric( <font color='#800080'>"Profit
    for "</font> + sym, allprofit, longprofit, shortprofit, <font color='#800080'>2</font>, <font color='#800080'>3</font> ); <br>
&nbsp;&nbsp;&nbsp;&nbsp; } <br>
    } <br>
    <font color='#008000'>// <br>
    </font><font color='#0000ff'>SetOption</font>( <font color='#800080'>"MaxOpenPositions"</font>, <font color='#800080'>10</font> ); <br>
    <font color='#008000'>// <br>
    </font><b>Buy</b> = <font color='#0000ff'>Cross</font>( <font color='#0000ff'>MACD</font>(), <font color='#0000ff'>Signal</font>()
    ); <br>
    <b>Sell</b> = <font color='#0000ff'>Cross</font>( <font color='#0000ff'>Signal</font>(), <font color='#0000ff'>MACD</font>()
    ); <br>
    <b>Short</b> = <b>Sell</b>; <br>
    <b>Cover</b> = <b>Buy</b>; <br>
    <font color='#0000ff'>SetPositionSize</font>( <font color='#800080'>10</font>, <b>spsPercentOfEquity</b> )
    ; </CODE> <br>
  </li>
  <li>AFL: <strong>StrExtract</strong> has now extra parameter allowing to specify
    separator character, example StrExtract(&quot;This;Is;Semicolon;Separated&quot;,
    3, ';' );</li>
  <li>AFL: <strong>StrMid</strong>( &quot;string&quot;, start, count ) now allows
    to skip &quot;count&quot; parameter. If you skip count, then a substring
    starting from 'start' to the end of the string will be returned.</li>
  <li>Charts: added ability to control number of decimals in chart value labes
    via GraphLabelDecimals variable (example, adding <strong>GraphLabelDecimals</strong> =
    2; to the formula would give you value lables with 2 decimal places</li>
  <li>Removed old-style Graph3*, Graph4*, Graph5*, Graph6*, Column3, 4, 5, 6
    identifiers from auto-complete lists (only 0..2 left)</li>
  <li>Report Explorer: Edit-&gt;Copy now copies selection only (not entire table)<br>
        <br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.86.0 (as compared to 5.85.0)</strong></p>
<ul>
  <li>AFL Editor: repeat replace + wrap around restarts only once and if no further
    matches/replaces are found it displays &quot;no more matching texts&quot; instead
    of restarting again.</li>
  <li>AFL Editor: when user closed Find&amp;Replace dialog and then pressed F3
    (find next) a couple of times to pass thru the end of document a crash could
    occur. Fixed.</li>
  <li>Analysis: HTML report generator - settings page used &lt;/TD&gt; tags to
    close some &lt;TH&gt; tags which is formally incorrect, even if it works.
    Fixed.</li>
  <li>Charts: Extreme descenders in text could be truncated (by one pixel) in
    multiple line Title strings. Fixed.</li>
  <li>HTMLView - Backtest report viewer - added Edit/Copy, Edit/Select All and
    Edit/Copy TABLE. The last command transforms HTML tables into CSV format
    and copies it into clipboard so tables can be pasted easily to Excel. Also
    it divides Entry/Exit columns into separate Entry/exit date/price columns</li>
  <li>Parameter window: mouse wheel scroll is now supported</li>
  <li>Realtime Quote window: added Bid/Ask trend - a graphical indicator showing
    the direction of 10 most recent changes in real-time bid/ask prices<br>
    The right-most box is most recent and as new bid/ask quotes arrive they are
    shifted to the left side. Color coding is as follows:<br>
    Dark green: bid &gt; previous bid OR ask &gt; previous ask<br>
    Bright green: bid &gt; previous bid AND ask &gt; previous ask<br>
    Dark red: bid &lt; previous bid OR ask &lt; previous ask<br>
    Bright red: bid &lt; previous bid AND ask &lt; previous ask<br>
    Red / Green box: ask &lt; previous ask AND bid &gt; previous bid<br>
    Green / Red box: ask &gt; previous ask AND bid &lt; previous bid<br>
    <br>
    If bid/ask prices don't change there is no new box.<br>
    NOTE: This column works only if there are real-time quotes streaming (markets
    are open)<br>
  </li>
  <li>Realtime Quote window: Sorting by Full name column did no work. Fixed</li>
  <li>Report Explorer: Column layout (order and sizes) is now saved and restored
    between runs</li>
  <li>Report Explorer: Loading and refresh performance significantly improved
    (5x) using owner draw/ virtual mode</li>
  <li>Report Explorer: Multi-column sorting implemented</li>
  <li>Report Explorer: Numeric columns are now right aligned for better readability</li>
  <li>Report Explorer: visuals significantly improved (list uses modern style,
    grid lines, immediate column resizing, double buffering for no flicker, thousand
    separators, negative values are displayed in dark red, HighDPI aware, changed
    toolbar)</li>
  <li>Snippet properties window now includes formula field for quick reference
    (no highlighting here - it is by design)<br>
  </li>
</ul>
<p>&nbsp;</p>
<p><strong>CHANGES FOR VERSION 5.85.0 (as compared to 5.84.0)</strong></p>
<ul>
  <li>AFL Editor: backtest* mode constants added to auto-complete list</li>
  <li>AFL Editor: now Code snippets are available in auto complete list (type
    @ plus first letter of snippet key trigger), and even without auto complete
    activated @keytrigger is replaced by snippet text</li>
  <li>AFL: added support for single-character literals, so you don't need to
    use Asc() funciton.<br>
      <br>
    Buy = Cross( MACD(), Signal() );<br>
    Sell = Cross( Signal(), MACD() );
    <p>Filter = Buy OR Sell;</p>
    <p>AddColumn( IIf( Buy, 'B', 'S' ), &quot;Signal&quot;, formatChar );</p>
  </li>
  <li>AFL: adding/removing symbols to/from watch list via CategoryAddSymbol/CategoryRemoveSymbol
    wasn't thread safe. Fixed.</li>
  <li>AFL: AmiBroker now checks number passed to SetOption(&quot;MaxOpenPosition&quot;,
    x ) and SetOption(&quot;WorstRankHeld&quot;,x ) and trims down the request
    to number of symbols in database to prevent running out of memory when user
    specifies some absurdly high values,</li>
  <li>AFL: new function SendEmail( &quot;subject&quot;, &quot;message&quot;,
    ShowUI = False )<br>
      <br>
    A direct version of functionality already provided by AlertIF. This function
    sends e-mail unconditionally and it is easier to use if you don't need state
    logic provided by AlertIf.<br>
    Note that &quot;From&quot; and &quot;To&quot; addresses as well as SMTP email
    configuration should be done in Tools-&gt;Preferences, &quot;Alerts&quot; page.<br>
    Without configuring E-mail settings first this function will not work.
    <p>E-mails are sent asynchronously (so function returns BEFORE e-mail is
      actually sent, sending occurs in the background)</p>
    <p>ShowUI parameter decides whenever user interface of e-mailer program is
      shown after sending e-mail or not.</p>
  </li>
  <li>AFL: SetOption(&quot;MarginRequirement&quot;, x ) checks if x is in the
    range 1..100 and displays an error if not.</li>
  <li>Backtest: backtestRegular now keeps detailed info on sequencing of signals
    within single bar to avoid problems with premature exit of just opened trade
    when same bar exits were allowed and previous trade was not open due to insuffcient
    funds leaving an unmatched exit signal.<br>
      <br>
    In case when an exit signal that really belongs to previous trade was found
    on the bar when next trade was open AmiBroker would display the following
    entry in the detailed report log:<br>
&lt; Symbol&gt; Exit/Entry/Scaling ignored because signal predates already processed
event.
    <p>FWIW: The issue did not affect other backtest modes.</p>
  </li>
  <li>Code Snippets: added &quot;Properties&quot; button to the toolbar that
    allows editing name/description/key trigger without re-inserting snippet</li>
  <li>Code Snippets: New snippet/Properties dialog is now resizable</li>
  <li>UI: changed cursor shape in all tree views from &quot;hand&quot; to normal
    arrow</li>
  <li>UI: Code snippet window is now also available when AFL editor is in MDI
    mode (use Window-&gt;Code Snippet menu when AFL editor is open)</li>
  <li>UI: Interpretation window: Ctrl+C (clipboard copy) did not copy the interpretation
    text in 5.8x. Fixed. <br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.84.0 (as compared to 5.83.0)</strong></p>
<ul>
  <li>AFL Editor: Idle-time Info tips were positioned incorrectly in 5.83. Fixed.</li>
  <li>AFL Editor: Text of inserted snippet is selected so one can easily see
    what was inserted and delete it if was a mistake.</li>
  <li>AFL: added Error 57. Invalid quotation mark (when user uses curly quotation
    marks instead of straight quotation marks &quot; to type a string literal)</li>
  <li>OLE: Document object has new property Interval (integer, read/write) -
    selected Interval in seconds (tick/range/volume intervals are represented
    by negative values)</li>
  <li>Report Charts: now it is possible to output HTML instead of graphics in
    report chart formulas using AFL: EnableTextOutput( 3 ) - HTML output to backtest
    report</li>
  <li>Report Charts: rewritten 3. Profit Table.afl using HTML embedding features
    auto-scalable layout (so it enlarges when numbers are bigger), bold summary
    columns, negative values in red, boundary date changed to last day of year/month</li>
  <li>UI: added Code Snippets window - allows inserting/deleting/saving selected
    parts of the formula as snippets. Also implemented is convenient drag-drop
    of snippet to the formula edit window</li>
  <li>UI: Further display improvements of Parameter window for high-DPI displays
    (ParamList bullet point is bigger and positioned better, Slider is resized
    when resizing param window, etc, etc)</li>
  <li>UI: On non-standard DPI displays Parameter window could show some visual
    artifacts when scrolling. Fixed.<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.83.0 (as compared to 5.82.1)</strong></p>
<ul>
  <li>New Analysis: Watch list 0 was used automatically (without opening WL selection
    dialog) when new watch list is created between scan and RMB click-&gt;Add
    results. Fixed.</li>
  <li>UI: Parameter window look and feel improved. Item height is increased and
    slider thumb made wider for easier use on small size/high DPI screens</li>
  <li>Commentary: attempt to display commentary on symbol without any quotes
    could cause access violation. Fixed.</li>
  <li>AFL Editor: Verify formula run on symbol without any quotes could cause
    access violation. Fixed (proper error message is displayed).</li>
  <li>Analysis: Table header in the HTML report trade list is now right aligned
    (to match number alignment) (affects newly generated reports only)</li>
  <li>AFL editor: when syntax check is performed and errors are detected, the
    editor is immediately scrolled to first error</li>
  <li>Analysis: Minimum value for &quot;Margin Requirement&quot; is now 1 (1%)</li>
  <li>AFL: Since v5.65 RestorePriceArrays() did nothing when there was no preceding
    SetForeign/TimeFrameSet. Now restores data if user explicitely overwrote
    OHLC arrays in the code preceding it.</li>
  <li>Analysis: Detailed Log message &quot;Symbol not entered bcause of insufficient
    funds&quot; improved to display requested position size in units such as
    shares/% of equity instead of just encoded negative value</li>
  <li>AFL engine: brand new custom micro allocator speeds up AFL execution of
    complex formulas with nested loops upto 3 times.</li>
  <li>Turned on LowFragmentationHeap in number of places</li>
  <li>Code snippets: New line \n was truncated from &quot;data export&quot; snippet.
    Fixed.</li>
  <li>AFL Editor: parameter info tip does not disappear on pressing Backspace
    key anymore.</li>
  <li>AFL Editor: Parameter info updates highlighted parameter when moving cursor
    inside function's param list</li>
  <li>New Analysis: Less refreshes of Info page provide some extra speed</li>
  <li>Analysis: fixed HoldMinBars check for scenario 3 with both buy and sell
    generated on all bars and random scores.<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.82.1 (as compared to 5.82.0)</strong></p>
<ul>
  <li>AFL Engine: fixes for stability issues in 5.81.0/5.82.0</li>
  <li>Filter dialog: a matching count wasn't updated on opening the dialog. Fixed.</li>
  <li>Bug report window made a little bigger so at least crash address is seen
    when someone sends screenshot instead of text<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.82.0 (as compared to 5.81.0)</strong></p>
<ul>
  <li>UI: Interpretation and Commentary windows now support color text (via EncodeColor),
    bold and italic styles (tags: &lt;b&gt;&lt;/b&gt; for bold, &lt;i&gt; &lt;/i&gt; for
    italic). Example:<br>
      <br>
      <CODE><font color='#0000ff'>printf</font>(<font color='#800080'>"&lt;b&gt;Bold
      text&lt;/b&gt;\n"</font>); <br>
      <font color='#0000ff'>printf</font>(<font color='#800080'>"&lt;i&gt;Italic
      text&lt;/i&gt;\n"</font>); <br>
      <font color='#0000ff'>printf</font>(<font color='#800080'>"Now "</font> + <font color='#0000ff'>EncodeColor</font>( <b>colorRed</b> )
      + <font color='#800080'>"red text\n"</font>); <br>
      <font color='#0000ff'>printf</font>(<font color='#800080'>"and finally "</font> + <font color='#0000ff'>EncodeColor</font>( <b>colorGreen</b> )
      + <font color='#800080'>"green &lt;b&gt;AND bold &lt;i&gt;AND italic&lt;/i&gt;&lt;/b&gt;\n"</font>); <br>
      <font color='#0000ff'>printf</font>(<font color='#0000ff'>EncodeColor</font>( <b>colorBlack</b> )
      + <font color='#800080'>"going back to black"</font>);</CODE><br>
  </li>
  <li>UI: Notepad, Interpretation and Commentary windows use default GUI font
    instead of hard-coded Tahoma now</li>
  <li>AFL: functionality of PlotGrid() function extended<br>
      <br>
    PlotGrid( level, color = colorDefault, pattern = 1, width = 1, label = True
    )
    <p>pattern - defines line pattern. Available grid patterns 1..10 as shown
      in the Tools-&gt;Preferences, &quot;Axes &amp; Grids&quot;<br>
      1-7 are single pixel patterns, 8 is regular windows dot pattern (PS_DOT)
      , 9 is regular Windows dash pattern (PS_DASH), 10 is solid line</p>
    <p>width - grid line width (in pixels). Note that due to Windows GDI limitations
      only patterns 8 (PS_DOT), 9 (PS_DASH), 10 (PS_SOLID) are available in widths &gt; 1</p>
    <p>label - whenever to display value label or not</p>
    <p><br>
      Use PlotGrid to display horizontal lines that are constant instead of using
        Plot. <br>
      PlotGrid offers much better performance in this case.</p>
    <p>So instead of</p>
    <p><CODE><font color='#0000ff'>Plot</font>( <font color='#800080'>50</font>, <font color='#800080'>""</font>, <b>colorRed</b>, <b>styleLine</b> | <b>styleThick</b> );</CODE></p>
    <p>use:</p>
    <p><CODE><font color='#0000ff'>PlotGrid</font>( <font color='#800080'>50</font>, <b>colorRed</b>, <font color='#800080'>10</font>, <font color='#800080'>2</font>, <b>False</b> ); <font color='#008000'>//
          solid line 2 pixels thick, no label</font></CODE></p>
  </li>
  <li>AFL Editor: added 4 new snippets under &quot;Function&quot; category</li>
  <li>UI: Filter dialog now displays number of matching symbols in real-time
    as selections are made</li>
  <li>AFL: CCI function speeded up by 50%</li>
  <li>Inserting indicator with Param() calls into chart when currently selected
    symbol had no quotes caused exception. Fixed.</li>
  <li>AFL: In 5.81.0 CategoryGetName returned nothing (void) instead of string
    type when specified category did not exist. Fixed (empty string is returned
    now)</li>
  <li>New Analysis: portfolio backtest processing was attempted even if there
    was no symbols that matched &quot;apply to&quot; filter. Fixed (unnecesary
    processing is skipped now).</li>
  <li>AFL engine: in v5.81 access violation could occur when AFL array size was
    0. Fixed.<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.81.0 (as compared to 5.80.3)</strong></p>
<ul>
  <li>AFL Engine: custom memory allocator does not use Microsoft runtime lib
    for reference tracking anymore. Result - complex formulas with lots of loops
    and OLE (especially low-level custom backtests) run upto 3 times faster in
    32 bit and 4 times faster in 64-bit</li>
  <li>AFL Editor: Parameter info tip significantly enhanced - now it re-opens
    on typing each , (comma) and highlights current parameter to be entered.</li>
  <li>UI: Column setup dialog: added Mark All / Toggle All buttons</li>
  <li>AFL: GetFormulaPath() function added - returns full formula file path</li>
  <li>AFL Editor: Smart reference highlighting implemented (usage: mark a word
    and all references become highlighted).</li>
  <li>AFL Editor: Find/Replace shows a message box when reached the end of the
    file and offers restarting from the beginning if new &quot;Wrap around&quot; option
    is turned on.</li>
  <li>AFL Engine: code refactoring for reduced size and improved speed</li>
  <li>AFL: when value of unsupported type was appended to string a crash could
    occur. Fixed. </li>
  <li>AFL Engine: when IIf was called the memory upsized from scalar to array
    could get freed twice (wrong). Fixed</li>
  <li>AFL: MACD() and Signal() functions made faster (approx 1.5-2x times)</li>
  <li>Analysis: Interest is added at the beginning of next bar (instead of end
    of current bar), to account for overnight rate. This also fixes the problem
    of ignoring interest in v.&gt; 5.69</li>
  <li>UI: fixed yet another place where entering customization changed working
    dir</li>
</ul>
<div>
  <p><b></b></p>
</div>
<p><strong>CHANGES FOR VERSION 5.80.3 (as compared to 5.80.2)</strong></p>
<ul>
  <li>GfxTextOut / GfxDrawText did not work well in new co-ords mode = 1. Fixed.<br>
  </li>
  <li>  When Customize was entered from editor frame and user browsed for bitmap image
    for the toolbar it could change current working directory. Fixed.<br>
  </li>
  <li>Editing and saving some old charts formulas that were using absolute paths
    (instead of relative) did not cause immediate chart update. Fixed.<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.80.2 (as compared to 5.80.0)</strong></p>
<ul>
  <li>UI: Status bar prompt for recent databases and recent files was incorrect.
  Fixed.</li>
  <li>When a formula that uses Category* functions is run inside commentary
  window, the symbol list is auto-refreshed now.</li>
  <li>When commentary window was
  open on completely empty database a crash could occur. Fixed.</li>
  <li>New Analysis:
  Progress bar is not hidden until custom portfolio backtest phase is completed</li>
  <li>AFL:
    when artithmetic operator was applied to variable that was uninitialized
  or having invalid type a crash could occur. Fixed.</li>
  <li>DB: If external data source
    set incorrect group or market or industry ID (lower than 0 or higher than
    255) a crash could occur when updating symbol
    list. Fixed,
  incorrect data are switched back to zero and warning message is displayed.</li>
  <li>New
    Editor: when user changes the formula name and presses &quot;Save&quot; the
  editor now displays a confirmation dialog if file already exists</li>
  <li>Charting:
  X-axis grid calculation speeded up 3x (for large number of bars)</li>
  <li>When chart
    pane had NULL formula path attempt to edit formula or drag-drop it could
  cause crash. Fixed.</li>
  <li>New Editor: crash could occur when formula was Saved as...&quot; for
    the first time outside &quot;Formulas&quot; folder and its subfolders. Fixed.  </li>
  <li>AFL: Error 56 &quot;Variable has an invalid type&quot; added when variable
    has uninitialized type or type set to some strange value (plugins may cause
  this due to programmer error)</li>
  <li>AFL: in multithreaded charts unhandled exceptions
    where not caught inside indicator even though preferences setting was to
  catch them. Fixed.</li>
  <li>AFL: when formula is executed in &quot;Indicator&quot; mode
    the execution stops at very first error and this error is displayed as most
    relevant in
    the chart
    pane instead of last error which is usually not relevant (often side effect
    of previous errors)<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.80.0 (as compared to 5.79.0)</strong></p>
<ul>
  <li>New Analysis: An error 709 is displayed when user specified so many Optimize()
    calls that search space is larger than 10^19 combinations (100 times more
    than the age of The Universe in seconds)</li>
  <li>New Analysis: progress bar update is forced so even if program is 100%
    busy the progress bar gets repainted</li>
  <li>New Analysis: &quot;the analysis is in progress&quot; text was not always
    cleared after analysis has completed. Fixed.</li>
  <li>New Editor: Param info is displayed even when there are spaces between
    identifier and opening brace</li>
  <li>New Editor: A full path to formula is displayed in the Status bar when
    mouse hovers over formula name edit</li>
  <li>New Editor: pressing ENTER just after identifier name resulted in auto-change
    case function ommitting first letter of the word. Fixed</li>
  <li>New Editor: added Window-&gt;Keep On Top menu (in separate frame mode)</li>
  <li>New Editor: Auto-complete pop up in immediate mode now does not appear
    when editing existing word in the middle, but it is available on demand (Ctrl+SPACE)</li>
  <li>AFL: increased maximum acceptable value for ThreadSleep function to 1000
    ms, and added appropriate level2 warning</li>
  <li>AFL: Error 52 wording changed from 'argument must be positive' to 'argument
    must be greater than zero' </li>
  <li>UI: when any non-modal dialog was displayed, activation of the app always
    brought up main frame in front possibly hiding New Editor. Fixed.</li>
  <li>UI: removed &quot;use new editor&quot; option from Preferences window.
    New editor is always used now.</li>
  <li>UI: Main frame is now disabled (modal) when file dialog is open from AFL
    editor</li>
  <li>Pre-processor errors occuring in run-time caused that chart pane stopped
    refreshing. Fixed.</li>
  <li>Charts: Bar chart close/open ticks are by default one pixel smaller</li>
  <li>Weekly compression for Sunday data was off by one day for dates pre-1970.
    Fixed.</li>
  <li>Weekly compression now offers user-selectable &quot;first day of the week&quot; in
    File-&gt;Database Settings-&gt;Intraday Settings</li>
  <li>Application manifest modified to include compatibility section for Win
    8.x</li>
  <li>Threads use current dir stored at application startup and resolve relative
    paths in AB, not to rely on Windows, so relative paths are resolved even
    if Windows changes dir<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.79.0 (as compared to 5.78.0)</strong></p>
<ul>
  <li>New Editor: Inverting colors on printout did not work for many backgrounds.
    Now white color is always used for background, foreground colors are kept
    unchanged, except for white which is replaced with black</li>
  <li>New Editor: Changing formula name marks it as &quot;modified&quot; so Save
    icon becomes enabled</li>
  <li>New Editor: Edit-&gt;Clear error message menu item added in MDI mode</li>
  <li>New Editor: Save icon is now grayed when formula is not modified</li>
  <li>New Editor: when separate editor frame was minimized, choosing &quot;Edit
    formula&quot; did not restore frame back to normal (non-minimized) state.
    Fixed.</li>
  <li>New Editor: Fold/Unfold did not always work correctly. Fixed. Also Fold
    All folds on 1st level only, so it requires less clicks to unfold one section.</li>
  <li>New Editor: Copy as HTML automatically replaces white font with black.
    Also HTML is shorter (black text does not use &lt;font&gt; tag) and coloring
    is forced, so long texts are correctly copied with colors. </li>
  <li>New Editor: relative paths caused problems with ReplaceFile API and FAT32,
    so relative paths are now converted to absolute prior to saving </li>
  <li>New Analysis now rejects attempts to use non-exhaustive optimization (OptimizeSetEngine)
    when number of exhaustive optimization steps is less than 100 (Error 708)</li>
  <li>DB: when broker.markets, broker.groups, broker.workspace files were missing
    then markets and groups from previously loaded DB leaked to newly created/loaded
    db. Fixed - now they are always initialized with defaults. Also default market
    0/group 0/sector 0/industry 0 is now labelled &quot;Undefined&quot;</li>
  <li>ASCII import: $MARKET and $GROUP commands allow to specify the name of
    market/group (after comma) to be updated during import</li>
  <li>UI: added File-&gt;Save All menu item to separate editor frame</li>
  <li>AFL: reverted change #2623 as it resulted in regression in custom portfolio
    backtest speeds</li>
  <li>Charts: Reverted #2621 change from 5.78.0 cached bitmap is now stretched
    when chart is resized while the formula is being run</li>
  <li>Persistent variables that were loaded from PresistVar.bin but not updated
    by the formula were removed on next start. Now they are kept.<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.78.0 (as compared to 5.77.0)</strong></p>
<ul>
  <li>Prefs: &quot;Use new editor&quot; is now always turned ON at the start
    of application.</li>
  <li>Low Level Gfx: performance improved for formulas making thousands of calls
    to Gfx functions (3x speed up for 200K calls)</li>
  <li>Charts: cached bitmap is now stretched when chart is resized while the
    formula is being run</li>
  <li>On saving broker.newcharts file a backup file is created prior to saving.
    Then on startup in case broker.newcharts is corrupted, a backup file is used
    instead</li>
  <li>New Editor: when auto-complete was in immediate mode typing xx.a resulted
    in xx.AddCustomMetric to be shown immediately. Fixed - now in 'immediate'
    mode single-selection choices are not auto-completed without user consent.</li>
  <li>New Editor: when user selected black background the colors on printout
    are inverted to save toner/ink. Also added File-&gt;Print/Print Setup menu
    item.</li>
  <li>New Editor: on application close editor window frame is closed first instead
    of last. This gives more 'graceful' exit.</li>
  <li>New Editor: on dark backgrounds unmatched brace is displayed in lighter
    blue color (instead of dark blue) for better visibility</li>
  <li>New Editor: Autocomplete listbox is now dismissed when user drags separate
    editor frame or MDI child frame</li>
  <li>New Editor: now it uses application theme instead of hard-coded &quot;VS2010&quot; theme</li>
  <li>New Editor: auto complete does not try to pop up in file paths in #includes.
    Also improved auto-complete operation in the very last line.</li>
  <li>New Editor prints debug string when saving document in order to diagnose
    possible issues with FAT32/WinXP</li>
  <li>Sometimes crash occured on Window-&gt;Floating command when Interpretation
    window was open. Fixed.</li>
  <li>UI: Window-&gt;Toggle Frame restores window from icon state (if was minimized)
    now.</li>
  <li>UI: added View-&gt;Fold / Unfold, Margin menu items in the MDI editor menu</li>
  <li>UI: Charts file treeview gets refreshed when saving AFL to any folder,
    not only 'Custom'</li>
  <li>UI: Customize keyboard page now displays an error message on attempt to
    create shortcuts with A-Z letters and 0-9 digits without Ctrl/Shift/Alt modifiers
    to prevent clash with the editor</li>
  <li>UI: AFL formulas are saved in separate MRU (most recently used) list (File-&gt;Recent
    Formulas) so they do not interfere with other document types using Recent
    File list</li>
</ul>
<p><strong>CHANGES FOR VERSION 5.77.0 (as compared to 5.76.0)</strong></p>
<ul>
  <li>New Editor: 'Use separate frame' mode implemented (Tools-&gt;Preferences, &quot;Editor&quot; to
    turn this off and open as tab in main frame)</li>
  <li>New Editor: Toolbar customization functionality added</li>
  <li>UI: Window-&gt;Toggle Frame (Ctrl + ` ) menu/shortcut added to quickly
    switch between main and separate editor frame</li>
  <li>UI: Window menu reordered (Tile/Cascade items moved up)</li>
  <li>New Editor: in 5.76 pressing Help button on dialogs when new editor was
    open, directed help file to 'formula editor' page instead of given dialog
    help file. Fixed.</li>
  <li>New Editor: On dark backgrounds the selection is darker than it was before</li>
  <li>New Editor: typing non-US characters (with right Alt key) is now working</li>
  <li>New Editor: Copy As HTML implemented</li>
  <li>New Editor: added ability to turn off line number margin, selection margin,
    fold margin (from View menu)</li>
  <li>New Editor: added View-&gt;Fold All / Unfold All commands</li>
  <li>New Editor: when relative paths were used sometimes auto-reload and auto-save
    before analysis did not work. Fixed.</li>
  <li>New Editor: Caret Ln/Col position is displayed in the status bar</li>
  <li>New Editor: Closing top error message bar clears ALL in-line error messages</li>
  <li>New Editor: added Edit-&gt;Clear Error message menu (Ctrl+E) - it clears
    an error(s) in currently selected line/range</li>
  <li>New Editor: The width of line number margin is automatically adjusted with
    regards to font size and line count and zoom level</li>
  <li>New Analysis: Progress bar is shown/hid quicker<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.76.0 (as compared to 5.75.0)</strong></p>
<ul>
  <li>New Editor: Auto-complete has now 3 modes: disabled, on-demand (shows auto
    complete list when you press Ctrl+SPACE as in old editor) and immediate (auto-complete
    pops up immediately)</li>
  <li>New Editor: Auto change case and auto parameter info features can be turned
    off from the preferences</li>
  <li>Prefs: Editor page changed: <br>
    a) added &quot;Virtual space&quot; checkbox to control whenever ability to
    move caret past the end of the line is enabled or not <br>
    b) replaced &quot;Auto-complete&quot; box with 3-way selection radio buttons
    (Disable/On-demand (Ctrl+Space)/Immediate) - to control whenever auto-complete
    opens on Ctrl+SPACE combination or immediately after typing first letter<br>
    c) removed &quot;Use syntax highlighting&quot; box (now it is always ON)<br>
    d) removed &quot;Highlight error line&quot; (now it is always ON)<br>
  </li>
  <li>New Editor: File is saved automatically when it is open in Analysis window
    and analysis is run</li>
  <li>UI: leftover and/or user-defined keyboard accelerators for HOME/END/PAGE
    UP/DOWN, letters and digits without Ctrl/Alt modifier are removed on startup
    not to interfere with the editor</li>
  <li>UI: Ctrl+F added to default key accelerators</li>
  <li>New Editor: Implemented user-defined colors/styles/font (from Tools-&gt;Preferences, &quot;Editor&quot;).<br>
    NOTE:<br>
    In 5.75 on Vista, Windows 7 and Windows 8 the editor automatically switched
    to modern ClearType &quot;Consolas&quot; font that is present on those systems.<br>
    If you want to use this new font instead of old &quot;courier&quot; font,
    go to Tools-&gt;Preferences, &quot;Editor&quot; and choose &quot;Consolas&quot; font
    and size 10pt. </li>
  <li>New Editor: Implemented Help features (access to help pages Function reference,
    Using AFL Editor, Param info, etc)</li>
  <li>New Editor: Chart tree is auto-refreshed when formula is saved under new
    name (Save As...)<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.75.0 (as compared to 5.74.0)</strong></p>
<ul>
  <li>Completely new AFL Editor, integrated with MDI structure with many new
    features
      <ul>
        <li>line numbering</li>
        <li> code folding</li>
        <li>automatic indent</li>
        <li> indentation markers</li>
        <li> brace highlighting</li>
        <li> improved auto-complete
            <ul>
              <li> shows up immediately after typing 1 char</li>
              <li> properly detects multi line comments </li>
              <li>displays custom backtester member methods / properties</li>
            </ul>
        </li>
        <li>in-line error reporting / highlight </li>
      </ul>
  </li>
</ul>
<blockquote>
  <p>TO SWITCH BACK TO OLD editor use Tools-&gt;Preferences, &quot;Editor&quot; tab:
    UNCHECK &quot;Use New Editor&quot;</p>
  <p>NOTE ALSO: that color/font preferences do not affect new editor yet (it
    is on to-do list).<br>
  </p>
</blockquote>
<ul>
  <li>New Analysis: few messages displayed in modal message box were moved to
    message bar</li>
  <li>UI: Active state is tracked separately for each document type (so there
    is 'last active chart' , 'last active analysis&quot;) to allow functioning
    of new editor</li>
  <li>InfoSite added to the PluginNotification structure (Notify API callback)<br>
      <br>
    struct PluginNotification<br>
    {<br>
    int	nStructSize;<br>
    int	nReason;<br>
    LPCTSTR pszDatabasePath;<br>
    HWND	hMainWnd;<br>
    struct StockInfoFormat4	*pCurrentSIOld;<br>
    struct _Workspace	*pWorkspace;<br>
    struct StockInfo	*pCurrentSINew;<br>
    struct InfoSite *pInfoSite; // NEW 5.74<br>
    };<br>
  </li>
  <li>AFL: Parser tracks position of some operators better so errors and warnings
    should show locations more precisely (for example Warning 501 points to =
    sign now)</li>
  <li>AFL: Parser produces more descriptive &quot;Syntax error, indentifier 'name'
    is undefined &quot; or &quot;... is not a function&quot; when it encounters
    a function call for undefined identifier or indentifier that is a variable.
    Previously it returned 'syntax error, unexpected '('</li>
  <li>UI: removed global user-definable accelerators for Chart/Pageup/down/home/end
    because they interferred with new AFL editor. Instead chart page/up/down/home/end
    implemented locally (work only when chart has focus)<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.74.0 (as compared to 5.73.0)</strong></p>
<ul>
  <li>AFL Editor: Code snippets implemented (phase 1). Code snippet is a small
    piece of AFL code. It can be inserted by right-clicking in the AFL editor
    window and choosing &quot;Insert Snippet&quot; menu<br>
      <br>
    This is phase 1 of implemetation of code snippets. There will be other elements
    added in the future.<br>
    There are two files located in AmiBroker directory that hold snippets:<br>
    CodeSnippets.xml - these are snippets shipped with AmiBroker installation
    (and can be replaced in subsequent installations, so don't modify it!)<br>
    UserSnippets.xml - these are user-definable snippets. This file is NOT present
    in the installation and user can create it by him/herself.
    <p>The XML schema for snippets file is simple (as below). Key trigger functionality
      is NOT yet implemented, however Keytrigger fields should be included in
      the definition for future use. It will be work like 'autocomplete' so that
      you type the shortcut it, it will unfold to the formula.</p>
    <p>Suggestions for new snippets are welcome.</p>
    <p><code><strong>&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</strong><br>
          <strong>&lt;AmiBroker-CodeSnippets CompactMode=&quot;0&quot;&gt;</strong></code></p>
    <p><code><strong>&lt;Snippet&gt;</strong><br>
          <strong>&lt;Name&gt;</strong><font color="#0000FF">First Snippet</font><strong>&lt;/Name&gt;</strong><br>
          <strong>&lt;Description&gt;</strong><font color="#0000FF">Description
          of the snippet</font><strong>&lt;/Description&gt;</strong><br>
          <strong>&lt;Category&gt;</strong><font color="#0000FF">User category</font><strong>&lt;/Category&gt;</strong><br>
          <strong>&lt;KeyTrigger&gt;</strong><font color="#0000FF">?trigger1</font><strong>&lt;/KeyTrigger&gt;</strong><br>
          <strong>&lt;Formula&gt;</strong><br>
          <strong>&lt;![CDATA[</strong></code></p>
    <p><code><font color="#0000FF">// the formula itself</font></code></p>
    <p><code><strong>]]&gt;<br>
&lt;/Formula&gt;<br>
&lt;/Snippet&gt;</strong></code></p>
    <p><code><strong>&lt;Snippet&gt;</strong><br>
          <strong>&lt;Name&gt;</strong><font color="#0000FF">Second Snippe</font>t<strong>&lt;/Name</strong>&gt;<br>
          <strong>&lt;Description&gt;</strong><font color="#0000FF">Description
          of the snippet</font><strong>&lt;/Description&gt;</strong><br>
          <strong>&lt;Category&gt;</strong><font color="#0000FF">User category</font><strong>&lt;/Category&gt;</strong><br>
          <strong>&lt;KeyTrigger&gt;</strong><font color="#0000FF">?trigger2</font><strong>&lt;/KeyTrigger&gt;</strong><br>
          <strong>&lt;Formula&gt;<br>
&lt;![CDATA[</strong></code></p>
    <p><code><font color="#0000FF">// the formula itself</font></code></p>
    <p><code><strong>]]&gt;<br>
&lt;/Formula&gt;<br>
&lt;/Snippet&gt;<br>
&lt;/AmiBroker-CodeSnippets&gt;</strong></code></p>
  </li>
  <li>AFL: Low level GFX: Multi-layering (z-order) implemented. AFL: GfxSetZOrder
    implemented<br>
      <br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"Price"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorDefault</B></FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#000000><B>GraphGridZOrder</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>; <BR>
      <BR>
      </FONT><FONT COLOR=#0000ff>GfxSetZOrder</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>); <BR>
      </FONT><FONT COLOR=#0000ff>GfxSelectSolidBrush</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>colorGreen</B></FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#0000ff>GfxCircle</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>100</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>100</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>100</FONT><FONT COLOR=#000000> ); <BR>
      <BR>
      </FONT><FONT COLOR=#0000ff>GfxSetZOrder</FONT><FONT COLOR=#000000>(-</FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>); <BR>
      </FONT><FONT COLOR=#0000ff>GfxSelectSolidBrush</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#0000ff>GfxCircle</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>150</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>150</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>100</FONT><FONT COLOR=#000000> ); <BR>
      <BR>
      </FONT><FONT COLOR=#0000ff>GfxSetZOrder</FONT><FONT COLOR=#000000>(-</FONT><FONT COLOR=#800080>2</FONT><FONT COLOR=#000000>); <BR>
      </FONT><FONT COLOR=#0000ff>GfxSelectSolidBrush</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>colorBlue</B></FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#0000ff>GfxCircle</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>180</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>180</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>100</FONT><FONT COLOR=#000000> );</FONT></CODE><br>
  </li>
  <li>AFL: Low-level GFX: radius in GfxCircle() function is expressed in &quot;X&quot; units
    (so it actually draws circle instead of ellipse when coords mode is 1). Additionally
    you can specify radius in pixels even in co-ords mode = 1. To do so pass
    radius as NEGATIVE number. Also one pixel is now added to the rounding box
    so circle is centered at &quot;x,y&quot;.<br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#008000>// fractional radius
      is supported, so 0.5 would mean half of space between bars</FONT><FONT COLOR=#000000> <BR>
      </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000> ( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>""</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorDefault</B></FONT><FONT COLOR=#000000>); <BR>
      </FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#0000ff>GfxSetCoordsMode</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#0000ff>GfxSelectSolidBrush</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>colorViolet</B></FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#0000ff>GfxSelectPen</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000> ); <BR>
      </FONT></CODE><CODE><FONT COLOR=#000000>bi = </FONT><FONT COLOR=#0000ff>BarIndex</FONT><FONT COLOR=#000000>(); <BR>
    start = </FONT><FONT COLOR=#0000ff>FirstVisibleValue</FONT><FONT COLOR=#000000>(
    bi ); <BR>
    end = </FONT><FONT COLOR=#0000ff>LastVisibleValue</FONT><FONT COLOR=#000000>(
    bi ); <BR>
        <BR>
    r = </FONT><FONT COLOR=#0000ff>Param</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"radius"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>,
    -</FONT><FONT COLOR=#800080>5</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>4</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>0.1</FONT><FONT COLOR=#000000> ); <BR>
        </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000> ( i
        = start; i &lt;= end; i ++ ) <BR>
    { <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>GfxCircle</FONT><FONT COLOR=#000000> (
i , <B>Close</B> [i] , r); <BR>
    } </FONT></CODE> </li>
  <li>AFL: Low level GFX: in 5.73.0 the pixel co-ordinates were rounded differently
    than in 5.72 and earlier. Fixed.</li>
  <li>AFL: Low level GFX: new function GfxGetTextWidth - returns pixel width
    of specified string. NOTE: it is slow because it has to create temporary
    DC and font to measure the text. It takes 40us (microseconds), that is about
    40 times more than other Gfx functions.<br>
      <br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>GfxSetZOrder</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>5</FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#0000ff>GfxSelectFont</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Tahoma"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>30</FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#0000ff>GfxSetTextColor</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>colorWhite</B></FONT><FONT COLOR=#000000> ); <BR>
    text = </FONT><FONT COLOR=#800080>"This is a test"</FONT><FONT COLOR=#000000>; <BR>
    </FONT><FONT COLOR=#0000ff>GfxTextOut</FONT><FONT COLOR=#000000>(text, </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>50</FONT><FONT COLOR=#000000>); <BR>
    </FONT><FONT COLOR=#0000ff>GfxSetTextColor</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000> ); <BR>
    </FONT><FONT COLOR=#0000ff>GfxTextOut</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"second
    part in red"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>GfxGetTextWidth</FONT><FONT COLOR=#000000>(text), </FONT><FONT COLOR=#800080>50</FONT><FONT COLOR=#000000> ); <BR>
    </FONT></CODE> </li>
  <li>AFL: fopen - new parameter: 'sharing' decides whenever file is open in
    sharing mode or not. When sharing is True a file is prepared for subsequent
    shared reading and writing.<br>
      <br>
    When sharing parameter is True the following things happen:<br>
    - when mode is &quot;w&quot; (writing) or &quot;a&quot; (appending) then
    file is open with a sharing flag that denies others to read and/or write
    at the same time<br>
    - when mode is &quot;r&quot; (reading) then file is open with a sharing flag
    that denies others to write to the file (shared reads are allowed)<br>
    - when open is unsuccessful due to sharing violation (other processes / threads
    have that file open and deny reads/writes) then fopen would wait for 250ms
    and retry automatically 4 times. After 4 unsuccessful retries it fails with
    file handle == Null.
    <p>When sharing parameter is set to False (default) no such checking occurs
      and file is open anyway without denying others to read/write. This may
      cause data corruption if file is written to from multiple threads/external
      processes at the same time. If you want to use this mode (sharing set to
      False) in multithreaded environment to write data, you need to care about
      synchronization yourself for example using critical section.<br>
    </p>
  </li>
  <li>UI: Added &quot;Name&quot; (full name) column to Real-time quote window</li>
  <li>AFL: Implemented user control over Y-axis cursor and tooltips by means
    of new option chartDisableYAxisCursor, chartDisableTooltips added to SetChartOptions<br>
          <br>
          <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>SetChartOptions</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>chartDisableYAxisCursor</B></FONT><FONT COLOR=#000000> | </FONT><FONT COLOR=#000000><B>chartDisableTooltips</B></FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
          don't change cursor shape in Y axis area and tooltips</FONT></CODE> <br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.73.0 (as compared to 5.72.0)</strong></p>
<ul>
  <li>AFL: SetOption(&quot;StaticVarAutoSave&quot;, interval ) - added to allow
    periodical auto-saving of persistent static variables<br>
        <br>
    The interval is given in seconds.<br>
    For example:<br>
    SetOption(&quot;StaticVarAutoSave&quot;, 60 ); // auto-save persistent variables
    every 60 seconds (1-minute)
    <p>It is important to understand that persistent variables are saved ON EXIT
      automatically, without any user intervention<br>
      so it should be enough for most cases. If you for some reason want auto-saves
      when AmiBroker is running, then<br>
      you can use this function.</p>
    <p>Please note that writing many static variables into physical disk file
      takes time and it blocks all static variable access<br>
      so you should AVOID specifying too small auto-save intervals.<br>
      Saving every second is bad idea - it will cause overload. Saving every
      60 seconds should be fine.</p>
    <p>Calling function with interval set to zero disables auto-save.</p>
    <p>SetOption(&quot;StaticVarAutoSave&quot;, 0 );</p>
  </li>
  <li>
    <p>AFL: new GfxSetCoordsMode - rewritten Low-Level Gfx to allow fractional
      coords and bar/price co-ords mode in addition to pixel<br>
              <br>
      // NEW FUNCTION<br>
      <strong>GfxSetCoordsMode</strong>( mode );<br>
      - allows to switch co-ordinate system for low-level gfx functions from
      sceen pixel (mode = 0) - the default, to<br>
      bar / price mode (mode = 1 ) where X is expressed in bar index and Y is
      expressed in price.<br>
      This new mode allows way easier overlays on top of existing charts without
      need to do conversion between bars/price pixels<br>
      and without any extra refresh normally required in old versions when Y
      scale changed.</p>
    <p>The function can be called to switch back and forth from pixel -&gt; bar/price
      mode and vice versa a number of times<br>
      allowing to mix different modes in the same chart.</p>
    <p>When co-ordinate mode 1 is selected (bar/price), co-ordinates can be fractional.
      For example if x is 2.5 it means half way between bar 2 and 3.</p>
    <p>Example:<br>
        <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#008000>// The sample shows
        how using GfxSetCoordsMode( 1 ) </FONT><FONT COLOR=#000000> <BR>
            </FONT><FONT COLOR=#008000>// results in</FONT><FONT COLOR=#000000> <BR>
            </FONT><FONT COLOR=#008000>// a) easier coding of overlay charts
            that plot on top of built-in charts (no need to convert from bar/price
            to pixels)</FONT><FONT COLOR=#000000> <BR>
            </FONT><FONT COLOR=#008000>// b) perfect matching between built-in
            Plot() and Gfx positioning </FONT><FONT COLOR=#000000> <BR>
            </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"Price"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorDefault</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>styleLine</B></FONT><FONT COLOR=#000000> ); <BR>
            </FONT><FONT COLOR=#0000ff>GfxSetOverlayMode</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ); <BR>
            </FONT><FONT COLOR=#0000ff>GfxSetCoordsMode</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
            bar/price mode (instead of pixel)</FONT><FONT COLOR=#000000> <BR>
            <BR>
            </FONT><FONT COLOR=#0000ff>GfxSelectSolidBrush</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000> ); <BR>
            </FONT><FONT COLOR=#0000ff>GfxSelectPen</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000> ); <BR>
            <BR>
      boxheight = </FONT><FONT COLOR=#800080>0.01</FONT><FONT COLOR=#000000> *
      ( </FONT><FONT COLOR=#0000ff>HighestVisibleValue</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000> )
      - </FONT><FONT COLOR=#0000ff>LowestVisibleValue</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000> )
      ); <BR>
            <BR>
      bi = </FONT><FONT COLOR=#0000ff>BarIndex</FONT><FONT COLOR=#000000>(); <BR>
      <BR>
      start = </FONT><FONT COLOR=#0000ff>FirstVisibleValue</FONT><FONT COLOR=#000000>(
      bi ); <BR>
      end = </FONT><FONT COLOR=#0000ff>LastVisibleValue</FONT><FONT COLOR=#000000>(
      bi ); <BR>
            <BR>
      </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000> ( i =
      start; i &lt;= end; i++ ) <BR>
      { <BR>
&nbsp;&nbsp;&nbsp;&nbsp;Cl = </FONT><FONT COLOR=#000000><B>Close</B></FONT><FONT COLOR=#000000>[
i ]; <BR>
&nbsp;&nbsp;&nbsp;&nbsp;Op = </FONT><FONT COLOR=#000000><B>Open</B></FONT><FONT COLOR=#000000>[
i ]; <BR>
            <BR>
&nbsp;&nbsp;&nbsp;&nbsp;Color = </FONT><FONT COLOR=#0000ff>IIf</FONT><FONT COLOR=#000000>(
Cl &gt; Op, </FONT><FONT COLOR=#000000><B>colorGreen</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000> ); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>GfxSelectPen</FONT><FONT COLOR=#000000>(
Color ); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>GfxSelectSolidBrush</FONT><FONT COLOR=#000000>(
Color ); <BR>
            <BR>
&nbsp;&nbsp;&nbsp;&nbsp;bodyup = </FONT><FONT COLOR=#0000ff>Max</FONT><FONT COLOR=#000000>(
Op, Cl ); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;bodydn = </FONT><FONT COLOR=#0000ff>Min</FONT><FONT COLOR=#000000>(
Op, Cl ); <BR>
            <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>GfxEllipse</FONT><FONT COLOR=#000000>(
i - </FONT><FONT COLOR=#800080>0.4</FONT><FONT COLOR=#000000>, bodyup, i + </FONT><FONT COLOR=#800080>0.4</FONT><FONT COLOR=#000000>,
bodydn ); <BR>
            <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>GfxMoveTo</FONT><FONT COLOR=#000000>(
i, </FONT><FONT COLOR=#000000><B>H</B></FONT><FONT COLOR=#000000>[ i ] ); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>GfxLineTo</FONT><FONT COLOR=#000000>(
i, bodyup ); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>GfxMoveTo</FONT><FONT COLOR=#000000>(
i, bodydn ); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>GfxLineTo</FONT><FONT COLOR=#000000>(
i, </FONT><FONT COLOR=#000000><B>L</B></FONT><FONT COLOR=#000000>[ i ] ); <BR>
      }</FONT></CODE><br>
    </p>
  </li>
  <li>
    <p>Charts: functions calculating day offset (GetBarsBetweenDates) support
      years &gt; 2038 and are now much faster (don't count days in loops but
      use smarter calendar math instead)</p>
  </li>
  <li>
    <p>Charts: Cycle Lines tool has drawn lines in weird places when using very
      long cycles that resulted in lines being positioned beyond 2038. Fixed.</p>
  </li>
  <li>
    <p>UI: added View-&gt;Price chart style-&gt;Bars without ticks</p>
  </li>
  <li>
    <p>Change #2534 made in 5.71.0 (allowing Null for Close field in bar chart)
      created backward compatiblity issue. Reverted. Instead a new styleBarNoTick
      introduced that allows to plot bar chart without open/close ticks:<br>
                        <br>
                        <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>IIf</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>Month</FONT><FONT COLOR=#000000>() & </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>Null</B></FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#800080>"Price"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorDefault</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>styleBarNoTicks</B></FONT><FONT COLOR=#000000> | </FONT><FONT COLOR=#000000><B>styleThick</B></FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
                        bar chart without open/close ticks</FONT></CODE><br>
    </p>
  </li>
  <li>
    <p>New Analysis: when Non-exhaustive Optimize was used on symbol without
      any quotes, UI displayed error and remained disabled and it was not possible
      to re-run non-exhaustive opt. Fixed.</p>
  </li>
  <li>
    <p>New Analysis: Backtest: Profit figures are color-coded now (negative -
      red/positive - green)<br>
    </p>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.72.0 (as compared to 5.71.0)</strong></p>
<ul>
  <li>AFL: new feature: high-performance Persistent Static variables implemented
    (StaticVarSet has new parameter 'persist' - if it is set to True then static
    variable will be stored in PersistVars.bin file when AmiBroker is closing
    and reloaded automatically on next startup, preventing the values of static
    variables between application runs)<br>
      <br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>ParamTrigger</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Set
      variable"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"Set"</FONT><FONT COLOR=#000000> )
      ) <BR>
    { <BR>
&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>StaticVarSet</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"varx"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>Close</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>True</B></FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
set persistent variable</FONT><FONT COLOR=#000000> <BR>
    } <BR>
    <BR>
      </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>StaticVarGet</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"varx"</FONT><FONT COLOR=#000000>), </FONT><FONT COLOR=#800080>"Persistent
      var"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000> );</FONT></CODE><br>
  </li>
  <li>64-bit optimizer plugins: fixed issue in SPSO/Tribes with OptimizeSetOption
    not working correctly</li>
  <li>UI: Interpretation and Notepad windows do not flicker anymore when they
    are resized</li>
  <li>ASCII importer: added $USEONLYLOCALDB command<br>
    If data is fed by database plugin, using the ASCII importer to add any symbol
      causes these newly added symbol to have &quot;Use only local database&quot; flag
      turned on.<br>
    A new command:<br>
    $USEONLYLOCALDB 0
    <p>allows to turn this off (so newly added symbols have &quot;use only local
      database&quot; turned off)</p>
    <p>This flag does NOT affect existing symbols.</p>
  </li>
  <li>Symbol pane full-text search is user-configurable (from options menu) and
    now supports searching by alias, address, country (in addition to search
    by symbol and full name). <br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.71.0 (as compared to 5.70.2)</strong></p>
<ul>
  <li>AFL: PlotText() now has additional parameter yoffset: PlotText( &quot;text&quot;,
    x, y, color, bkcolor = colorDefault, yoffset = 0 )<br>
    yoffset allows to specify PIXEL offset to Y coordinate which is expressed
    in price in PlotText calls. This provides easy method to position precisely
    the text based on font/letter specific characteristics<br>
  </li>
  <li>AFL: PlotTextSetFont( &quot;text&quot;, &quot;fontname&quot;, pointsize,
    x, y, color, bkcolor = colorDefault, yoffset = 0 )<br>
    Example:<br>
    <br>
    <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"Price"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorDefault</B></FONT><FONT COLOR=#000000> ); <BR>
    x = </FONT><FONT COLOR=#0000ff>SelectedValue</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>BarIndex</FONT><FONT COLOR=#000000>()
    ); <BR>
    y = </FONT><FONT COLOR=#000000><B>Close</B></FONT><FONT COLOR=#000000>[ x
    ]; <BR>
    <BR>
    </FONT><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>PlotTextSetFont</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"E"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"Wingdings"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>40</FONT><FONT COLOR=#000000>,
    x, y, </FONT><FONT COLOR=#000000><B>colorGreen</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorDefault</B></FONT><FONT COLOR=#000000>,
    -</FONT><FONT COLOR=#800080>30</FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#0000ff>PlotText</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>"C"</FONT><FONT COLOR=#000000>,&nbsp;&nbsp;</FONT><FONT COLOR=#000000><B>BarCount</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>Close</B></FONT><FONT COLOR=#000000>[ </FONT><FONT COLOR=#000000><B>BarCount</B></FONT><FONT COLOR=#000000> - </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ], </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorDefault</B></FONT><FONT COLOR=#000000>,
      -</FONT><FONT COLOR=#800080>20</FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
      will use new font too</FONT></CODE><br>
  </li>
  <li>ASCII importer: now company address can be imported ($ADDRESS &lt;company
    address&gt; command and new ADDRESS field in the $FORMAT command)</li>
  <li>ASCII importer: NULL can be specified as date in several date fields such
    as delisting date, dividend date,etc. This results in date being cleared
    (unset).<br>
    $FORMAT TICKER,LAST_SPLIT_DATE,ADDRESS<br>
    $AUTOADD 1<br>
    $OVERWRITE 1<br>
    $NOQUOTES 1<br>
    $SEPARATOR ,
    <p>XLNX,NULL,&quot;This is new address&quot;</p>
  </li>
  <li>Charts: Y-axis grid can now be finer than 0.0001 (#125281) - upto 6 decimal
    digits (0.000001) are displayed when needed</li>
  <li>Charts: Null values in Open/Close fields now disable drawing of open/close
    ticks in the bar chart (PlotOHLC function)<br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>""</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorDefault</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>styleNoDraw</B></FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#0000ff>PlotOHLC</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>Null</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>High</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>Low</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>Null</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"Price"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>IIf</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>H</B></FONT><FONT COLOR=#000000> &gt; </FONT><FONT COLOR=#0000ff>Ref</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>H</B></FONT><FONT COLOR=#000000>,
      -</FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#000000><B>colorGreen</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#000000><B>styleBar</B></FONT><FONT COLOR=#000000> | </FONT><FONT COLOR=#000000><B>styleNoLabel</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>Null</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>Null</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>,
      -</FONT><FONT COLOR=#800080>100</FONT><FONT COLOR=#000000> );</FONT></CODE><br>
  </li>
  <li>UI: Last pane height does not change on window resizing after pane resize
    anymore.</li>
  <li>New Analysis: in Windows 7 and 8 the progress of scan/backtest/exploration/optimization
    is also shown in Windows Taskbar, so it is visible even if AmiBroker window
    is minimized or covered by other windows</li>
  <li>New Analysis: Backtest report settings: added option NOT to include Formula
    in the report (for security purposes)</li>
  <li>New Analysis: Horizontal scroll bar is refreshed after HTML import</li>
  <li>Prefs: Currency tab, added option &quot;Trade using FX cash conversion&quot; to
    handle different ways to calculate profits depending on whenever foreign
    currency is borrowed or cash actualy exchanged<br>
        <br>
    When you actually exchange the cash when entering a trade on security traded
    in foreign currency then you should have this option turned ON<br>
    when you use a loan in a foreign currency, turn this option OFF (the pre
    5.71-behavior)<br>
    See this for more info:<br>
    <a href="https://www.interactivebrokers.com/images/flash/tours/MechanicsOfForeignTransaction/index.html%20">https://www.interactivebrokers.com/images/flash/tours/MechanicsOfForeignTransaction/index.html </a><br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.70.2 (as compared to 5.70.0)</strong></p>
<ul>
  <li>Vertical selector line for the very first quote in a chart was not displayed.
  Fixed.</li>
  <li>Exception could occur when passing openpos object to user-defined function.
  Fixed.</li>
  <li>Deleted databases are removed on start up from that &quot;Recent databases&quot; menu</li>
  <li>An
    exception at 678BAB24 when full name edit was incomplete and symbol was changed.
  Fixed.</li>
  <li>In 32-bit version of AmiBroker, StaticVarInfo could return negative
  value when static memory usage was greater than 2GB. Fixed</li>
  <li>Added extra checks
    in SetOption to avoid crash when user deletes symbols while formula is running
  (which is bad idea anyway)</li>
  <li>On attempt to print/copy image of an empty chart
  pane appropriate message is displayed</li>
  <li>State of command bars is loaded with
    'silent' option to prevent &quot;due to
    software update the toolbar has changed &quot; messages that could appear
    when user launched AmiBroker from different folders or different versions
    (old and
    new)<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.70.0 (as compared to 5.69.0)</strong></p>
<ul>
  <li>GDI: use of PS_ALTERNATE style in Windows 95/98 causes resource leak. Fixed.</li>
  <li>UI:
    Place Order dialog, it was problematic to enter fractional offsets for brackets.
  Fixed.</li>
  <li>&quot;
    Recent database&quot; menu randomly listed files instead of databases. Fixed.
    Note if you have custom toolbar with &quot;Recent database&quot; submenu
    added, you need to delete it and re-insert.<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.69.0 (as compared to 5.68.1)</strong></p>
<ul>
  <li>Adding symbols via ASCII import caused change of selected symbols in charts.
  Fixed.</li>
  <li>OLE: AnalysisDoc.Run supports Individual Optimization now (Action ==
  5)</li>
  <li>Charts: when formula file can not be found the detailed information about
    the path referenced and current working directory is displayed instead of
    old &quot;the
  formula can not be found - no chart to display&quot;</li>
  <li>New Analysis: added Auto-repeat
    status icon in the right-hand corner of the Info bar (yellow 'play' arrow
    shows up when auto-repeat is active and scheduled
  for next run)</li>
  <li>AFL: Percentile() uses now new algorithm that has linear O(n)
    complexity instead of O(log(n)*n) so it is MUCH faster than the old one and
    close to
    Median()
  that uses quickselect (which is fastest)<br>
  <br>
  By the way, to find average of upper and lower median for EVEN number of elements
  you can use<br>
  Percentile( array, range, 50 )
  <p>- it will execute approx 30% slower than Median, but Median only returns
    LOWER median for even 'range' parameter.</p>
  </li>
  <li>ODBC plugin: now available in 64-bit</li>
  <li>AFL: since 5.63 round() function used
    32-bit floorf which resulted in some differnces as compared to 5.60. Previous
  code version is restored now.</li>
  <li>DDE plugin: 64-bit version of DDE plugin was
  producing incorrect timestamps. Fixed.</li>
  <li>Default seed for Random() and mtRandom()
    was based on time(), which could be the same for threads created in the very
    same moment. Now the seed in
    multiple
    threads is guaranteed to be unique. This prevents repeated pseudo-random
  sequences in multiple threads created in the very same moment.</li>
  <li>IB plugin:
    added support for CFDs (security type=CFD, exchange=SMART) and commodities
  (security type = CMDTY, exchange = SMART)<br>
  <br>
  Example symbology for CFD:<br>
  IBUS500-SMART-CFD-USD
  <p>Symbol-SMART-CFD-Currency</p>
  <p>Example symbology for commodities:<br>
    XAUUSD-SMART-CMDTY</p>
  <p>Symbol-SMART-CMDTY-Currency</p>
  </li>
  <li>UI: Now there are separate MRU (most
    recently used) menus for files and databases (File-&gt;Recent Databases,
  File-&gt;Recent Files_)</li>
  <li>Removed / changed some mnemonics (key accelerators)
  in menus to avoid duplicates</li>
  <li>The default setting for Layers/&quot;Auto-Select
    Layer&quot; is changed to
  OFF.</li>
  <li>Custom Backtester interface: added FullName read-only property to Trade
  object (gives full name of symbol)<br>
  <br>
  You can use it for example to add full name as a custom metric to the trade
  list
  <p>SetCustomBacktestProc(&quot;&quot;); </p>
  <p>/* Now custom-backtest procedure follows */ <br>
    if( Status(&quot;action&quot;) == actionPortfolio ) <br>
  { <br>
  bo = GetBacktesterObject(); </p>
  <p> bo.Backtest(1); // run default backtest procedure </p>
  <p> // iterate through closed trades first <br>
  for( trade = bo.GetFirstTrade(); trade; trade = bo.GetNextTrade() ) <br>
  { <br>
  trade.AddCustomMetric(&quot;FullName&quot;, trade.FullName ); <br>
  } </p>
  <p> bo.ListTrades(); </p>
  <p> } </p>
  <p>// your trading system here </p>
  <p><br>
  fast = Optimize(&quot;fast&quot;, 12, 5, 20, 1 ); <br>
  slow = Optimize(&quot;slow&quot;, 26, 10, 25, 1 ); <br>
  Buy=Cross(MACD(fast,slow),Signal(fast,slow)); <br>
  Sell=Cross(Signal(fast,slow),MACD(fast,slow));</p>
  <br>
  </li>
  <li>SPSO (standard particle swarm optimizer)
  plugin: now available in 64-bit</li>
  <li>Tribes plugin: now available in 64-bit</li>
  <li>DDE plugin: now available in 64-bit<br>
  </li>
</ul>
<p>&nbsp;</p>
<p><strong>CHANGES FOR VERSION 5.68.1 (as compared to 5.68.0)</strong></p>
<ul>
  <li>fixed crash in 64-bit version when usign StaticVarGenerateRanks
      on large arrays</li>
  <li>AFL: since 5.63 round() function used 32-bit floorf which resulted in some
    differnces as compared to 5.60. Previous code version is restored now.<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.68.0 (as compared to 5.67.2)</strong></p>
<ul>
  <li>AFL: new function: Error(&quot;text&quot;) - allows to display user-defined
    error messages and stop execution of the formula. Good for 3rd party plugin
  implementors to display error messages<br>
  <br>
  Example:<br>
  Error(&quot;Something went wrong&quot;);
  <p>Note that error number in case of user-defined error message is always 99.</p>
  </li>
  <li>AFL: new function: StaticVarGetRankedSymbols( &quot;outputprefix&quot;, &quot;inputprefix&quot;,
    datetime )</li>
  <li>AFL: new function: StaticVarGenerateRanks function (flexible ranking
      function)<br>
      <br>
      NOTE: This function is NOT intended to replace bakctester's built-in ranking
      via PositionScore. Just the opposite: whenever you can, you should use
      PositionScore 
      as it is way way faster and less memory-consuming way to perform backtests
      with ranking. To learn more about how to use PositionScore see &quot;Portfolio
      level backtesting&quot; section of the tutorial.
      StaticVarGenerateRanks is intended to be used for tasks OTHER than backtesting
      such as explorations or indicators
      that may require ranking functionality.
      <p> WARNING: this function is computationally and memory intensive. It
        takes about 20ms per 15K bars and 7 symbols. Try to call it JUST ONCE
        per scan/exploration/backtest using
        if( Status(&quot;stocknum&quot;)==0) or better yet, use separate scan
        just once to pre-calculate ranks and use it later (like composite creation
        scan).
        If you fail to do so and call StaticVarGenerateRanks for every symbol
        performance would drop significantly as this function not only needs
        lots of time to compute
        but it also has to lock the access to shared memory used by static variables
        so other threads trying to access static variables would wait until this
    function completes.</p>
      <p>StaticVarGenarateRanks( &quot;outputprefix&quot;, &quot;inputprefix&quot;,
        topranks, tiemode )</p>
      <p></p>
      <p>&quot;inputprefix&quot; is a prefix that defines names of static variables
        that will be used as input for ranking.<br>
        AmiBroker will search for all static variables that begin with that prefix
        and assume that remaining part of the variable name is a stock symbol.
        Say you want to rank stocks by ROC (rate of change). All you need to
        do is to store values into static variables.<br>
        Let us say that we will use static variable names like &quot;ValuesToSortAPPL&quot;, &quot;ValuesToSortMSFT&quot;,
        and so on.</p>
      <p>To fill input static variables you can use this loop:</p>
      <p>for( i = 0; ( sym = StrExtract( symlist, i ) ) != &quot;&quot;; i++
        )<br>
        {<br>
  SetForeign(sym );<br>
  Value = ROC( C, 10 );<br>
  RestorePriceArrays();<br>
  StaticVarSet( &quot;ValuesToSort&quot; + sym, Value );<br>
  }</p>
      <p>Now you are ready to perform sorting/ranking. There are two modes, normal
        ranking mode and Top/Bottom Rank mode.<br>
        Normal ranking mode is performed when toprank argument is set to zero.</p>
      <p>StaticVarGenerateRanks( &quot;rank&quot;, &quot;ValuesToSort&quot;,
        0, 1224 );</p>
      <p><br>
        In this case StaticVarGenerateRanks call would generate set of static
          variables starting with prefix defined by 2nd argument<br>
        each variable holding the rank of particular symbol, so in this case<br>
        RankValuesToSortMSFT will hold ranking of MSFT <br>
        RankValuesToSortAAPL will hold ranking of AAPL<br>
        Note that in AmiBroker rank count start from ZERO.</p>
      <p>Third argument (topranks) is zero in normal ranking mode<br>
        Fourth argument (tiemode) defines how ties are ranked. Supported modes
          are 1234 and 1224. In 1224 mode ties are numbered with equal rank.</p>
      <p><br>
        Example code for normal ranking mode (everything done is done in one
          pass, can be used in indicator):</p>
      <p>symlist = &quot;C,CAT,DD,GE,IBM,INTC,MSFT&quot;;</p>
      <p>// delete static variables<br>
        StaticVarRemove(&quot;ValuesToSort*&quot;);</p>
      <p>// fill input static arrays<br>
        for( i = 0; ( sym = StrExtract( symlist, i ) ) != &quot;&quot;; i++ )<br>
        {<br>
  SetForeign(sym );<br>
  Value = ROC( C, 10 );<br>
  RestorePriceArrays();<br>
  StaticVarSet( &quot;ValuesToSort&quot; + sym, Value );<br>
  }</p>
      <p>// perform ranking<br>
        StaticVarGenerateRanks( &quot;rank&quot;, &quot;ValuesToSort&quot;, 0,
        1224 ); // normal rank mode</p>
      <p>// read ranking<br>
        for( i = 0; ( sym = StrExtract( symlist, i ) ) != &quot;&quot;; i++ )<br>
        {<br>
  Plot( StaticVarGet( &quot;RankValuesToSort&quot; + sym ), sym, colorCustom10
  + i );<br>
  }</p>
      <p>Top/bottom ranking mode (that generates top/bottom ranking tables that
        hold indexes to top ranking values. When topranks &gt; 0 top ranked values
        are used, when topranks &lt; 0 then bottom ranked values are used.
        The values are stored in variables that have format of:
        OutputprefixInputprefixN where N is a number 1, 2, 3 representing top/bottom
        ranks. Let us assume that
        OutputPrefix parameter is &quot;Top&quot; and Inputprefix parameter is
        ROC.
        In such case variable TopROC1 would hold the index of top rated value.
        TopROC2 would hold second top rated value, and so on.<br>
        StaticVarGenerateRanks function uses rank numbering that starts from
        ONE.
        In top ranking mode StaticVarGenerateRanks will also prepare static variable
        that contains comma separated list of variable names that can be used
        to
        find out which index refers to which symbol. So if TopROC1 holds 1 you
        would lookup first substring in TopROCSymbols variable to find out what
        variable (symbol)
        ranked at the top.
        Additionally StaticVarGetRankedSymbols gives easy-to-use method to retrieve
    comma separated list of ranked symbols for particular datetime.</p>
      <p>Example code for top ranking mode</p>
      <p>symlist = &quot;C,CAT,DD,GE,IBM,INTC,MSFT&quot;;</p>
      <p>// delete static variables<br>
        StaticVarRemove(&quot;ValuesToSort*&quot;);</p>
      <p>// fill input static arrays<br>
        for( i = 0; ( sym = StrExtract( symlist, i ) ) != &quot;&quot;; i++ )<br>
        {<br>
  SetForeign(sym );<br>
  Value = ROC( C, 10 );<br>
  RestorePriceArrays();<br>
  StaticVarSet( &quot;ValuesToSort&quot; + sym, Value );<br>
  }</p>
      <p>// perform ranking<br>
        StaticVarGenerateRanks( &quot;rank&quot;, &quot;ValuesToSort&quot;, 0,
        1224 ); // normal rank mode<br>
        StaticVarGenerateRanks( &quot;top&quot;, &quot;ValuesToSort&quot;, 3,
        1224 ); // top-N mode<br>
        StaticVarGenerateRanks( &quot;bot&quot;, &quot;ValuesToSort&quot;, -3,
        1224 ); // bottom-N mode<br>
        // read ranking<br>
        for( i = 0; ( sym = StrExtract( symlist, i ) ) != &quot;&quot;; i++ )<br>
        {<br>
  Plot( StaticVarGet( &quot;RankValuesToSort&quot; + sym ), sym, colorCustom10
  + i );<br>
  }</p>
      <p>sdt = SelectedValue( DateTime() );<br>
        Title = &quot;{{NAME}} -{{DATE}} - {{VALUES}} TOP: &quot; + StaticVarGetRankedSymbols( &quot;top&quot;, &quot;ValuesToSort&quot;,
        sdt ) +<br>
      &quot; 
        BOT: &quot; + StaticVarGetRankedSymbols( &quot;bot&quot;, &quot;ValuesToSort&quot;,
        sdt ) ; </p>
  </li>
  <li>New
  Analysis: when two Analysis windows were open and running Scan simultaneously
      with AddToComposite composites could get reset by scan running in second
  window. Fixed.</li>
  <li>Added millisecond support to ASCII importer. Supported time format
      with milliseconds is HH:MM:SS.mmm (where mmm is milliseconds 000..999)  </li>
  <li>Unsettled sale proceeds were settled at the end of the day instead of the
  beginning of the next day. Fixed.</li>
  <li>The message 'trade not entered because
      of insufficient funds' is modified to mention that it also it may not be
      entered because of incorrect
            position size
            specified by the user<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.67.2 (as compared to 5.67.0)</strong></p>
<ul>
  <li>Using more than 100 Plot() statements in one formula could cause memory
  corruption sometimes resulting in access violation. Fixed.</li>
  <li> File-&gt;New-&gt;Blank chart and then clicking &quot;View&quot; caused
  exception in 5.67.1. Fixed</li>
  <li>Low-level gfx playback engine resets colors to black pen / white background,
    so it does not get influenced by chart colors like labels.</li>
  <li>GfxSetOverlayMode(
      2 ) sometimes produced incorrect output in 5.67.0. Fixed.<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.67.0 (as compared to 5.66.0)</strong></p>
<ul>
  <li>New Analysis: Optimization continued even if there was error inside custom
  backtest procedure. Fixed.</li>
  <li>Charting: a new &quot;Warning 902 can not plot
    a chart in logarithmic scale as a data set contains negative value(s)&quot; message
    is displayed on attempt to use log scale with negative data and the chart
    is plotted in linear scale
  instead.</li>
  <li>UI: 'Logarithmic scale' item added to &quot;View&quot; menu. <br>
    Also the user can add this to View toolbar using toolbar customization (click
  on arrow in the &quot;View&quot; toolbar, &quot;Add or remove buttons&quot; then &quot;View&quot; then &quot;Logarithmic...&quot;)  </li>
  <li>AFL: new function
    fdir( &quot;wildcard&quot;, flags = 1 ) - returns comma separated
  directory list (like &quot;DIR&quot; command)<br>
  &quot;wildcard&quot; is a path with a wildcard pattern to match.<br>
  For example &quot;C:\\*.*&quot; will give you all files in C: drive, but &quot;C:\\*.txt&quot; will
  give you only files with .txt extension.<br>
  flags - controls what is returned the default is 1 - only files, 2 - only directories,
  3 - both files and directories
  <p>Example:<br>
    printf(&quot;Only files:\n&quot;);<br>
    _N( list = fdir( &quot;c:\\*.*&quot;, 1 ) );</p>
  <p>for( i = 0; ( filename = StrExtract( List, i ) ) != &quot;&quot;; i++ )<br>
    {<br>
  printf( filename + &quot;\r\n&quot; );<br>
  }</p>
  <p>printf(&quot;\n\nOnly directories:\n&quot;);<br>
    _N( list = fdir( &quot;c:\\*.*&quot;, 2 ) );</p>
  <p>for( i = 0; ( filename = StrExtract( List, i ) ) != &quot;&quot;; i++ )<br>
    {<br>
  printf( filename + &quot;\r\n&quot; );<br>
  }</p>
  <p>printf(&quot;\n\nBoth files and directories:\n&quot;);<br>
    _N( list = fdir( &quot;c:\\*.*&quot;, 3 ) );</p>
  <p>for( i = 0; ( filename = StrExtract( List, i ) ) != &quot;&quot;; i++ )<br>
    {<br>
  printf( filename + &quot;\r\n&quot; );<br>
  }</p>
  </li>
  <li>GfxSetOverlayMode( mode = 1
    ) did not work with &quot;alternate background
  fill&quot;. Fixed.</li>
  <li>Analysis Settings Load/Save buttons were positioned wrong
  in RTL (right-to-left) systems. Fixed.</li>
  <li>AFL: CategoryCreate( &quot;name&quot;, category
  ) - adds new category (currently supports only adding watchlists)<br>
  newwl = CategoryCreate( &quot;name&quot;, categoryWatchList ) - this will add
  (create new) watch list with &quot;name&quot; (if it does not exist) or will
  return existing &quot;name&quot; watch list
  <p>newwl will hold new watch list index.</p>
  <p>Currently only creation of watch list is supported by this function.</p>
  </li>
  <li>64-bit:
  Fixed crash with backtest of more than 10 million bars</li>
  <li>64-bit: Fixed 'squeeze'
    problem with charts at full zoom out when more than 10 million data bars
  were displayed</li>
  <li>OLE Stocks.Add and Stocks.Remove trigger resynchronization
    of selected indexes to avoid problems with &quot;symbol locked&quot; charts<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.66.0 (as compared to 5.65.0)</strong></p>
<ul>
  <li>32-bit and 64-bit versions now use different registry key to save list
    of DLLs so warning messages about non-certified 3rd party plugins are not
    displayed
  each time you switch between 32-bit and 64-bit app version anymore.</li>
  <li>Foreign(&quot;~~~EQUITY&quot; )
    within custom backtest proc in old AA returned zero (because of change in
  5.65). Fixed.</li>
  <li>CBT: when low-level mode was used (no ProcessTradeSignals was
    called) ~~~Equity open interest field was not filled with number of open
  positions. Fixed.</li>
  <li>When user moved default Formula path somewhere else Report
  charts were not generated properly. Fixed.</li>
  <li>CBT: a new field &quot;TransactionCosts&quot; (equivalent
    to report's &quot;total
  transaction costs&quot;) is now supported in the custom backtester Stats.GetValue
  method</li>
  <li>ASCII importer: added DELISTING_DATE to fields available in $FORMAT command.<br>
    To import delisted symbols you may use file like this. Acceptable date formats
    are<br>
    YYYY-MM-DD (ISO standard) and DD-MM-YYYY (automatically detected).<br>
    Note that MM-DD-YYYY (US) is not detected because one can not automatically
    detect if 01-02-2003 means<br>
    february 1st or january 2nd
    <p>#<br>
      $FORMAT NAME, DELISTING_DATE<br>
      $NOQUOTES 1<br>
      $OVERWRITE 1<br>
      SYMBOL,&quot;2012-07-0</p>
  </li>
  <li>AFL:
    GetFnData returned invalid value for fields DividendPayDate and ExDividendDate
  when they were empty (not set) in the Information window. Fixed (now Null is
  returned)</li>
  <li>AFL: GetFnData now supports new field &quot;DelistingDate&quot;<br>
    <br>
    dd = GetFnData(&quot;DelistingDate&quot;);<br>
    if( IsNull( dd ) )<br>
printf(&quot;Security is active&quot;);<br>
else<br>
printf( &quot;Delisted at&quot; + dd + DateTimeToStr( dd ) );<br>
</li>
  <li>Information
  window: added &quot;Delisting date&quot; field.<br>
  Delisting Date is a last day when security was available for trading due to
  delisting. If the security is still active the field is empty.  </li>
  <li>Information window: it was
    not possible to set/change Dividend Pay Date and Ex Dividend date from UI.
  Fixed.</li>
  <li>Preferences window: new tab &quot;Candles &amp; Bars&quot; that controls
  detailed appearance of candlestick and traditional bar charts<br>
  <br>
  Use up/down colors - when marked bar charts use candlestick up/down color defined
  in the Colors tab<br>
  End cap style - controls whenever bar charts are plotted so the endings of
  lines are rounded, square or flat.<br>
  The difference between square and flat is that square end will plot with &quot;square&quot; pen
  and with wide pens it will plot width/2 pixels above high and below low because
  of pen thickness (looks good but high/lows are not precisely marked).<br>
  &quot;
  Flat&quot; means that ends terminate at exact position (so high and lows are
  precise), but the open/close ticks may look weird when plotted at high/low
  (&quot;staircase effect&quot;)
  <p>Open/Close tick % thickness - controls the thickness of line used to plot
    open/close ticks. It is expressed in % of main bar thickness (default is
    100%)<br>
    Open/Close tick % length - controls the length of open/close ticks. It is
    expressed in % of candle width which is usually half the distance between
    bars (but not more than 30 pixels).</p>
  </li>
  <li>The database
  save was triggered when opening documents using recent file list. Fixed.</li>
  <li>Parameter
      window: Right mouse button double click over parameter label resets selected
  parameter to the default value now</li>
  <li>AFL: PlotShapes() now has XShift parameter</li>
  <li>Custom metric optimization target
      (WF tab) is now matched case-insensitive (FC#2442)<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.65.0 (as compared to 5.64.0)</strong></p>
<ul>
  <li>In-memory quotation cache can now be larger than 20K symbols. Now the maximum
    is 100K symbols (user definable in Tools-&gt;Preferences, &quot;Data&quot; tab).
    Caveat use extreme values ONLY if you have plenty of memory AND you are using
  64-bit version</li>
  <li>New Analysis: Walk-forward result list colums had &quot;alpha&quot; type
    which resulted in alphabetic sort when user clicked on column. Fixed (numeric
    type
  is used now).</li>
  <li>QuickData did not work properly for not time-based intervals
  so it is now automatically turned off for charts using such intervals.</li>
  <li>Fixed
    crash @0048C19A/48C1C4 (click on result list after backtest to show arrows
  sometimes produced this). </li>
  <li>Trade profit calculation speeded up which results in upto 15% faster optimization
  with lots of trades</li>
  <li>New Analysis: In 5.64.x &quot;stocknum&quot; incorrectly
  started counting from 1 instead of 0 as in old versions. Fixed.</li>
  <li>Foreign/SetForeign/RelStrength
      of the same symbol as active does nothing (i.e. refers to already existing
  thread local data, instead of querying database)</li>
  <li>New Analysis: when SetSortColumns
      was used in 5.63 and above it could trigger redundant multiple sorts. Now
  it is fixed (sort only once)</li>
  <li>New Analysis: results are now sorted after
      Individual Optimization the same way as after portfolio Optimization<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.64.0 (as compared to 5.63.0)</strong></p>
<ul>
  <li><strong>New Analysis: Multi-threaded Individual Optimization</strong> (experimental)<strong>. </strong>Upto
  NumberOfCores faster. Note: no CBT and only exhaustive mode is supported as
    of now<br>
    <br>
    The new optimizer is called &quot;Individual Optimize&quot; in the New analysis
  window and you can access it here:<br>
  <br>
  Note that old &quot;Optimize&quot; button runs OLD (i.e. 5.60) optimizer -
  for comparison purposes.
  <br>
  <br>
  <img src="http://www.amibroker.com/gifs/indopt.png" alt="" name="IndOpt" width="336" height="159">  <br>  
  <p>&quot;Individual Optimize&quot; will use all available processor cores to
    perform single-symbol optimization.<br>
    In &quot;Current symbol&quot; mode it will perform optimization on one symbol.<br>
    In &quot;All symbols&quot; and &quot;Filter&quot; modes it will process all
    symbols sequentially, i.e.<br>
    first complete optimization for first symbol, then optimization on second
    symbol, etc.</p>
  <p>Limitations:<br>
    1. Custom backtester is not supported (yet)<br>
    2. Smart optimization engines are NOT supported - only EXHAUSTIVE optimization
    works.</p>
  <p>For explanation of these limitations see http://www.amibroker.com/guide/h_multithreading.html</p>
  <p>Eventually I may get rid of limitation (1) - when I change the CBT NOT to
    use OLE anymore.<br>
    But (2) is probably here to stay for long.</p>
</li>
</ul>
<ul>
  <li>Built-in constant are set up once and shared among all threads to save
  setup time (gives 10% speed up in execution of simple formulas)</li>
  <li>Built-in constants
      such as colorBlack are now read-only and any attempt to overwrite such constant
  value results in error 55.</li>
  <li>    New Analysis, list view in scans, explorations and individual optimizations
  is refreshed less often to gain some speed.</li>
  <li>In case of individual backtest
      / individual optimization the backtester allocates much smaller price cache
  (just for 2 symbols) - takes less time.</li>
  <li>In 5.63 Bar Replay did not with &quot;QuickData&quot; enabled
  (it required View-&gt;Refresh All to start working). Fixed.</li>
  <li>Some actions (like
        import of past data, split, etc) did not trigger automatic chart refresh
        when QuickData was enabled. Fixed.<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.63.0 (as compared to 5.62.0)</strong></p>
<ul>
  <li>QuickData for charts implemented. QuickData is a new feature that greatly
    decreases time required to prepare compressed/filtered data for real-time
  charts.<br>
  QuickData is turned ON by default. It can be turned off in Tools-&gt;Preferences, &quot;AFL&quot; tab.
  Do NOT turn it off however, unless you are having problems/issues.<br>
  QuickData minimizes number of required operations by analysing what has changed
  in the input data and re-doing compression only for changed portion. This results
  in significant real-time performance improvement especially on 1-minute databases
  having &gt;200K bars and many charts open. With this option turned on and 6
  charts open load factor can drop from above 100% to less than 1%. CPU usage
  drops by more than 7x (from 7% to less than 1%)<br>
</li>
  <li>Time&amp;Sales
    now supports filtering out trades and bid/ask quotes below user-defined size  </li>
  <li>Time&amp;Sales allows to customize colors (separate color setting for trades
      occuring above/at ask, inside, at / below bid, etc). Right-click and use
  context menu to bring up &quot;Colors...&quot; dialog</li>
  <li>Time&amp;Sales now supports &quot;Wide
    list&quot; mode in addition to existing &quot;Narrow&quot; mode. &quot;Wide
      mode&quot; has separate columns for bid / ask data. To switch - right click
      on the T&amp;S window and choose &quot;Wide&quot; or &quot;Narrow&quot; from
  context menu</li>
  <li>OpenInterest field of ~~~EQUITY symbol now holds number of
  open positions on bar per bar basis</li>
  <li>GetFnData() supports now &quot;Currency&quot; and &quot;WebID&quot; fields</li>
  <li>AFL:
    some transcendental math functions (sqrt, sin,asin, cos, acos, tan, atan,
  ln, log10, etc) are 10-30% faster now.</li>
  <li>AmiQuote 3.05: fix to &quot;It is illegal
    to call out while inside message filter&quot; error that sometimes occurred
  when OLE server was busy during long imports</li>
  <li>ASCII importer: if import takes
  more than 5 seconds, Windows does not mark AmiBroker as &quot;not responding&quot; anymore</li>
  <li>Progress
    indicator (for ASCII import) in the status bar is larger and works better
  for large files</li>
  <li>AFL: SetSortColumns() can now be called more than once to
  support multiple rankings via AddRankColumn</li>
  <li>64-bit version: Added 'highDPIaware'
    and &quot;asInvoker' settings to application
      manifest in x64 version, to prevent file system virtualization and scaling
  on high-DPI screens</li>
  <li>Added X/Y constaints for drawing tools. When you hold
    down &quot;Y&quot; key,
      start and end Y co-ordinates are set to equal value (with trend line it
    gives horizontal line). When you hold down &quot;X&quot; key you get perfectly
  vertical line (X start/end set to equal value)</li>
  <li>When loading and saving quotation
    files, AmiBroker does not allocate extra memory buffer. This conserves RAM
  when handling large files.</li>
  <li>64-bit version is able to load/save files larger
    than 2GB per symbol (more than 53 million data bars per symbol). Note that
    you would need to use
      huge amounts of RAM as using 50 million data bars requires 6GB of RAM or
      more
  for any decent performance.<br>
  WARNING: Files larger than 2GB can not be used with 32-bit version. You must
  use 64-bit version in order to be able to access files &gt;2GB.<br>
  Also note that loading / saving file that has 2GB (2000MB) size on hard disk
  that has 100MB/second read/write speed takes over 20 seconds. Do not assume
  that the program hanged up only because Windows marks it as &quot;not responding&quot; when
  it is busy writing 2GB+ files. Windows would say the application is 'not responding'
  if it is busy reading/writing for more than 1 second.<br>
  To work with such huge files you should invest in some very fast SSD to cut
  down those times, with currently fastest SSD use SATA3 6GBps and this would
  give you theoretical maximum of 750MB per second. Still loading/saving 2GB
  from such high-performance drive would take 3+ seconds.  </li>
  <li>When user re-arranged tabs in the &quot;Log&quot; window, &quot;Clear&quot; and
  other right-menu commands used wrong tab. Fixed.</li>
  <li>AFL: new function AddRankColumn
      - adds ranking column(s) according to current sort set by SetSortColumns<br>
      Filter = 1;<br>
      AddColumn( Close, &quot;Close&quot; );<br>
      AddColumn( Volume, &quot;BI&quot; ); <br>
      AddSummaryRows( 31+32, 1.5 );
      <p>AddRankColumn(); // without prior sorting AddRankColumn just adds line
        number<br>
        SetSortColumns(-4);<br>
        AddRankColumn(); // rank according to 4th column (descending)<br>
        SetSortColumns(-3);<br>
        AddRankColumn(); // rank according to 3rd column (ascending)</p>
      <br>
    <br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.62.0 (as compared to 5.61.0)</strong></p>
<ul>
  <li>AddSummaryRows now supports also flag = 32. This flag adds standard deviation
  row<br>
  <br>
  Filter=1; <br>
  AddColumn(V, &quot;Volume&quot; ); <br>
  AddSummaryRows( 63, 1.2 ); <br>
  // add Total, Average, Min, Max, and Count and StdDev rows (1+2+4+8+16+32)=63
  - with two decimal places summary rows are added at the top of the list<br>
  </li>
  <li>AddSummaryRows treated NULLs as zeros in averages. Now it is fixed and
  NULLs are not included in calculations.</li>
  <li>Drawing tooltip &quot;bars&quot; count
    starts from 0 (when line is pure vertical) to match status bar X distance
    display. Status bar coords display
      is hidden
  once drawing is done to prevent user confusion.</li>
  <li>Snap to price now allows
    snapping to Closing and Opening price, to activate snap to close hold down &quot;C&quot; key,
    to activate snap to open hold down &quot;O&quot; key
  while drawing line / moving the mouse</li>
  <li>When &quot;Play&quot; button is pressed
      Bar replay dialog checks if Start Date is earlier than End date and displays
      error message if that is not
  the case.</li>
  <li>Ticker box is updated with new full name if it is changed from
  symbol information</li>
  <li>Per-symbol UserData fields are accessible now via GetFnData(&quot;UserData0&quot;)..GetFnData(&quot;UserData99&quot;).
      This feature is for implementors of custom data plugins to allow them to
  expose custom data<br>
  for( i = 0; i &lt; 100; i++ )<br>
  printf( &quot;UserData%g %g\n&quot;, i, GetFnData(&quot;UserData&quot;+i) );<br>
</li>
  <li>New Analysis: In 5.61.0 Walk Forward kept old &quot;Current
      symbol&quot; until
  Scan/Explore/Backtest was run. Fixed</li>
  <li>First line in &quot;Parallel trendlines&quot; tool
  is snapped to price (if the option is turned on) as normal trendline.</li>
  <li>eSignal:
  now plugin supports EOD history for more than 40 years back</li>
  <li>Charting: Copy-Paste
  Special allows to copy entire chart pane with various options<br>
  <br>
  a) Entire chart pane (fully independent) - it creates a copy of chart pane,
  assigns new chart ID, creates duplicate of the formula file so parameters are
  independent and formula is private (not shared with source pane)
  <p>b) Entire chart pane (independent parameters, but shared formula), the same
    as (a) but does NOT create duplicate of the formula so it shares the very
    same formula file with the original pane</p>
  <p>c) Entire chart pane (hard-wired, shared parameters, formula and drawings,
    same chartID) - a new pasted pane is directly hard-wired with pane being
    copied, so it shares the same CHART ID and every change made to it is made
    to the original (source) too.<br>
  </p>
  </li>
  <li>Backtest report
  now includes 'Total transaction costs' (sum of all commissions paid)</li>
  <li>Aux1/Aux2
    fields now allow user-definable aggregation/compression mode (File-&gt;Database
      Settings-&gt;Intraday Settings). Available choices are last (default),
      first, highest, lowest, sum<br>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 5.61.0 (as compared to 5.60.3)</strong></p>
<ul>
  <li>When using any drawing tool X and Y distance is shown in the status bar
  (FC #2380)</li>
  <li>When position can not be entered due to insufficient funds the
    Backtester
    in the &quot;detailed mode&quot; gives additional info such as: requested
    entry price, requested position size (and dollar value) and requested round
    lots
  (FC#2377)</li>
  <li>Time&amp;Sales column layout persists between runs now (FC #2341)</li>
  <li>Running
    any #import command (including &quot;Update US symbol list and categories&quot;)
  is preceeded by prompt for confirmation now</li>
  <li>Report Explorer now supports copying
    selected items to clipboard (Edit-&gt;Copy),
  Ctrl+C (FC#2288)</li>
  <li>Quote Editor: added &quot;Go to selected&quot; button that
  quickly scrolls to and selects the data bar marked on chart (FC#2342)</li>
  <li>New
    Analysis: parameters were not reset to default values when formula was loaded.
  Fixed. (#2353)</li>
  <li>New Analysis: &quot;Add artificial future bar&quot; option
  does not affect Exploration and Scan anymore (FC#2353)</li>
  <li>Max. chart rendering
    time of 1000 ms when multithreaded charts are turned ON can be overriden
  now by registry setting. See FC#2330 for details.</li>
  <li>Increased width of symbol
    combo boxes in Symbol-&gt;Merge dialog to prevent
  truncation of ticker names</li>
  <li>Floating window caption is now synchronized even
  if it is not active (FC#2376)</li>
  <li>eSignal: new  version allows to select
  whenever EOD bars should report Settlement price or regular close </li>
  <li>Change
    PlotShapes does NOT use &quot;shape0&quot;, &quot;shape1&quot; variables
  anymore to prevent clashing with user-defined variables (#104931)</li>
  <li>ASCII importer
      now supports $WEBID command and WEBID field in the $FORMAT command to allow
  importing web ID (FC#2362)</li>
  <li>ASCII importer now supports $ISINDEX, $ISFAVORITE
  commands, and ISINDEX and ISFAVORITE fields in the $FORMAT command (FC#2310)</li>
  <li>Apply
      To: Filter dialog takes less time to show up<br>
    <br>
  </li>
</ul>
  
    
      
        
          
            
              
                
                  
                    
                      
                        
                          
                            
                              
                                <p><strong>CHANGES FOR VERSION 5.60.3 (as compared
                                    to 5.60.2)</strong></p>
                                <ul>
                                  <ul>
                                  </ul>
                                  <li>When custom backtest formula was defined
                                      in separate file then report &quot;Formula&quot; tab
                                      shown CBT formula instead of actual system
                                    formula. Fixed.</li>
                                  <li>New Analysis, when Apply to was set to &quot;Current&quot; then
                                      changing current symbol during optimization
                                    affected results. Fixed</li>
                                  <li>New Analysis, database's time shift was
                                      applied twice in &quot;Show current trade
                                    arrows&quot; mode. Fixed.</li>
                                  <li>Custom backtest procedure was not called
                                      when number of trades was equal zero (no
                                      trades at all). This prevented creation of
                                      custom metrics in such case. Now CBT code
                                    is called anyway.</li>
                                  <li>3D optimization chart was corrupted when
                                    optimization included custom metrics. Fixed.</li>
                                  <li>Corrections and updates to Users' Guide</li>
                                </ul>
                                <p><strong>CHANGES FOR VERSION 5.60.2 (as compared
                                to 5.60.1)</strong></p>
                                <ul>
                                  <li>Setup: GICS.txt file had 50102010 category
                                    incorrectly entered (without new line). Fixed.<br>
                                  <li>Setup: Formats\aqgi.format file added<br>
                                  <li>Scale in/out column could have thousand
                                    separator added in incorrect place. Fixed.<br>
                                  <li>New Analysis: when there was no selected
                                    formula filey a number of empty items were
                                    added to the combo box. Fixed.<br>
                                  <li>New Analysis: Walk-forward summary report
                                    name and from date was not reset in second
                                    and subsequent runs in the same Analysis
                                    window. Fixed.<br>
                                  <li>New Analysis: if symbol did not have any
                                    quotes at all, &quot;wait for backfill&quot; did
                                    not wait. Fixed.<br>
                                  <li>New Analysis: Exploration - a little speed
                                    up by decreased number of string reallocations
                                    in CAnalysisExploreJob::Run<br>
                                  <li>Inactive Web research window did not sync
                                    with selected symbol when &quot;sync always&quot; was
                                    turned on. Fixed. MG #113<br>
                                  <li>Filter dialog background change did not
                                    look nice on Windows XP and earlier. Turned
                                    this off in pre-Vista OSes.<br>
                                  <li>eSignal: in &quot;EOD&quot; mode when started
                                    outside trading session a last bar could
                                    be duplicate of previous day bar. Fixed<br>
                                  <li>eSignal: 64-bit plugin now correctly downloads
                                    daily (EOD) history (so mixed mode works
                                    fine too).<br>
                                  <li>eSignal plugin: added support for extended
                                    intraday (to enable it use Configure: &quot;Use
                                    extended intraday history data request&quot;) <br>
                                  <li>Due to Windows &quot;feature&quot; dotted
                                    lines with width of 1 were printed as solid
                                    lines on a printer. Workaround (forcing width
                                    to 0) for printer implemented.<br>
                                  <li>Default black chart theme is only set when
                                    no preferences file is found. If broker.prefs
                                    exists but it is stored in pre-5.52 version
                                    then white scheme is applied by default.<br>
                                  <li>Charts: when loading multiple chart layout
                                    the invisible/obscured windows were not always
                                    scrolled to the end (most recent quote).
                                    Fixed.<br>
                                  <li>Auto-hidden Analysis windows sometimes
                                    did not repaint properly. Fixed.<br>
                                  <li>Sharpe ratio now uses floating point trade
                                    length/qty ratio instead of integer to prevent
                                    rounding.<br>
                                  <li>AFL: Now OLE strings passed by reference
                                    (VT_BSTR|VT_BYREF) are accepted too.
                                </ul>
                                <p>&nbsp;</p>
                                <p><strong>CHANGES FOR VERSION 5.60.1 (as compared
                                      to 5.60.0)</strong></p>
                                <ul>
                                  <li>New Analysis: when OoS test was turned
                                    OFF in advanced Walk Forward mode, it would
                                    crash at the end attempting to create summary
                                    out of non-existing out-of-sample tests.
                                    Fixed.</li>
                                  <li>New Analysis: Walk-forward combined OoS
                                    equity is just concatenation of OoS steps
                                    and no scaling is applied anymore. This it
                                    little faster and prevents some boundary/roundoff
                                    conditions.</li>
                                  <li>Inactive tab text color is now fixed RGB
                                    (#656565) instead of querying system COLOR_GRAYTEXT
                                    as it is too light on XP. <br>
    If you want inactive tab text to be completely black, then create registry
    key<br>
    HKEY_CURRENT_USER\Software\TJP\Broker\Settings\InactiveTabTextColor<br>
    with DWORD value of 0 (zero)
    <p>Instead of black (0) you may use any other RGB value of course</p>
    <p><br>
      [HKEY_CURRENT_USER\Software\TJP\Broker\Settings]<br>
&quot; InactiveTabTextColor&quot;=dword:00000000</p>
                                  </li>
                                  <li>In 5.58 and above Study() only worked in
                                    indicators, and always referred to current
                                    chart ID. It did not work in Analysis. Fixed.</li>
                                  <li>ASCII import: ASCII characters above code
                                    127 are not trimmed from the end of strings
                                  anymore.</li>
                                </ul>
                                <p><strong>CHANGES FOR VERSION 5.60.0 (as compared
                                      to 5.59.0)</strong></p>
                                <ul>
                                  <li>Upgrade information: keys issued before
                                    2011-04-13 are expired with 5.60</li>
                                  <li>UI: removed unused options from Prefs/Miscelleneous
                                    page</li>
                                  <li>UI: In 5.59 ticker box was not in sync
                                    with currently selected symbol on loading
                                    single-chart layout. Fixed</li>
                                  <li>UI: importing custom icon image using Tools-&gt;Customize,
                                    button RMB -&gt; Edit Image -&gt; Import
                                    image caused change of current working directory.
                                    Now CWD is saved and restored after customization.</li>
                                  <li>UI: Floating panes use themed frames now</li>
                                  <li>UI: Filter settings dialog is resizable
                                    now (and static fields use proper background
                                    color)</li>
                                  <li>UI: Crash could occur if the user customized
                                    Tools menu by moving &quot;Update US stock
                                    list...&quot; item from the very last position
                                    in the menu elsewhere. Fixed.</li>
                                  <li>UI: cosmetic color changes (chart sheet
                                    tabs)</li>
                                  <li>On attempt to close Analysis window that
                                    is currently running scan/exploration/backtest
                                    an appropriate error message is displayed.</li>
                                  <li>New Analysis: the message &quot;No symbols
                                    matched apply to / filtering criteria&quot; shows
                                    up in the message bar instead of dialog,
                                    so one does not need to click OK</li>
                                  <li>New Analysis: Specifying ReEntryDelay &gt; 0
                                    in ApplyStop rotational and raw modes caused
                                    incorrect results in second and subsequent
                                    backtests (MG#79). Fixed.</li>
                                  <li>New Analysis: In 5.59 3D optimization chart
                                    - wrong 2nd axis legend was wrong (duplicate
                                    of 1st axis). Fixed.</li>
                                  <li>New Analysis: In 5.58 and 5.59 smart optimizer
                                    engine was not finalized properly when user
                                    pressed &quot;Cancel&quot; during optimize
                                    run. Fixed.</li>
                                  <li>New Analysis: error message bar text is
                                    now trimmed to 110 characters to ensure there
                                    is a place for the &quot;Details&quot; button</li>
                                  <li>In colorCycle sequence colorRed is replaced
                                    with colorLightOrange for better visibility
                                    when displayed with red candles</li>
                                  <li>In 5.58 View-&gt;Intraday-&gt;Tick turned
                                    incorrect &quot;0-tick&quot; interval which
                                    resulted in effective 1-second compression.
                                    Fixed.</li>
                                  <li>colorDefault is now user- definable in
                                    the preferences (Colors tab) and selectable
                                    from Parameters window and associated with
                                    chart theme</li>
                                  <li>Charts: Print Preview and printout had
                                    incorrect colors due to the fact that SetDCPenColor/SetDCBrushColor
                                    APIs do not work with metafiles/printers.
                                    Fixed.</li>
                                  <li>Charts: In 5.59 chart could stop refreshing
                                    when it had odd number of Plot() calls combined
                                    with a couple of PlotForeign() calls and
                                    total number of items to display in tooltip/data
                                    window exceeded 20. Fixed.</li>
                                  <li>Changed default Price all in one volume
                                    to color to ColorBlend( ColorRGB( 128, 128,
                                    192 ), GetChartBkColor(), 0.5 )),</li>
                                  <li>Changed default colors for charts to &quot;Black&quot; scheme
                                    and outline mode to &quot;One color for entire
                                    handle and hollow up candle body&quot;</li>
                                  <li>Changed default chart layout for clean
                                    installation</li>
                                  <li>Changed default appearance to VS2010 /
                                    pane tabs on bottom</li>
                                  <li>Changed Bollinger band filled default color
                                    to ColorBlend( Color, GetChartBkColor(),
                                    0.8 )</li>
                                  <li>changed all price formulas shipped in setup
                                    to use colorDefault instead of colorBlack</li>
                                  <li>Blank chart panes now use defined chart
                                    background color instead of white</li>
                                  <li>Background of built-in dark grey theme
                                    made slightly lighter than black</li>
                                  <li>ASCII import: sector names beginning with &quot;Sector&quot; and
                                    industry names beginning with &quot;Industry&quot; were
                                    not imported properly. Fixed.</li>
                                  <li>aqh.format, aqd.format, aqg.format changed
                                    - removed $VOLFACTOR 0.01 previously used
                                    so volume is reported in shares not in hundreds
                                    of shares</li>
                                  <li>ApplyStop( stopTypeNBar, ... ) in backtestRegularRaw
                                    / backtestRegularRawMulti/Rotational - N-bar
                                    stop exited 1 bar later than in regular mode.
                                    Fixed.</li>
                                  <li>AFL: when array was passed as &quot;amount&quot; argument
                                    to DateTimeAdd, the results could be incorrect.
                                    Fixed.</li>
                                  <li>AFL: SetChartOptions did not write chart
                                    flags in 5.5x. Fixed</li>
                                  <li>AFL: GetFnData() now supports &quot;Country&quot; field</li>
                                </ul>
                                <p><strong>CHANGES FOR VERSION 5.59.0 (as compared
                                      to 5.58.0)</strong></p>
                                <ul>
                                  <li>New Analysis: loading previously stored
                                    APX files into 5.58 resulted in ICB filter
                                    being set (instead of cleared). Fixed.</li>
                                  <li>New Analysis: 3D optimization chart can
                                    also be displayed from single-parameter optimization
                                    now, without need to add dummy Optimize()</li>
                                  <li>IB data plugin: CMDTY historical requests
                                    use MIDPRICE instead of TRADES</li>
                                  <li>IB data plugin: Max. number of symbols
                                    increased to 1000</li>
                                  <li>UI: Tools-&gt;Preferences/Charting: added
                                    setting to show (or hide) the bar number
                                    in the crosshair's X label, by default the
                                    bar number is NOT shown now (previously it
                                    was ON by default)</li>
                                  <li>UI: Tools-&gt;Preferences/Charting removed
                                    setting for &quot;'New look' charts&quot; -
                                    now 'New look' is used always</li>
                                  <li>UI: For PlotOHLC and Plot with styleCandle/styleBar
                                    tooltip and data window display OHLC data
                                    in this order (instead COHL in previous versions)</li>
                                  <li>UI: Data window now displays values for
                                    all panes at once (you can turn the display
                                    of single pane back using right click menu
                                    option)</li>
                                  <li>ASCII importer: added $COUNTRY command
                                    and COUNTRY field to $FORMAT command</li>
                                  <li>AFL: in ROC, RSI, RSIa, TRIX, CCI, MFI,
                                    MA, EMA, Hold, BBandBottom, BBandTop, PDI,
                                    MDI, ADX, ATR, Correlation, Wilders functions
                                    'range' parameter is now checked for &gt; 0
                                    and error is displayed when it is negative</li>
                                  <li>Interval-locked layers did not work correctly
                                    for N-tick/volume/range intervals. Fixed.<br>
        <br>
                                  </li>
                                </ul>
                                <p><strong>CHANGES FOR VERSION 5.58.0 (as compared
                                    to 5.57.1)</strong></p>
                                <ul>
                                  <li>DB: Automatic setup and update of stock
                                    symbol listing, together with sectors, industries,
                                    markets and groups (Tools-&gt;Update US symbol
                                    list and categories). This is implemented
                                    using new #import command and new ASCII importer
                                    commands (see below for the details) </li>
                                  <li>UI: custom tools menu - added special internal
                                    command #import that allows to import ASCII
                                    files from local disk or even from remote
                                    (web) sources. In the Tools-&gt;Customize, &quot;Tools&quot; page,
                                    you can now define custom tool that uses
                                    new #import command<br>
    Command: #import<br>
    Arguments: URL to download data from <br>
    Initial dir: path to format definition file</li>
                                  <li>UI: custom tools menu - when an error occurs
                                    during launching of external command appropriate
                                    error message is displayed (instead of nothing
                                    like in old versions)</li>
                                  <li>DB: The support for Industry Classification
                                    Benchmark (ICB) category system added (See
                                    icb.txt file for definitions)</li>
                                  <li> OLE: Stock object has new property (string):
                                    ICB (read/write)</li>
                                  <li>ASCII importer: support for importing sector/industry
                                    scheme and assignments by name (new SECTORNAME
                                    and INDUSTRYNAME fields in $FORMAT command) </li>
                                  <li>ASCII importer: new command $CLEARSECTORS
                                    1 to wipe existing sector / industry structure. </li>
                                  <li>ASCII importer: new $SORTSECTORS command
                                    to sort existing sector/industry structure. <br>
    $SORTSECTORS 1 - sort case sensitive, without touching sector/industry ==
    0 (undefined sector/undefined industry)<br>
    $SORTSECTORS 2 - sort case sensitive, all defined sectors/industries <br>
    $SORTSECTORS 3 - sort case insensitive, without touching sector/industry
    == 0 (undefined sector/undefined industry)<br>
    $SORTSECTORS 4 - sort case insensitive, all defined sectors/industries </li>
                                  <li>ASCII importer: crash could occur if required
                                    numeric arguments for some commands were
                                    missing. Fixed.</li>
                                  <li>ASCII importer: added support for ICB import:
                                    ICB field added to $FORMAT command and added
                                    $ICB command<br>
        <br>
    For example ICB assignments for NYSE can be imported from this site:<br>
    http://www.nyse.com/indexes/nyaindex.csv
    <p>(to import use this format def)<br>
      $FORMAT FullName, Ticker, Skip, ICB, Skip, Skip, Skip, Skip <br>
      $SKIPLINES 2<br>
      $SEPARATOR ,<br>
      $CONT 1<br>
      $GROUP 255<br>
      $AUTOADD 1<br>
      $NOQUOTES 1</p>
                                  </li>
                                  <li>ASCII importer: numeric field data may
                                    be enclosed in double quotation marks and
                                    still properly interpreted as numbers now.</li>
                                  <li>AFL: SetChartOptions did not allow to overwrite
                                    miny/maxy in 5.51-5.57. Fixed.</li>
                                  <li>AFL: CategoryGetSymbols, CategoryGetName,
                                    CategorySetName, CategoryAddSymbol, CategoryRemoveSymbol,
                                    CategoryFind updated to support categoryICB
                                    (new constant = 8)</li>
                                  <li>AFL: added InIcb() and IcbID() functions</li>
                                  <li>AFL: Added Status(&quot;lastbartimeleftrt&quot;)
                                    - it works like &quot;lastbartimeleft&quot; but
                                    uses the most recent RT stream update time
                                    instead of Now(). Also added Status(&quot;lastrtupdate&quot;)
                                    - time of last RT stream update<br>
    Depends on RT plugin to deliver correct DateUpdate / TimeUpdate data.<br>
    If plugin or date source sends incorrect datetimestamps or does not send
    DateUpdate/TimeUpdate correctly this function will not operate properly.<br>
    Note that most data sources send weird (not current) datetime stamps on weekends.
    Also IQFeed plugin sends DateUpdate/TimeUpdate only inside regular trading
    hours </li>
                                  <li>UI: Interval combo box was not updated
                                    after changing preferences / intraday / custom
                                    interval settings. Fixed.</li>
                                  <li>Analysis: when optimization is stopped,
                                    Optimize() returned NON-default value when
                                    Status(&quot;action&quot;)==actionPortfolio
                                    in subsequent backtest. Fixed<br>
        <br>
                                  </li>
                                </ul>
                                <p><strong>CHANGES FOR VERSION 5.57.1 (as compared
                                    to 5.57.0)</strong></p>
                                <ul>
                                  <li>When real-time quotes were streaming interval
                                    combo refreshed too often making it hard
                                    to enter new interval in 5.57.0. Fixed.</li>
                                  <li>Entering custom interval in the combo did
                                    not always work correctly for floating windows
                                    in 5.57.0. Fixed.<br>
                                  </li>
                                </ul>
                                <p><strong>CHANGES FOR VERSION 5.57.0 (as compared
                                    to 5.56.0)</strong></p>
                                <ul>
                                  <li>Charts/UI: now there is a new chart interval
                                    combo box that allows to either select predefined
                                    interval OR simply type ANY interval you
                                    want without the need to define it in the
                                    preferences<br>
    Supported interval codes are:<br>
    Y - yearly, Q - quarterly, M - monthly, W - weekly, D - daily, N - day/night,<br>
    h - hourly, m -minute (note lowercase m), s - second, T - tick, R - range,
    V.
    <p>D, h, m, s, T, R, V intervals can be preceded by a number. So if you type
      15m it means 15 minute chart,<br>
      if you type 13T it means 13 tick chart, if you type 200R it means 200R
      (range) chart. <br>
      If you type just a number (x) without the following letter it will treat
      it as x-minute chart.<br>
        <br>
      Note that while AmiBroker is trying to keep layout files backward compatible,
      attempt to load the layout that uses 'new' interval that is not present
      in defined set into *old* (pre-5.57) version will result in this extra
      interval being replaced by simply daily chart.</p>
                                  </li>
                                  <li> Tools-&gt;Auto update quotes is now native
                                    command (not a 'custom tool' as it was)<br>
    This change was caused by the fact that custom tools menu is stored in HKEY_CURRENT_USER
    registry key that is shared between 32-bit and 64-bit version.<br>
    That caused that if both 32-bit and 64-bit versions were installed an unmatching
    bitness version of AmiQuote could be launched and that in turn<br>
    caused problems because in Windows OS 64-bit automation first calls 64-bit
    server and only in absense of it tries 32-bit. So if both versions were installed<br>
    only one was updated properly (the last one installed) using &quot;Auto-update&quot; command.<br>
    Having this command native ensures that proper bitness version is launched
    so 32-bit and 64-bit versions of AmiBroker can be updated with appropriate
    corresponding versions of AmiQuote.<br>
                                  </li>
                                  <li>Default &quot;X grid spacing&quot; changed
                                    to 50 (from original 60) pixels<br>
                                  </li>
                                  <li>12 hour X grid spacing replaced by 6 hour</li>
                                </ul>
                                <p><strong>CHANGES FOR VERSION 5.56.0 (as compared
                                    to 5.55.1)</strong></p>
                                <ul>
                                  <li>New Analysis: A new walk-forward summary
                                    report that covers all out-of-sample steps<br>
    There were significant changes to walk forward testing made to allow summary
    out-of-sample report.<br>
    The most important change is that each subsequent out-of-sample test uses
    initial equity equal to previous step ending equity.<br>
    (Previously it used constant initial equity).<br>
    This change is required for proper calculation of all statistics/metrics
    throughout all sections of out-of-sample test.
    <p>Summary report shows the note that built-in metrics correctly represent
      all out-of-sample steps <br>
      but summary custom metrics are composed using user-definable method:<br>
      1 first step value, 2 last step value, 3 sum, 4 average, 5 minimum, 6 maximum.</p>
    <p>By default summary report shows last step value of custom metrics UNLESS
      user specifies different combining method in<br>
      bo.AddCustomMetrics() call. bo.AddCustomMetrics has now new optional parameter
      - CombineMethod</p>
    <p>bool AddCustomMetric( string Title, variant Value, [optional] variant
      LongOnlyValue, [optional] variant ShortOnlyValue , [optional] variant DecPlaces
      = 2, [optional] variant CombineMethod = 2 )</p>
    <p> This method adds custom metric to the backtest report, backtest &quot;summary&quot; and
      optimization result list. Title is a name of the metric to be displayed
      in the report, Value is the value of the metric, optional arguments LongOnlyValue,
      ShortOnlyValue allow to provide values for additional long/short-only columns
      in the backtest report. Last argument DecPlaces controls how many decimal
      places should be used to display the value.</p>
    <p>Supported CombineMethod values are:<br>
      1 first step value, - summary report will show the value of custom metric
        from very first out-of-sample step<br>
      2 last step value (default), - summary report will show the value of custom
      metric from the last out-of-sample step<br>
      3 sum, - summary report will show the sum of the values of custom metric
      from all out of sample steps<br>
      4 average, - summary report will show the average of the values of custom
      metric from all out of sample steps<br>
      5 minimum, - summary report will show the smallest value of custom metric
      from all out of sample steps<br>
      6 maximum.- summary report will show the largest value of custom metric
      from all out of sample steps</p>
    <p>Note that certain metrics calculation methods are complex and for example
      averaging them would not lead to mathematically correct representation
      of all out of sample test.<br>
      Summaries of all built-in metrics are mathematically correct out-of-the-box
      (i.e. they are *not* averages, but properly calculated metrics using method
      that is appropriate for given value). This contrasts with custom metrics,
      because they are user-definable and it is up to the user to select 'combining'
      method, and still it may happen that none of the available methods is appropriate.<br>
      For that reason the report includes the note that explains what user-definable
      method was used to combine custom metrics.<br>
    </p>
                                  </li>
                                  <li>New Analysis: walk forward procedure now
                                    produces detailed reports for every out-of-sample
                                    step</li>
                                  <li>Enhanced backtest report: color-coding
                                    'good' and 'bad' values in backtest report<br>
    Some of the metrics in the backtest report are color-coded. <br>
    Blue means &quot;neutral&quot;, Green means &quot;good&quot;, Red means &quot;bad&quot;<br>
    Metrics that are not colorized are always black<br>
    This color coding is of course arbitrary and should be used as guideance
    only.<br>
    Treat 'red' as a warning flag and advice to check the value in detail.
    <p>As of now the following metrics are colorized:<br>
      Net Profit, Net Profit % - bad &lt; 0, good &gt; 0<br>
      Annual Profit %, bad &lt; 0, neutral betwen 0 and 10, good &gt; 10<br>
      RAR % bad &lt; 0, good &gt; (10 / Exposure)<br>
      Avg. Profit/Loss all trades (Expectancy $) - bad &lt; 0, good &gt; 0<br>
      Avg Profit/Loss % all trades (Expectancy %) - bad &lt; 0, good &gt; 0<br>
      Max. system % drawdown - bad: dd worse than -30%, neutral: dd between -30
      and -10%, good - -10% to 0%<br>
      CAR/MaxDD, RAR/MaxDD - bad &lt; 1, neutral between 1 and 2, good &gt; 2<br>
      Recovery factor - bad &lt; 1, neutral between 1 and 2, good &gt; 2<br>
      Payoff ratio - bad &lt; 1, neutral between 1 and 2, good &gt; 2<br>
    </p>
                                  </li>
                                  <li>Report: a note added to tooltips for Sharpe
                                    ratio and UPI metrics telling where user
                                    can change risk-free rates for those metrics</li>
                                  <li>Report Explorer 1.0.2 - added alternate
                                    row background color</li>
                                  <li>Removed &quot;00:00:00&quot; time in the &quot;date
                                    from&quot; in the backtest report / settings
                                    page</li>
                                  <li>Param window: clicking on category that
                                    had exactly same name as parameter resulted
                                    in changing parameter value. Fixed.</li>
                                  <li>Analysis: all custom metrics were treated
                                    as numbers (for example got formatted with
                                    thousand separator). Now AmiBroker custom
                                    metrics of string type are treated as strings
                                    and do not get any extra formatting for the
                                    display.</li>
                                  <li>Added recommendation to activate multithreading
                                    to the performance warning tooltip when multithreading
                                    is currently turned OFF. <br>
                                  </li>
                                </ul>
                                <p><strong>CHANGES FOR VERSION 5.55.1 (as compared
                                    to 5.54.0)</strong></p>
                                <ul>
                                  <li>Random characters could appear in list
                                    view clipboard copy in 5.55.0. Fixed (5.55.1).</li>
                                  <li>_SECTION_BEGIN/_SECTION_END/_PARAM_VALUES
                                    appeared twice in auto-complete listbox.
                                    Fixed.</li>
                                  <li>SetOption(&quot;PortfolioReportMode&quot;,
                                    x ) changed exploration columns too. Fixed.
                                    (bmg#92)</li>
                                  <li>AFL: new function GetAsyncKeyState( vkey
                                    )<br>
    GetAsyncKeyState is 100% equivalent of Windows API function of the same name.<br>
    See: http://msdn.microsoft.com/en-us/library/windows/desktop/ms646293(v=vs.85).aspx
    <p>The function queries current state of keyboard keys (at the time of the
      call).</p>
    <p>vkey is virtual key code to query (see table below).<br>
      The function returns 0 if key is NOT pressed and value &lt; 0 ( less than
      zero) when key is currently pressed.</p>
    <p>Example:<br>
        <CODE><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( <B>C</B>, </FONT><FONT COLOR=#800080>"Close"</FONT><FONT COLOR=#000000>, <B>colorRed</B> ); <BR>
      vk_Shift = </FONT><FONT COLOR=#800080>16</FONT><FONT COLOR=#000000>; <BR>
      </FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( <font color="#0000FF">GetAsyncKeyState</font>(
      vk_Shift ) &lt; </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000> ) </FONT><FONT COLOR=#000000><B>Title</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#800080>"Shift
      is pressed"</FONT><FONT COLOR=#000000>; <BR>
          </FONT></CODE></p>
    <p>Virtual Key codes:</p>
    <p>vk_BackSpace = 8; <br>
      vk_Tab = 9; <br>
      vk_Return = 13;<br>
      vk_Shift = 16; <br>
      vk_Control = 17;<br>
      vk_Alt = 18; <br>
      vk_Pause = 19; <br>
      vk_CapsLock = 20;<br>
      vk_Escape = 27; <br>
      vk_Space = 32; <br>
      vk_PageUp = 33;<br>
      vk_PageDown = 34; <br>
      vk_End = 35; <br>
      vk_Home = 36;<br>
      vk_Left = 37; <br>
      vk_Up = 38; <br>
      vk_Right = 39;<br>
      vk_Down = 40; <br>
      vk_PrintScreen = 44; <br>
      vk_Insert = 45;<br>
      vk_Delete = 46; </p>
    <p>/* NOTE: vk_0..vk_9 vk_A.. vk_Z match regular ASCII codes for digits and
      A-Z letters */</p>
    <p>vk_0 = 48; <br>
      vk_1 = 49; <br>
      vk_2 = 50;<br>
      vk_3 = 51; <br>
      vk_4 = 52; <br>
      vk_5 = 53;<br>
      vk_6 = 54; <br>
      vk_7 = 55; <br>
      vk_8 = 56;<br>
      vk_9 = 57; <br>
      vk_A = 65; <br>
      vk_B = 66; <br>
      vk_C = 67;<br>
      vk_D = 68; <br>
      vk_E = 69; <br>
      vk_F = 70;<br>
      vk_G = 71; <br>
      vk_H = 72; <br>
      vk_I = 73;<br>
      vk_J = 74; <br>
      vk_K = 75; <br>
      vk_L = 76;<br>
      vk_M = 77; <br>
      vk_N = 78; <br>
      vk_O = 79;<br>
      vk_P = 80; <br>
      vk_Q = 81; <br>
      vk_R = 82;<br>
      vk_S = 83; <br>
      vk_T = 84; <br>
      vk_U = 85;<br>
      vk_V = 86; <br>
      vk_W = 87; <br>
      vk_X = 88;<br>
      vk_Y = 89; <br>
      vk_Z = 90; <br>
    </p>
    <p>vk_LWin = 91; <br>
      vk_RWin = 92; <br>
      vk_Apps = 93; <br>
      /* numerical key pad */<br>
      vk_NumPad0 = 96; <br>
      vk_NumPad1 = 97; <br>
      vk_NumPad2 = 98;<br>
      vk_NumPad3 = 99; <br>
      vk_NumPad4 = 100; <br>
      vk_NumPad5 = 101;<br>
      vk_NumPad6 = 102; <br>
      vk_NumPad7 = 103; <br>
      vk_NumPad8 = 104;<br>
      vk_NumPad9 = 105; <br>
      vk_Multiply = 106; <br>
      vk_Add = 107;<br>
      vk_Subtract = 109; <br>
      vk_Decimal = 110; <br>
      vk_Divide = 111;<br>
      /* function keys */<br>
      vk_F1 = 112; <br>
      vk_F2 = 113; <br>
      vk_F3 = 114;<br>
      vk_F4 = 115; <br>
      vk_F5 = 116; <br>
      vk_F6 = 117;<br>
      vk_F7 = 118; <br>
      vk_F8 = 119; <br>
      vk_F9 = 120;<br>
      vk_F10 = 121; <br>
      vk_F11 = 122; <br>
      vk_F12 = 123;<br>
      vk_F13 = 124; <br>
      vk_F14 = 125; <br>
      vk_F15 = 126;<br>
      vk_F16 = 127; <br>
      <br>
      vk_NumLock = 144; <br>
      vk_ScrollLock = 145; <br>
      vk_LShift = 160; <br>
      vk_RShift = 161; <br>
      vk_LControl = 162; <br>
      vk_RControl = 163; <br>
      vk_LAlt = 164;<br>
      vk_RAlt = 165; <br>
      vk_SemiColon = 186;<br>
      vk_Equals = 187; <br>
      vk_Comma = 188; <br>
      vk_UnderScore = 189;<br>
      vk_Period = 190; <br>
      vk_Slash = 191; <br>
      vk_BackSlash = 220;<br>
      vk_RightBrace = 221; <br>
      vk_LeftBrace = 219; <br>
      vk_Apostrophe = 222;</p>
                                  </li>
                                  <li>AFL: Status() function supports new fields &quot;lastbarend&quot;, &quot;lastbartimeleft&quot;, &quot;timeshift&quot;<br>
    Status(&quot;lastbarend&quot;) returns DateTime of the end of last bar. For
    example 5 -minute bar at 9:00 will have end time of 9:04:59 (works for time-based
    bars only)<br>
    Status(&quot;timeshift&quot;) returns database timeshift expressed in seconds<br>
    Status(&quot;lastbartimeleft&quot;) returns number of seconds to the completion
    of current last bar. Works for time-based bars only. Note that for proper
    operation this requires database timeshift to be set properly (so dates displayed
    on chart match your local computer time zone).<br>
                                  </li>
                                  <li>List view clipboard copy now uses regional
                                    settings decimal separator. <br>
    You can turn it off and revert to &quot;always dot&quot; decimal separator
    by creating registry key<br>
    HKEY_CURRENT_USER\TJP\Broker\Settings<br>
    DWORD value &quot;UseLocaleForClipboard&quot; = 0<br>
                                  </li>
                                  <li>Charting: added left- and right extend
                                    option to the rectagle drawing tool</li>
                                  <li>List view date column sort was incorrect
                                    when regional settings time format was set
                                    to: H:mm:ss. Fixed.</li>
                                  <li>When multithreading in charts was turned
                                    OFF, drawing tools did not work properly
                                    in 5.53-5.54. Fixed.</li>
                                  <li>XYChartAddPoint does not generate error
                                    anymore when Null values are passed as X,
                                    Y co-ords. Instead it silently ignores such
                                    points (they are not plotted) and XYChartAddPoint
                                    returns FALSE (0) </li>
                                  <li>AFL: new function StaticVarInfo( &quot;varname&quot;, &quot;field&quot; )<br>
    StaticVarInfo( &quot;varname&quot;, &quot;field&quot;) - provides information
    about static variables<br>
&quot; varname&quot; - is a variable name. It can be also a wildcard template
such as &quot;myvariable*&quot; and then it means that AmiBroker will search
for all variables beginning with<br>
&quot; myvariable&quot;. * character matches any string, ? matches any single
character
    <p>Supported &quot;field&quot; values are:<br>
&quot; list&quot; - returns the list of static variables<br>
&quot; memory&quot; - returns memory usage in bytes (not including memory used
for variable name itself)<br>
&quot; totalmemory&quot; - returns memory usage in bytes (including memory used
for variable name)</p>
    <p>Example:</p>
    <p><CODE><FONT COLOR=#0000ff>StaticVarSet</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"my_array1"</FONT><FONT COLOR=#000000>, <B>Close</B> ); <BR>
      </FONT><FONT COLOR=#0000ff>StaticVarSet</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"my_array2"</FONT><FONT COLOR=#000000>, <B>Close</B> ); <BR>
      </FONT><FONT COLOR=#0000ff>StaticVarSet</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"my_scalar"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>12</FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#0000ff>StaticVarSetText</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"my_text"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"Text123456"</FONT><FONT COLOR=#000000> ); <BR>
      <BR>
      </FONT><FONT COLOR=#800080>"All variables in memory: "</FONT><FONT COLOR=#000000> + <font color="#0000FF">StaticVarInfo</font>( </FONT><FONT COLOR=#800080>"*"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"list"</FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#800080>" Total static var memory: "</FONT><FONT COLOR=#000000> + <font color="#0000FF">StaticVarInfo</font>( </FONT><FONT COLOR=#800080>"*"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"totalmemory"</FONT><FONT COLOR=#000000>); <BR>
      </FONT><FONT COLOR=#800080>" Only my_ variables: "</FONT><FONT COLOR=#000000> + <font color="#0000FF">StaticVarInfo</font>( </FONT><FONT COLOR=#800080>"my_*"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"list"</FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#800080>" Memory 2 arrays (bytes): "</FONT><FONT COLOR=#000000> + <font color="#0000FF">StaticVarInfo</font>( </FONT><FONT COLOR=#800080>"my_array*"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"memory"</FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#800080>" Memory scalar (bytes): "</FONT><FONT COLOR=#000000> + <font color="#0000FF">StaticVarInfo</font>( </FONT><FONT COLOR=#800080>"my_scalar"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"memory"</FONT><FONT COLOR=#000000> ); <BR>
    </FONT><FONT COLOR=#800080>" Memory text (bytes): "</FONT><FONT COLOR=#000000> + <font color="#0000FF">StaticVarInfo</font>( </FONT><FONT COLOR=#800080>"my_text"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"memory"</FONT><FONT COLOR=#000000> );</FONT></CODE></p>
    <br>
                                  </li>
                                </ul>
                                <p><strong>CHANGES FOR VERSION 5.54.0 (as compared
                                    to 5.53.1)</strong></p>
                                <ul>
                                  <li>New Analysis: &quot;Sync chart on select&quot; did
                                    not respect linked charts and symbol lock.
                                    Fixed.</li>
                                  <li>AFL: new function XYChartSetAxis( &quot;chartname&quot;, &quot;x-axis
                                    name&quot;, &quot;y-axis name&quot; )</li>
                                  <li>AFL: new function XYChartAddPoint( &quot;chartname&quot;, &quot;text&quot;,
                                    x, y, color )</li>
                                  <li>New Analysis: Implemented XY (scatter)
                                    charts in Explorations<br>
    Example:<br>
    <br>
    <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#008000>// XY chart coding example</FONT><FONT COLOR=#000000> <BR>
    </FONT><FONT COLOR=#008000>// This formula generates 2 X-Y scatter charts
    that display relationship between</FONT><FONT COLOR=#000000> <BR>
        </FONT><FONT COLOR=#008000>// final trade profit and MFE and MAE</FONT><FONT COLOR=#000000> <BR>
        <BR>
        </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#0000ff>Cross</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>MACD</FONT><FONT COLOR=#000000>(), </FONT><FONT COLOR=#0000ff>Signal</FONT><FONT COLOR=#000000>()); <BR>
        </FONT><FONT COLOR=#000000><B>Sell</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#0000ff>Cross</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>Signal</FONT><FONT COLOR=#000000>(), </FONT><FONT COLOR=#0000ff>MACD</FONT><FONT COLOR=#000000>()
        ); <BR>
        </FONT><FONT COLOR=#000000><B>Short</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#000000><B>False</B></FONT><FONT COLOR=#000000>; <BR>
        </FONT><FONT COLOR=#000000><B>Cover</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#000000><B>False</B></FONT><FONT COLOR=#000000>; <BR>
        <BR>
    Eq = </FONT><FONT COLOR=#0000ff>Equity</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
    single-security equity&nbsp;&nbsp;this evaluates stops (if you use them)
    and removes extra signals </FONT><FONT COLOR=#000000> <BR>
        <BR>
    Entry = </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#000000><B>OR</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#000000><B>Short</B></FONT><FONT COLOR=#000000>; <BR>
    EqAtEntry = </FONT><FONT COLOR=#0000ff>ValueWhen</FONT><FONT COLOR=#000000>(
    Entry, Eq ); <BR>
    Profit = </FONT><FONT COLOR=#800080>100</FONT><FONT COLOR=#000000> * ( Eq
    - EqAtEntry ) / EqAtEntry; </FONT><FONT COLOR=#008000>// percent profit</FONT><FONT COLOR=#000000> <BR>
        <BR>
        </FONT><FONT COLOR=#008000>// MAE and MFE below use CLOSING equity, MAE
        and MFE in the report use high/low price</FONT><FONT COLOR=#000000> <BR>
    MAE = </FONT><FONT COLOR=#800080>100</FONT><FONT COLOR=#000000> * ( </FONT><FONT COLOR=#0000ff>LowestSince</FONT><FONT COLOR=#000000>(
    Entry, Eq ) - EqAtEntry ) / EqAtEntry; </FONT><FONT COLOR=#008000>// percent
    MAE </FONT><FONT COLOR=#000000> <BR>
    MFE = </FONT><FONT COLOR=#800080>100</FONT><FONT COLOR=#000000> * ( </FONT><FONT COLOR=#0000ff>HighestSince</FONT><FONT COLOR=#000000>(
    Entry, Eq ) - EqAtEntry ) / EqAtEntry; </FONT><FONT COLOR=#008000>// percent
    MAE </FONT><FONT COLOR=#000000> <BR>
        <BR>
    bi = </FONT><FONT COLOR=#0000ff>BarIndex</FONT><FONT COLOR=#000000>(); <BR>
    <BR>
    Len = bi - </FONT><FONT COLOR=#0000ff>ValueWhen</FONT><FONT COLOR=#000000>(
    Entry, bi ); <BR>
        <BR>
    EntryPrice = </FONT><FONT COLOR=#0000ff>ValueWhen</FONT><FONT COLOR=#000000>(
    Entry, </FONT><FONT COLOR=#000000><B>BuyPrice</B></FONT><FONT COLOR=#000000> ); <BR>
        </FONT><FONT COLOR=#008000>// if you prefer MAE/MFE using high/low price </FONT><FONT COLOR=#000000> <BR>
        </FONT><FONT COLOR=#008000>// uncomment the lines below (long only Version)</FONT><FONT COLOR=#000000> <BR>
    MAE = </FONT><FONT COLOR=#800080>100</FONT><FONT COLOR=#000000> * ( </FONT><FONT COLOR=#0000ff>LowestSince</FONT><FONT COLOR=#000000>(
    Entry, </FONT><FONT COLOR=#000000><B>Low</B></FONT><FONT COLOR=#000000> )
    - EntryPrice ) / EntryPrice ; </FONT><FONT COLOR=#008000>// percent MAE using
    low</FONT><FONT COLOR=#000000> <BR>
    MFE = </FONT><FONT COLOR=#800080>100</FONT><FONT COLOR=#000000> * ( </FONT><FONT COLOR=#0000ff>HighestSince</FONT><FONT COLOR=#000000>(
    Entry, </FONT><FONT COLOR=#000000><B>High</B></FONT><FONT COLOR=#000000> )
    - EntryPrice ) / EntryPrice ; </FONT><FONT COLOR=#008000>// percent MAE using
    high</FONT><FONT COLOR=#000000> <BR>
        <BR>
    Exit = </FONT><FONT COLOR=#000000><B>Sell</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#000000><B>OR</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#000000><B>Cover</B></FONT><FONT COLOR=#000000>; <BR>
    dt = </FONT><FONT COLOR=#0000ff>DateTime</FONT><FONT COLOR=#000000>(); <BR>
    Clr = </FONT><FONT COLOR=#0000ff>ColorHSB</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"stocknum"</FONT><FONT COLOR=#000000>), </FONT><FONT COLOR=#800080>255</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>255</FONT><FONT COLOR=#000000> ); <BR>
    </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>( bar = </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>;
    bar &lt; </FONT><FONT COLOR=#000000><B>BarCount</B></FONT><FONT COLOR=#000000>;
    bar++ ) <BR>
    { <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>(
Exit[ bar ] ) <BR>
&nbsp;&nbsp; { <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>// item text consists
of two parts</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>// first part
(before \t) is a item name displayed immediatelly on XY chart</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>// second part
(after \t) is a tooltip hint text that is displayed in the tooltip</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>// when you hover
on given item</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>// here we will
only use hint text</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; HintText = </FONT><FONT COLOR=#800080>"\t"</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#0000ff>Name</FONT><FONT COLOR=#000000>()+</FONT><FONT COLOR=#800080>"@"</FONT><FONT COLOR=#000000>+ </FONT><FONT COLOR=#0000ff>DateTimeToStr</FONT><FONT COLOR=#000000>(
dt[ bar ] ); <BR>
        <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">XYChartAddPoint</font>( </FONT><FONT COLOR=#800080>"Profit
vs MAE"</FONT><FONT COLOR=#000000>, HintText, MAE[ bar ], Profit[ bar ],Clr ); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">XYChartAddPoint</font>( </FONT><FONT COLOR=#800080>"Profit
vs MFE"</FONT><FONT COLOR=#000000>, HintText, MFE[ bar ], Profit[ bar ], Clr
); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <font color="#0000FF">XYChartAddPoint</font>( </FONT><FONT COLOR=#800080>"Profit
vs trade length"</FONT><FONT COLOR=#000000>, HintText, Len[ bar ], Profit[ bar
], Clr ); <BR>
&nbsp;&nbsp;&nbsp; } <BR>
    } <BR>
    <BR>
    <font color="#0000FF">XYChartSetAxis</font>( </FONT><FONT COLOR=#800080>"Profit
    vs MAE"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"[MAE]"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"[Profit]"</FONT><FONT COLOR=#000000> ); <BR>
    <font color="#0000FF">XYChartSetAxis</font>( </FONT><FONT COLOR=#800080>"Profit
    vs MFE"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"[MFE]"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"[Profit]"</FONT><FONT COLOR=#000000> ); <BR>
    <font color="#0000FF">XYChartSetAxis</font>( </FONT><FONT COLOR=#800080>"Profit
    vs trade length"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"[Length]"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"[Profit]"</FONT><FONT COLOR=#000000>&nbsp;&nbsp;); <BR>
    <BR>
    <BR>
    <B>Filter</B> = Exit; <BR>
    </FONT><FONT COLOR=#0000ff>AddColumn</FONT><FONT COLOR=#000000>( Eq, </FONT><FONT COLOR=#800080>"Equity"</FONT><FONT COLOR=#000000> ); <BR>
    </FONT><FONT COLOR=#0000ff>AddColumn</FONT><FONT COLOR=#000000>( Profit, </FONT><FONT COLOR=#800080>"Profit"</FONT><FONT COLOR=#000000> ); <BR>
    </FONT><FONT COLOR=#0000ff>AddColumn</FONT><FONT COLOR=#000000>( MAE, </FONT><FONT COLOR=#800080>"MAE"</FONT><FONT COLOR=#000000> ); <BR>
    </FONT><FONT COLOR=#0000ff>AddColumn</FONT><FONT COLOR=#000000>( MFE, </FONT><FONT COLOR=#800080>"MFE"</FONT><FONT COLOR=#000000> ); <BR>
    </FONT><FONT COLOR=#0000ff>AddColumn</FONT><FONT COLOR=#000000>( Len, </FONT><FONT COLOR=#800080>"trade
    length"</FONT><FONT COLOR=#000000> );</FONT></CODE><br>
                                  </li>
                                  <li>{{INTERVAL}} gave incorrect (unstable)
                                    results in custom n-tick/n-range/n-volume
                                    charts when used with multithreading. Fixed.</li>
                                  <li>Interval(2) returned incorrect (unstable)
                                    results in custom n-tick/n-range/n-volume
                                    charts when used with multithreading. Fixed.</li>
                                  <li>Preferences: Currency page was not working
                                    properly. Fixed.</li>
                                  <li>Status bar look matches now appearance
                                    settings (esp. visible in VS2012 style)</li>
                                  <li>Parameter window now allows to select combined
                                    styles (like styleHidden) as well as their
                                    components styleNoRescale+styleNoDraw independently</li>
                                  <li>User setting for minimum pixel spacing
                                    in X grid (Tools-&gt;Preferences, &quot;Axes
                                    / Grids&quot;) - it is recommended to keep
                                    it at default value (60 pixels), for denser
                                    grid use less spacing (minimum 30 pixels),
                                    for wider grid use more x spacing (maximum
                                    120 pixels)</li>
                                  <li>Sometimes panes did not refresh to final
                                    size when chart sheets are switched (for
                                    example - one tab has only one pane second
                                    tab has two panes). Fixed.<br>
                                  </li>
                                </ul>
                                <p><strong>CHANGES FOR VERSION 5.53.1 (as compared
                                    to 5.53.0)</strong></p>
                                <ul>
                                  <li>Trend lines and other drawing tools sometimes
                                    were blinking or disappeared in 5.53.0. Fixed</li>
                                  <li>Plots with styleDashed mixed with plots
                                    using other styles could cause continuous
                                    growth of rendering time in 5.52/5.53. Fixed.<br>
                                  </li>
                                </ul>
                                <p><strong>CHANGES FOR VERSION 5.53.0 (as compared
                                    to 5.52.0)</strong></p>
                                <ul>
                                  <li>Triangle drawing tool now supports filled
                                    interiors</li>
                                  <li>Vertical selector line was flicerking with
                                    RT update when more than one chart window
                                    was open. Fixed</li>
                                  <li>SetChartGradientFill renamed to SetGradientFill</li>
                                  <li>SetGradientFill now has 2 more arguments:
                                    baseline and baselinecolor. Allows reverse
                                    gradient chart (such as underwater equity)
                                    and 3 color gradients top-&gt;baseline-&gt;bottom</li>
                                  <li>Added 2-year and 5-year x grid spacing</li>
                                  <li>Gradient chart sometimes disappeared when
                                    null values were in the data set and chart
                                    was zoomed out to the maximum. Fixed.</li>
                                  <li>GUI: Preferences dialog adjustments (moved &quot;bold&quot; checkbox
                                    in color page, removed obsolete &quot;show
                                    vertical line&quot; boxes in charting page,
                                    moved candlestick outline color settings
                                    from charting to color page )</li>
                                  <li>styleClipMinMax interferred with styleGradient
                                    in 5.52.0. Fixed (both styles can now be
                                    used independently as well as combined together)<br>
                                  </li>
                                </ul>
                                <p><strong>CHANGES FOR VERSION 5.52.0 (as compared
                                    to 5.51.2)</strong></p>
                                <ul>
                                  <li>Chart themes implemented, featuring new
                                    look, new grid settings, new background gradient
                                    fills, predefined themes for more details
                                    see: http://www.amibroker.com/guide/h_themes.html</li>
                                  <li>Charts: X-axis algorithm rewritten (now
                                    it is clearer and prevents overcrowded/unreadable
                                    X labels)</li>
                                  <li>Charts: added native gradient area charts.
                                    Gradient chart is obtained using styleGradient.
                                    Upper gradient color is specified by color
                                    parameter in Plot() function, bottom gradient
                                    color is either background color or can be
                                    defined using SetChartGradientFill function.
                                    styleGradient can be combined with styleLine<br>
      <br>
    Example<br>
    <CODE><FONT COLOR=#0000FF>SetChartGradientFill</FONT><FONT COLOR=#000000>( <B>colorLightOrange</B>, <B>colorPaleGreen</B> );</FONT><br>
    <FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( <B>C</B>, </FONT><FONT COLOR=#800080>"Close"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>ColorBlend</FONT><FONT COLOR=#000000>( <B>colorPaleGreen</B>, <B>colorBlack</B> ), <strong>styleGradient</strong> | <B>styleLine</B>, <B>Null</B>, <B>Null</B>, </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>,
    -</FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> );</FONT></CODE><br>
                                  </li>
                                  <li>Charts: Plot/PlotForeign/PlotOHLC now adds
                                    extra parameter &quot;width&quot; that controls
                                    the width of the line. Positive values specify
                                    PIXEL width, negative values specify width
                                    in percent of current bar width. So for example
                                    -20 will give you dynamic width that is 20%
                                    of bar width. Example:<br>
      <CODE><FONT COLOR=#000000> </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( <B>C</B>, </FONT><FONT COLOR=#800080>"Close"</FONT><FONT COLOR=#000000>, <B>colorBlack</B>, <B>styleBar</B>, <B>Null</B>, <B>Null</B>, </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>,
      -</FONT><FONT COLOR=#800080>20</FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#008000>/*
      line width as percent of bar */</FONT><FONT COLOR=#000000> ); <br>
    </FONT></CODE> </li>
                                  <li>Eliminated build-up of rendering times
                                    caused by growing of MFC temporary GDI object
                                    maps in non-UI threads. Now rendering engine
                                    uses direct WINAPI calls without MFC</li>
                                  <li>View-&gt;Filtering menu was disabled in
                                    5.51.x. Fixed</li>
                                  <li>Data window was not working in 5.51.x.
                                    Fixed</li>
                                  <li>&quot; Show middle lines&quot; = &quot;NO&quot; causes
                                    date axis to be moved down outside visible
                                    area. Fixed.</li>
                                  <li>Selector line was not working correctly
                                    in 5.51. Fixed.</li>
                                  <li>Bold dotted trendline did not work in 5.51
                                    BETA. Fixed</li>
                                  <li>AFL: LinearReg/LinRegSlope/LinRegIntercept/TSF/StdError
                                    display proper error message when user passes
                                    negative (wrong) parameter</li>
                                  <li>Study tooltip information now includes
                                    also number of bars between start and end
                                    of the trendline</li>
                                  <li>New Analysis: saving last column layout
                                    works better</li>
                                  <li>Account manager: Edit-&gt;Undo menu was
                                    missing. Fixed.</li>
                                  <li>GetFnData() now supports retrieving &quot;Address&quot; field
                                    too</li>
                                  <li>On Win98 and above drawing engine uses
                                    DC_PEN/DC_BRUSH for speed</li>
                                  <li>Optimize() reduced possibility of IEEE
                                    floating point accumulation errors with steps &lt; 1
                                    (such as 0.01)</li>
                                  <li>PlotShapes() does not plot multiple times
                                    in same x/y pos anymore - it results in faster
                                    rendering when shapes overlap (large zoom
                                    outs)<br>
                                  </li>
                                </ul>
                                <p><strong>CHANGES FOR VERSION 5.51.2 (as compared
                                    to 5.51.1)</strong></p>
                                <ul>
                                  <li>PlotShapes() rendering was slower in 5.51
                                    than in 5.50. Fixed.</li>
                                  <li>Interpretation was blank with new rendering
                                    engine. Fixed.</li>
                                  <li>Charts: Quick AFL was disabled in new rendering
                                    engine causing slowdowns with &gt; 100K bars.
                                    Fixed<br>
                                  </li>
                                </ul>
                                <p><strong>CHANGES FOR VERSION 5.51.1 (as compared
                                    to 5.51.0)</strong></p>
                                <ul>
                                  <li>fix for low-level Gfx* functions causing
                                    crash when multithreaded GDI was enabled</li>
                                </ul>
                                <p><strong>CHANGES FOR VERSION 5.51.0 (as compared
                                    to 5.50.5)</strong></p>
                                <ul>
                                  <li>Charts: Multithreaded GDI implemented for
                                    super-smooth UI response and preventing GDI-intensive
                                    charts from detoriating entire UI responsiveness</li>
                                  <li>Maximum rendering time limit increased
                                    to 1000ms (1sec) when multithreaded charts
                                    + GDI are enabled (allowing 2 times more
                                    complex plots without Warning 901)</li>
                                  <li>64-bit only: eSignal plugin - first BETA
                                    version of 64-bit eSignal plugin (3.0.0)<br>
        <br>
                                  </li>
                                </ul>
                                <p><strong>CHANGES FOR VERSION 5.50.5 (as compared
                                      to 5.50.4)</strong></p>
                              <ul>
    <li>
      
        
          
            
              
                
                  
                    Newly created chart template did not save current tab when
                                    it was not switched before saving. Fixed.<br>
                      </li>
    <li>
      
        
          
            
              
                
                  
                    Notepad window is refreshed when it is brought back from invisible
                                                      tab<br>
                      </li>
    <li>
      
        
          
            
              
                
                  
                    AFL Code Wizard: sometimes
                                                                      64-bit
                      version of AFL wizard could hang on clicking &quot;AND/OR&quot; rule.
                                                                      Fixed (AFL
                      Wizard 1.0.2)<br>
                      </li>
    <li>
      
        
          
            
              
                
                  
                    Charts:  Invisible Symbol-linked charts may not
                                                                                    be properly refreshed when changing symbol (happens only when
                                                                                    not using streaming RT source). Fixed.<br>
                      </li>
    <li>
      
        
          
            
              
                
                  
                    OLE: AnalysisDoc.Run now supports mode =3 (individual backtest)<br>
                      </li>
    <li>
      
        
          
            
              
                
                  
                    AFL: Equity()/Status()/GetOption used on chart referred to
                                                                                                                    OLD AA settings instead of last run analysis (whenever it is
                      old AA or new). Now uses last run analysis settings .</li>
    <li>
      
        
          
            
              
                
                  
                    AFL: SetFormulaName did not work in New Analysis. Fixed.                </li>
  </ul>
  
    
      
        
          
            
              
                
                  <p><strong>CHANGES FOR VERSION 5.50.4 (as compared to 5.50.3)</strong></p>
                <ul>
    <li>
      
        
          
            
              
                
                  
                    New Analysis: &quot;Show arrows for actual trades&quot; sometimes
                    used date range from old AA. Fixed</li>
    <li>
      
        
          
            
              
                
                  
                    New Analysis:
                                        Individual backtest - custom metrics
                      columns would not appear if very first symbol under test
                      does not generate
                    ANY trades. Fixed.</li>
    <li>
      
        
          
            
              
                
                  
                    UI: when
                                        you float a maximized MDI window it becomes
                      little smaller so it does not
                                                                        overlap
                    MDI tabs.</li>
    <li>
      
        
          
            
              
                
                  
                    Print/Print
                                                                            
                       Preview: circle/arc/rectangle
                                                                            
                       objects outside
                                                                            
                       current view
                                                                            
                       are properly clipped
                                                                            
                    on printouts</li>
    <li>
      
        
          
            
              
                
                  
                    New
                                                                            
                       Analysis: When
                                                                            
                       user cancelled
                                                                            
                       optimization in the
                                                                            
                      
                                         middle and ran 
                                                                            
                       backtest afterwards
                                                                            
                       then
                                                                            
                       this single
                                                                            
                       follow up backtest
                                                                            
                       could
                                                                            
                       be incorrect and
                                                                            
                       required
                                                                            
                       another run to
                                                                            
                       produce correct
                                                                            
                       result again.
                                                                            
                    Fixed.</li>
    <li>
      
        
          
            
              
                
                  
                    When
                                                                            
                       timeshift != 0
                                                                            
                       then duplicate
                                                                            
                       range markers
                                                                            
                       could appear
                                                                            
                       at day boundary.
                                                                            
                    Fixed.</li>
    <li>
      
        
          
            
              
                
                  
                    Small
                                                                            
                      
                                                                            
                       rounding issue
                                                                            
                      
                                                                            
                       in ray
                                                                            
                       drawing
                                                                            
                    fixed</li>
    <li>
      
        
          
            
              
                
                  
                    When
                                                                            
                      
                                          
                                                                            
                                         multiple 
                                                                            
                       chart
                                                                            
                      
                                                                            
                       panes
                                                                            
                       were
                                                                            
                      
                                                                            
                       using
                                                                            
                       SetForeign
                                                                            
                      
                                                                            
                       on
                                                                            
                       rare
                                                                            
                      
                                                                            
                       occassions
                                                                            
                       foreign
                                                                            
                      
                                                                            
                       call
                                                                            
                       could
                                                                            
                      
                                                                            
                       fail
                                                                            
                       (return
                                                                            
                      
                                                                            
                       other
                                                                            
                       symbol
                                                                            
                      
                                                                            
                       data)
                                                                            
                       Fixed.<br>
                  </li>
  </ul>
  
    
      
        
          
            
              
                
                  <p><strong>CHANGES FOR VERSION 5.50.3 (as compared to 5.50.2)</strong></p>
                  <ul>
                    <li>New Analysis: proper symbol list refresh is triggered when
                                    composites are created or user calls SetOption(&quot;RefreshWhenCompleted,
                      True );</li>
                    <li>When settlement delay was set to zero, then interest rate
                      setting was ignored (5.46-5.50.2). Fixed.</li>
                    <li>New Analysis: Individual backtest: setting different report
                      mode took place only after second run / second symbol. Fixed.</li>
                    <li>Formulas: styleNoLabel is now default for all &quot;Band&quot; formulas
                      (Bollinger/Keltner/Percent)</li>
                    <li>Formulas: faster version of Portfolio Equity formula</li>
                    <li>Formulas: Ichimoku cloud added</li>
                    <li>TC2K/TC2KFunds plugins updated to check Wow6432Node registry
                                    key on 64-bit installations (should avoid TC2k detection
                      issue on 64-bit Windows)</li>
                    <li>PlotVAPOverlay did not draw the very last level line. Fixed.
                      Also done some cosmetic tweaks.</li>
                    <li>New Analysis: Walk forward tab table did not display custom
                      metrics. Fixed.</li>
                    <li>Ticker bar prevents from adding empty '' symbol names</li>
                    <li>Blank chart can be closed using flyout minitoolbar now</li>
                    <li>When database is empty or chart does not have properly
                                    selected symbol the information note is displayed in the
                      chart window (instead of blank chart)</li>
                    <li>Fixed crash @7C8097FF when trying to drag drop indicator
                      on chart when database is empty</li>
                  </ul>
                  <p><strong>CHANGES FOR VERSION 5.50.2 (as compared to 5.50.1)</strong></p>
                <ul>
    <li>
      
        
          
            
              
                
                  
                    New Analysis: If current formula is open in the formula
                      editor it is auto-saved prior to running any Analysis (as
                    old AA did)</li>
    <li>
      
        
          
            
              
                
                  
                    New Analysis: on Backtest/Optimization current
                                      formula is saved
                                                    in @LastBacktestFormula registry
                    key so it can be referenced by Individual Equity formula</li>
    <li>
      
        
          
            
              
                
                  
                    New
                                      Analysis and Old AA: HoldMinBars &gt; 0
                                                                    can now be
                                      used together with AllowSameBarExit=True
                                      Settings: 'Stops' tab: N
                                                                    Bar stop
                                      has priority check box state was not saved.
                    Fixed</li>
    <li>
      
        
          
            
              
                
                  
                    New
                                                      Analysis: on attempt
                                                                            
                       to load analysis project file
                                                                            
                       that contains formula
                                                                            
                       path that does not
                                                                            
                       exist or is not writable
                                                                            
                       AmiBroker will create
                                                                            
                       the formula in the &quot;Formulas\Imported&quot; folder
                                                                            
                        instead of not creating
                                                                            
                    it at all</li>
    <li>
      
        
          
            
              
                
                  
                    New
                                                                            
                       Analysis: WinXP-only
                                                                            
                       - RMB click column descend/ascend
                                                                            
                       menus were
                                                                            
                       not working due to Windows
                                                                            
                    XP bug. Fixed.</li>
    <li>
      
        
          
            
              
                
                  
                    New
                                                                            
                       Analysis: when formula
                                                                            
                       is picked from the
                                                                            
                       folder that is inside
                                                                            
                       current working directory,
                                                                            
                       then relative
                                                                            
                       path is used and stored
                                                                            
                       in project
                                                                            
                       instead of absolute
                                                                            
                    path previously used</li>
    <li>
      
        
          
            
              
                
                  
                    New
                                                                            
                       Analysis:
                                                                            
                       SeparateLongShortRank
                                                                            
                       required
                                                                            
                      
                                                                            
                       proper
                                                                            
                       MaxLongPos and MaxShortPos
                                                                            
                      
                                                                            
                      
                                                                            
                       definitions in order
                                                                            
                      
                                                                            
                       to work. Now if
                                                                            
                       they
                                                                            
                       are missing defaults
                                                                            
                      
                                                                            
                      
                                                                            
                       are applied as in
                                                                            
                       old
                                                                            
                    AA.</li>
    <li>
      
        
          
            
              
                
                  
                    Plugins:
                                                                            
                      
                                                                            
                       IQFeed:
                                                                            
                      
                                                                            
                       added &quot;You
                                                                            
                        can't close
                                                                            
                        plugin window&quot; on
                                                                            
                          attempt
                                                                            
                         to close
                                                                            
                         working IQFeed
                                                                            
                    window.</li>
    <li>
      
        
          
            
              
                
                  
                    UI: 
                                                                            
                      
                                                                            
                       Chart
                                                                            
                       tree,
                                                                            
                      
                                                                            
                       Layout
                                                                            
                       tree
                                                                            
                      
                                                                            
                    in &quot;Explorer&quot; theme</li>
    <li>
      
        
          
            
              
                
                  
                    UI:
                                                                            
                      
                                                                            
                       Category
                                                                            
                       list
                                                                            
                      
                                                                            
                       now
                                                                            
                       features
                                                                            
                      
                                                                            
                       new
                                                                            
                       icons
                                                                            
                      
                                                                            
                       and
                                                                            
                       decreased
                                                                            
                      
                                                                            
                    indentation</li>
    <li>
      
        
          
            
              
                
                  
                    UI:
                                                                            
                      
                                                                            
                       Owner-draw
                                                                            
                       listviews
                                                                            
                      
                                                                            
                       now
                                                                            
                       fully
                                                                            
                      
                                                                            
                       implement
                                                                            
                       ellipsis
                                                                            
                      
                                                                            
                       item
                                                                            
                       truncation
                                                                            
                      
                                                                            
                       mechanism,
                                                                            
                       but
                                                                            
                      
                                                                            
                       using
                                                                            
                       ExtTextOut
                                                                            
                      
                                                                            
                       only
                                                                            
                       which
                                                                            
                      
                                                                            
                       is
                                                                            
                       6
                                                                            
                      
                                                                            
                       times
                                                                            
                       faster
                                                                            
                      
                                                                            
                       than
                                                                            
                       DrawText
                                                                            
                      
                                                                            
                       that
                                                                            
                       Windows
                                                                            
                      
                                                                            
                    uses</li>
    <li>
      
        
          
            
              
                
                  
                    UI:
                                                                            
                      
                                           
                                                                            
                                          Floating 
                                                                            
                       non-chart
                                                                            
                      
                                                                            
                       windows
                                                                            
                       (account/web
                                                                            
                      
                                                                            
                       browser/analysis)
                                                                            
                       are
                                                                            
                      
                                                                            
                       not
                                                                            
                       closed
                                                                            
                      
                                                                            
                       when
                                                                            
                       switching
                                                                            
                      
                                                                            
                    layouts.</li>
    <li>
      
        
          
            
              
                
                  
                    Plugins:
                                                                            
                      
                                                                            
                       IQFeed
                                                                            
                       plugin
                                                                            
                      
                                                                            
                       uses
                                                                            
                       new
                                                                            
                      
                                                                            
                       faster
                                                                            
                       IQFeed
                                                                            
                      
                                                                            
                       API,
                                                                            
                       downloads
                                                                            
                      
                                                                            
                       less
                                                                            
                       and
                                                                            
                      
                                                                            
                       uses
                                                                            
                       way
                                                                            
                      
                                                                            
                       more
                                                                            
                       efficient
                                                                            
                      
                                                                            
                       method
                                                                            
                       to
                                                                            
                      
                                                                            
                       backfill
                                                                            
                       1/5/15-second
                                                                            
                      
                                                                            
                       base
                                                                            
                       time
                                                                            
                      
                                                                            
                       intervals<br>
                  </li>
  </ul>
  
    
      
        
          
            
              
                
                  <p><strong>CHANGES FOR VERSION 5.50.1 (as compared to 5.50.0)</strong></p>
                  <ul>
                    <li>New Analysis: Individual Backtest implemented. Note that
                                    it runs with approx same speed as old AA as Individual Backtest
                      is single threaded for reasons explained in the User's manual <a href="http://www.amibroker.com/guide/h_multithreading.html">http://www.amibroker.com/guide/h_multithreading.html</a></li>
                    <li>New Analysis: toolbar icons for parameters and settings
                      changed to avoid confusion with the icon for preferences</li>
                    <li>UI: Symbol List uses Windows 7/Vista style</li>
                    <li>New Analysis: Toolbar customization is now saved</li>
                    <li>MRU (most recently used) file menu moved to submenu and
                      MRU list increased to 10 items</li>
                    <li>Charts: fixed small alignment problem on Y axis when using
                      fixed (nonproportional) font</li>
                    <li>New Analysis: backtester object now has EquityArray property
                                    that returns entire equity array (not just current value).<br>
                    Please note that values are filled during backtest and only after backtest
                    is complete, all values are valid. If you call it in the middle, it will
                    contain only &quot;upto given point&quot; data. Avoid abusing this function
                    and it is costly in terms of RAM/CPU.e).<br>
                    You may use <br>
                    bo.EquityArray instead of Foreign(&quot;~~~Equity&quot;, &quot;C&quot; ) <br>
                    in custom backtester code.<br>
                    It accesses local copy of equity in New Analysis (unlike Foreign that accesses
                    global symbol)<br>
                    </li>
                    <li>New Analysis: AddToComposite with atcDeleteValues | atcEnableInPortfolio
                      did not delete previous values. Fixed</li>
                    <li>New Analysis: &quot;Interval&quot; menu item in the auto-repeat
                                    group renamed to &quot;AR interval&quot; because some users
                      interpreted it wrong (as periodicity)</li>
                    <li>New Analysis: OLE interface implemented<br>
                      <br>
                    Description in the <a href="http://www.amibroker.com/guide/objects.htm">http://www.amibroker.com/guide/objects.htm</a>l
                    <p>Example<br>
                      The following JScript example<br>
                      a) opens analysis project from C:\Analysis1.apx file<br>
                      b) starts backtest (asynchronously)<br>
                      c) waits for completion<br>
                      d) exports results<br>
                      e) closes analysis document</p>
                    <p><CODE><FONT COLOR=#000000>AB = new ActiveXObject( </FONT><FONT COLOR=#800080>"Broker.Application"</FONT><FONT COLOR=#000000> ); <BR>
                      <BR>
                      try <BR>
                      { <BR>
&nbsp;&nbsp;NewA = AB.AnalysisDocs.Open( </FONT><FONT COLOR=#800080>"c:\\analysis1.apx"</FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
                opens given analysis project file</FONT><FONT COLOR=#000000> <BR>
                      <BR>
&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000> (
                NewA ) <BR>
&nbsp; { <BR>
&nbsp;&nbsp;&nbsp;&nbsp;NewA.Run( </FONT><FONT COLOR=#800080>2</FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
                starts analysis (asynchronous - returns immediatelly <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// (0-scan, 1- exploration, 2- portfolio
                backtest, 4- optimization, 6-walk forward)</FONT><FONT COLOR=#000000> <BR>
                      <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>while</B></FONT><FONT COLOR=#000000> (
                NewA.IsBusy ) <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WScript.Sleep( </FONT><FONT COLOR=#800080>500</FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
                wait for completion</FONT><FONT COLOR=#000000> <BR>
                      <BR>
&nbsp;&nbsp;&nbsp;&nbsp;NewA.Export( </FONT><FONT COLOR=#800080>"test.html"</FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
                exporing results</FONT><FONT COLOR=#000000> <BR>
                      <BR>
&nbsp;&nbsp;&nbsp;&nbsp;WScript.echo( </FONT><FONT COLOR=#800080>"ended"</FONT><FONT COLOR=#000000> ); <BR>
                      <BR>
&nbsp;&nbsp;&nbsp;&nbsp;NewA.Close(); </FONT><FONT COLOR=#008000>// closing analysis
                window</FONT><FONT COLOR=#000000> <BR>
&nbsp;} <BR>
                      } <BR>
                      catch ( exc ) <BR>
                      { <BR>
&nbsp; WScript.echo( </FONT><FONT COLOR=#800080>"Exception: "</FONT><FONT COLOR=#000000> +
                exc.message ); <BR>
                      }</FONT></CODE></p>
                    </li>
                    <li>Charts: more tweaks for Y axis algorithm for readability.
                                    Now in Tools-&gt;Preferences, &quot;Charting&quot; the user
                                    may select different grid stepping: Instead of default 1,
                                    2, 5, 10 grid stepping, user may select to use 2.5 step instead
                      of 2 (Use 2.5 step in Y axis)</li>
                    <li>GetFnData() supports new field &quot;Alias&quot; - return
                      Alias field without need to use OLE</li>
                    <li>GetOption supports new fields: ApplyTo and Filter*, eliminates
                                    the need to use OLE for that purpose<br>
                    New fields:<br>
                    -&quot;ApplyTo&quot; - returns Analysis &quot;Apply To&quot; setting 0 -
                    all symbols, 1 - current symbol, 2 - filter<br>
                    - &quot;FilterIncludeIndex&quot;, &quot;FilterIncludeFavorite&quot;, &quot;FilterIncludeMarket&quot;, &quot;FilterIncludeGroup&quot;, &quot;FilterIncludeSector&quot;, &quot;FilterIncludeIndustry&quot;, &quot;FilterIncludeWatchlist&quot; -
                    return &quot;Include&quot; filter settings -1 - means NOT selected (not included), &gt;=
                    0 index of included category<br>
                    - &quot;FilterExcludeIndex&quot;, &quot;FilterExcludeFavorite&quot;, &quot;FilterExcludeMarket&quot;, &quot;FilterExcludeGroup&quot;, &quot;FilterExcludeSector&quot;, &quot;FilterExcludeIndustry&quot;, &quot;FilterExcludeWatchlist&quot; -
                    return &quot;Exclude&quot; filter settings -1 - means NOT selected (not excluded), &gt;=
                    0 index of excluded category<br>
                      <br>
                    </li>
                    <li>Fix for FPU inaccurracies in range bars implemented<br>
                    </li>
                  </ul>
                  <p><strong>CHANGES FOR VERSION 5.50.0 (as compared to 5.49.2)</strong></p>
                  <ul>
                    <li>New Analysis: &quot;Save&quot; creates now a Analysis project
                                    (.apx) file that includes all settings and formula needed
                                    in single file. The file itself is in human readable XML
                                    format. When such file is loaded on somebodys' else computer
                                    it will recreate original formula if one is not present.
                                    It will warn if there is a name conflict and let you decide
                                    to keep existing formula or overwrite.<br>
                    </li>
                    <li>UI: File open dialog now has &quot;All supported files&quot; option
                      in the &quot;Files of type&quot;</li>
                    <li>UI: PopupWindow is now resizable (see size gripper in the
                      lower-right corner)</li>
                    <li>AFL: PopupWindow function has additional parameters to
                                    control width/height and flag that controls whenever popup
                                    window captures input focus<br>
                    PopupWindow( &quot;bodytext&quot;,&quot;captiontext&quot;, timeout = 5, left
                    = -1, top = -1, width = -1, height = -1, captureFocus = True );
                    <p>width = width in pixels, -1 - use default width<br>
                      height = height in pixels, -1 - use default height</p>
                    <p>captureFocus - decides whenever popup window captures input focus or not</p>
                    <p>Example: popup window that does not change input focus:<br>
                      PopupWindow(&quot;test&quot;, &quot;caption&quot;, 30, -1, -1, -1, -1,
                      False);<br>
                    </p>
                    </li>
                    <li>New Analysis: ApplyStops applied in non-regular modes are
                      passed to 2nd phase properly now.</li>
                    <li>New Analysis: &quot;Show current trade arrows&quot; fixed.</li>
                    <li>New Analysis: View-&gt;Filtering menu options were not
                      available when New Analysis was active. Fixed.</li>
                    <li>New Analysis: Standard Edition has a limit of max 2 threads
                      per Analysis window instance.</li>
                    <li>UI: Log window clicking on error displayed AFL Editor and
                                    marked Line+1, Col+1 char position instead of proper place.
                      Fixed</li>
                    <li>New Analysis: Errors are now displayed in a modern message
                      bar instead of dialog box</li>
                    <li>UI: holding down Ctrl and Q keys simultaneously while AmiBroker
                      is starting resets all menus/command bars to defaults</li>
                    <li>New Analysis: scroll bar properly works when &quot;Walk
                      forward&quot; tab is active</li>
                    <li>New Analysis: Walk forward tab content can be now copied
                      using Edit-&gt;Copy / Ctrl+C</li>
                    <li>New Analysis: when &quot;wait for backfill&quot; was turned
                                    on and external data source was very slow to repond (like
                                    IQFeed during backfill) subsequent calls to Status('stocknum')
                      could give non-unique numbers. Fixed.</li>
                    <li>New Analysis: Copy to clipboard includes headers now</li>
                    <li>New Analysis: Column customization/state persistence implemented</li>
                    <li>Charts: New Y axis grid algorithm for clearer display on
                      condensed charts</li>
                    <li>AFL: CategoryGetSymbols supports new categoryAll (all symbols
                                    in the database) and new Mode parameter<br>
                    CategoryGetSymbols( category, number, mode = 0 );
                    <p>Mode parameter decides what field is retrived:<br>
                      0 (default value) - ticker symbol<br>
                      1 - full name</p>
                    <p>Example: to get all symbols existing in the database simply call<br>
                      CategoryGetSymbols( categoryAll, 0 );<br>
                      to get full names of all symbols use:<br>
                      CategoryGetSymbols( categoryAll, 0, 1 );</p>
                    </li>
                    <li>AFL: Added Warning 503. Using OLE / CreateObject / CreateStaticObject
                                    is not multi-threading friendly. See Users' Guide &quot;&quot;Efficient
                      use of multithreading&quot;&quot; for more details.</li>
                    <li>AFL: Added ThreadSleep( milliseconds ) function. It suspends
                                    current thread for specified number of milliseconds (maximum
                                    is 100 ms). Works only from NON-UI threads. When called from
                                    UI thread the function does NOTHING and returns immediatelly.
                                    Please do NOT abuse this function. Using it may negatively
                      impact performance.</li>
                    <li>AFL: Added StaticVarCompareExchange function. Provides
                                    atomic interlocked compare/exchange functionality<br>
                      <br>
                    Parameters<br>
&quot; varname&quot;<br>
                    Specifies the name of the destination static variable. Static variable if
                    exists must be scalar numeric type. If static variable is not initialized,
                    the function assumes that it has value of zero.<br>
                    exchange <br>
                    Specifies the exchange value. Scalar numeric.<br>
                    Comperand <br>
                    Specifies the value to compare to the destination static variable. Scalar
                    numeric.<br>
                    Return Values<br>
                    The return value is the initial value of the destination static variable.
                    If variable did not exist, it returns zero.
                    <p>The StaticVarCompareExchange function performs an atomic comparison of
                      the &quot;varname&quot; static variable value with the Comperand value.
                      If the static variable value is equal to the Comperand value, the Exchange
                      value is stored in the static variable. Otherwise, no operation is performed.</p>
                    <p>The function StaticVarCompareExchange provides a simple mechanism for
                      synchronizing access to static variables that are shared by multiple threads.
                      The following examples show how to implement semaphore and critical section
                      in AFL using StaticVarCompareExchange function:</p>
                    <p><CODE><FONT COLOR=#000000> </FONT><FONT COLOR=#008000>// EXAMPLE 1 : Simple
                          semaphore (no waiting)</FONT><FONT COLOR=#000000> <BR>
                      </FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( StaticVarCompareExchange( </FONT><FONT COLOR=#800080>"semaphore"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000> )
                      == </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000> ) </FONT><FONT COLOR=#008000>//
                      obtain semaphore</FONT><FONT COLOR=#000000> <BR>
                      { <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>// protected section here</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>// Here you have exclusive access
                (no other threads that check for semaphore will enter simultaneously)&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp; </FONT><FONT COLOR=#008000>/////////////////////////</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>StaticVarSet</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"semaphore"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
                reset semaphore</FONT><FONT COLOR=#000000> <BR>
                      } <BR>
                      </FONT><FONT COLOR=#800000><B>else</B></FONT><FONT COLOR=#000000> <BR>
                      { <BR>
&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>_TRACE</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Can
                not obtain semaphore"</FONT><FONT COLOR=#000000>); <BR>
                      } <BR>
                      <BR>
                      </FONT><FONT COLOR=#008000>///////////////</FONT><FONT COLOR=#000000> <BR>
                      </FONT><FONT COLOR=#008000>// EXAMPLE 2 HOW TO IMPLEMENT CRITICAL
                              SECTION IN AFL</FONT><FONT COLOR=#000000> <BR>
                              </FONT><FONT COLOR=#008000>///////////////</FONT><FONT COLOR=#000000> <BR>
                              <BR>
                              </FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> _TryEnterCS(
                              secname ) <BR>
                      { <BR>
&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>global</B></FONT><FONT COLOR=#000000> _cursec; <BR>
&nbsp;&nbsp;_cursec= </FONT><FONT COLOR=#800080>""</FONT><FONT COLOR=#000000>; <BR>
                      <BR>
&nbsp;&nbsp;</FONT><FONT COLOR=#008000>// try obtaining semaphore for 1000 ms</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>(
                i = </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>; i &lt; </FONT><FONT COLOR=#800080>1000</FONT><FONT COLOR=#000000>;
                i++ ) <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>(
                StaticVarCompareExchange( secname, </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000> )
                == </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000> ) <BR>
&nbsp;&nbsp; { <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _cursec = secname; <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>break</B></FONT><FONT COLOR=#000000>; <BR>
&nbsp;&nbsp; } <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>else</B></FONT><FONT COLOR=#000000> ThreadSleep( </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//sleep
                one millisecond</FONT><FONT COLOR=#000000> <BR>
                      <BR>
&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>return</B></FONT><FONT COLOR=#000000> _cursec
                != </FONT><FONT COLOR=#800080>""</FONT><FONT COLOR=#000000>; <BR>
                      } <BR>
                      <BR>
                      </FONT><FONT COLOR=#008000>// call it ONLY when _TryEnterCS returned TRUE
                      !</FONT><FONT COLOR=#000000> <BR>
                      </FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> _LeaveCS() <BR>
                      {&nbsp;&nbsp;&nbsp; <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>global</B></FONT><FONT COLOR=#000000> _cursec; <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>(
                _cursec != </FONT><FONT COLOR=#800080>""</FONT><FONT COLOR=#000000> ) <BR>
&nbsp;&nbsp;&nbsp; { <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>StaticVarSet</FONT><FONT COLOR=#000000>(
                _cursec, </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000> ); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; _cursec = </FONT><FONT COLOR=#800080>""</FONT><FONT COLOR=#000000>; <BR>
&nbsp;&nbsp;&nbsp; } <BR>
                      } <BR>
                      <BR>
                      </FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> TimeConsumingWork() <BR>
                      { <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>// WARNING: the Percentile is CPU
                hungry as it involves lots of sorting, the loop below may take &gt; 1 second
                to complete</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>(
                i = </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>; i&lt; </FONT><FONT COLOR=#800080>10</FONT><FONT COLOR=#000000>;
                i++ ) </FONT><FONT COLOR=#0000ff>Percentile</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>100</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>10</FONT><FONT COLOR=#000000> ); <BR>
                      } <BR>
                      <BR>
                      </FONT><FONT COLOR=#008000>//_TRACE("Without CS Begin " + GetChartID()
                      );</FONT><FONT COLOR=#000000> <BR>
                      </FONT><FONT COLOR=#008000>//TimeConsumingWork(); // some time consuming
                      calculation</FONT><FONT COLOR=#000000> <BR>
                      </FONT><FONT COLOR=#008000>//_TRACE("Without CS End" + GetChartID() );</FONT><FONT COLOR=#000000> <BR>
                      <BR>
                      </FONT><FONT COLOR=#008000>// Example usage (critical section)</FONT><FONT COLOR=#000000> <BR>
                      </FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( _TryEnterCS( </FONT><FONT COLOR=#800080>"mysemaphore"</FONT><FONT COLOR=#000000> )
                      ) <BR>
                      { <BR>
&nbsp;&nbsp;</FONT><FONT COLOR=#008000>// you are inside critical section now</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp; </FONT><FONT COLOR=#0000ff>_TRACE</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Begin
                CS "</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#0000ff>GetChartID</FONT><FONT COLOR=#000000>()
                ); <BR>
&nbsp;&nbsp; TimeConsumingWork(); </FONT><FONT COLOR=#008000>// some time consuming
                calculation</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp; </FONT><FONT COLOR=#0000ff>_TRACE</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"End
                CS "</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#0000ff>GetChartID</FONT><FONT COLOR=#000000>()
                ); <BR>
&nbsp;&nbsp; _LeaveCS(); <BR>
                      } <BR>
                      </FONT><FONT COLOR=#800000><B>else</B></FONT><FONT COLOR=#000000> <BR>
                      { <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>_TRACE</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Unable
                to enter CS"</FONT><FONT COLOR=#000000>); <BR>
                      }</FONT></CODE></p>
                    <br>
                    </li>
                  </ul>
                  <p><strong>CHANGES FOR VERSION 5.49.2 (as compared to 5.49.1)</strong></p>
                  <ul>
                    <li>New Analysis: added Optimize-&gt;3D Optimization chart
                      menu</li>
                    <li>New Analysis: buttons for Portfolio Equity/Individual Equity
                      charts added</li>
                    <li>New Analysis: Info Bar added (that duplicates some of the
                                    info that normally appears on the Info Tab). It can be turned
                      on using Settings-&gt;Info Bar</li>
                    <li>New Analysis: Report generation is now OFF by default when
                                    running optimization/walk forward as in old AA. This gives
                      about 0.9 sec gain per step.</li>
                    <li>New Analysis: Single-symbol optimization made faster by
                      caching already compressed quote array on subsequent steps</li>
                    <li>New Analysis: the check for Status(&quot;StockNum&quot;)
                                    was sensitive to blanks between parenthesis, function name
                      and string parameter. Now it is made insensitive to blanks.</li>
                    <li>New Analysis: when &quot;Range&quot; was &quot;n last bars&quot; or &quot;n
                                    last days&quot;, Status(&quot;rangefromdate&quot;) gave date
                      of preceding bar. Fixed.</li>
                    <li>UI: &quot;Performance&quot; tooltip title was not always
                      updated on time. Fixed.</li>
                    <li>UI: &quot;Wait for plugin&quot; window displays progress
                                    bar with &quot;marquee&quot; style instead of circle of dots<br>
                    </li>
                  </ul>
                  <p><strong>CHANGES FOR VERSION 5.49.1 (as compared to 5.49.0)</strong></p>
                  <ul>
                    <li>New Analysis: Testing on unaligned data sometimes took
                                    longer than expected because of the work necessary to bring
                                    signals in order. Now a smart method avoids most of the memory
                                    transfers and can give <u>10x speedup</u> on backtesting
                      very long unaligned intraday data.</li>
                    <li>New Analysis: &quot;Backtest started&quot;, &quot;Exploration
                                    started&quot; text in the info tab appeared twice per run
                      (instead of once). Fixed</li>
                    <li>New Analysis: Backtest report did not include formula code.
                      Fixed.</li>
                    <li>New Analysis: Fixed crash that could occur when running
                                    analysis with Range set to &quot;N recent bars&quot; and
                      N was exceeding number of quotes. </li>
                    <li>New Analysis: Float/Normal/Close popup menu RMB menu was
                                    active everywhere in floating window instead of only caption
                      area. Fixed.</li>
                    <li>New Analysis: Implement single-thread start when Status(&quot;StockNum&quot;)
                                    is detected in the code. Other threads are started when first
                      symbol processing is completed.</li>
                    <li>New Analysis: Send to Analysis did not update formula combo
                                    box properly in certain scenarios: when formula X was selected,
                      then formula Y, then formula X again. Fixed.</li>
                    <li>Old AA: status bar displays true timing for fair comparisons
                                    between old AA and new Analysis. Watching progress bar numbers
                                    was misleading as it closed before all processing was truly
                                    complete, so it looked like old AA completed sooner than
                      it really did</li>
                    <li>UI: menu item for Old Automatic Analysis restored as apparently
                                    some users got lost. Also attempt to run old Automatic analysis
                                    displays an information about new Analysis window<br>
                    </li>
                  </ul>
                  <p><strong>CHANGES FOR VERSION 5.49.0 (as compared to 5.48.0)</strong></p>
                  <ul>
                    <li>New Analysis: when floating pane is made normal from/to
                      dates were reset to today. Fixed.</li>
                    <li>New Analysis: when Apply To: Filter is defined so NO symbol
                                    matches the criteria, appropriate message is displayed when
                                    trying to run Analysis and action is terminated instead of
                      displaying progress bar forever</li>
                    <li>New Analysis: when analysis window is &quot;floating&quot; double
                                    click/show arrows/sync affects active MDI chart just like
                                    old AA did, as opposed to last one (when analysis is not
                      floating)</li>
                    <li>New Analysis: Optimization parameter setup stage uses now
                      not more than 100 bars. This reduces setup time.</li>
                    <li>New Analysis: implemented import / export, File menu now
                      has Import HTML and Export HTML/CSV commands</li>
                    <li>New Analysis: Implemented &quot;Wait for backfill&quot; option.
                                    This slows down analysis sequence so AmiBroker waits for
                                    external RT data source to deliver backfill data<br>
                    When &quot;wait for backfill&quot; option is turned on, AmiBroker checks
                    if data for given symbol are complete, if not, it sends request to external
                    source to backfill the data and waits 1 second.<br>
                    After one second, it checks again, it data are complete, if not, it waits
                    another 1 second, and so on. Once data are complete given symbol is used
                    for formula execution. </li>
                    <li>New Analysis: Custom backtester uses &quot;last backtest
                                    settings&quot; when calling GetStatus() instead of old AA
                      settings</li>
                    <li>New Analysis: auto-repeat interval edit field did not allow
                                    to enter values if moved to main toolbar via customization.
                      Fixed.</li>
                    <li>Formula Editor Analysis toolbar button now operates on
                      New Analysis window</li>
                    <li>Default for timestamping of intraday compression changed
                      to &quot;Show START time of interval&quot;</li>
                    <li>Charts: AFL error message color is now definable in Tools-&gt;Preferences, &quot;Color&quot; tab</li>
                    <li>Charts: Tooltips automatically display also OHL prices
                                    (in addition to close) when Plot style is set to candlestick,
                      bar or when PlotOHLC was used</li>
                    <li>UI: Adjusted item Y offset for owner drawn listviews for
                                    consitent look with old layout of system listviews in Windows
                      XP and earlier OSes</li>
                    <li>UI: Account, Analysis and Web research windows don't use
                                    client edge/border anymore - gives slicker / less crowded
                      look</li>
                    <li>UI: when focus is switched to floating document window,
                      the application menu is switched to proper context</li>
                    <li>UI: When File-&gt;Close was used on floating pane, document
                      was closed but docking pane was not. Fixed.</li>
                    <li>UI: The toolbar button and menu option to launch old Automatic
                                    Analysis window are now hidden (can be brought back by using
                                    Tools-&gt;Customize), old AA can also be launched from new
                      Analysis via Analysis-&gt;Old Analysis menu</li>
                    <li>UI: New menu options and toolbar button to launch new analysis
                      window</li>
                    <li>UI: Moved all menu items controlling visibility of docking
                      windows to &quot;Window&quot; menu</li>
                    <li>UI: floating state of windows can now be turned on/off
                      using right-click menu over tab / floating window caption</li>
                    <li>UI: File-&gt;Save (when currently selected window is a
                                    chart) command now saves Chart template. To save database
                      use &quot;Save database&quot; instead.</li>
                    <li>UI: Defaults for data window are changed, so extra OHL
                                    display is turned off by default as currently PlotOHLC displays
                      all 4 prices in the tooltip and data window already</li>
                    <li>UI: Data window scroll bars are hidden and do not flicker
                      when updating</li>
                    <li>UI: &quot;Save All&quot; toolbar button removed, &quot;Save
                      database&quot; button added to replace it</li>
                    <li>Web Research: turned on &quot;silent&quot; mode - should
                      prevent error message boxes displayed by IE engine.</li>
                    <li>QuoteEngine: Range bars algorithm improved significantly</li>
                    <li>Quote array uses 20480 bytes (512 quotes) allocation chunk
                                    size (exactly 5x4KB page) for better alignment with Windows
                                    virtual memory pages<br>
                    </li>
                  </ul>
                  <p><strong>CHANGES FOR VERSION 5.48.0 (as compared to 5.47.0)</strong></p>
                  <ul>
                    <li>New Analysis: custom metrics columns were invisible in
                      backtest/optimizations. Fixed. (#91031)</li>
                    <li>New Analysis: backtest did not display proper column names
                                    when Report mode was different than trade list. Fixed. Also
                      added support for changing report mode via SetOption().</li>
                    <li>New Analysis: Auto-repeat Scan/Explore implemented (aka. &quot;Run
                      every&quot; in old AA) (use drop down menu next to &quot;Settings&quot; button)</li>
                    <li>New Analysis: Showing arrows by double click implemented</li>
                    <li>New Analysis: Sync chart on select option implemented (use
                      drop down menu next to &quot;Settings&quot; button)</li>
                    <li>Fixed window activation issue after RMB click in chart
                      window when non-chart floating windows are active</li>
                    <li>New Analysis: Cancelling walk-forward did not restore date
                                    range and settings and didn't reset internal step counter.
                      Fixed.</li>
                    <li>New Analysis: Formula path disappeared when window was
                      made floating. Fixed.</li>
                    <li>New Analysis: in 5.47 non-exhaustive optimizers sometimes
                      stopped after first step in walk-forward. Fixed.</li>
                    <li>Charting: scroll bar zoom function remains active even
                      at extreme zoom in levels</li>
                    <li>New Analysis: Fixed problem with opt steps warning dialog
                                    appearing sometimes in the out-of-sample tests in walk forward
                      sequence</li>
                    <li>New Analysis: Signal heaps are separated now, allowing
                                    to run concurrent backtest/optimizations in many analysis
                      windows</li>
                    <li>New Analysis: removed unnecessary refreshes of symbol list
                                    during optimizations that caused slowdowns when user had
                      large database</li>
                    <li>New Analysis: The size of control fields is properly adjusted
                      with regards to DPI</li>
                    <li>New Analysis: Status(&quot;StockNum&quot;) was always zero
                                    in 5.47 and earlier. Now it is set properly.<br>
                    Caveat: be careful when you run codes that use Status(&quot;StockNum&quot;)==0
                    for special processing in multithreading mode.<br>
                    Other threads with &quot;StockNum&quot; = 1, 2, 3,... will run simultaneously!
                    If you store static variables in step 0 these variables may be empty if you
                    access them from other parallel running threads. </li>
                    <li>Fixed Error 53 message that was giving an error when proper
                                    \&quot; (quotation mark espace sequence) was used<br>
                    </li>
                  </ul>
                  <p><strong>CHANGES FOR VERSION 5.47.0 (as compared to 5.46.0)</strong></p>
                  <ul>
                    <li>New Analysis: last used ApplyTo/Range/From/to dates/filters
                      and other settings are saved when Analysis window is closed</li>
                    <li>Fix to &quot;slow response&quot; problems some users reported
                      when switching symbols</li>
                    <li>Fibonacci retracement- modifying Z-order affected only
                      control trendline, not all lines as it should. Fixed.</li>
                    <li>New Analysis: implemented Walk-Forward testing (use drop
                      arrow next to Optimization button)</li>
                    <li>AFL engine: new error 53: incorrect \ espace sequence.
                                    Error is issued when user forgets that single slash must
                      be written as \\</li>
                    <li>Default title for new analysis window is &quot;AnalysisX&quot; (instead
                                    of &quot;Unnamed&quot;) where X is consecutive number 1,
                      2..</li>
                    <li>attempt to use Say() on computer without sound card or
                                    without driver installed does not result in throwing exception/crash
                                    report, but it is rather silently ignored<br>
                    </li>
                  </ul>
                  <p><strong>CHANGES FOR VERSION 5.46.0 (as compared to 5.45.0)</strong></p>
                  <ul>
                    <li>New Analysis: Exhaustive multi-threaded optimization implemented</li>
                    <li>New Analysis: Smart (non-exhaustive) multi-threaded optimization
                                    implemented in a way compatible with existing optimizer plugins<br>
                      <br>
                    Note however that due to the fact that most non-exhaustive optimization plugins
                    are not re-entrant, AmiBroker prevents from running more than one non-exhaustive
                    multi-threaded optimization at a time. You can however, run many exhaustive
                    optimizations in parallel, as they don't require external plugins.<br>
                    </li>
                    <li>Slight modification to the way how compressed bar charts
                                    are drawn (so bars with H==L are better visible)<br>
                    </li>
                  </ul>
                  <p><strong>CHANGES FOR VERSION 5.45.0 (as compared to 5.44.1)</strong></p>
                  <ul>
                    <li>64-bit version compiled with new version of C runtime (Microsoft
                      security update)</li>
                    <li>Fixed date/time column sorting in virtual list views when
                      regional date format was different than yyyy-MM-dd</li>
                    <li>AFL: ClipboardSet() returns True (1) when clipboard has
                                    been successfully set. Sometimes clipboard is locked by another
                                    applications and then write can fail (ClipboardSet() will
                      return zero/False then)</li>
                    <li>New Analysis: Changed alignment of Date/Time column to
                      left in backtest result list.</li>
                    <li>Most AFL engine setup moved to worker threads. Result -
                                    smaller UI thread load in MT charts (better scalability)
                                    and much faster (upto 2x) explorations/scans in New Analysis
                      window</li>
                    <li>New Analysis: added &quot;Info&quot; tab that provides
                                    some summary information about analysis (number of rows,
                                    timings, backtest summary) - contents can be copied using
                                    Ctrl+C / Edit-&gt;Copy<br>
                      <br>
                    NOTE:<br>
                    End users should only look at &quot;Completed in... sec&quot; line that shows
                    actual run time of the analysis (scan/exploration/backtest).
                    <p>The times shown in &quot;timings&quot; row are for Amibroker.com internal
                      use. In development/testing they help us tweak the performance of various
                      parts of analysis engine. The detailed timings do not sum up to actual
                      run time. No further infomation is available at the moment. The &quot;timings&quot; row
                      is subject to change/removal in the future versions.</p>
                    <p>If you have problems/questions with the performance of new Analysis window
                      please copy (Ctrl+C) the contents of Info tab and send to support.<br>
                    </p>
                    </li>
                    <li>New Analysis: first-phase backtest signal processing and
                                    ranking moved to non-UI threads, enabling better parallelism,
                                    results in better backtest performance (upto 2x in with trivial
                                    codes)<br>
                    </li>
                  </ul>
                  <p><b>CHANGES FOR VERSION 5.44.0 (as compared to 5.43.1)</b></p>
                  <ul>
                    <li>New Analysis: fixed AddToComposite()</li>
                    <li>New Analysis: Interval() function was working incorrectly
                      in new analysis window. Fixed.</li>
                    <li>New Analysis: Backtest ~~~EQUITY symbol did not have &quot;use
                      only local database&quot; set in 5.43.1. Fixed.</li>
                    <li>New Analysis: Backtest performance improved by removing
                                    some unnecessary list view refreshes (now it should never
                                    be slower than old AA even with simplest formulas)<br>
                    </li>
                  </ul>
                  <p><b>CHANGES FOR VERSION 5.43.1 (as compared to 5.43.0)</b></p>
                  <ul>
                    <li>When range different than &quot;All quotes&quot; was selected,
                                    backtest in new Analysis window could produce incorrect results
                      in 5.43.0. Fixed.</li>
                  </ul>
                  <p><b>CHANGES FOR VERSION 5.43.0 (as compared to 5.42.0)</b></p>
                  <ul>
                    <li>New Analysis Window: multi-threaded Backtest feature implemented
                                    (experimental)<br>
                        <br>
                    Note that only first phase of backtest is multithreaded (each symbol in separate
                    thread). 2nd phase (custom backtest) is executed in main thread as there
                    is only one symbol to work on (i.e. equity) and it needs to talk with OLE
                    which is single threaded and GUI.<br>
                    </li>
                    <li>Load/Unload buttons removed from Plugins dialog. This was
                                    developer-only feature and it was abused by ordinary people
                                    who were unloading plugins that were actually in -use (such
                      as data plugins when being connected to given data source)</li>
                    <li>ListViews: the last line (partially shown) in RT quote
                      window was not easily selectable. Fixed</li>
                    <li>New Analysis window: Implemented Parameters dialog</li>
                    <li>AFL: GetCursorMouseButtons() sometimes missed clicks when
                                    multithreading was on and formula took ages to execute. Now
                      it is now 100% reliable.</li>
                    <li>Auto-selection of proper layer based on selected viewing
                                    interval<br>
                    NOTE: This feature can be turned off by click with RIGHT mouse button over
                    layers window and UNCHECKING &quot;Auto-select layer&quot;<br>
                    </li>
                    <li>IRA accounts support - implemented Settlement delay in
                                    backtester, via SetOption(&quot;SettlementDelay&quot;, x
                                    )<br>
                      <br>
&quot;SettlementDelay&quot; option describes the number of days (not bars) it
                takes for sale proceeds to settle and be available for opening new positions. <br>
                    SetOption(&quot;SettlementDelay&quot;, 3 ); // this will cause that proceeds
                    from sale are only available for trading on 3rd day after sale<br>
                    For detailed tracking <br>
&quot; Detailed log&quot; report option now shows available and unsettled funds
                for T+1, T+2 and so on
                    <p>Note: when using this option it is recommended to use backtestRegularRaw
                      instead of backtestRegular, otherwise some trades may not be entered<br>
                      because funds are not settled immediately and you need to be able to enter
                      not on first but subsequent buy signals and that is exactly what backtestRegularRaw
                      offers.</p>
                    <p>Note2: old backtester (Equity() function) ignores settlement delay </p>
                    </li>
                    <li>Zoom in/out toolbar buttons zoom in finer steps (+/-10%)</li>
                    <li>Analysis ListView, RMB menu new option: &quot;Add Rank
                                    column&quot; - adds a column with ordinal rankings based
                                    on current sort or just row number column when list is not
                      sorted</li>
                    <li>New feature: Adding new chart/research/account/analysis
                      via (+) tab</li>
                    <li>New Analysis window: Implemented SetSortColumns</li>
                    <li>New Analysis window: Implemented AddSummaryRows<br>
                    </li>
                  </ul>
                  <p><b>CHANGES FOR VERSION 5.42.0 (as compared to 5.41.0)</b></p>
                  <ul>
                    <li>Implemented right click menu in new Analysis windows (Add
                      symbols to watchlist/Show arrows functionality)</li>
                    <li>Zoom in/out toolbar buttons now have auto-repeat feature</li>
                    <li>In 5.41.0 Ctrl+C from list view copied text without tabs
                      (column separators). Fixed</li>
                    <li>In 5.41.0 did not refresh progress dialog optimization
                                    status list. Fixed. (owner draw list view initial size is
                      retrieved in PreSubclass now)</li>
                    <li>In 5.41.0 did not display Time&amp;Sales in reverse order
                                    (newest on top). Fixed.<br>
                    </li>
                  </ul>
                  <p><b>CHANGES FOR VERSION 5.41.0 (as compared to 5.40.3)</b></p>
                  <ul>
                    <li><strong>New Analysis window (File-&gt;New-&gt;Analysis)
                                      - featuring multithreaded Scan and Exploration</strong><br>
                    Performance note:<br>
                    to fully benefit from multithreading it is best to use AmiBroker local NATIVE
                    database (not external)<br>
                    as it is the only database that can deliver data quickly enough.
                    <p>Tests show that on AmiBroker native databases scans and explorations are
                      100% scalable to multiple cores<br>
                      - i.e. for example would run upto 8 times faster on 8 CPU/core machine.<br>
                      <br>
                      IMPORTANT: This window is work-in-progress. Multithreaded Backtest and
                      Optimization features will be added later.</p>
                    </li>
                    <li>AFL: AddColumn - added mini bar charts to explorations<br>
                    Exploration now features ability to create mini bar charts in individual
                      cells.
                      <p>AddColumn has new parameter 'barchart'</p>
                      <p>AddColumn( ARRAY, &quot;Caption&quot;, format = 1.2, fgcolor = colorDefault,
                      bkcolor = colorDefault, width = -1, barchart = null )</p>
                      <p>'barchart' parameter accepts values from 0...100 represening percentage
                        width of bar chart displayed in a cell<br>
                      the in-cell bar chart is drawn with bkcolor (background color). </p>
                      <p>Example usage:</p>
                      <p>Filter=1;<br>
                      AddColumn( Close, &quot;Close&quot; );<br>
                      rank = PercentRank( Close, 100 );<br>
                      Color = ColorHSB( rank * 64/100, 255, 255 );<br>
                      AddColumn( rank, &quot;100-day percent rank&quot;, 1.2, colorDefault, Color,
                      -1, rank );</p>
                      <p>Note that although this example uses same value for numeric display
                        and chart bar width, it does NOT need<br>
                      to be the same, i.e. numerical value of the cell is independent from bar
                      chart.<br>
                      </p>
                    </li>
                    <li>Totally rewritten listview with very efficient owner draw
                                    code speeds up list view scrolling/resizing/repainting more
                                    than 10 times. Native system ListView control is terribly
                                    slow on Windows XP/Vista/7 (surprisingly it was many times
                      faster in Win9x!) </li>
                    <li>AFL: Percentile() does a param check for range &gt; 0 now</li>
                    <li>Mini-chart in RT Quote window - Mini chart shows where
                      LAST price is within LOW-HIGH range.</li>
                    <li>Errors and warnings are now displayed in red color in the
                      indicator pane</li>
                    <li>During actual GDI chart rendering AmiBroker measures time
                                    and if it exceeds 500ms timeout it stops rendering with Warning
                                    901.<br>
                    This check is required because GDI rendering occurs in GUI thread and if
                    GUI thread does not process messages for half second Windows will think that
                    application is &quot;not responding&quot;.<br>
                    This prevents making application stuck with some overly complex, possibly
                    incorrect formulas that call hundreds of Plot()s<br>
                    </li>
                    <li>Warning 502: Calling Plot()/PlotOHLC over 500 times is
                      displayed in indicator in runtime to prevent abuse</li>
                    <li>All list views, pressing Ctrl and NumPad'+' automatically
                      adjusts column widths to content</li>
                    <li>if data are missing in the in-memory cache, Foreign() calls
                                    from non-GUI threads use synchronous retrieval method for
                                    reliability.<br>
                    This provides reliable results in AA but may slow down the multi-threaded
                    operations if cache size is too small and user uses more Foreign() calls
                    than in-memory cache size.<br>
                    IMPORTANT: <br>
                    For optimum performance in-memory cache setting (Tools-&gt;Preferences-&gt;Data)
                    should be GREATER than number of Foreign() calls in any single formula used.<br>
                    Values lower than that cause lots of disk activity and serialization of all
                    Foreign calls that means that additional threads must wait for data retrieval
                    to complete.<br>
                    </li>
                    <li>Old and new Analysis window: outputting millions of rows
                      to listview is much faster now</li>
                    <li>All list views - Ctrl+A (Select All) made much faster<br>
                    </li>
                  </ul>
                  <p><b>CHANGES FOR VERSION 5.40.3 (as compared to 5.40.2)</b></p>
                <ul>
    <li>
      
        
          
            GfxTextOut produced too large text on paper / printout. Fixed.</li>
    <li>
      
        
          
            GicsID
            returns empty string when GICS is not defined for symbol</li>
    <li>
      
        
          
            PlotText:
                        y==Null check added to skip calls that don't produce
            any output</li>
  </ul>
  
    
      
        
          <ul>
          </ul>
          <p>&nbsp;</p>
          <p><b>CHANGES FOR VERSION 5.40.2 (as compared to 5.40.0)</b></p>
        <ul>
    <li>
      
        64-bit version: MS VC++2005 compiler default floating point code
          generation option switched back to fp:precise because fp:fast produced
        incorrect code</li>
    <li>
      
        Print preview and Edit-&gt;Image-&gt;Copy respect Price
        chart style setting</li>
    <li>
      
        Notepad window: pressing Ctrl+C/V/X and ESC
        key afterwards closed AmiBroker without warning. Fixed.</li>
    <li>
      
        Quick review:
        Volume is printed without using scientific notation upto 9 billion</li>
    <li>
      
        SaveNewChartsInfo
              is called in SaveWorkspaceInfo() to ensure that broker.newcharts
          is in sync with saved layout, Broker.cpp
                          line
        927</li>
    <li>
      
        Exception dialog &quot;Exit program&quot; exits
                              program forcefully now. This prevents situation
          when program could not be closed and sometimes
                              corrupted
        data on exit.</li>
    <li>
      
        Selection line is handled properly
        again in Print preview/Edit-&gt;Image-&gt;Copy</li>
    <li>
      
        AA / Scan outputting
        lots (10K+) of signals made much faster</li>
    <li>
      
        Memory consumption during
              AA / Explorations reduced significantly, also multi-column
                      explorations are
        much faster (10x)</li>
    <li>
      
        64-bit version: AB
              x64 reverted to &quot;Daily&quot; setting when re-entering
                                              AA Settings dialog if user previously
              selected weekly/monthly/quarterly/yearly. Fixed<br>
        </li>
  </ul>
  
    
      <ul>
      </ul>
      <p>&nbsp;</p>
      <p><b>CHANGES FOR VERSION 5.40.0 (as compared to 5.39.0)</b></p>
    <ul>
    <li>
      
        Fixed crash occuring when drawing object was not deselected prior
        to switching symbol</li>
    <li>
      
        Added extra thread safety measure for Foreign()
              so it handles situation
                when other thread is deleting symbol while it is being accessed
        via Foreign()</li>
    <li>
      
        New version (1.3) of 3D chart viewer (O3G) fixes problem
              with Edit-&gt;Copy
                    image function on Vista/Windows 7 with desktop composition
        turned ON</li>
    <li>
      
        Multithreading does not revert to &quot;ON&quot; state
                  on startup when user turned if OFF last time (it was so in
          5.34-5.39 to force
                        testing of
        MT)</li>
    <li>
      
        Temporarily removed asInvoker manifest because it
                created problems with 3rd party programs/plugins that are not
                              Windows 7 compatible
        (QP2, FastTrack)</li>
    <li>
      
        AFL: PercentRank( array, range
        ) implemented<br>
        <br>
        array - input data <br>
        range - lookback range
        <p>Returns percent rank (0...100) of the current element of the array
          within all elements over the specified range. </p>
        <p>A value of 100 indicates that the current element of the array is
          the highest for the given lookback range, while a value of 0 indicates
          that the current value is the lowest for the given lookback range.</p>
        <p>It is equivalent (but 2x faster) to:</p>
        <p>function PercentRank2( Data, Periods)<br>
          {<br>
  &nbsp;Count = 0;<br>
  &nbsp;for ( i = 1; i &lt;= Periods ; i++ )<br>
  &nbsp;{<br>
  &nbsp;&nbsp;&nbsp;Count += Data &gt; Ref( Data, -i );<br>
  &nbsp;}<br>
  &nbsp;return 100 * Count / Periods;<br>
  }<br>
        </p>
      </li>
    <li>
      
        AFL thread termination is safer and faster now
                                          (this also eliminates randomly occuring
          AFL syntax errors when
                                          swithing
                                          layouts)<br>
      </li>
  </ul>
  
      
        <p><b>CHANGES FOR VERSION 5.39.0 (as compared to 5.38.0)</b></p>
        <ul>
          <li>Lookup( array, datetime, mode = 0 ) enhanced to support mode = -2 and
            mode 2<br>
        mode now has following allowable values<br>
        mode = 0 - find exact match, otherwise return Null<br>
        mode = -1 - find exact match, otherwise return nearest predecesor (if datetime
        is past last bar it will return last bar value)<br>
        mode = -2 - find exact match, otherwise return nearest predecessor EXCEPT
        the very last bar (if searched datetime is past last bar it will return Null)<br>
        mode = 1 - find exact match, otherwise return nearest successor (if datetime
        is before first bar it will return first bar value)<br>
        mode = 2 - find exact match, otherwise return nearest successor EXCEPT the
        very first bar (if searched datetime is before first bar it will return Null)<br>
          </li>
          <li>GetPriceStyle() caused chart flashing when different windows had different
            price style selected. Fixed.</li>
          <li>Log output/error messages from AFL engine are now passed to main window
            asynchronously (via PostMessage)</li>
          <li>Chart was not refreshed immediatelly when using drag-drop on single-pane
            charts with non-streaming DB. Fixed</li>
          <li>Account manager: Transactions list: &quot;Gross value&quot; column
            calculation fix.</li>
          <li>Bar Replay dialog has now new checkbox &quot;Reset alert time&quot; that
            resets last alert time for all symbols when you press Play button enabling
            AlertIf() to be triggered again from the start on each replay</li>
          <li>Fixed problem with incorrect reading of previously saved layout/template
            when user decreased number of chart sheets in the preferences</li>
          <li>&quot;Show arrows for current trade&quot; in AA did not work with 12
            hour AM/PM time format. Fixed</li>
          <li>Fixed Lookup() function handling of end-of-day-only records and mode=0
            (exact match).</li>
          <li>Quote Editor: &quot;Use timeshift&quot; checkbox position wasn't adjusted
            when resizing dialog. Fixed.</li>
          <li>Quote Editor was not able to edit quotes after 12:00PM when 12 hour
            AM/PM time format was used. Fixed</li>
          <li>In 5.31.x BETAs syntax error message was displayed without error number.
            Fixed.</li>
          <li>Fixed problem of incorrect allocation of chart value cache when window
            width was below 16 pixels.<br>
          </li>
        </ul>
        <p><b>CHANGES FOR VERSION 5.38.0 (as compared to 5.37.1)</b></p>
        <ul>
          <li>Fixed structure packing in x64 version causing problems with display
            of parameter tooltips for 3rd party DLLs</li>
          <li>WMA had trouble with null handling at the beginning. Fixed.</li>
          <li>Improved CCI accuracy in x64 version (as compared to x86 version)</li>
          <li>Added switch to turn reset chart zoom level when loading layout<br>
        Tools-&gt;Preferences, &quot;Charting&quot; <br>
&quot; Reset zoom to default when loading layout&quot;
        <p>- by turning this ON, zoom level gets reset to default number of bars
          as defined in preferences for<br>
          any loaded layout, bringing old (pre-5.37) behaviour<br>
        </p>
          </li>
          <li>AFL: FIR( array, coefficients, size ) implemented<br>
        This function implements general-purpose Finite Impulse Response filter (FIR)<br>
        http://en.wikipedia.org/wiki/Finite_impulse_response
        <p>The output is convolution of input aray with coefficents table (impulse
          response table).</p>
        <p>The function performs automatic normalization of coefficient table if
          necessary (if its sum is not 1)</p>
        <p>INPUTS:<br>
          array - input array to be smoothed<br>
          coefficients - array of FIR coefficients<br>
          size - number of coefficients ( filter_order + 1 )</p>
        <p>It is functional (but 2+ times faster) equivalent of following AFL:</p>
        <p>function FIR_AFL( input, coeff, size )<br>
          {<br>
          result = 0;<br>
          sumcoeff = 0;<br>
          for( i = 0; i &lt; Min( size, BarCount ); i++ )<br>
          {<br>
          sumcoeff += coeff[ i ];<br>
          result += coeff[ i ] * Ref( input, - size + i + 1 );<br>
          }</p>
        <p> return result/sumcoeff;<br>
          }</p>
        <p>For example 5 bar weighted moving average can be written:<br>
          coeff[ 0 ] = 1;<br>
          coeff[ 1 ] = 2;<br>
          coeff[ 2 ] = 3;<br>
          coeff[ 3 ] = 4;<br>
          coeff[ 4 ] = 5;</p>
        <p>FIR( Close, coeff, 5 );</p>
        <p>Another example: ALMA which is FIR filter with shifted Gaussian coefficents
          can be implemented as follows:</p>
        <p>function ALMA_AFL( input, range, Offset, sigma )<br>
          {<br>
          local m, im, s, Coeff;</p>
        <p> m = floor( Offset * (range - 1) );<br>
          s = range / sigma;</p>
        <p> for( i = 0; i &lt; Min( range, BarCount ); i++ )<br>
          {<br>
          im = i - m;<br>
          Coeff[ i ] = exp( - ( im * im )/ ( 2 * s * s ) );<br>
          }</p>
        <p> return FIR( input, Coeff, range );<br>
          }</p>
          </li>
          <li>AFL: HMA (Hull Moving Average)<br>
        HMA - Hull Moving average it is equivalent to this AFL:
          <p>function HMA_AFL( input, Range )<br>
          {<br>
          return WMA( 2 * WMA( input, int( Range / 2 ) ) - WMA( input, Range ), int(
          sqrt( Range ) ) );<br>
          }<br>
          </p>
          </li>
          <li>AFL: new function: DateTimeAdd( datetime, amount, interval = inDaily
            )<br>
        The function adds specified amount of 'intervals' to input datetime array.<br>
        Allows for example to calculate datetime 5 days back or 13 months into the
        future<br>
        INPUT:<br>
        datetime - scalar or array - the datetime value to add to (for example returned
        by Now(), DateTime() or StrToDateTime/_DT or ConvertDateTime functions)<br>
        amount - number of 'intervals' to add (seconds/minutes/hours/days/etc - depending
        on interval parameter)<br>
        interval - specifies unit you want to add, supported units are in1Second,
        in1Minute, inHourly, inDaily, inWeekly, inMonthly, inQuarterly, inYearly
        <p>RETURNS:<br>
          datetime (scalar or array) - returned type depends on input </p>
        <p>Example 1:</p>
        <p>x = Now( 5 ) ;<br>
          printf(&quot;11 days from now &quot; + DateTimeToStr( DateTimeAdd( x, 11,
          inDaily ) ) ;</p>
        <p>Example 2 (commentary):</p>
        <p>x = Now(5);<br>
&quot; now is &quot; + DateTimeToStr( x );</p>
        <p>for( shift = -12; shift &lt;= 12; shift++ )<br>
          {<br>
          printf(&quot;%g seconds from now is &quot; + DateTimeToStr( DateTimeAdd(
          x, shift, 1 ) ) + &quot;\n&quot;, shift );<br>
          printf(&quot;%g minutes from now is &quot; + DateTimeToStr( DateTimeAdd(
          x, shift, in1Minute ) ) + &quot;\n&quot;, shift );<br>
          printf(&quot;%g hours from now is &quot; + DateTimeToStr( DateTimeAdd(
          x, shift, inHourly ) ) + &quot;\n&quot;, shift );<br>
          printf(&quot;%g days from now is &quot; + DateTimeToStr( DateTimeAdd( x,
          shift, inDaily ) ) + &quot;\n&quot;, shift );<br>
          printf(&quot;%g weeks from now is &quot; + DateTimeToStr( DateTimeAdd(
          x, shift, inWeekly ) ) + &quot;\n&quot;, shift );<br>
          printf(&quot;%g months from now is &quot; + DateTimeToStr( DateTimeAdd(
          x, shift, inMonthly ) ) + &quot;\n&quot;, shift );<br>
          printf(&quot;%g quarters from now is &quot; + DateTimeToStr( DateTimeAdd(
          x, shift, inQuarterly ) ) + &quot;\n&quot;, shift );<br>
          printf(&quot;%g years from now is &quot; + DateTimeToStr( DateTimeAdd(
          x, shift, inYearly ) ) + &quot;\n\n&quot;, shift );<br>
          }<br>
        </p>
          </li>
          <li>AFL: new function: Lookup( array, datetime, mode = 0 )<br>
        The function searches for the bar with specified datetime and returns the
          value from the same position of the input array.<br>
        If exact match can not be found it returns:<br>
        Null - when mode is 0 (zero) - the default behaviour,<br>
        closest predecesor bar value - when mode is -1<br>
        closest successor bar value - when mode is 1
        <p>Example:<br>
          InputDate = &quot;2011-04-05&quot;;<br>
          Title = &quot;Close value at (or before) &quot; + InputDate + &quot; is &quot; +
          Lookup( Close, _DT( InputDate ), -1 );</p>
        <p>This function uses very fast binary search and it is many times faster
          than previous AFL-based methods<br>
          such as FindValueAtDateTime() presented in the past.<br>
          Any call to FindValueAtDateTime ( input, dt, value ) can be now replaced
          with Lookup( input, value )<br>
          (there is no need to pass dt- datetime).</p>
        <p>NOTE: This function does not affect QuickAFL required bars, therefore
          it will only search bars that are actually<br>
          loaded in arrays. For indicators it may mean that it won't be able to find
          value if it is invisible, unless you<br>
          use SetBarsRequired() function to ensure that more bars are loaded.<br>
        </p>
          </li>
          <li>AFL: function _DT( &quot;string&quot; ) added - this is short alias
            for StrToDateTime() function</li>
          <li>AFL: added FirstVisibleValue/LastVisibleValue functions<br>
        // in charts / indicators /interpretation they return the values of array
          at first and last visible bars<br>
        // in other (non-indicator) modes they return array elements with subscripts
        of 0 and BarCount -1 respectively<br>
        // Note that these functions do not affect QuickAFL, so LastVisibleValue
        may be used instead of LastValue<br>
        // These functions are intended to complement functionality already available
        via HighestVisibleValue and LowestVisibleValue
        <p>x = C;<br>
          Plot( x, &quot;x&quot;, colorRed );<br>
          Plot( FirstVisibleValue( x ), &quot;fvv&quot;, colorGreen );<br>
          Plot( LastVisibleValue( x ), &quot;lvv&quot;, colorBlue );</p>
        <p><br>
        </p>
          </li>
          <li>Cum( Null) was causing exception in AFL engine. Fixed</li>
          <li>Print preview flickered when moving the mouse due to frequent refreshes
            when crosshair was enabled. Fixed.</li>
          <li>Structured exception handler is set for every thread for better exception
            reporting<br>
          </li>
        </ul>
        <p><b>CHANGES FOR VERSION 5.37.1 (as compared to 5.36.0)</b></p>
        <ul>
          <li>EncodeColor did not accept colorDefault (-1) in 5.37.0. Fixed 5.37.1.</li>
          <li>AFL Code Wizard 1.01: fixed incompatibility with Internet Explorer
            9 </li>
          <li>AFL: PlotText() internally detects if given x-coordinate is outside
            visible area, skips entire processing and returns zero (without plotting
            anything) for invisible bars. This saves execution time for inefficiently
            written formulas that did not check for visible bars by themselves.</li>
          <li>Report charts now use Formula path as defined in preferences not hard-coded
            one so they work if user has moved his/her formula folder elsewhere</li>
          <li>Fixed crash occuring sometimes on completly blank chart when user set
            number of blank (future) bars to zero (#75570)</li>
          <li>Fixed crash when trying to use Overlay onto blank chart</li>
          <li>AmiBroker is now marked as DPI-aware (this ensures crisp display by
            turning off Win7 DPI virtualization that scales and blurs image on high
            DPI (&gt;=150dpi) displays)</li>
          <li>AFL: added new message: 'Error 52. Invalid argument value. Argument
            must be positive (and not Null))'. The message is displayed when you
            pass incorrect value to a function (like Null as a range to Sum() )</li>
          <li>Layout files now include zoom factor so charts are loaded with most
            recently used zoom level</li>
          <li>Updated version of UI library featuring new appearance themes and alpha-channel
            resize tracker<br>
          </li>
        </ul>
        <p><b>CHANGES FOR VERSION 5.36.0 (as compared to 5.35.0)</b></p>
        <ul>
          <li>AFL Editor more detailed code checks implemented - now displays *warnings*
            (for code parts that are syntactically correct but likely errorneous
            in practice)<br>
          <br>
        Example: Warning 501. Assigment within conditional. Did you mean == instead
        of = ?<br>
        The warning will display if you use = (assignment operator) as a condition
        in <br>
        if(), while(), do-while(), and for() statements and IIf() function
        <p>The result of an = assignment statement is the value of the right-hand
          side of the = statement. You can use an assignment statement as a conditional
          test, but it is not recommended. It usually is the result of a typo where
          a == equality test was intended, as the following example shows:</p>
        <p>Example:<br>
          if( x = 3 ) // x will be assigned with 3 then it is used as &quot;true&quot; value
          so condition is always met - AmiBroker will display warning 501. Assignment
          within conditional<br>
          {<br>
          // this if will ALWAYS be executed<br>
          }</p>
        <p>Probably the user meant:<br>
          if( x == 3 ) // x will be compared to 3<br>
          {<br>
          // this is true conditional part<br>
          }</p>
        <p>If you want to overcome warning 501 while still doing assigment within
          conditional perform a check like this:<br>
          if( ( x = 3 ) == True ) // this NOT cause warning 501<br>
          { <br>
          printf(&quot;test&quot;);<br>
          }</p>
        <p></p>
        <p><br>
        </p>
          </li>
          <li>Temporary workaround for docking window crash when Internet Explorer
            9 is installed and web research window resized</li>
          <li>AFL: GicsID and InGICS added<br>
              <br>
        GicsID( mode )<br>
        returns STRING<br>
        - gives information about current symbol GICS category<br>
        mode = 0 - returns string containing GICS code alone (such as &quot; 15103020&quot;)<br>
        mode = 1 - returns string containing GICS category name (such as &quot;Paper
        Packaging&quot;)<br>
        mode = 2 - returns string containing both code and name (such as &quot;15103020
        Paper Packaging&quot;)
            <p>InGics( &quot;gics_code&quot; )<br>
          - performs yes/no test if current symbol belongs to given GICS category
            for example<br>
          if GICS set for the symbol is 15103020<br>
          InGics(&quot;15&quot;), InGICS(&quot;1510&quot;), InGics(&quot;151030&quot;)
          and InGics(&quot;15103020&quot;) will ALL return true<br>
          but all others (like InGics(&quot;20&quot;)) will return false.</p>
            <p>Example usage:</p>
            <p>&quot;GICS(0) = &quot; + GicsID( 0 );<br>
&quot; GICS(1) = &quot; + GicsID( 1 );<br>
&quot; GICS(2) = &quot; + GicsID( 2 );</p>
            <p>for( i = 10; i &lt; 90; i+= 1 )<br>
          {<br>
          gics_code = StrFormat(&quot;%02.0f&quot;, i ); <br>
          printf(&quot;In Gics '&quot;+ gics_code + &quot;' = %g\n&quot;, InGics(
          gics_code ) );<br>
          }<br>
            </p>
            <br>
          </li>
          <li>In minimised windows RequestTimedRefresh with onlyvisible parameter
            set to False worked unreliably when multithreading was ON. Fixed.</li>
          <li>AFL engine gives more detailed information about exceptions (including
            line numbers and file path)</li>
          <li>Formula editor, indicators and commentary catch all exceptions, not
            only system exceptions</li>
          <li>Fixed potential crash when param dialog is referring to non-existing
            view (NO_CHART_ID)</li>
          <li>AFL: &quot;Unknown exception&quot; should now be reported with line
            numbers for easier identification of ofending function</li>
          <li>AFL: for/while/do-while loops were not executed if syntax or runtime
            error occured before them and &quot;stop parsing on first error&quot; was
            turned off. Fixed<br>
          </li>
        </ul>
        <p><b>CHANGES FOR VERSION 5.35.0 (as compared to 5.34.5)</b></p>
        <ul>
          <li>AFL Editor: &quot;firstvisiblebarindex&quot; and &quot;lastvisiblebarindex&quot; are
            initialized with first and last data bar when using &quot;Verify syntax&quot; to
            avoid problems. Although these Status fields should only be used in indicators,
            it is quite common mistake among users to use them unconditionally</li>
          <li>AFL: Sum() function displays Error 52. Invalid argument value when
            range argument is negative (instead of random crash)</li>
          <li>Account manager: fixed OLE exception in date conversion occuring randomly
            due to uninitialized exit date when trade has been opened.</li>
          <li>Indicator Maintenance Wizard now creates log (indmaint.log in AmiBroker
            directory) that reports all layout files read and eventual errors found.
            It also attempts to read corrupted layouts in a &quot;safe&quot; way
            so it does not crash</li>
          <li>Parameter window: fixed handling of mixed section and section-less
            parameters</li>
          <li>Quote Editor: fixed editing when timeshift was not zero plus added
            ability to turn on/off timeshift (so quotes can be edited in original
            exchange zone)</li>
          <li>Fix: Click on items in param() window did not set focus ( fix @ line
            1505 HotPropCtrl.cpp )</li>
          <li>AFL: Error 10. Subcript out of range message now gives information
            about exactly which array element was accessed</li>
          <li>AFL: Added new error message &quot;Error 51. Array subscript has Null
            value&quot;</li>
          <li>/STACK:2097152,16384 (2M/16K) option for x64 compilation - to allow
            deep nesting in AFL, also reduced stack usage by Execute() function</li>
          <li>Removed (evil) IsBadReadPtr function</li>
          <li>OLE: AB.RefreshAll( [optional] Flags = 1 ) - takes now new optional
            parameter Flags. Flags = 1 means refresh only charts (fast), Flags =
            3 means refresh charts, dialogs, symbol list, chart list, etc (SLOW!)</li>
          <li>OLE: AB.RefreshAll() changed for improved consistency (marks for refresh
            and it is refreshed every 1 second regardless of number of requests within
            one second)</li>
          <li>//--Indicator-End-- special marker is now obsolete and does nothing
            (entire formula is executed). For conditional execution of interpretation
            code use conditional statement if with Status() function</li>
          <li>Fix: switch( str_function_call_here ) did not work properly when expression
            was a function call returning string such as StrLeft(). Fixed</li>
          <li>Fix: internal time conversion (flocaltime) made thread safe using TLS</li>
          <li>AFL: Equity() now uses thread local storage for keeping stop state
            variables to prevent interference when multiple threads call Equity()</li>
          <li>AFL: mtRandom(A) now uses thread local storage, so using non-null seed
            yields reproducible sequence even if multiple threads are calling mtRandom
            in parallel</li>
          <li>Foreign() uses SendNotifyMessage instead of PostMessage if symbol data
            are not already cached to trigger loading quicker (solves support #78278)</li>
          <li>Implemented cross-thread bidirectional communication mechanism that
            allows to call functions across threads in safe way. This allows among
            other things to make non-threading safe APIs (like Quotes Plus) to operate
            properly with multi-threading enabled. (Fixes GetExtraData crash with
            QP2 - FC#2072)</li>
          <li>Prefs/Misc/&quot;Show interpretation in tooltips&quot; checkbox removed
            as this functionality has been removed in 5.32.0. Use Interpretation
            window instead (View-&gt;Interpretation)</li>
          <li>OLE: AB.Import() - UI is automatically refreshed after import so there
            is no need to call RefreshAll() anymore. Also the refresh is &quot;smart&quot; it
            only updates symbol lists if any symbols were added<br>
          </li>
        </ul>
        <p><b>CHANGES FOR VERSION 5.34.5 (as compared to 5.34.0)</b></p>
        <ul>
          <li>Worked around Microsoft OS bug #248760 and #209467 - writing to metafiles
            from multiple threads causes lost object selections. This has caused
            display unstability for Gfx function-generated output. The only way to
            fix that was NOT to use metafiles at all. Gfx code was rewritten not
            to use Microsoft metafiles. As a result of custom implementation Gfx
            functions work now 3 times faster and are multi-threading safe.</li>
          <li>GfxDrawText automatically falls back to much (4x) faster ExtTextOut
            when format is 0 or DT_NOCLIP and string does not contain any new line
            characters</li>
        </ul>
        <p><b>CHANGES FOR VERSION 5.34.0 (as compared to 5.33.0)</b></p>
        <ul>
          <li>Fix: Gfx functions when run in multithreaded mode slowed down over
            time due to Micosoft MFC library GDI wrappers not being thread-safe.
            Fixed by replacing MFC calls with straight WINAPI calls.</li>
          <li>Multi-threading charts are now ON by default and will be reset to ON
            on each restart. This change is temporary but added because some people
            forget to turn this on. </li>
          <li>Fix: When Symbol Lock was ON, currently focused chart did not update
            its quote cache. Fixed</li>
          <li>Fix: Status(&quot;redrawaction&quot;) was giving 0 result for timed
            refreshes in 5.31-5.33 while it should give 1. Fixed.</li>
          <li>Fix: GDI leak found when using Gfx* functions in Automatic Analysis
            that resulted in resource exception after long use. Fixed</li>
          <li>Fix: GDI leak found after Parameter windows &quot;Reset all&quot;.
            Fixed</li>
          <li>Fix: Black screen in Edit-&gt;Image-&gt;Copy as bitmap/Metafile/Export/Send
            e-mail. Fixed. Now uses separate instance of AFL engine not to interfere
            with execution running in the background.</li>
          <li>Fix: AFL engine did not release memory buffer for pre-processed parts
            (#include). Fixed </li>
          <li>AmiBroker now has requestedExecutionLevel set to &quot;asInvoker&quot; in
            its manifest file and that prevents Vista/Windows 7 folder virtualization.
            It also displays a warning message when it does not have write access
            to its working directory.<br>
          </li>
        </ul>
        <p><b>CHANGES FOR VERSION 5.33.0 (as compared to 5.32.1)</b></p>
        <ul>
          <li>OLE: Analysis object - added IsBusy property that allows OLE programs
            to check whenever AA is currently running asynchronous AA operation</li>
          <li>In 5.32.1 only active window was refreshed automatically by streaming
            data - others required mouse click. Fixed.</li>
          <li>In 5.32 formulas using Status(&quot;actionex&quot;) == actionIndicator
            caused blank pane when focused because actionex was NOT indicator. Compatibility
            shim implemented.</li>
          <li>Fixed bad crash occuring when using AddToComposite with atcFlagsEnableInIndicator
            in multi-threaded mode</li>
          <li>Fix: Interval linked charts did not update immediatelly and multi-window
            layouts required click to update after loading. Fixed.</li>
          <li>Fix: Crash @501C30 when doing double right click on Data window</li>
          <li>Dangling pointer to view (after its deletion) removed from timedrefresh
            map and parameter window. This prevents some crashes</li>
          <li>Compat: In 5.32 when SetOption() was placed AFTER custom backtester
            procedure code in user formula - such options did not affect CBT results.
            Technically 5.32 was correct one and 5.30 incorrect (such options affected
            CBT results), but because probably too many user formulas are poorly
            written without taking attention on placement of SetOption() calls and
            that created false bug reports, an old compatible behaviour was restored
            till the time when error messages about wrong placement of SetOption()
            calls are implemented, so users become aware about their coding errors.</li>
          <li>Bug recovery/report dialog now allows the user to type steps required
            to reproduce the crash and select how often given problem occurs</li>
          <li>Attempts to run AA asynchronous operation (Backtest/Optimize/Scan/Explore)
            via OLE while another one is still running are detected and prevented
            (with error message &quot;Automatic Analysis is Busy processing&quot;)</li>
          <li>AFL thread termination routine checks for possible same-process COM
            call deadlock and pumps COM messages if necessary to complete thread
            gracefully<br>
          </li>
        </ul>
        <p><b>CHANGES FOR VERSION 5.32.1 (as compared to 5.32.0)</b></p>
        <ul>
          <li>Fix: when &quot;stop parsing at first error&quot; option was turned
            on &quot;Reset all&quot; button in parameters window caused params to
            disappear. Fixed</li>
          <li>Fix: random crash @7792E25B (small alloc heap corruption) fixed</li>
          <li>Fix: random crash @4BFFF7 (when accessing static variables from multiple
            threads at once). Fixed.</li>
          <li>Fix: Eliminated multi-threaded race condition that randomly caused
            blank charts.<br>
          </li>
        </ul>
        <p><b>CHANGES FOR VERSION 5.32.0 (as compared to 5.31.2)</b></p>
        <ul>
          <li>Parameters work also without _SECTION_BEGIN/_SECTION_END, Parameters
            'Reset All' operation improved</li>
          <li>Interpretation does not use extra execution cycle anymore (text evaluation
            is done within normal indicator execution)</li>
          <li>Formula Editor: Syntax check, Apply indicator, Insert work faster because
            it only uses 100 bars to perform syntax check instead of all bars</li>
          <li>Formula Editor: Code check &amp; profile uses not more than 100K bars</li>
          <li>Fix: Timing display in the chart shows correctly AFL execution and
            redraw time when multi-threading is ON and does not flicker</li>
          <li>Fix: Say() function works properly when multithreading is ON</li>
          <li>Fix: Errors occuring in JScript/VBScript parts do not result in crash
            anymore</li>
          <li>Data Window now allows to choose which of default data elements (OHLCV,
            OI, Aux1/2) to display - use Right click context menu</li>
          <li>Data window display is immediate and does not require extra AFL execution</li>
          <li>Data tooltip readout is immediate - does not use extra execution cycle
            anymore (implemented internal cache)</li>
          <li>When there are no parameters for given indicator - empty brackets are
            not added anymore for display in tooltip/data window and as a return
            value of _DEFAULT_NAME().<br>
          </li>
        </ul>
        <p><b>CHANGES FOR VERSION 5.31.2 (as compared to 5.31.1)</b></p>
        <ul>
          <li>Fixed: Problems with Gfx functions in 5.31.1</li>
          <li>Fixed: Parameters window was not refreshed properly after ResetAll
            in 5.31.1</li>
          <li>Fixed: Crash when switching layouts in 5.31.1</li>
          <li>Fixed: Crash @004C297D - Foreign returned wrong interval in 5.31.1</li>
          <li>Fixed: Crash @0040F91C / @0040FA2B (all references to ChartInfo removed
            from AFL engine) in 5.31.1</li>
          <li>Fixed: Automatic Analysis ignored changes done via SetOption and other
            runtime settings-related changes in 5.31.1</li>
          <li>Fixed: Changing chart display interval did not work immediatelly in
            5.31.1<br>
          </li>
        </ul>
        <p><b>CHANGES FOR VERSION 5.31.1 (as compared to 5.31.0)</b></p>
        <ul>
          <li>fixed crash @0040BACD (using Gfx... functions) when multi-threading
            was enabled </li>
          <li>fixed crash @0041E27C (JScript/VBScript embedded code) when multi-threading
            was enabled </li>
          <li>fixed crash @7686F05D and @004B83EC (load/create new database) when
            multi-threading was enabled </li>
        </ul>
        <p>&nbsp;</p>
        <p><b>CHANGES FOR VERSION 5.31.0 (as compared to 5.30.4)</b></p>
        <ul>
          <li>Major change: <strong>AFL Engine rewritten completely to allow multi-threaded
              execution<br>
            <br>
          </strong>CAVEAT: this is very new code and may not be stable<strong><br>
          <br>
          </strong>This change will lead to several improvements that will be added
            in future versions. First public release of multi-threaded AFL engine
            (5.31.0 BETA) features support for multi-threading in commentary and
            charts.<strong><br>
              <br>
              </strong>By default multi-threaded execution in charts is disabled.
              To enable multi-threaded execution of charts, go to Tools-&gt;Preferences, &quot;AFL&quot; tab
              and check &quot;Multi-threaded charts&quot;.<br>
        Note that once you turn this option on, each chart PANE will execute in separate
        thread, so refreshes of each pane will become completely asynchronous, non-blocking.
        This has quite dramatic (positive) effect on perceived snappiness of user
        interface.<br>
          <br>
        However, there are also things you need to keep in mind. If your formulas
        rely on certain order of execution of panes, they may work incorrectly because
        generally all panes will be executing in parallel, and it depends on complexity
        of formula which one will finish earlier. Also a formula that is quick to
        execute may run several times while the other lenghty one is only finishing
        one run.<br>
        This has also another side effect that Foreign and AddToComposite functions
        when they are used in chart formulas, will operate in asynchronous way (what
        you write with AddToComposite may not necesarily appear instantly if you
        read it back right after using Foreign()), therefore it is recommended to
        use static variables when you need synchronized access between threads.<br>
                <br>
        Since each thread uses approximatelly 1 MB of RAM for thread stack, the memory
        consumption when using multi-threading may be slightly larger.<strong><br>
            <br>
            </strong>There are some things that do not work properly yet when &quot;multi-threading
                charts&quot; are turned on<strong>:</strong>
            <ul>
              <li>Performance meter / chart timing display do not show AFL execution
                times (the values reported are minimal).</li>
              <li>Data tooltips / Data window are still executed in main GUI thread
                and this in theory can lead to problems<strong> </strong>(to improve
                stability it is recommended to turn off price data tooltips in Tools-&gt;Preferences-&gt;Miscellaneous)<strong><br>
                  </strong></li>
            </ul>
          </li>
          <li>$HYBRID now allows importing OpenInterest, Aux1, Aux2 onto existing
            data without need to specify price</li>
          <li>New AFL function: PlaySound( &quot;filename&quot; )<br>
              <br>
        The function plays back specified .WAV file
        <p>returns 1 on success, 0 on failure</p>
        <p>Example:<br>
          PlaySound(&quot;c:\\windows\\media\\ding.wav&quot;);</p>
          </li>
          <li>New AFL function: ShellExecute( &quot;filename&quot;, &quot;arguments&quot;, &quot;workingdir&quot;,
            showcmd = 1 )<br>
          <br>
        The function opens a file or runs executable.
        <p>It is equivalent of Windows API ShellExecute, with one difference, it
          always uses &quot;open&quot; verb.<br>
          This allows running executables, scripts, opening document files using
          their associated editors, etc.</p>
        <p>If the function succeeds, it returns a value greater than 32. If the function
          fails, it returns an error value that indicates the cause of the failure. <br>
          For possible error codes, consult Microsoft documentation:<br>
          http://msdn.microsoft.com/en-us/library/bb762153(VS.85).aspx</p>
        <p>Example: <br>
          ShellExecute(&quot;notepad.exe&quot;, &quot;&quot;, &quot;&quot; );</p>
        <br>
          </li>
          <li>Multiple file open dialogs now use 1MB buffer (instead of 256K)</li>
          <li>OptimizerSetOption and OptimizerSetEngine are now no-ops for anything
            but backtest/optimization action<br>
          <br>
        This prevents random problems when one used OptimizerSetOption or OptimizerSetEngine
        within indicator code.<br>
          </li>
          <li>Value labels are drawn with a little offset from the Y axis. First
            Plot() label is drawn with an arrow pointing out exactly price level</li>
          <li>When main application window is in modal state (displaying File open
            dialog for example), RequestTimedRefresh is held<br>
        This fixes problem with file dialog changing current working directory while
        browsing for directory (FC #1670)<br>
          </li>
          <li>When multiple MDI windows are open and one is maximized, the windows
            in back that are completely obscured by others and minimized windows
            are not redrawn during normal RT refresh<br>
                      <br>
        It is worth noting that if you use RequestTimedRefresh the chart will continue
        to be refreshed periodically even if obscured by other windows.<br>
        If you use RequestTimedRefresh with &quot;onlyvisible&quot; parameter set
        to False, the chart will be also refreshed if it is minimized <br>
          </li>
        </ul>
        <p><b>CHANGES FOR VERSION 5.30.3 (as compared to 5.30.1)</b></p>
      <ul>
      <li>Added GICS property to Stock OLE object</li>
      <li>Tools-&gt;Prefs-&gt;Data &quot;In
        memory cache size&quot; upper limit was
      sometimes calculated incorrectly on 64 bit Windows. Now upper limit is equal
      to physical RAM size even if &gt; 4GB</li>
      <li>RequestTimedRefresh now supports sub-second
        (down to 0.1 sec) resolution, when enabled via registry setting (HKCU/Software/Broker/Settings/EnableHiresRTR,
        DWORD value = 1 )<br>
      </li>
    </ul>
    <p>&nbsp;</p>
    <p><b>CHANGES FOR VERSION 5.30.1 (as compared to 5.30.0)</b></p>
  <ul>
    <li>
      Show arrows for actual trades does not show arrows immediately. Fixed</li>
    <li>
      IB
        plugin: set Aux1/Aux2/OpenInt to zero</li>
    <li>
      Added Gradient Price chart and
            Spread Chart</li>
    <li>
      Default redraw time (when no
         charts are displayed) is set to arbitrary 0.1 sec (instead of 1 sec
      used previously) </li>
    <li>
      Other minor fixes</li>
    <li>
      Performance warning tooltip is popped up automatically
      only once per run unless you exceed 1000% load</li>
    <li>
      Fixed access violation when
          refreshing &quot;Charts&quot; window under extreme
      load</li>
    <li>
      PluginNotification structure is now larger - has pCurrentSINew
                      that is a pointer to new StockInfo structure, while pCurrentSI
                      is reverted
                      to StockInfoFormat4
                      to maintain compatibility with plugins that were no rewritten
                      using new API<br>
    </li>
  </ul>
  
    <p><b>CHANGES FOR VERSION 5.30.0 (as compared to 5.29.6)</b></p>
    <ul>
      <li>When non-existing symbol is typed into &quot;ticker&quot; box, AmiBroker
        will first check if symbol with given Alias does not exist before proposing
        to add new symbol</li>
      <li>AmiBroker now ensures that during writing of data and config files no
        other process is reading or writing to them in order to prevent possible
        data corruption when running multiple simultaneous instances accesing same
        files. In case some other process is working with given file AB will retry
        to access given file within next 0.25 sec and repeat four times before
        failing</li>
      <li>Simple trading from the chart implemented (see &quot;Place a buy/sell
        on chart&quot; buttons in the toolbar and Insert menu) - requires installation
        of auto-trading interface</li>
      <li>Possible small database reading speed enhancements via use of FILE_FLAG_SEQUENTIAL_SCAN</li>
      <li>Parameters file (broker.params) was kept open all the time instead being
        closed right after reading/writing and that could cause problems. Fixed</li>
      <li>New status bar indicator showing performance measure: percentage load
        factor and more info in the tooltip</li>
      <li>Status bar information auto pop time set to 10 seconds to allow easier
        reading</li>
      <li>Filling symbol combo box is speeded up</li>
      <li>&quot; Wait for plugin&quot; shows up only when plugin takes more than
        0.5 sec to initialize/release and uses simpler animation and does not use
        topmost style therefore does not cover IQFeed Connect dialog<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.29.6 (as compared to 5.29.5)</b></p>
    <ul>
      <li><font face="Arial, Helvetica, sans-serif">Race condition between UI threads
          eliminated (resulting in &quot;wait for plugin&quot; window not being
          closed sometimes)</font></li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.29.5 (as compared to 5.29.2)</b></p>
    <ul>
      <li>Sometimes when copying AA list to clipboard three dot (...) sequence
        appeared every 2048 characters of copied text and some characters could
        be missing. Fixed.</li>
      <li>GUI: chart context window items re-arranged - 'Close' menu item moved
        to the bottom and 'Properties' menu item moved to top (after Parameters)</li>
      <li>styleClipMinMax constant is now highlighted in AFL editor</li>
      <li>When different symbol were selected in active chart and in the Symbols
        pane (because of filtering) operations like adding/removing from watchlist
        got confused. Now AmiBroker asks the user what to do.</li>
      <li>NumToStr/WriteVal are polymorphic now (means better performance for scalar
        input arguments)</li>
      <li>Aux1/Aux2 reserved variables are highligted now in AFL editor</li>
      <li>PREV/NEXT sibling keyboard shortcut functionality restored</li>
      <li>Added &quot;wait for plugin&quot; window when switching external plugin-driven
        databases because sometimes plugin may take long time to shutdown/initialize</li>
      <li>New symbol bar: inability to select first symbol after new search when
        previously displayed was one symbol, current symbol is re-selected automatically
        when search string changes. In-place symbol editing disabled.</li>
      <li>Under some circumstances when broker.master was deleted/corrupted/inaccessible
        AmiBroker could hang loading database. Fixed.</li>
      <li>Cum() function does NOT use all bars any more by default.<br>
      In the past versions Cum() functions effectively turned OFF QuickAFL feature
        by requesting all bars to be processed.<br>
      Since Cum() function was popular it caused that many legacy formulas that
      used it were not benefiting from QuickAFL.<br>
      To enable QuickAFL with such formulas now Cum() function does NOT affect
      required bars count (previously it forced all bars).
      <p>This change may lead to different results when comparing with old versions.
        If you are interested in getting old behaviour and use all bars just add:</p>
      <p>SetBarsRequired( sbrAll ) </p>
      <p>anywhere in your formula.</p>
      </li>
      <li>BarIndex() now returns values always starting from zero (even if QuickAFL
        is turned on).<br>
      This change is required because Cum() now does not require all bars and formulas
      mixing Cum(1) and BarIndex would work improperly otherwise. </li>
      <li>Due to operating system changes in Vista and Windows 7, structured exceptions
        like address violations were not handled properly by exception handler
        and caused immediate program exit. Fixed.</li>
      <li>Status() function new fields<br>
      Status can now retrieve &quot;quickaflfirstdatabar&quot; and &quot;quickafllastdatabar&quot;.<br>
      This feature is for internal use only.<br>
      These are bar indexes of actual underlying compressed quotation array that
      make up AFL's array[ 0 ] and array[ BarCount - 1] </li>
      <li>Crash report now properly lists Windows Vista (OS 6.0) and Windows 7
        (OS 6.1)</li>
      <li>Crash recovery window now sends bug reports directly over http (WWW)
        protocol instead of relying on clients' MAPI email program as on Windows
        7 e-mail program is no longer installed by default.<br>
                          <br>
      Improved crash recovery should also be able to catch exceptions in more (all?)
      cases.<br>
      New direct send in future will offer immediate resolution to problem once
      given exception is identified and entered into database.<br>
      Privacy:<br>
      Direct bug reporting allows to send bug report to amibroker.com on user request
      (click on &quot;Send report&quot; button).<br>
      It works over regular http (www) port 80, and sends only the information
      displayed explicitely on screen<br>
      (i.e. AmiBroker version, OS version, crash information, database info (number
      of symbols) and machine info (memory figures)).<br>
      No other information is sent. The user has option to send anonymously (without
      providing e-mail address). Although e-mail<br>
      address is optional, it is recommended to provide one if user wants to receive
      e-mail response to the error report. <br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.29.2 (as compared to 5.29.0)</b></p>
    <ul>
      <li>Some issues with datestamps (including wrong montly compression) were
        introduced by change to EOD markers done 5.29.0. Reverted/fixed.</li>
      <li>New symbol window is properly filled with categories even if not initally
        visible</li>
      <li>New symbol window category/list panes can be resized now</li>
      <li>GetPlaybackDateTime did not return zero when playback was not active
        in 5.27-5.29. Fixed.</li>
      <li>When plugins used InfoSite.AddStock (old one) more than once per symbol
        certain category assignments could be improperly set in 5.27..5.29.0. Fixed.</li>
      <li>Added fopen()/fclose() tracking and error message (Error 51) when user
        forgot to close files. On such error files are automatically closed by
        AB<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.29.0 (as compared to 5.28.1)</b></p>
    <ul>
      <li>ASCII importer: added GICS support<br>
          <br>
      Now you can import GICS symbol-code assignments using ASCII importer.<br>
      $FORMAT command now supports GICS code <br>
      and there is $GICS command for single-symbol files.
      <p>For example if your file looks as follows:<br>
        (format is symbol, full name, gics sub industry code)<br>
        AAN,AARON'S INC,25504060</p>
      <p>Then to import it usign AmiBroker's import wizard use the following<br>
        $FORMAT Ticker,FullName,GICS<br>
        $OVERWRITE 1$<br>
        $SEPARATOR ,<br>
        $CONT 1<br>
        $GROUP 255<br>
        $AUTOADD 1<br>
        $NOQUOTES 1</p>
      <br>
      </li>
      <li>Fixed loading of old AA settings so Chart dimensions are initialized
        with (500,300) instead of zero</li>
      <li>Trade.EntryDateTime, Trade.ExitDateTime were reporting values incompatible
        with DateTimeToStr in 5.27/5.28. Fixed</li>
      <li>Fixed assertion in Import Wizard (refering to non-existing combo box)</li>
      <li>A blank chart timing is now set to arbitrary value of 10ms</li>
      <li>All numeric edit fields in AmiBroker now display numbers in regular (non-scientific)
        notation upto 10^15 and max available precision (7 significant digits in
        case of single-precision IEEE)</li>
      <li>ASCII importer: removed 2^31 cap on volume field and removed some (int)
        conversions that were left from old days</li>
      <li>Implemented protection against re-entrant WM_PAINT messages sent by Vista
        and Win7 during COM calls</li>
      <li>New symbol list is repainted immediately after some changes now.</li>
      <li>Quote Editor in 5.28 editing EOD records caused creation of duplicates.
        Fixed.</li>
      <li>When converting from old database format, Aux1/2 fields are initialized
        with zero instead of some random values.</li>
      <li>When focus was inside new symbol window, accelerator keys did not work
        in 5.28. Fixed<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.28.1 (as compared to 5.28.0)</b></p>
    <ul>
      <li>Re-based DLLs included to increase contiguous virtual memory space</li>
      <li>&quot; Index&quot; category was showing nothing in a new symbol window.
        Fixed.</li>
      <li>Quote Editor - multiple quote deletion was not possible in 5.27/5.28.0,
        only first selected item was deleted. Fixed</li>
      <li>Right-click beyond last symbol in the symbol list in a new symbol window
        caused crash in 5.28. Fixed.</li>
      <li>Changed the way in DateTime() values are coded to support legacy formulas
        that are not using currently recommended comparision method via DateTimeDiff()</li>
      <li>OLE: ZoomToRange() method works for floating windows</li>
      <li>ADK: Added GetDateTimeArray to site interface<br>
          <br>
      GetDateTimeArray returns a pointer to internal date time array. Array of
      DATE_TIME_INT elements.
      <p>The SiteInterface structure now looks as follows (struct size = 40 on
        32-bit platforms, 76 on 64-bit platforms)</p>
      <p> struct SiteInterface <br>
        {<br>
        int	nStructSize;<br>
        int	(*GetArraySize) (void);<br>
        float *	(*GetStockArray)( int nType );<br>
        AmiVar	(*GetVariable) ( const char *pszName );<br>
        void	(*SetVariable) ( const char *pszName, AmiVar newValue );<br>
        AmiVar (*CallFunction) ( const char *pszName, int nNumArgs, AmiVar *ArgsTable
        );<br>
        AmiVar	(*AllocArrayResult) (void);<br>
        void *	(*Alloc) (size_t nSize);<br>
        void	(*Free) (void *pMemory);<br>
        DATE_TIME_INT* (*GetDateTimeArray) (void);<br>
        };</p>
      <br>
      </li>
      <li>In 5.27/5.28 DateTimeConvert function returned incorrect datenum. Fixed</li>
      <li>New symbol list supports selection via typing few first letters (like
        symbol combo)</li>
      <li>When saved Automatic Analysis settings contained some garbage data in
        MaxLongPos/MaxShortPos parameters the backtester could exit with &quot;Not
        enough memory&quot; error. Fixed<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.28.0 (as compared to 5.27.3)</b></p>
    <ul>
      <li>GICS is now available as Filter category (in Automatic Analysis, Quick
        Review and DB Purify)<br>
      </li>
      <li>Completely redesigned Symbol window (View-&gt;Symbol)<br>
      New symbol window now features:<br>
      a) separate category/filter view<br>
      b) full text search with category filtering<br>
      full text search works in two modes:<br>
      - simple substring search (enter the text into &quot;&lt;search&gt;&quot; edit
      and<br>
      it will find all symbols that contain search phrase in either symbol or full
      name (anywhere, not just at the beginning)<br>
      - wildcard search (if you enter the search phrase with either * or ? wildcards<br>
      AmiBroker will perform wildcard search. For example ??? will return only
      3-character symbols, and *-A0-FX - will return all forex symbols on eSignal
      database. Please note that search feature operates on symbols PRESENT in
      the AmiBroker database, it will not find symbols that do not exist in the
      AmiBroker database yet but are generally accessible after importing/adding
      them.<br>
      c) sorting by symbol or by full name<br>
      d) GICS support<br>
      e) hierachical filtering (if you select sector from category view it will
      show symbols <br>
      belonging to all industries within given symbol)<br>
      f) multiple selection of symbols (hold down CTRL key while selecting, or
      SHIFT to select groups)<br>
      allowing watchlist/favorite operation on multiple symbols at once<br>
      g) super-fast operation (all filtering/search/display takes less than 0.01
      sec with 10000 symbols) <br>
      </li>
      <li>Quote Editor Aux1 field was overwritten with value of Aux2 field. Fixed</li>
      <li>Quote Editor column layout/width is saved between sessions (again)</li>
      <li>N-second custom intervals can now be defined in Tools-&gt;Preferences-&gt;Intraday</li>
      <li>GICS categorisation<br>
      AmiBroker now reads GICS.txt file from its installation folder.<br>
      It contains GICS categories listed one by one in order of GICS code in the
      following format<br>
      GICS;Name;Description&lt;CRLF&gt;
      <p>GICS is numeric code from 2 digits upto 8 digits<br>
        Name is GICS category name<br>
        Description is GICS category description<br>
        These fields must be separated by semicolon<br>
&lt; CRLF&gt; means carriage return/line feed characters (means &quot;new line&quot; -
  just press ENTER/RETURN key if you are editing with text editor)</p>
      <p>There must be only one category per line in GICS.txt file</p>
      <p>The default GICS.txt file is supplied already.</p>
      <br>
      </li>
      <li>Added support for GICS to AFL <br>
          <br>
      There is a new constant : categoryGICS that works<br>
      in conjunction with category functions like<br>
      CategoryGetSymbols<br>
      CategoryGetName<br>
      CategorySetName<br>
      CategoryAddSymbol<br>
      CategoryRemoveSymbol<br>
      CategoryFind
      <p>Note that these functions take index parameter, but the meaning of index
        parameter is different for GICS category - the index for categoryGICS is
        actually GICS code. Such as 10 for energy sector or 351010 for &quot;Health
        Care Equipment &amp; supplies&quot; industry. <br>
        The codes are fixed even if new classifications are added at some point
        in the future. This means that you won't need to change AFL codes even
        if new classifications are added. But it is important to understand that
        these codes work in hierarchical way. So<br>
        GetCategorySymbols( categoryGICS, 10 ) will return all symbols belonging
        to energy sector, including those in 10101010 - Oil &amp; Gas Drilling
        sector as well as 10102050 - Coal &amp; Consumable Fuels; for example. <br>
        See<br>
        <a href="http://en.wikipedia.org/wiki/Global_Industry_Classification_Standard" target="_blank">http://en.wikipedia.org/wiki/Global_Industry_Classification_Standard</a><br>
        for more details on GICS system</p>
      <p>NOTE: current databases DO NOT have GICS codes assigned to symbols. <br>
        As far as I know PremiumData <a href="http://www.premiumdata.net/" target="_blank">http://www.premiumdata.net/</a> is
        planning to release AmiBroker-compatible database with GICS support.</p>
      <p></p>
      <br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.27.3 (as compared to 5.27.2)</b></p>
    <ul>
      <li>HighestSince/LowestSince ignored very first bar [0] in the array. Fixed</li>
      <li>Stock object date fields can be set to &quot;empty&quot; by assigning
        zero.</li>
      <li>Aux1,Aux2 added to Import Wizard comboboxes</li>
      <li>View-&gt;Data window is now present in Customization dialog</li>
      <li>Weekly chart was not displayed if settings were to show first date of
        week and first date was before 1970. Fixed.</li>
      <li>Added DateTimeDiff( arg1, arg2 ) AFL function that returns difference
        in seconds between two date time arguments<br>
      It is important to understand that DateTime is not a simple number but rather
      bitset and two datetime values can only<br>
      be reliably compared for equlity or inequality using == or != operators.
      Any other comparisions (less than/greater then)<br>
      using normal operators &gt; &lt; can lead to wrong results, therefore to
      compare two datetime numbers you should use<br>
      DateTimeDiff( arg1, arg2 ) which will return positive values if arg1 &gt; arg2
      and negative values if arg1 &lt; arg2. </li>
      <li>Symbol-&gt;Quote Editor now uses fully virtual mode - it does not require
        extra memory and shows up immediatelly and works fast regardles of number
        of quotes per symbol and is auto-refreshed every 5 sec</li>
      <li>eSignal plugin does not fill AuxData with random data (they are initialized
        with zero now)</li>
      <li>Fixed DateTimeToStr and StrToDateTime</li>
      <li>Fixed crash when saving symbols that had name() longer than 32 characters<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.27.2 (as compared to 5.27.1)</b></p>
    <ul>
      <li>Fixed 16-character name problem in Metastock plugin</li>
      <li>Fixed monthly compression problem present in 5.27.1</li>
      <li>Fixed problem when OLE automation was used to modify symbol properties
        on OLD format databases without saving them first in new format</li>
      <li>Aux1 and Aux2 are new built-in AFL price arrays</li>
      <li>Fixed Text tool bug (Vertical text instead of horizontal in 5.27.1)</li>
      <li>'Avg' field compression with TimeFrameSet fixed.</li>
      <li>Added AUX1 and AUX2 to ASCII importer field definitions</li>
      <li>Auxilliary data fields writable by AddToComposite field &quot;1&quot; (aux1),
        and field &quot;2&quot; (aux2)</li>
      <li> Quotations object added new method: long RetrieveEx(long Count, VARIANT*
        Date, VARIANT* Open, VARIANT* High, VARIANT* Low, VARIANT* Close, VARIANT*
        Volume, VARIANT* OpenInt, VARIANT* Aux1, VARIANT* Aux2);</li>
      <li>Aux1/Aux2 available as properties of Quotation object (OLE interface)<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.27.1 (as compared to 5.27.0)</b></p>
    <ul>
      <li>Fixed incorrect year when importing intraday data using ASCII importer</li>
      <li>Fixed intraday filtering issue that occurred for auto-converted databases</li>
      <li>Market ID was not properly set in 5.27.0 alpha<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.27.0 (as compared to 5.26.5)</b></p>
    <ul>
      <li>
        <p>changed core data structures to support the following</p>
        <ul>
          <li>64 bit date/time field with date range of 4095 years and resolution
            down to microseconds</li>
          <li>floating point volume and open interest fields</li>
          <li>two new auxilliary data fields per bar (internally, not yet exposed)</li>
          <li>100 new user-defined fundamental data fields (internally, not yet
            exposed)</li>
          <li>support for GICS (internally, not yet exposed)</li>
          <li>upto 48 character length in Symbol/Alias/WebID fields</li>
        </ul>
      </li>
      <li>Updated plugins for eSignal, IQFeed, Interactive Brokers, Quotes Plus,
        Metastock to support floating point volume/open int and 64 bit date/time</li>
      <li>Metastock plugin now reads long symbol description</li>
      <li>Symbol lock fixed (does not interfere with Interval linking)</li>
      <li>Added simple &quot;BackupAB.exe&quot; to backup entire AmiBroker folder
        after installation to prevent data in old format.</li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.26.5 (as compared to 5.26.0)</b></p>
    <ul>
      <li>Symbol lock on per-chart window basis (available via padlock button next
        to chart sheet tabs and chart context menu)</li>
      <li>User interface dialogs now use MS Shell Dlg 2 (Tahoma) font on Windows
        2000, XP, Vista and Windows 7</li>
      <li>several minor fixes for 64 bit version</li>
    </ul>
    <ul>
    </ul>
    <p><b>CHANGES FOR VERSION 5.26.0 (as compared to 5.25.0)</b></p>
    <ul>
      <li>Implemented user-definable report charts<br>
          <br>
      Now it is possible for the user to create any number of charts that will
      be automatically generated and included in the backtest report.
      <p>To add user-defined chart to the report, simply save your chart formula
        under &quot;Report Charts&quot; folder.</p>
      <p>That's all. </p>
      <p>Any formula present in the &quot;Report Charts&quot; folder will be executed
        after completion of the backtest using ~~~EQUITY as selected symbol.</p>
      <p>The beta ships with 3 sample charts:<br>
        a) portfolio equity<br>
        b) underwater equity (drawdown)<br>
        c) profit table</p>
      <p>The charts are displayed in alphabetical order (using file name as a chart
        name).</p>
      <p></p>
      <br>
      </li>
      <li>Built-in price arrays (OHLC, V, OI, Avg) are protected against assigning
        the value of wrong type (non-array)<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.25.0 (as compared to 5.24.0)</b></p>
    <ul>
      <li>StaticVarGet() now has additional parameter - align<br>
          <br>
      StaticVarGet(&quot;varname&quot;, align = True );
      <p>second parameter - 'align' - booleand True/False, default: True<br>
        - decides whenever AmiBroker performs timestamp synchronization/alignment
          or not.</p>
      <p>The default value is True and it means that values stored in static variables<br>
        are retrieved and aligned to currently selected symbol data/timestamp<br>
        on each bar basis so data for corresponding date/time stamps match.<br>
        This is recommended setting and this is the way it worked in previous versions.</p>
      <p>When align is switched to False - it means that AmiBroker does not perform<br>
        any checks nor any alignment and will fill the array with consecutive values<br>
        stored in static array regardless of their timestamps.<br>
        If there are less bars in the static array than in the current arrays,
        the last<br>
        value of static array will be propagated till BarCount - 1.</p>
      <p>It is advised NOT to use align=False, unless you know exactly what you
        are doing<br>
        and you are aware that date/time stamps have no meaning in particular variable<br>
        or in case when date/time stamps are are aligned using your own method.</p>
      <p>Note that speed difference between align 'on' and 'off' is usually negligible<br>
        because alignment algorithm is very fast and has similar complexity as
          plain<br>
        memory copy.</p>
      <br>
      </li>
      <li>AFL: HighestVisibleValue( array ), LowestVisibleValue( array )<br>
        <br>
      Two new functions that calculate single value (not array) representing<br>
      highest and lowest values of given array within VISIBLE range (on chart).<br>
      Should be applied only in indicators as only indicators have concept of &quot;visible&quot; bars.<br>
      The function will return Null value if no visible bars are present.
      <p>They are equivalent to the following coding:<br>
        <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> HighestVisibleValueEquivalent(
          array ) <BR>
        { <BR>
&nbsp;bv = </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"barvisible"</FONT><FONT COLOR=#000000>); <BR>
&nbsp;Hh = -</FONT><FONT COLOR=#800080>1e8</FONT><FONT COLOR=#000000>; <BR>
        </FONT><FONT COLOR=#800000><B>&nbsp;for</B></FONT><FONT COLOR=#000000>(
        i = </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>; i &lt; </FONT><FONT COLOR=#000000><B>BarCount</B></FONT><FONT COLOR=#000000>;
        i++ ) <BR>
&nbsp;{ <BR>
&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>(
  bv[ i ] </FONT><FONT COLOR=#000000><B>AND</B></FONT><FONT COLOR=#000000> array[
  i ] &gt; Hh ) Hh = array[ i ]; <BR>
&nbsp;} <BR>
        </FONT><FONT COLOR=#800000><B>&nbsp;return</B></FONT><FONT COLOR=#000000> hh; <BR>
        } <BR>
        <BR>
        </FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> LowestVisibleValueEquivalent(
        array ) <BR>
        { <BR>
&nbsp;bv = </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"barvisible"</FONT><FONT COLOR=#000000>); <BR>
&nbsp;ll = </FONT><FONT COLOR=#800080>1e8</FONT><FONT COLOR=#000000>; <BR>
        </FONT><FONT COLOR=#800000><B>&nbsp;for</B></FONT><FONT COLOR=#000000>(
        i = </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>; i &lt; </FONT><FONT COLOR=#000000><B>BarCount</B></FONT><FONT COLOR=#000000>;
        i++ ) <BR>
&nbsp;{ <BR>
&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>(
  bv[ i ] </FONT><FONT COLOR=#000000><B>AND</B></FONT><FONT COLOR=#000000> array[
  i ] &lt; ll ) ll = array[ i ]; <BR>
&nbsp;} <BR>
        </FONT><FONT COLOR=#800000><B>&nbsp;return</B></FONT><FONT COLOR=#000000> ll; <BR>
        }</FONT></CODE></p>
      <p>As you can see the AFL equivalent is simple, but native functions<br>
        are faster.</p>
      <br>
      </li>
      <li>When user picks a drawing tool, AmiBroker offers switching to default
        layer (0) if current layer is not visible<br>
      </li>
      <li>StaticVarRemove(&quot;varname&quot;) now supports wildcards in the variable
        name<br>
        <br>
&quot;varname&quot; parameter can be either exact variable name or wildcard match
  string.<br>
      The '*' matches any number of characters, including zero characters. The
      '?' matches exactly<br>
      one character.
      <p>Example 1:</p>
      <p>StaticVarRemove(&quot;MyVariables*&quot;);<br>
        // this will remove all static variables beginning with MyVariables prefix.</p>
      Example 2:<br>
      <br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>StaticVarSet</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"DifferentName"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ); <BR>
      <BR>
      </FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>"Total
      static variables = %g\n\n"</FONT><FONT COLOR=#000000>, StaticVarCount() ); <BR>
        <BR>
        </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>( i = </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>;
          i &lt;= </FONT><FONT COLOR=#800080>5</FONT><FONT COLOR=#000000>; i++
          ) <BR>
          </FONT><FONT COLOR=#800000><B>&nbsp;&nbsp;for</B></FONT><FONT COLOR=#000000>(
          j = </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>; j &lt;= </FONT><FONT COLOR=#800080>5</FONT><FONT COLOR=#000000>;
          j++ ) <BR>
&nbsp;&nbsp; { <BR>
&nbsp;&nbsp;&nbsp;&nbsp; VarName = </FONT><FONT COLOR=#800080>"Test_X="</FONT><FONT COLOR=#000000> +
  i + </FONT><FONT COLOR=#800080>"_Y="</FONT><FONT COLOR=#000000> + j; <BR>
&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Setting
  variable "</FONT><FONT COLOR=#000000> + VarName + </FONT><FONT COLOR=#800080>"\n"</FONT><FONT COLOR=#000000> ); <BR>
&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT COLOR=#0000ff>StaticVarSet</FONT><FONT COLOR=#000000>(
  Varname, </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ); <BR>
&nbsp;&nbsp; } <BR>
      <BR>
      </FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>"Total
      static variables = %g\n\n"</FONT><FONT COLOR=#000000>, StaticVarCount() ); <BR>
        <BR>
        </FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>"Now
          wildcard remove *X=1*\n"</FONT><FONT COLOR=#000000> ); <BR>
          <BR>
          </FONT><FONT COLOR=#0000ff>StaticVarRemove</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>"*X=1*"</FONT><FONT COLOR=#000000> ); <BR>
          <BR>
          </FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>"Total
          static variables = %g\n\n"</FONT><FONT COLOR=#000000>, StaticVarCount()
          ); <BR>
          <BR>
          </FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>"Now
          wildcard remove Test*\n"</FONT><FONT COLOR=#000000> ); <BR>
          <BR>
          </FONT><FONT COLOR=#0000ff>StaticVarRemove</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>"Test*"</FONT><FONT COLOR=#000000> ); <BR>
          <BR>
          </FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>"Total
          static variables = %g\n\n"</FONT><FONT COLOR=#000000>, StaticVarCount()
          ); <BR>
          <BR>
          </FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Removing
          'differenname' variable\n"</FONT><FONT COLOR=#000000>); <BR>
          <BR>
          </FONT><FONT COLOR=#0000ff>StaticVarRemove</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"DifferentName"</FONT><FONT COLOR=#000000> ); <BR>
          <BR>
          </FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>"Total
          static variables = %g\n\n"</FONT><FONT COLOR=#000000>, StaticVarCount()
          );</FONT></CODE><br>
      </li>
      <li>StaticVarCount function added - returns the total number of static variables
        in memory<br>
        <br>
      </li>
      <li>Study() function now allows to specify which Y scale to use (Study( studyid,
        chartid, scale = -1))<br>
        <br>
      Study( studyid, chartid = 1, scale = -1 )
      <p>scale parameter specifies which scale should be used<br>
        scale = -1 : automatic (default value) - either linear or logarithmic depending
          on actual chart setting, chart is specified by chartID<br>
        scale = 0 : linear scale<br>
        scale = 1 : logarithmic scale</p>
      <br>
      </li>
      <li>data and optimizer plugins are loaded later (saves upto 15MB of RAM)<br>
      </li>
      <li>Fixed GetChartBkColor function<br>
      </li>
      <li>&quot; show trading arrows&quot; feature optimized for significantly
        lower CPU usage<br>
      </li>
      <li>hi-density (&gt;2x more data bars than pixels) variable color styleHistogram
        charts are plotted with correct colors<br>
      </li>
      <li>less reallocations in real-time mode, 10% performance improvement and
        less fragmentation<br>
      </li>
      <li>arrays for storing dynamic stop levels are only allocated/filled when
        needed (saves about 10% of AFL setup time)<br>
      </li>
      <li>Added miny/maxy parameters to SetChartBkGradient (allows gradient area
        charts in combination with cloud style)<br>
            <br>
      Example Gradient Area chart:<br>
      <br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> PlotGradientArea(
      array, caption, ColorTop, ColorBottom ) <BR>
      { <BR>
&nbsp;bkclr = </FONT><FONT COLOR=#0000ff>GetChartBkColor</FONT><FONT COLOR=#000000>(); <BR>
      <BR>
&nbsp;HH = <font color="#0000FF">HighestVisibleValue</font>( array ); <BR>
      </FONT><FONT COLOR=#800000><B>&nbsp;if</B></FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>NOT</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#0000ff>IsNull</FONT><FONT COLOR=#000000>(
      hh ) ) </FONT><FONT COLOR=#0000ff>SetChartBkGradientFill</FONT><FONT COLOR=#000000>(
      ColorTop, ColorBottom, bkclr, </FONT><FONT COLOR=#000000><B>Null</B></FONT><FONT COLOR=#000000>,
      HH ); <BR>
      </FONT><FONT COLOR=#0000ff>&nbsp;Plot</FONT><FONT COLOR=#000000>( array,
      Caption, </FONT><FONT COLOR=#0000ff>ColorBlend</FONT><FONT COLOR=#000000>(
      ColorBottom, </FONT><FONT COLOR=#000000><B>colorBlack</B></FONT><FONT COLOR=#000000> )
      ); <BR>
      </FONT><FONT COLOR=#0000ff>&nbsp;PlotOHLC</FONT><FONT COLOR=#000000>( HH,
      HH, array, HH, </FONT><FONT COLOR=#800080>""</FONT><FONT COLOR=#000000>,
      bkclr, </FONT><FONT COLOR=#000000><B>styleNoLabel</B></FONT><FONT COLOR=#000000> | </FONT><FONT COLOR=#000000><B>styleNoTitle</B></FONT><FONT COLOR=#000000> | </FONT><FONT COLOR=#000000><B>styleCloud</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>Null</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>Null</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>,
      -</FONT><FONT COLOR=#800080>10</FONT><FONT COLOR=#000000> ); <BR>
      } <BR>
      <BR>
      </FONT><FONT COLOR=#969696>_SECTION_BEGIN</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Price"</FONT><FONT COLOR=#000000>); <BR>
      </FONT><FONT COLOR=#0000ff>SetChartOptions</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#000000><B>chartShowArrows</B></FONT><FONT COLOR=#000000>|</FONT><FONT COLOR=#000000><B>chartShowDates</B></FONT><FONT COLOR=#000000>); <BR>
      </FONT><FONT COLOR=#0000ff>_N</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>Title</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#0000ff>StrFormat</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"{{NAME}}
      - {{INTERVAL}} {{DATE}} Open %g, Hi %g, Lo %g, Close %g (%.1f%%) {{VALUES}}"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>O</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>H</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>L</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>SelectedValue</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>ROC</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> )
      ) )); <BR>
      PlotGradientArea( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"Close"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>ParamColor</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Top"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorLightOrange</B></FONT><FONT COLOR=#000000>), </FONT><FONT COLOR=#0000ff>ParamColor</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Bottom"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorPaleGreen</B></FONT><FONT COLOR=#000000> )
      ); <BR>
      <BR>
      </FONT><FONT COLOR=#969696>_SECTION_END</FONT><FONT COLOR=#000000>(); <BR>
    </FONT></CODE></li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.24.0 (as compared to 5.23.0)</b></p>
    <ul>
      <li>typeof() incorrectly returned compile-time type instead of run-time type.
        Fixed.</li>
      <li>Static array variables implemented<br>
          <br>
      StaticVarSet( name, value ) and<br>
      StaticVarGet( name )<br>
      AFL functions now accept arrays in addition to numbers (scalars).
      <p>Static arrays can be even 100 faster than AddToComposite/Foreign, however
        these two are not strictly equivalent.<br>
        There are following limitations / differences of static arrays as compared
        to Foreign/AddToComposite:<br>
        a) static array variables store only as many bars as there are currently
        in use by given chart <br>
        (so they do not affect QuickAFL in any way). This is different that AddToComposite
        that forces usage and store of all bars.<br>
        b) static array variables work best if you read them using the same interval
        as they were written to. I.e when you create static array variables using
        5-minute chart, for best results read them in some other 5-minute chart.
        Reading in different intervals is possible, but subject to limitations<br>
        of timestamping (see below)<br>
        c) when you read static variable in a different interval that it was originally
        stored, <br>
        static variables perform padding/synchronization and time compression/decompression
        automatically in a similar way as foreign,<br>
        however Foreign compresses data always from base-time interval, while static
        variables operate on previously stored interval,<br>
        hence result may differ. For example, if previously stored data was in
        daily interval, and you read such static variable in intraday<br>
        chart, you will see essentially flat lines for each day, representing static
        data from daily interval. <br>
        d) static array variables do not work well for non-time based intervals
        (tick/n-volume/n-tick) because timestamps in those intervals<br>
        may not be unique (i.e. several bars may have same time stamp), so time
        synchronization is not reliable.<br>
        e) static array variables are little slower than normal AFL variables,
        so for best performance, use read-once, write-once paradigm, using<br>
        temporary normal variable for any processing during formula execution,
        like this:<br>
        // start of the formula:<br>
        temp = StaticVarGet(&quot;mystaticarray&quot; );</p>
      <p>// now perform all necessary calculations using temp variable</p>
      <p>temp = Nz(temp) + C/2;<br>
        ...</p>
      <p>// at the end of the formula store to static<br>
        StaticVarSet(&quot;mystaticarray&quot;, temp ); </p>
      <br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.23.0 (as compared to 5.22.0)</b></p>
    <ul>
      <li>Font used by progress window, string input, tip of the day, search file
        is now &quot;MS Shell Dlg&quot; (the same as elsewhere in AB) that means
        that is CoolType friendly (TTF)<br>
        <br>
      </li>
      <li>AFL: SetOption(&quot;ExtraColumnsLocation&quot;, col) - this new option
        allows the user to change the location of custom columns added during backtest/optimization<br>
        <br>
&quot;extra&quot; columns mean:<br>
      a) any custom metrics added using custom backtester<br>
      b) any optimization parameters defined using Optimize() function
      <p>If both custom metrics and optimization parameters are present then<br>
        custom metrics appear first then optimization parameters</p>
      <p>This function is provided to allow the user to change the default &quot;at
        the end&quot; location of custom columns/optimization parameters.<br>
        For example</p>
      <p>SetOption(&quot;ExtraColumnsLocation&quot;, 1 );</p>
      <p>will cause that custom metrics and opt params will be subsequently added
        starting from column 1 (as opposed to last column default)</p>
      <p>Note that this setting changes &quot;visual&quot; order of columns, not
        really in-memory order or export order, so<br>
        exported data files or copy/paste format do not change.</p>
      <br>
      </li>
      <li>Implemented hiding columns in all list views (right click over list view
        HEADER to bring &quot;Setup Columns&quot; dialog)<br>
        <br>
      </li>
      <li>Storing column state (widths/ordering/visibility) in automatic analysis
        implemented<br>
      The widths, ordering and visibility of all built-in columns in automatic-analysis
      is stored between runs.<br>
      This works for each operation mode (i.e. scan/backtest/optimization) separately,
      so column setup<br>
      for scan does not affect stored column order for backtest, as well as state
      of columns for optimization does not<br>
      affect backtest, etc.<br>
      Note also that state of exploration mode is not stored, due to its complete
      user-configurability from AFL level.<br>
        <br>
      </li>
      <li>Data Window implemented (available from View-&gt;Data Window menu)<br>
        <br>
      (if you can not see this menu, you would need to reset the menu using Tools-&gt;Customize,
      select &quot;Menu Bar&quot; and then press &quot;Reset&quot; button).
        <p>If you prefer to use Data Window over data tooltips, you can turn off
          data tooltips using Tools-&gt;Preferences, &quot;Miscellaneous&quot; tab,
          UNCHECK &quot;Price data tooltips&quot; box.</p>
        <br>
      </li>
      <li>Home key was working incorrectly when more than one pane was used in
        the chart. Fixed<br>
        <br>
      </li>
      <li>Implemented simple performance monitor Tools-&gt;Performance Monitor<br>
      Showing some memory and usage statistics:<br>
      - number of symbols in the database<br>
      - number of symbols cached in RAM<br>
      - quotation data memory usage<br>
      - current symbol memory usage<br>
      - total chart refresh time<br>
      - real-time data stream update frequency
      <p>The contents of the window is updated automatically every 3 seconds</p>
      <p>This tool is intended to be used now for two purposes:<br>
        a) tweaking cache settings for best RAM usage (for example optimizations
          will run faster if all quotation data can be kept in RAM)<br>
        b) monitoring real-time performance</p>
      <p>More uses will probably come in the future.</p>
      <br>
      </li>
      <li>Time&amp;Sales window now shows some &quot;recent statistics&quot; regarding
        trading<br>
          <br>
      Time&amp;Sales window now shows some &quot;recent statistics&quot; regarding
      trading namely:<br>
      - number of trades and average # of trades per second<br>
      - number of trades and shares traded at ask or above<br>
      - number of trades and shares traded at bid or below<br>
      - ask minus bid difference expressed in number of trades and shares <br>
      - ask minus bid difference expressed as percentage ratio to total trades/total
      volume traded
      <p>A little background:<br>
        Ask minus bid: the positive numbers represent more transactions occuring
          on ASK side than on BID side.<br>
        This in theory may mean more buying than selling, but in practice things
        are largely dependent<br>
        on security traded. Esp. dark liquidity pools do not show in order books
        and <br>
        may report trades to the tape several seconds later thus invalidating relationship
        between<br>
        bid/ask and actual trade prices.</p>
      <p>IMPORTANT: <br>
        These are temporary, short-term stats - they cover ONLY trades displayed
          in the T&amp;S window since opening of the window OR<br>
        resetting stats.</p>
      <p>You can reset statistics using right click menu : &quot;Reset Stats&quot;</p>
      <br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.22.0 (as compared to 5.21.0)</b></p>
    <ul>
      <li>added ability to extend blank chart area by pressing END key multiple
        times (each time 10 blank bars are added) and restoring preferences value
        by subsequent pressing of HOME key.<br>
      </li>
      <li>added option to always require variable declarations (using local/global)
        on formula-by-formula basis:<br>
      SetOption(&quot;RequireDeclarations&quot;, True );<br>
      global test1;<br>
      test1 = 5; // OK variable declared<br>
      test2 = 3; // error: assignment without declaration<br>
      <br>
      </li>
      <li>added typeof() operator<br>
          <br>
      The typeof operator is used in the following way: <br>
      typeof (operand)<br>
      The typeof operator returns a string indicating the type of the *unevaluated*
      operand. operand is the string, variable, function identifier, or object
      for which the type is to be returned. <br>
      When supplying identifier, it should be provided alone, without arithmetic
      operators, without extra arguments and without braces. <br>
      If you want to check the type of value returned by the function, you must
      first assign the return value to a variable and then use<br>
      typeof( variable ).<br>
      Possible return values are:<br>
&quot; undefined&quot; - identifier is not defined <br>
&quot; number&quot; - operand represents a number (scalar)<br>
&quot; array&quot; - operand represents an array<br>
&quot; string&quot; - operand represents a string<br>
&quot; function&quot; - operand is a built-in function identifier<br>
&quot; user function&quot; - operand is a user-defined function<br>
&quot; object&quot; - operand represents COM object<br>
&quot; member&quot; - operand represents member function or property of COM object<br>
&quot; handle&quot; - operand represents Windows handle <br>
&quot; unknown&quot; - type of operand is unknown (should not happen)typeof operator
  allows among other things to detect undefined variables in the following way<br>
      if( typeof( somevar ) == &quot;undefined&quot; )<br>
      {<br>
      /// when somevar is undefined the code here will execute<br>
      }<br>
      The following sample COMMENTARY code shows the output of <br>
      typeof in some common situations<br>
      x = MACD();<br>
      y = LastValue( x );<br>
      function testfun() { return 1; };<br>
      printf( typeof( test ) + &quot;\n&quot; ); // the undefined variable<br>
      printf( typeof( 1 ) + &quot;\n&quot;); // literal number<br>
      printf( typeof( &quot;checking&quot; ) + &quot;\n&quot;); // literal string<br>
      printf( typeof( x ) + &quot;\n&quot;); // array variable<br>
      printf( typeof( y ) + &quot;\n&quot;); // scalar variable<br>
      printf( typeof( MACD ) + &quot;\n&quot;); // function identifier<br>
      printf( typeof( testfun ) + &quot;\n&quot; ); // user function identifier<br>
      <br>
      </li>
      <li>GetSignalQty member function of Backtester object returned zero. Fixed
        now</li>
      <li>In the Plot() function Xshift parameter was used as z-order in 5.21 beta.
        Fixed now.</li>
      <li>Plot, PlotOHLC and PlotForeign() are no longer limited to -5..+5 zorder
        range. You can use any zorder value now. <br>
          <br>
      Note that if you use zorder outside default range -5..+5, you may see performance
      degradation for big positive and big negative z-order values.<br>
      Approximate performance penalty is 10 milliseconds for 100 z-orders (or 1ms
      for 10 z-orders)<br>
          <br>
      </li>
      <li>SetChartOptions now adds ability to programmatically extend blank space
        on chart-by-chart basis<br>
        <br>
      SetChartOptions( Mode = 0, Flags = 0, gridFlags = chartGridMiddle, ymin =
      0, ymax = 0, blankbars = 0 )<br>
      New, 6th parameter &quot;blankbars&quot; defines the minimum number of blank
      bars for given chart. The default value of zero means no change<br>
      (use preferences setting).<br>
      if specified value is less than value set in preferences, it is ignored,
      so you can not decrease the blank bars below value set in preferences.<br>
      if many panes within same chart use this function, then the largest specified
      blankbars will be used<br>
      Note that you can still extend blank space further using END key.<br>
      Special feature - if &quot;blankbars&quot; is negative then extra blank bars
      added are equal to absolute value of blankbars parameter plus chart gets
      scrolled to rightmost position. <br>
      Caveat: forcing custom blankbars via SetChartOptions effectivelly disables
      HOME key scroll to begin operation. <br>
        <br>
      </li>
      <li>the feature to extend blank area via mouse wheel and &gt; button is removed,
        due to complaints received<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.21.0 (as compared to 5.20.0)</b></p>
    <ul>
      <li>Added optional data padding for non-trading days (switchable from View-&gt;Pad
        non-trading days menu) - for daily and higher intervals only (FC#1136,FC#1174)</li>
      <li>All drawing tools now can define Z-order (from -5 to +5).<br>
        <br>
      Z-order. <br>
      Imagine that you could see the drawing objects arranged on the chart page
      like puzzle pieces on a table. Some objects may appear to be placed one on
      top of another, and others may be overlapping.<br>
      This third dimension of chart page is known as &quot;Z order.&quot; If the
      X axis relates to width and the Y axis to height, then the Z order relates
      to depth. Although Z order cannot be seen directly, just as can you position
      objects along X and Y (horizontal and vertical) axes, you can also position
      them in the Z order.<br>
      Every object on the page has its Z order, positioned in back to front order,
      so that objects at the front will take precedence over objects behind. <br>
      Z order gives you the ability to superimpose objects one on top of another. <br>
      You can change Z-order parameter using Properties dialog<br>
      as well as using Format-&gt;Z-Order-&gt;Bring Forward / Send Backward menus<br>
      (and default keystrokes Shift+Page Up, Shift+Page Down)<br>
      Negative values mean BEHIND axis/grid, positive mean above grid.<br>
      </li>
      <li>Blank area past last available quote can be now enlarged on the fly by
        simply using &gt; arrow in the scroll bar or using mouse wheel (just roll
        the wheel past the last bar) (FC #430,#1516, #1500, #1239, #982, #808,
        #561 )</li>
      <li>CBT: Backtester.GetSignalQty( bar, type ) method implemented (FC#1671)<br>
        <br>
      Backtester object<br>
      GetSignalQty( bar, type ) method<br>
      - retrieves the number of signals occuring on given bar<br>
      type = 0 - both entry and exit signals<br>
      type = 1 - only entry signals<br>
      type = 2 - only exit signals<br>
      Note that AmiBroker to conserve memory keeps track only of 2 * MaxNumberOfPositions
      entry signals on any single bar,<br>
      however it keeps track of ALL exit signals (because they consume much less
      space and at the time of signal collection<br>
      it is not known which positions are already open, so all exits must be tracked
      to prevent missing an exit)<br>
      </li>
      <li>E-mail alerts can now be sent through different port than 25 (see Tools-&gt;Preferences-&gt;Alerts)
        (FC#1641)<br>
      </li>
      <li>Early warning of indicator space running out. At application exit the
        message is displayed when less than 10% indicator space is left, plus an
        offer to run Indicator Maintenance (FC#1667)</li>
      <li>new AFL functions ColorBlend<br>
          <br>
      ColorBlend( colorFrom, colorTo, factor = 0.5 )<br>
      - the function blends (mixes) colorFrom with colorTo with 'factor' proportion
      using the following algorithm<br>
      RGB = ( 1 - factor ) * RGB(colorFrom) + factor * RGB(colorTo );<br>
      So factor = 0 means use colorFrom only, factor = 1 means use colorTo only.
      All in-between values<br>
      mean create mix of colors. The lower the factor value means more colorFrom.<br>
      This function makes it easy to lighten or darken colors like this:<br>
      function ColorLighten( color ) <br>
      {<br>
      return ColorBlend( color, colorWhite, 0.5 );<br>
      }<br>
      function ColorDarken( color )<br>
      {<br>
      return ColorBlend( color, colorBlack, 0.5 );<br>
      }<br>
      </li>
      <li>Plot, PlotForeign and PlotOHLC now have new parameter zorder which defines
        the Z-axis position of given plot. (FC#257)<br>
        <br>
      zorder can be set from -5 to 5.<br>
      The default is zero. <br>
      Zorder = 0 means also where the &quot;grid&quot; is located. <br>
      So if you want to plot BEHIND the grid you need to specify negative zorder
      parameter.<br>
      Smaller values mean draw first (i.e. BEHIND others), higher values mean draw
      later (ON TOP of others).<br>
      Plots are drawn in the following order:
      <ul>
        <li>zorder parameter takes precedence over the order of calling Plot()
          functions, so if z-order is set, it determines plotting order. <br>
        See <a href="http://www.amibroker.com/gifs/zorder.gif">http://www.amibroker.com/gifs/zorder.gif</a></li>
        <li>If multiple plots use the same z-order parameter they are plotted in
          reverse call order (ones that appear last in the code are plotted first).
          This rule can be changed by already existing switch graphzorder = 1 which,
        when specified, reverses this behaviour (so plots are drawn in call order).</li>
      </ul>
      Please note the above applies to each zorder &quot;layer&quot; separately
      (so within same zorder &quot;layer&quot; reverse call rule applies) <br>
      This may sound complicated but is required for backward compatibility.<br>
      Example: <br>
      Bollinger bands with &quot;cloud&quot; fill behind price (zorder = -1)<br>
                <CODE><FONT COLOR=#000000>P = </FONT><FONT COLOR=#0000ff>ParamField</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Price
                field"</FONT><FONT COLOR=#000000>,-</FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>); <BR>
      Periods = </FONT><FONT COLOR=#0000ff>Param</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Periods"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>15</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>2</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>100</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ); <BR>
      Width = </FONT><FONT COLOR=#0000ff>Param</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Width"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>2</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>10</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>0.05</FONT><FONT COLOR=#000000> ); <BR>
      Color = </FONT><FONT COLOR=#0000ff>ParamColor</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Color"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorLightGrey</B></FONT><FONT COLOR=#000000> ); <BR>
      Style = </FONT><FONT COLOR=#0000ff>ParamStyle</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Style"</FONT><FONT COLOR=#000000>)
      | </FONT><FONT COLOR=#000000><B>styleNoRescale</B></FONT><FONT COLOR=#000000>;; <BR>
              </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( bbt
                = </FONT><FONT COLOR=#0000ff>BBandTop</FONT><FONT COLOR=#000000>(
                P, Periods, Width ), </FONT><FONT COLOR=#800080>"BBTop"</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#969696>_PARAM_VALUES</FONT><FONT COLOR=#000000>(),
                Color, Style ); <BR>
                </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( bbb
                = </FONT><FONT COLOR=#0000ff>BBandBot</FONT><FONT COLOR=#000000>(
                P, Periods, Width ), </FONT><FONT COLOR=#800080>"BBBot"</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#969696>_PARAM_VALUES</FONT><FONT COLOR=#000000>(),
                Color, Style ); <BR>
                </FONT><FONT COLOR=#0000ff>PlotOHLC</FONT><FONT COLOR=#000000>(
                bbt, bbt, bbb, bbb, </FONT><FONT COLOR=#800080>""</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>ColorBlend</FONT><FONT COLOR=#000000>(
                Color, </FONT><FONT COLOR=#000000><B>colorWhite</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>0.9</FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#000000><B>styleCloud</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>Null</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>Null</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>Null</B></FONT><FONT COLOR=#000000>,
                -</FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> );</FONT></CODE><br>
      </li>
      <li>Rectangle and Ellipse drawing tool now are by default SOLID, with default
        fill color being a blend between background and selected drawing color,
        they are use ZOrder = -1 (behind regular plots) by default</li>
      <li>Support for SSL (secure connection) e-mail alerts added, so now you can
        use your GMail accounts. (FC#83)<br>
      Steps:<br>
      1. Download and install AmiBroker 5.21 or higher<br>
      2. Download and run SSL add-on from <a href="http://www.amibroker.com/bin/SSLAddOn.exe">http://www.amibroker.com/bin/SSLAddOn.exe</a><br>
      3. Configure (Tools-&gt;Preferences-&gt;Alerts) with SSL enabled as shown
      in this picture:<br>
        <a href="http://www.amibroker.com/gifs/gmailalert.gif">http://www.amibroker.com/gifs/gmailalert.gif</a><br>
      </li>
      <li>X-Y co-ordinate labels on axes implemented. Can be controlled using View-&gt;X-Y
        labels menu. (FC#1621, FC#732)</li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.20.0 (as compared to 5.19.0)</b></p>
    <ul>
      <li>AFL: new function StrCount( &quot;string&quot;, &quot;substring&quot; )<br>
          <br>
      Function returns integer which is number of times substring was found in
      string. It is case sensitive.
      <p>The function can be used for example to count the number of commas in
        comma-separated list</p>
      <p>tickers = &quot;AAPL,MSFT,INTC&quot;;</p>
      <p>numtickers = 1 + StrCount( tickers, &quot;,&quot; );</p>
      <br>
      </li>
      <li>AFL: StrExtract( &quot;string&quot;, item ) now accepts negative item
        values allowing to address items counting from the END of the list<br>
          <br>
      tickers = &quot;AAPL,MSFT,INTC&quot;;
      <p>&quot;The last item is &quot; + StrExtract( tickers, -1 );</p>
      <p>printf(&quot;listing from the end of the list:\n&quot;);</p>
      <p>for( item = -1; ( sym = StrExtract( tickers, item ) ) != &quot;&quot;;
        item-- )<br>
        {<br>
        printf( sym + &quot;\n&quot; );<br>
        }</p>
      </li>
      <li>
        <p>minor fixes</p>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.19.0 (as compared to 5.18.0)</b></p>
    <ul>
      <li>Internal log window deletes all items if &quot;!CLEAR!&quot; text is
        outputted (FC 1552)<br>
      Example:<br>
      _TRACE(&quot;!CLEAR!&quot;); // this clears the internal log window.<br>
      _TRACE(&quot;First line after clear&quot;); <br>
      </li>
      <li>SetOption(&quot;RefreshWhenCompleted&quot;, True) added. This performs
        View-&gt;Refresh All once AFTER AA operation is completed<br>
        <br>
      Under normal circumstances it is not needed to use that because AmiBroker
      refreshes ticker tree if necessary,<br>
      for example if use AddToComposite. It may be useful if you however use OLE
      automation inside AA and you don't want to trigger too many refreshes using
      RefreshAll().<br>
      This only works in Automatic Analysis, when used in indicator code it has
      no effect.<br>
      </li>
      <li>Sometimes AddSummaryRows was not working when AB.RefreshAll() was used
        in the formula. Fixed now. (FC1550)<br>
        <br>
      </li>
      <li>Date time calendar disappeared when streaming update arrived. Fixed now.
        (FC 1572)<br>
      </li>
      <li>Equity ticker symbols (~~~EQUITY, BESTEQUITY, ISEQUITY, OSEQUITY) marked
        with special flag so they are not used (skipped) in backtest</li>
      <li>Fib Timezones tool now displays lines 144 and 233 too. (FC20)<br>
      </li>
      <li>math functions (sin,cos,log, ...) added to profiler reporting (array
        versions only)<br>
      </li>
      <li>RT quote and log window tab sheet drag-drop marker is visible again<br>
      </li>
      <li>Y-axis scale labels do not overlap even if chart is very compressed<br>
            <br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.18.0 (as compared to 5.17.1)</b></p>
    <ul>
      <li>AFL: CategorySetName() function<br>
          <br>
      CategorySetName( name, category, number )
      <p>Function sets the name of category (group,market, watch list, industry)</p>
      <p>Arguments;<br>
        name - a new name for the category (in case of watch lists it has to be
          unique)<br>
        category - type of category, one of the following: categoryMarket, categoryGroup,
        categorySector, categoryIndustry, categoryWatchlist<br>
        number - the number (index) of the category 0.255 for market, group industry,
        0..32 for sectors, 0...unlimited for watch lists<br>
        Please note that the function will also create watch list of given index
        if one does not exist.</p>
      <p>&nbsp;</p>
      </li>
      <li>Added protection against trying to use 3d graph on non-exhaust optimization</li>
      <li>ParamToggle default value not shown after &quot;Reset all&quot; in AA
        [#52129]. Fixed</li>
      <li>added &lt;= 0 check for log10 calls to protect from FPU exceptions when
        using log chart scale</li>
      <li>Added error message that prevents from running &quot;Current symbol&quot; backtest
        on IS/OOS/Best equity special tickers</li>
      <li>Added symbol validity check in backtest &quot;Apply To: Current symbol&quot;</li>
      <li>In detailed log mode the backtester now reports reason why trade is not
        entered</li>
      <li>Line studies were not visible on Yearly and Qtrly charts. Fixed</li>
      <li>Progress window does not steal focus from active window (prevents some
        random crashes when &quot;run every&quot; is used)</li>
      <li>When &quot;run every&quot; is used progress window is displayed minimized
        when AA is minimized<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.17.1 (as compared to 5.17.0)</b></p>
    <ul>
      <li>In 5.17.0 &quot;Current symbol&quot; selection in AA always used first
        symbol in the database. Fixed.</li>
    </ul>
    <ul>
    </ul>
    <p><b>CHANGES FOR VERSION 5.17.0 (as compared to 5.16.0)</b></p>
    <ul>
      <li>Log Window implemented<br>
          <br>
      Log window (<b>View-&gt;Log</b>) allows to view:<br>
      edit-time errors displayed during formula check<br>
      run-time errors that occur when formula is running (not edited)<br>
      _trace command output within AmiBroker (without using 3rd party debug view)
      <p>To perform tasks such clearing the output, copying, changing settings
        use right - mouse click over the log window list.<br>
        Double click on the error line brings up the editor, so you can fix the
        error easily.</p>
      <p>While &quot;edit-time&quot; error list is cleared automatically each time
        you check the syntax in the editor, the run-time error list is NOT cleared,
        so all errors remain listed, even if they are fixed already, unless you
        manually clear the list.</p>
      <p>Note that _TRACE output is by default directed to outside debugger (like
        DebugView), in order to enable internal display you need to switch appropriate
        option in the Tools-&gt;Preferences-&gt;AFL You can choose to display internally
        / externally or in both places.<br>
        Internal _trace has much lower performance penalty (order of magnitude)
        than external, but that is achieved by the fact that<br>
        internal log window is refreshed only when application is not busy. It
        is appropriate for some uses, but you may prefer more immediate<br>
        refresh offered by DebugView.<br>
      </p>
      </li>
      <li>Zooming via Scroll bar improved. Now it works with wider range of zoom
        factors and also does not disable scoll bar when all quotes are visible.
        As accessibility feature, you can temporarily DISABLE zoom via scroll bar
        by pressing and holding down CTRL key.</li>
      <li>Added extra protection against going out of drawing array bounds in GetNextDrawing</li>
      <li>when broker.master file was loaded, some symbol temporary data were read
        from non-zeroed memory, fixed now</li>
      <li>fixed display glitch that occurred on some bars when logarithmic scale
        was used and chart was drawn using compression (2x more bars than pixels)</li>
      <li>When application is closed in Minimized state, the x,y co-ords of main
        window are not stored</li>
      <li>styleHistogram chart when drawn in compressed mode could fail to display
        some negative spikes (below base level) in 5.16. Fixed.</li>
      <li>inQuarterly and inYearly higlighted in AFL editor now</li>
      <li>SetBarFillColor could not make candle with same body and outline color.
        Fixed now.</li>
      <li>Fixed handling Null in styleArea chart (Null was ignored in 5.16)</li>
      <li>32bit AmiBroker is now compiled with LARGEADDRESSAWARE flag, that allows
        it to use 3GB on 32 bit Windows versions that have /3GB boot flag enabled
        and 4GB on 64 bit Win</li>
      <li>First sorted column is drawn with darker color now (as in Windows explorer)</li>
      <li>Layouts are displayed in alphabetical order now (previously they were
        sorted only if files were stored on NTFS partition)</li>
      <li>When from-to range of backtest was small, AB sometimes allocated too
        large cache for portfolio backtest than necessary. Now it is fixed and
        should provide speed up for short range backtests.<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.16.0 (as compared to 5.15.0)</b></p>
    <ul>
      <li>If in-memory cache was too small, it could happen that Walk-Forward kept
        old equity values in ~~~BESTEQUITY. Fixed now.</li>
      <li>AFL: Faster LR. Added constant-period version of linear regression calc
        - reduces complexitiy from O(N^2) to O(N)<br>
        <br>
      Constant-period LinearReg, LinRegSlope, LinRegIntercept, TSF and StdErr functions
      execute now order(s) of magnitude faster.<br>
      </li>
      <li>AFL: new GetChartBkColor function<br>
          <br>
      Returns RGB color value of chart background. Sample code:
      <p>SetChartBkColor( ParamColor(&quot;Color&quot;, ColorRGB( 255, 255, 255
        ) ) );</p>
      <p>rgb = GetChartBkColor();</p>
      <p>red = ( rgb &amp; 255 );<br>
        green = floor( (rgb/256) &amp; 255 );<br>
        blue = floor( rgb/(256*256) );</p>
      <p>Title=&quot;R=&quot;+ red + &quot; G=&quot; + green + &quot; B=&quot; +
        blue;</p>
      </li>
      <li>Candlestick style switches back to bar chart when number of bars displayed
        is twice the number of screen pixels</li>
      <li>eSignal plugin 1.9.0 (fixes to problem with RT update of certain foreign
        future markets such as NSF)</li>
      <li>IBController 1.2.0
          <ul>
            <li>following TWS API changes ignoreRth and rthOnly flags are removed
              and replaced with single flag: outsideRTH</li>
            <li>IBc now allows to define which error codes should be ignored using
              File-&gt;Error code ignore list</li>
            <li>upgraded to use latest TWS API 9.41 (tested with latest TWS 885.7,
              requires at least 879)</li>
          </ul>
      </li>
      <li>Improved speed of Day(), Month(), Year(), DaysSince1900(), DayOfWeek(),
        DayOfYear() functions on intraday data (upto 20x faster)</li>
      <li>Improved speed of DayOfWeek(), DayOfYear(), DaysSince1900() on EOD data
        (upto 2x faster)</li>
      <li>Optimized chart drawing for large number of bars, upto 10x faster when
        more than 70000 bars are visible on screen<br>
        <br>
      The drawing algorithm switches to optimized drawing mode when just one line
      draw per horizontal pixel is performed if there are 2x or more bars than
      screen pixels.<br>
      </li>
      <li>Say() function has now ability to queue speak requests<br>
            <br>
      Say( &quot;Text&quot;, purge = True );
      <p>when purge is set to True (the default) - any call to Say() purges all
        previous speak requests (queued or in-progress) and speaks<br>
        specified text immediatelly.</p>
      <p>when purge is set to False - speak request is queued and will be spoken
        right after previous requests are done.</p>
      <p>Also now Say() function returns the NUMERIC value that indicates how many
        speak requests are pending<br>
        0 - ERROR - speech engine not installed or not working properly<br>
        1 - currently requested text is spoken now (queue was empty)<br>
        2 or more - queue was not empty and previous request(s) will be completed
        prior to speaking currently specified text</p>
      <br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.15.0 (as compared to 5.14.0)</b></p>
    <ul>
      <li>SetForeign called multiple times with &quot;tradeprices&quot; parameter
        set to True freed memory only partially. Now fixed.</li>
      <li>Equity() function does not cause exception when running backtest with
        QuickAFL enabled</li>
      <li>Equity() function does not require all past bars anymore when used in
        AA</li>
      <li>OptimizerSetEngine(&quot;&quot;) in some circumstances selected random
        plugin. Fixed now.</li>
      <li>When user has aborted optimization during in-sample step, the previously
        used opt params were not freed. Fixed.</li>
      <li>Implemented command line parameter that allows to specify the database
        to load at startup. /database &quot;the path to the database here&quot;</li>
      <li>In some places C-runtime mktime() was used leading to problems with dates
        prior to 1970. Fixed now.</li>
      <li>During custom backtester phase the ~~~EQUITY ticker is protected from
        flushing out of cache (it could only happen if using OLE to access quotes
        inside CB proc)</li>
      <li>Now ~~~BESTEQUITY, ~~~ISEQUITY, ~~~OSEQUITY are not flushed out from
        the cache during WF even if cache is small (ensures no missing parts in
        IS/OOS chart)</li>
      <li>Single-symbol optimization now also uses QuickAFL (when enabled). Requirements
        for the first symbol are calculated in setup phase. To get &quot;most safe&quot; requirement
        estimation, the setup phase uses maximum values of opt params.<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.14.0 (as compared to 5.13.0)</b></p>
    <ul>
      <li> added support for Quarterly and Yearly intervals in all parts of the
        program
          <ul>
            <li>new menu items under View interval</li>
            <li>new AFL constants inQuarterly, inYearly</li>
            <li>Yearly and Quarterly charts compression</li>
            <li>updated TimeFrame functions <br>
            </li>
          </ul>
      </li>
      <li>Changes to drawing made in v5.13 caused improper drawing lines located
        PAST the last available quote (trendlines and pitchforks) when timestamping
        method was &quot;START TIME of interval&quot;. This is fixed now.<br>
          <br>
      </li>
      <li>Fixed AddSummaryRows so 'onlycols' parameter default (zero) is applied
        properly<br>
        <br>
      </li>
      <li>Implemeted &quot;Select all&quot; via Ctrl-A keyboard shortcut for all
        list (result list in AA for example)<br>
        <br>
      </li>
      <li>Mouse cursor shape (moving/sizing) reflects the selected study priority
        when more than one study exists under mouse position<br>
        <br>
      </li>
      <li>new multiple Volume At Price charts at user-defined points via new PlotVolumeOverlayA
        function<br>
        <br>
      PlotVAPOverlayA( segments, lines = 300, width = 80, color = colorLightGrey,
      vapstyle = 4);
      <p>segmens - is an array which holds 0 and 1 (False/True) values, where 1
        indicates starting/ending point of each VAP segment</p>
      <p>AmiBroker will draw as many segments as there are '1' in the array. Note
        that minimum segment length is 2, so if entire array is filled with 1-s
        only, <br>
        it won't draw anything. In other words, there must be zeros (at least one)
        between 1's.</p>
      <p>Simplest example:</p>
      <p><CODE><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"Close"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorBlack</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>styleCandle</B></FONT><FONT COLOR=#000000> ); <BR>
        segments = </FONT><FONT COLOR=#0000ff>IIf</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>Interval</FONT><FONT COLOR=#000000>() &lt; </FONT><FONT COLOR=#000000><B>inDaily</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>Day</FONT><FONT COLOR=#000000>(), </FONT><FONT COLOR=#0000ff>Month</FONT><FONT COLOR=#000000>()
        ); </FONT><FONT COLOR=#008000>// draw daily or monthly VAP segments depending
        on display interval</FONT><FONT COLOR=#000000> <BR>
        segments = segments != </FONT><FONT COLOR=#0000ff>Ref</FONT><FONT COLOR=#000000>(
        segments , -</FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ); <BR>
          <BR>
          <font color="#0000FF">PlotVAPOverlayA</font>( segments );</FONT></CODE></p>
      <p><br>
        More complex example:<br>
        <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#969696>_SECTION_BEGIN</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Price"</FONT><FONT COLOR=#000000>); <BR>
        </FONT><FONT COLOR=#0000ff>SetChartOptions</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#000000><B>chartShowArrows</B></FONT><FONT COLOR=#000000>|</FONT><FONT COLOR=#000000><B>chartShowDates</B></FONT><FONT COLOR=#000000>); <BR>
        </FONT><FONT COLOR=#0000ff>_N</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>Title</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#0000ff>StrFormat</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"{{NAME}}
        - {{INTERVAL}} {{DATE}} Open %g, Hi %g, Lo %g, Close %g (%.1f%%) {{VALUES}}"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>O</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>H</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>L</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>SelectedValue</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>ROC</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> )
        ) )); <BR>
          </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"Close"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>ParamColor</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Color"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorBlack</B></FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#000000><B>styleNoTitle</B></FONT><FONT COLOR=#000000> | </FONT><FONT COLOR=#0000ff>ParamStyle</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Style"</FONT><FONT COLOR=#000000>)
            | </FONT><FONT COLOR=#0000ff>GetPriceStyle</FONT><FONT COLOR=#000000>()
            ); <BR>
            </FONT><FONT COLOR=#969696>_SECTION_END</FONT><FONT COLOR=#000000>(); <BR>
            <BR>
            </FONT><FONT COLOR=#969696>_SECTION_BEGIN</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"VAP"</FONT><FONT COLOR=#000000>); <BR>
        segments = </FONT><FONT COLOR=#0000ff>IIf</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>Interval</FONT><FONT COLOR=#000000>() &lt; </FONT><FONT COLOR=#000000><B>inDaily</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>Day</FONT><FONT COLOR=#000000>(), </FONT><FONT COLOR=#0000ff>Month</FONT><FONT COLOR=#000000>()
        ); <BR>
        segments = segments != </FONT><FONT COLOR=#0000ff>Ref</FONT><FONT COLOR=#000000>(
        segments , -</FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ); <BR>
          <BR>
          <font color="#0000FF">PlotVAPOverlayA</font>( segments , </FONT><FONT COLOR=#0000ff>Param</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Lines"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>300</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>100</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>1000</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#0000ff>Param</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Width"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>80</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>100</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#0000ff>ParamColor</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Color"</FONT><FONT COLOR=#000000>, <B>colorGold</B> ), </FONT><FONT COLOR=#0000ff>ParamToggle</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Side"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"Left|Right"</FONT><FONT COLOR=#000000> )
            | </FONT><FONT COLOR=#800080>2</FONT><FONT COLOR=#000000> * </FONT><FONT COLOR=#0000ff>ParamToggle</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Style"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"Fill|Lines"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>)
            | </FONT><FONT COLOR=#800080>4</FONT><FONT COLOR=#000000>*</FONT><FONT COLOR=#0000ff>ParamToggle</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"Z-order"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"On
            top|Behind"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> )
            ); <BR>
            </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>(segments, </FONT><FONT COLOR=#800080>""</FONT><FONT COLOR=#000000>, <B>colorLightGrey</B>, <B>styleHistogram</B> | <B>styleOwnScale</B> ); <BR>
        </FONT><FONT COLOR=#969696>_SECTION_END</FONT><FONT COLOR=#000000>();</FONT></CODE></p>
      <br>
      </li>
      <li>QuickAFL can now be used in Automatic Analysis (Settings: General: &quot;Use
        QuickAFL&quot; - check this box) - this can speed up explorations, scans
        and backtests by factor of 2+ if range is less than &quot;all quotations&quot;<br>
        <br>
      More on QuickAFL feature here: <a href="http://www.amibroker.com/kb/2008/07/03/quickafl/" target="_blank">http://www.amibroker.com/kb/2008/07/03/quickafl/</a><br>
      <br>
      </li>
      <li>Range Bars compression now uses TickSize as &quot;1R step&quot;. TickSize
        defined in the Symbol Information, if its value is zero, then 1R would
        be equivalent to 0.01 movement (for backward compat)<br>
        <br>
      </li>
      <li>selecting date in multiple linked charts is now faster because redraw
        is not made when selected line in higher compressed interval remains in
        place<br>
        <br>
      </li>
      <li>selector line in linked charts works OK now, regardless of selected time
        compression timestamping method<br>
        <br>
      </li>
      <li>SetBarsRequired accepts now values -2 in special meaning: reference ALL
        bars<br>
        <br>
      So<br>
      SetBarsRequired( -2, -2 ); // require ALL past and future bars - this turns
      OFF quickAFL
      <p>(Note that in pre 5.14 versions, such combination does NOTHING, and with
        those versions one needed<br>
        to write SetBarsRequired( 1000000, 1000000 ) to achieve the same effect)</p>
      <p>For readability sbrNoChange (-1) and sbrAll (-2) constants were added
        so you can write:</p>
      <p>SetBarsRequired( sbrAll, sbrAll );</p>
      <br>
      </li>
      <li>Sometimes progress bar did not show the name of optimization engine used.
        Now it is fixed<br>
        <br>
      </li>
      <li>Status(&quot;ActionEx&quot;) provides more codes than Status(&quot;action&quot;)
        to detect special executions states<br>
        <br>
      Status(&quot;ActionEx&quot;) provides more detailed information about action
      that triggered AFL execution. Note that 5 first codes are the same as Status(&quot;action&quot;)
      but scope is limited to 'core'<br>
      meaning (see notes below).<br>
      Possible values<br>
      1 - actionIndicator - when indicator is being repainted<br>
      2 - actionCommentary (NOTE: commentary only, not interpretaion nor tooltip)<br>
      3 - actionScan - when AA Scan is performed<br>
      4 - actionExplore - when AA exploration is performed<br>
      5 - actionBacktest (NOTE backtest only, no optimization)<br>
      8-9 - reserved for future use<br>
      10 - actionExAAShowArrows - when AA &quot;Show arrows&quot; command is used<br>
      11 - actionExAAParameters - when AA &quot;Parameters&quot; dialog is displayed/updated<br>
      12 - actionExEditVerifyFormula - when AFL editor verifies syntax <br>
      13 - actionExOptimizeSetup - when Optimize() parameters are read (to setup
      optimization engine)<br>
      14 - actionExOptimizeBacktest - when Backtest is performed as a part of optimization
      process<br>
      15- actionExOptimizePortfolio - when portfolio-backtest phase (CUSTOM backtester)
      is performed as a part of optimization process<br>
      16 - actionExTooltip - when tooltip for given chart is being displayed/updated<br>
      17 - actionExInterpret - when the Interpretation window is being updated<br>
      18 - actionExInit - when AA needs to initialize QuickAFL bars required information
      and/or formula contains functions changing general AA options
      <p>NOTE: for backward compatiblity with all formulas you have written already,
        the codes for Status(&quot;action&quot;) did NOT change .</p>
      <br>
      </li>
      <li>Streaming chart update could stall if trend line handle was clicked in
        attempt to resize and released in the very same position (without moving
        the mouse). Now it is fixed.<br>
        <br>
      </li>
      <li>TimeFrameMode() now supports mode == 4 - which expresses RANGE bars in
        TickSize units (as opposed to mode 3 that uses dollars for backward compatiblity)<br>
        <br>
      </li>
      <li>when display chart timing option is turned on and RT stream is active
        the application STATUS BAR now displays TOTAL time for all charts, it should
        be BELOW 1 second for RT trading<br>
                  <br>
                  <br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.13.0 (as compared to 5.12.2)</b></p>
    <ul>
      <li>Main app window maximize state on 2nd monitor is saved OK now.<br>
      </li>
      <li>Trendlines drawn in smaller interval (such as 1-minute), was moved one
        bar in higher interval (such as 5 minute) if compressed intraday timestamps
        ware set to START time of interval or FIRST tick <br>
      </li>
      <li>The left-hand handle moved to the next bar when it was off-screen and
        right-hand handle was adjusted by the user. Now it is fixed. (FC#890)<br>
      </li>
      <li>When drawing is clicked without moving the mouse, the co-ordinates stay
        untouched ( snap is not activated until you move the mouse)<br>
      </li>
      <li>AFL: AddSummaryRows changed<br>
          <br>
      AddSummaryRows( flags, format = 0, onlycols = 0, ...)
      <p>AddSummaryRows automatically adds &quot;summary&quot; row(s) to the exploration
        output.<br>
        the flags parameter can be combination of the following<br>
        1 - add TOTAL row<br>
        2 - add AVERAGE row<br>
        4 - add MIN row<br>
        8 - add MAX row<br>
        16 - add COUNT row</p>
      <p>format - defines the numeric formating in WriteVal style so 1.2 for example
        means 2 decimal digits.<br>
        If default value of zero is used (or parameter not specified) the default
        formatting of &quot;maximum precision&quot;<br>
        is used - upto 15 digits are printed</p>
      <p>onlycols - defines for which columns you want to display summary row values.<br>
        Note that if you do not specify any columns - ALL will be printed.</p>
      <p>If you are using onlycols, you can define upto 10 columns, columns, like<br>
        in SetSortColumns are numbered starting from 1. For example:</p>
      <p>AddSummaryRows( 1, 1.2, 3, 5, 7, 9 ); </p>
      <p>Display sum for columns: 3, 5, 7, and 9.</p>
      <p>Generally you should call this funciton only once, using combination of
        flags desired.<br>
        But it is possible to call AddSummaryRows multiple times and the result
        will be &quot;accumulation&quot; (i.e. bitwise OR)<br>
        in case of &quot;flag&quot; parameter. format and onlycols are always overwritten
        by last call.</p>
      <p>Example:</p>
      <p>Filter=1;<br>
        AddColumn(V, &quot;Volume&quot; );<br>
        AddSummaryRows( 31, 1.2 ); // add Total, Average, Min, Max, and Count rows
        (1+2+4+8+16)=31 - with two decimal places<br>
        summary rows are added at the top of the list</p>
      <br>
      </li>
      <li>Handles from selected study line are respected (i.e when study is already
        selected, and multiple studies exists under &quot;click&quot; point, the
        selection does not change) (FC#726)<br>
      </li>
      <li>Magnet mode can be asynchronously (temporarily) toggled by holding SHIFT
        key while drawing. Toggle means that if you are in magnet mode and hold
        down shift it will turn it off and vice versa<br>
      </li>
      <li>Magnet mode implemented for horizontal price levels and working correctly
        now (stay horizontal) (FC#728)<br>
      </li>
      <li>During optimization Progress bar shows engine ID, opt. target, best value,
        step and best combination of parameters found upto &quot;now&quot;. These
        figures are refreshed every second.<br>
      </li>
      <li>Optimization (in non-WF mode) results are sorted by optimization target
        column (too)<br>
      </li>
      <li>New optimization engine added: CMAE (Covariance Matrix Adaptation Evolutionary
        Strategy) optimizer plug-in<br>
        <br>
      CMA-ES (Covariance Matrix Adaptation Evolutionary Strategy) is state-of-the-art
      non-exhaustive optimizer.<br>
      For scientific background see:<br>
      <a href="http://www.bionik.tu-berlin.de/user/niko/cmaesintro.html" target="_blank">http://www.bionik.tu-berlin.de/user/niko/cmaesintro.html</a><br>
      According to scientific benchmarks outperforms nine other, most popular evolutionary
      strategies (like PSO, Genetic and Differential evolution).<br>
        <a href="http://www.bionik.tu-berlin.de/user/niko/cec2005.html%20" target="_blank">http://www.bionik.tu-berlin.de/user/niko/cec2005.html </a>
        <p>The CMAE.DLL plugin implements &quot;Global&quot; variant of search
          with several restarts with increasing population size<br>
        CMAE.DLL comes with FULL SOURCE CODE (inside &quot;ADK&quot; folder) </p>
        <p>By default number of runs (or restarts) is set to 5. <br>
        It is advised to leave the default number of restarts.<br>
        You may vary it using OptimizerSetOption(&quot;Runs&quot;, N ) call, where
        N should be in range 1..10.<br>
        Specifying more than 10 runs is not recommended, although possible.<br>
        Note that each run uses TWICE the size of population of previous run so
        it grows exponentially.<br>
        Therefore with 10 runs you end up with population 2^10 greater (1024 times)
        than the first run.</p>
        <p>There is another parameter &quot;MaxEval&quot;. The default value is
          ZERO which means that plugin will automatically calculate MaxEval required.
          It is advised to NOT to define MaxEval by yourself as default works fine.</p>
        <p>The algorithm is smart enough to minimize the number of evaluations
          required and it converges VERY fast to solution point, so usually it
          finds solutions way faster than other strategies.</p>
        <p>It is normal that the plugin will skip some evaluations steps, if it
          detects that solution was found, therefore you should not be surprised
          that optimization progress bar may move very fast at some points. The
          plugin also has ability to increase number of steps over initially estimated
          value if it is needed to find the solution. Due to its adaptive nature,
          the &quot;estimated time left&quot; and/or &quot;number of steps&quot; displayed
          by the progress dialog is only &quot;best guess at the time&quot; and
          may vary during optimization course.</p>
        <p>To use CMA-ES optimizer, you just need to add one line to your code:</p>
        <p>OptimizerSetEngine(&quot;cmae&quot;);</p>
        <p>This will run the optimization with default settings which are fine
          for most cases.</p>
        <p>It should be noted, as it is the case with many continouos-space search
          algorithms, that decreasing &quot;step&quot; parameter in Optimize()
          funciton calls does not significantly affect optimization times. The
          only thing that matters is the problem &quot;dimension&quot;, i.e. the
          number of different parameters (number of optimize function calls). The
          number of &quot;steps&quot; per parameter can be set without affecting
          the optimization time, so use the finest resolution you want. In theory
          the algorithm should be able to find solution in at most 900*(N+3)*(N+3)
          backtests where &quot;N&quot; is the dimension. In practice it converges
          a LOT faster. For example the solution in 3 (N=3) dimensional parameter
          space (say 100*100*100 = 1 million exhaustive steps) can be found in
          as few as 500-900 CMA-ES steps. <br>
        </p>
      </li>
      <li>New optimization engine added: &quot;Tribes&quot; adaptive PSO optimizer
        implemented<br>
        <br>
      Tribes is adaptive, parameter-less version of PSO (particle swarm optimization)
      non-exhaustive optimizer.<br>
      For scientific background see:<br>
      <a href="http://www.particleswarm.info/Tribes_2006_Cooren.pdf%20" target="_blank">http://www.particleswarm.info/Tribes_2006_Cooren.pdf </a>
      <p>In theory it should perform better than regular PSO, because it can automatically
        adjust the swarm sizes and algorithm strategy to the problem being solved. </p>
      <p>Practice shows that its performance is quite similar to PSO.</p>
      <p>To find solutions significantly faster I can recommend CMA-ES (Covariance
        Matrix Adaptation Evolutionary Strategy) algorithm instead.</p>
      <p>The Tribes.DLL plugin implements &quot;Tribes-D&quot; (i.e. dimensionless)
        variant. Based on http://clerc.maurice.free.fr/pso/Tribes/TRIBES-D.zip
        by Maurice Clerc. Original source codes used with permission from the author </p>
      <p>Tribes.DLL comes with FULL SOURCE CODE (inside &quot;ADK&quot; folder)</p>
      <p>Supported parameters:<br>
&quot; MaxEval&quot; - maximum number of evaluations (backtests) per run (default
  = 1000).<br>
        OptimizerSetOption(&quot;MaxEval&quot;, 1000 );<br>
        You should increase the number of evaluations with increasing number of
        dimensions (number of optimization params).<br>
        The default 1000 is good for 2 or maximum 3 dimensions.</p>
      <p>&quot;Runs&quot; - number of runs (restarts). (default = 5 )<br>
        You can leave the number of runs at default value of 5.</p>
      <p>By default number of runs (or restarts) is set to 5. </p>
      <p><br>
        To use Tribes optimizer, you just need to add one line to your code:</p>
      <p>OptimizerSetEngine(&quot;trib&quot;);</p>
      <p>OptimizerSetOption(&quot;MaxEval&quot;, 5000 ); // 5000 evaluations max<br>
      </p>
      <br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.12.2 (as compared to 5.12.0)</b></p>
    <ul>
      <li>In 5.12.0 BETA the walk-forward test was stopping after first in-sample
        cycle. Now it is fixed.</li>
      <li>AddSummaryRows total did not include the very first item. Fixed.</li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.12.0 (as compared to 5.11.1)</b></p>
    <ul>
      <li>ADK: A new interface for external optimization engines, see <a href="ADK/optimizer.html">optimizer.html</a><br>
      </li>
      <li>Added two example non-exhaustive optimizers: Standard Particle Swarm
        Optimizer (spso), and Monte Carlo (random pick) optimizer( moca)<br>
          <br>
      Note that BOTH optimizers are provided for demonstration purposes. <br>
      Particularly Monte Carlo optimizer is meant as a &quot;the most trivial and
      simple&quot; or even &quot;dumb&quot; example of optimizer DLL coding.<br>
      It works by randomly picking parameter combinations without ANY additional
      logic. The results are thus random<br>
      and most probably sub-optimum.
      <p>On the other hand Standard Particle Swarm Optimizer is based on SPSO2007
        code that is supposed to produce<br>
        good results provided that correct parameters (i.e. Runs, MaxEval) are
        provided for particular problem.<br>
        Picking correct options for the PSO optimizer can be tricky therefore results
        may significantly vary from case to case.</p>
      <p>The source codes for both optimizers are OPEN and provided as illustration
        how to implement optimizer engines using<br>
&quot; simple&quot; and &quot;advanced&quot; methods as described in optimizers.html
  file. You can find full source codes inside &quot;ADK&quot; subfolder.</p>
      <p>In the future, I will provide more robust non-exhaustive optimizers using
        various methods.</p>
      <p>Example code for Standard Particle Swarm Optimizer:<br>
        (finding optimum value in 1000 tests within search space of 10000 combinations)</p>
      <p>OptimizerSetEngine(&quot;spso&quot;);<br>
        OptimizerSetOption(&quot;Runs&quot;, 1 );<br>
        OptimizerSetOption(&quot;MaxEval&quot;, 1000 );</p>
      <p>sl = Optimize(&quot;s&quot;, 26, 1, 100, 1 );<br>
        fa = Optimize(&quot;f&quot;, 12, 1, 100, 1 );</p>
      <p>Buy = Cross( MACD( fa, sl ), 0 );<br>
        Sell = Cross( 0, MACD( fa, sl ) ); </p>
      <p>Example Code for Monte Carlo optimizer:<br>
        (finding sub-optimum value in 1000 test within search space of 10000 combinations)</p>
      <p>OptimizerSetEngine(&quot;moca&quot;);<br>
        OptimizerSetOption(&quot;NumSteps&quot;, 1000 );</p>
      <p>sl = Optimize(&quot;s&quot;, 26, 1, 100, 1 );<br>
        fa = Optimize(&quot;f&quot;, 12, 1, 100, 1 );</p>
      <p>Buy = Cross( MACD( fa, sl ), 0 );<br>
        Sell = Cross( 0, MACD( fa, sl ) ); </p>
      </li>
      <li>Increased limit of optimization parameters to 100</li>
      <li>AFL: new OptimizerSetOption(&quot;name&quot;, value ) function<br>
          <br>
      The function set additional parameters for external optimization engine.
      The parameters are engine-dependent.<br>
      For example SPSO optimizer supports &quot;Runs&quot; (number of runs) and &quot;MaxEval&quot; (maximum
      evaluations (tests)per single run) parameters. Monte Carlo optimizer supports &quot;NumSteps&quot; (number
      of steps) parameter.<br>
      </li>
      <li>AFL: new OptimizerSetEngine(&quot;name&quot;) function<br>
          <br>
      The function selects external optimization engine defined by name. For demonstration
      two engines are provided: Standard Particle Swarm Optimizer (&quot;spso&quot;)
      and Monte Carlo (random pick) optimizer (&quot;moca&quot;)<br>
           <br>
      Example: <br>
      OptimizerSetEngine(&quot;moca&quot;);<br>
      </li>
      <li>ADK: new example C++ source codes: PSOSample, MOCASample</li>
      <li>AFL: AddSummaryRows( flags )<br>
          <br>
      AddSummaryRows automatically adds &quot;summary&quot; row(s) to the exploration
      output.<br>
      the flag parameter can be combination of the following<br>
      1 - add TOTAL row<br>
      2 - add AVERAGE row<br>
      4 - add MIN row<br>
      8 - add MAX row<br>
      16 - add COUNT row
      <p>You can call AddSummaryRows multiple times and the result will be &quot;accumulation&quot; (i.e.
        bitwise OR)</p>
      <p>Example:</p>
      <p>Filter=1;<br>
        AddColumn(V, &quot;Volume&quot; );<br>
        AddSummaryRows( 31 ); // add Total, Average, Min, Max, and Count rows (1+2+4+8+16)=31</p>
      <p>summary rows are added at the top of the list</p>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.11.1 (as compared to 5.11.0)</b></p>
    <ul>
      <li>Fixed problem with Walk Forward picking sometimes not the best parameter
        when thousand separator was used and metric values were greater than 1000 <br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.11.0 (as compared to 5.10.1)</b></p>
    <ul>
      <li><b>Backtester: Implemented SeparateLongShortRank</b><br>
          <br>
      To enable separate long/short ranking use:<br>
      SetOption(&quot;SeparateLongShortRank&quot;, True );
      <p>When separate long/short ranking is enabled, the backtester maintains
        TWO separate &quot;top-ranked&quot; signal lists, one<br>
        for long signals and one for short signals. This ensures that long and
        short candidates are independently even if position score<br>
        is not symetrical (for example when long candidates have very high positive
        scores while short candidates have only fractional negative scores).<br>
        That contrasts with the default mode where only absolute value of position
        score matters, therefore one side (long/short) may completely dominate
        ranking if score values are asymetrical.</p>
      <p>When SeparateLongShortRank is enabled, in the second phase of backtest,
        two separate ranking lists are interleaved to form final signal list by <br>
        first taking top ranked long, then top ranked short, then 2nd top ranked
        long, then 2nd top ranked short, then 3rd top ranked long <br>
        and 3rd top ranked short, and so on... (as long as signals exist in BOTH
        long/short lists, if there is no more signals of given kind, then<br>
        remaining signals from either long or short lists are appended)</p>
      <p>For example:<br>
        Entry signals(score):ESRX=Buy(60.93), GILD=Short(-47.56), CELG=Buy(57.68),
          MRVL=Short(-10.75), ADBE=Buy(34.75), VRTX=Buy(15.55), SIRI=Buy(2.79), </p>
      <p>As you can see Short signals get interleaved between Long signals even
        though their absolute values of scores are smaller than corresponding scores
        of long signals. Also there were only 2 short signals for that particular
        bar so, the rest of the list shows long signals in order of position score</p>
      <p>Although this feature can be used independently, it is intended to be
        used in combination with MaxOpenLong and MaxOpenShort options.</p>
      </li>
      <li><b>Backtester: MaxOpenLong/MaxOpenShort implemented</b><br>
        <br>
      MaxOpenLong - limits the number of LONG positions that can be open simultaneously<br>
      MaxOpenShort - limits the number of SHORT positions that can be open simultaneously
      <p>Example:<br>
        SetOption(&quot;MaxOpenPositions&quot;, 15 );<br>
        SetOption(&quot;MaxOpenLong&quot;, 11 );<br>
        SetOption(&quot;MaxOpenShort&quot;, 7 );</p>
      <p>The value of ZERO (default) means NO LIMIT. If both MaxOpenLong and MaxOpenShort
        are set to zero (<br>
        or not defined at all) the backtester works old way - there is only global
        limit active (MaxOpenPositions) regardless of type of trade.</p>
      <p>Note that these limits are independent from global limit (MaxOpenPositions).<br>
        This means that MaxOpenLong + MaxOpenShort may or may not be equal to MaxOpenPositions.</p>
      <p>If MaxOpenLong + MaxOpenShort is greater than MaxOpenPositions<br>
        then total number of positions allowed will not exceed MaxOpenPositions,
          and individual long/short limits will apply too.<br>
        For example if your system MaxOpenLong is set to 7 and maxOpenShort is
        set to 7 and MaxOpenPositions is set to 10<br>
        and your system generated 20 signals: 9 long (highest ranked) and 11 short,
        it will open 7 long and 3 shorts.</p>
      <p>If MaxOpenLong + MaxOpenShort is smaller than MaxOpenPositions (but greater
        than zero), the system won't be able to <br>
        open more than (MaxOpenLong+MaxOpenShort).</p>
      <p>Please also note that MaxOpenLong and MaxOpenShort only cap the number
        of open positions of given type (long/short).<br>
        They do NOT affect the way ranking is made. I.e. by default ranking is
        performed using ABSOLUTE value of positionscore.</p>
      <p>If your position score is NOT symetrical, this may mean that you are not
        getting desired top-ranked signals from one side.<br>
        Therefore, to fully utilise MaxOpenLong and MaxOpenShort in rotational
        balanced (&quot;market neutral&quot;) long/short systems<br>
        it is desired to perform SEPARATE ranking for long signals and short signals.<br>
        To enable separate long/short ranking use:<br>
        SetOption(&quot;SeparateLongShortRank&quot;, True );</p>
      <p> </p>
      <br>
      </li>
      <li><b>Added ability to running Walk forward test from OLE, using Optimize(3)</b><br>
          <br>
      Analysis.Optimize( mode )<br>
      when mode == 3 it runs walk forward test
      <p>AB = new ActiveXObject(&quot;Broker.Application&quot;);<br>
        AA = AB.Analysis;<br>
        AA.Optimize(3);<br>
      </p>
      </li>
      <li><b>AFL: DaysSince1900() function </b><br>
            <p>It returns the number of days that passed since January 1st, 1900,
              counting from 1. January 1, 1900 is serial number 1, and January
              1, 2008 is serial number 39448 because it is 39,448 days after January
              1, 1900. Technically is equal to Windows OLEDATE and Excel's DATEVALUE
              function.</p>
            <p>The function can be used for calculations that involve calendar
              days as opposed to trading days and replaces previously proposed
              AFL solution<br>
        http://www.amibroker.com/kb/2007/03/15/calendar-day-index/</p>
            <p>Now RefDays can be implemeted as follows:</p>
            <p><CODE><FONT COLOR=#000000> <BR>
              </FONT><FONT COLOR=#0000ff>SetBarsRequired</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>365</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000> ); <BR>
              </FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> RefDays(
              Array, Days ) <BR>
        { <BR>
td = </FONT><FONT COLOR=#0000ff>DaysSince1900</FONT><FONT COLOR=#000000>(); <BR>
result = </FONT><FONT COLOR=#000000><B>Null</B></FONT><FONT COLOR=#000000>; <BR>
        <BR>
</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( Days < </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000> ) <BR>
{ <BR>
 </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>( i = </FONT><FONT COLOR=#000000><B>BarCount</B></FONT><FONT COLOR=#000000> -</FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>;
  i >= -Days; i = i - </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ) <BR>
 { <BR>
 backday = td[ i ] + Days; </FONT><FONT COLOR=#008000>// Days is negative</FONT><FONT COLOR=#000000> <BR>
 </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>( j =
  -Days/</FONT><FONT COLOR=#800080>2</FONT><FONT COLOR=#000000>; j < i; j++ ) <BR>
 { <BR>
</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( td[
  i - j ] <= backday ) <BR>
 { <BR>
 result[ i ] = Array[ i - j ]; <BR>
 </FONT><FONT COLOR=#800000><B>break</B></FONT><FONT COLOR=#000000>; <BR>
 } <BR>
 } <BR>
 } <BR>
} <BR>
</FONT><FONT COLOR=#800000><B>return</B></FONT><FONT COLOR=#000000> result; <BR>
        } <BR>
        <BR>
        </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"C"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000> ); <BR>
        </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>Ref</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>,
        -</FONT><FONT COLOR=#800080>252</FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#800080>"Close
        252 bars back"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorBlue</B></FONT><FONT COLOR=#000000> ); <BR>
        </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( RefDays( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>,
        -</FONT><FONT COLOR=#800080>365</FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#800080>"Close
        365 days back"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorGreen</B></FONT><FONT COLOR=#000000> ); </FONT></CODE>      
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.10.2 (as compared to 5.10.1)</b></p>
  <ul>
    <li>
      Fixed problem with Walk Forward picking sometimes not the best parameter when thousand separator was used
           and metric values were greater than 1000<br>
    </li>
  </ul>

  <p><b>CHANGES FOR VERSION 5.10.1 (as compared to 5.10.0)</b></p>
<ul>
    <li>
      Fixed crash @004AB5A1 (when sector ID was invalid &gt; 64)<br>
  </li>
    <li>
      Fixed bug AFL editor Undo @004B2324 <br>
  </li>
    <li>
      Fixed bug @004662AD (crash when doing Code Check and Profile while AA running
            in background)<br>
  </li>
</ul>
  
    <p><b>CHANGES FOR VERSION 5.10.0 (as compared to 5.09.0)</b></p>
    <ul>
      <li>Small improvement in axis font positioning - based on TEXTMETRIC</li>
      <li>Removed 1-pixel rendering overlap in multi-colored chart titles when
        ClearType was enabled</li>
      <li>Hi-Res (256x256) alpha Vista icon </li>
      <li>      Quote array now uses HeapRealloc instead of HeapAlloc/HeapFree
      combination </li>
      <li>Fixed rare crash @433F58 </li>
      <li>Fixed account manager updating cash after exiting
      short trade </li>
      <li>Web Browser window does not flicker anymore when resizing<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.09.0 (as compared to 5.08.0)</b></p>
    <ul>
      <li>MDI Tab order is now saved in the layout<br>
      </li>
      <li>Added interface to BugslayerUtil.dll for optional call stack / symbol
        dump report in crash recovery window<br>
      Now in the bottom of the crash report there is a detailed call stack and
      CPU register state. This should allow quicker/easier fixes of any crashes<br>
      </li>
      <li>New fields in Status() function: pxchart* <br>
          <br>
      Status(&quot;pxchartleft&quot;) - returns x-coordinate of top-left corner
      of chart area<br>
      Status(&quot;pxcharttop&quot;) - returns y-coordinate of top-left corner
      of chart area<br>
      Status(&quot;pxchartright&quot;) - returns x-coordinate of bottom-right corner
      of chart area<br>
      Status(&quot;pxchartbottom&quot;) - returns y-coordinate of bottom-right
      corner of chart area<br>
      Status(&quot;pxchartwidth&quot;) - returns width chart area (right-left)<br>
      Status(&quot;pxchartheight&quot;) - returns width chart area (bottom-top)<br>
      Chart co-ordinates are useful because they automatically take into account
      selected axis font size, whenever date axis is on or off<br>
      and other settings (New Look chart style)<br>
      All co-ordinates are in screen pixels. Note that top, left coordinates may
      not be zero as chart rectangle is smaller than underlying window because
      there is an extra space (padding) around chart.
      <p><br>
        // Test code:<br>
        <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#000000><B>Title</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#0000ff>StrFormat</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"left=%g,
        top=%g, right=%g, bottom=%g, width=%g, height=%g"</FONT><FONT COLOR=#000000>, <BR>
        left=</FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"pxchartleft"</FONT><FONT COLOR=#000000>), <BR>
        top=</FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"pxcharttop"</FONT><FONT COLOR=#000000>), <BR>
        right=</FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"pxchartright"</FONT><FONT COLOR=#000000>), <BR>
        bottom=</FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"pxchartbottom"</FONT><FONT COLOR=#000000>), <BR>
        </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"pxchartwidth"</FONT><FONT COLOR=#000000>), <BR>
        </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"pxchartheight"</FONT><FONT COLOR=#000000>)
        ); <BR>
        </FONT><FONT COLOR=#0000ff>GfxSetOverlayMode</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>); <BR>
        </FONT><FONT COLOR=#0000ff>GfxRectangle</FONT><FONT COLOR=#000000>(Left,top,
        right, bottom);</FONT></CODE></p>
      <p>============ Overlay sample ================<br>
        <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#969696>_SECTION_BEGIN</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"GfxOverlaySampleNew"</FONT><FONT COLOR=#000000>); <BR>
        <BR>
        </FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> GetVisibleBarCount() <BR>
        { <BR>
&nbsp;lvb = </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"lastvisiblebar"</FONT><FONT COLOR=#000000>); <BR>
&nbsp;fvb = </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"firstvisiblebar"</FONT><FONT COLOR=#000000>); <BR>
        <BR>
        </FONT><FONT COLOR=#800000><B>&nbsp;return</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#0000ff>Min</FONT><FONT COLOR=#000000>(
        Lvb - fvb, </FONT><FONT COLOR=#000000><B>BarCount</B></FONT><FONT COLOR=#000000> -
        fvb ); <BR>
        } <BR>
        <BR>
            </FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> GfxConvertBarToPixelX(
              bar ) <BR>
        { <BR>
&nbsp;lvb = </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"lastvisiblebar"</FONT><FONT COLOR=#000000>); <BR>
&nbsp;fvb = </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"firstvisiblebar"</FONT><FONT COLOR=#000000>); <BR>
&nbsp;pxchartleft = </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"pxchartleft"</FONT><FONT COLOR=#000000>); <BR>
&nbsp;pxchartwidth = </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"pxchartwidth"</FONT><FONT COLOR=#000000>); <BR>
        <BR>
        </FONT><FONT COLOR=#800000><B>&nbsp;return</B></FONT><FONT COLOR=#000000> pxchartleft
        + bar&nbsp;&nbsp;* pxchartwidth / ( Lvb - fvb + </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ); <BR>
        } <BR>
        <BR>
            </FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> GfxConvertValueToPixelY(
              Value ) <BR>
        { <BR>
            </FONT><FONT COLOR=#800000><B>&nbsp;local</B></FONT><FONT COLOR=#000000> Miny,
              Maxy, pxchartbottom, pxchartheight; <BR>
            <BR>
&nbsp;Miny = </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"axisminy"</FONT><FONT COLOR=#000000>); <BR>
&nbsp;Maxy = </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"axismaxy"</FONT><FONT COLOR=#000000>); <BR>
        <BR>
&nbsp;pxchartbottom = </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"pxchartbottom"</FONT><FONT COLOR=#000000>); <BR>
&nbsp;pxchartheight = </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"pxchartheight"</FONT><FONT COLOR=#000000>); <BR>
        <BR>
        </FONT><FONT COLOR=#800000><B>&nbsp;return</B></FONT><FONT COLOR=#000000> pxchartbottom
        - </FONT><FONT COLOR=#0000ff>floor</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>0.5</FONT><FONT COLOR=#000000> +
        ( Value - Miny ) * pxchartheight/ ( Maxy - Miny ) ); <BR>
        } <BR>
        <BR>
        <BR>
        <BR>
            </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"Price"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorBlack</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>styleHistogram</B></FONT><FONT COLOR=#000000> ); <BR>
            <BR>
            </FONT><FONT COLOR=#0000ff>GfxSetOverlayMode</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>); <BR>
            </FONT><FONT COLOR=#0000ff>GfxSelectSolidBrush</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000> ); <BR>
            </FONT><FONT COLOR=#0000ff>GfxSelectPen</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000> ); <BR>
            <BR>
        AllVisibleBars = GetVisibleBarCount(); <BR>
        fvb = </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"firstvisiblebar"</FONT><FONT COLOR=#000000>); <BR>
        <BR>
        </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>( i = </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>;
        i &lt; AllVisibleBars ; i++ ) <BR>
        { <BR>
&nbsp;&nbsp; x = GfxConvertBarToPixelX( i ); <BR>
&nbsp;&nbsp; y = GfxConvertValueToPixelY( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>[
  i + fvb ] ); <BR>
        <BR>
&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>GfxRectangle</FONT><FONT COLOR=#000000>(
  x-</FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>, y-</FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>,
  x + </FONT><FONT COLOR=#800080>2</FONT><FONT COLOR=#000000>, y+</FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ); <BR>
        } <BR>
        <BR>
        </FONT><FONT COLOR=#008000>//SetChartBkGradientFill( ColorRGB(200,200,200),
        ColorRGB( 255,255,255) );</FONT><FONT COLOR=#000000> <BR>
          </FONT><FONT COLOR=#969696>_SECTION_END</FONT><FONT COLOR=#000000>();</FONT></CODE></p>
      <p><br>
      </p>
      </li>
      <li>OLE: Name property is now writable, allowing switchin currently selected
        symbol for the document<br>
          <br>
      Example (JScript):<br>
      AB = new ActiveXObject(&quot;Broker.Application&quot;);<br>
      AB.ActiveDocument.Name = &quot;MSFT&quot;; // change the symbol for current
      document to &quot;MSFT&quot; <br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.08.0 (as compared to 5.07.0)</b></p>
    <ul>
      <li>Walk-Forward: &quot;Easy&quot; mode divided into two submodes: EOD and
        Intraday<br>
      Easy EOD mode assumes that you are using EOD data for walk-forward.<br>
      Easy Intraday mode assumes that you are using Intraday data for walk-forward<br>
      The difference is that in EOD mode the END date of previous period and START
      date of next period are the same - thus avoiding gap<br>
      between periods. Intraday mode set START date of the next period as NEXT
      DAY after END of previous period. That guarantees<br>
      that boundary day is not counted twice when testing on intraday data.<br>
      </li>
      <li>SetOption(&quot;GenerateReport&quot;, value )<br>
      New option added to SetOption call<br>
&quot; GenerateReport&quot; - 0/1/2<br>
      By default backtest reports are generated ONLY for portfolio backtests and
      for individual backtests if individual reporting is turned on in the settings.
      Reports are disabled for optimization.<br>
      Now with the SetOption() function you can either supress report generation
      for backtests or enable report generation during certain optimization steps,
      all from code level.<br>
      SetOption(&quot;GenerateReport&quot;, 0 ); // suppress generation of report<br>
      SetOption(&quot;GenerateReport&quot;, 1 ); // force generation of full report<br>
      SetOption(&quot;GenerateReport&quot;, 2 ); // only one-line report is generated
      (in results.rlst file) viewable as single line in Report Explorer<br>
      </li>
      <li>Total chart redraw time is calculated properly if multiple documents
        and charts are open that results in smoother performance and no update
        lockup</li>
      <li>When custom color palette is changed, any old RGB color that is not present
        in changed palette is matched to closest &quot;standard&quot; color</li>
      <li>Bugfix: when crosshair was enabled and moved OUTSIDE chart windows, then
        CPU usage was high. Now it is fixed</li>
      <li>Walk-Forward: when starting date is the last day of the month and step
        is n-month then it is treated as special case<br>
      AmiBroker now detects that start day is the last day of the month and moves
      the window to the last day of NEXT month, even if it is shorter.<br>
      That addresses the problem when one starts with January 31 and wants to step
      by one month - &gt; since there is NO February 31, previous version<br>
      moved to March 3rd. Now it detects that it is last day of the month and moves
      to Feb 28 (or 29). Then in next step it will move to March 31. <br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.07.0 (as compared to 5.06.0)</b></p>
    <ul>
      <li>a bugfix in 5.06 affected Foreign() function so it did not load the data
        on very first access - now fixed. This fixes also huge drawdown numbers
        that occurred on open positions at the end of trade list if cache size
        was small</li>
      <li>AFL: SetChartOptions has now 2 more parameters that allow to set custom
        scaling<br>
      SetChartOptions( Mode = 0, Flags = 0, gridFlags = chartGridMiddle, ymin =
      0, ymax = 0 )<br>
      new ymin, ymax parameters specify Y-axis minimum and maximum values for custom
      scaling.<br>
      If you specify any values that meet the condition ymin &lt; ymax, AmiBroker
      will turn OFF automatic scaling and use specified min/max values<br>
      for Y scale. Note that Mode argument controls when these settings are applied
      (0 - only when new chart is created, 1 - always), when modes 2 and 3 are
      used - scaling is not changed. </li>
      <li>bugfix: in 5.06.0 deleting the very first symbol raised exception, now
        it is fixed</li>
      <li>bugfix: rarely when trade profits gone to absurd levels (for example
        if user switched off price checking and used zero as entry price), AmiBroker
        would crash when generating profit distribution chart, now it is fixed</li>
      <li>Crosshair moves way faster and flicker is practically eliminated</li>
      <li>Crosshair state is global now and saved between sessions</li>
      <li>Crosshair works now in floating windows and in inactive windows too</li>
      <li>IS, OOS, BEST equity tickers are now put into group 253 and market 253
        (composites)<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.06.0 (as compared to 5.05.1)</b></p>
    <ul>
      <li>Walk Forward: now you can select &quot;trading days&quot; instead of
        calendar days as step unit. Currently it is using simplified method: Mon-Fri
        as a trading days</li>
      <li>Walk Forward settings: fixed lockup (due to infinite loop) when step
        was set to zero, also added other checks for invalid entries</li>
      <li>RT Quote window: now symbols can be re-arranged by drag-and-drop (simply
        click on the symbol, hold and drag to re-arrange order)</li>
      <li>RT Quote window: faster refreshes and multi-step color fading</li>
      <li>RT Quote window: added ability to type-in multiple symbols directly (instead
        of selecting one by one or via existing watch list)</li>
      <li>RT Quote window: added ability to insert EMPTY line (to separate symbol
        groups)</li>
      <li>Preferences / Currencies: now you can define upto 20 currencies for multiple-currency
        backtesting</li>
      <li>New FindSignal function in Backtester object (custom backtester procedure)
        allowing fast lookups for signals matching given symbol<br>
      bo = GetBacktesterObject();<br>
      bo.FindSignal( bar, symbol, type )
      <p>where <br>
        bar is a bar number<br>
        symbol is ticker symbol<br>
        type represents type of signal to find: 0 - both entries and exits, 1 -
        only entries, 2 - only exits</p>
      <p>The function finds for first matching signal that has fPrice != -1 (different
        than -1). If 0 is used as type, and entry and exit is on the same bar then
        entry signal will be returned. Note: fPrice = -1 is a special marker meaning
        that given signal should be ignored.</p>
      </li>
      <li>Internal symbol pointers stay the same when new symbols are added or
        deleted. This addresses exceptions when using AddToComposite during backtests
        among other things<br>
      This fixes: FC#1101, exceptions when using AddToComposite inside CBT and
      exceptions occuring sometimes with COM when adding / removing symbols </li>
      <li>Floating panes are now &quot;sticky&quot; that makes it easier to arrange
        the workspace</li>
      <li>Charts: ability to hide vertical quote marker<br>
      The control over vertical quote marker is given now via<br>
      Parameter dialog -&gt; Axes &amp; Grid -&gt; Vert. quote marker: Show/Hide
      <p>And programmatically via SetChartOptions function:<br>
        SetChartOptions( 2, chartHideQuoteMarker );<br>
      </p>
      </li>
      <li>Bugfix: when &quot;pad and align&quot; was used in AA and reference symbol
        did not have all trading days, the data used for very first symbol in the
        watch list under test could have been unaligned for the very first AA run,
        subsequent runs were OK)</li>
      <li>Alert Output column sizes / layout are now preserved between sessions</li>
      <li>Added two new backtest modes: backtestRegularRaw2 and backtestRegularRaw2Multi
        that do not remove excess EXIT signals<br>
      The common thing between Raw and Raw2 modes is that they both do NOT remove
      excess ENTRY signals.<br>
      The difference is that Raw modes remove excess EXIT signals, while Raw2 do
      NOT.<br>
      In Raw2 modes all exit signals (even redundant ones) are passed<br>
      to second phase of backtest just in case that you want implement strategy
      that skips first exit. Lets suppose that you want to exit on some condition
      from first phase but only in certain hours or after certain numbers of bars
      in trade or only when portfolio equity condition is met. Now you can do that
      in raw2 modes.<br>
      Note that Raw2 modes can get significantly slower when you are using custom
      backtester code that iterates thru signals as there can be zillions of exit
      signals in the lists even for symbols that never generated any entry signals,
      therefore it is advised to use it only when absolutely necessary. Raw2 modes
      are also the most memory consuming.
      <p>Note also that if you run the system WITHOUT custom backtest procedure
        there should be no difference between Raw and Raw2 modes (other than speed &amp; memory
        usage) as first matching exit signal is what is used by default.</p>
      </li>
      <li>3D chart viewer: process priority is now set to IDLE</li>
      <li>3D chart viewer: animation is now smoother (upto 100fps vs 25fps)<br>
          <br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.05.1 (as compared to 5.05.0)</b></p>
    <ul>
      <li>Walk Forward AA Settings: added error message when start date &gt; end
        date</li>
      <li>Walk Forward AA Settings: added &quot;preview&quot; list - showing all
        IS and OOS segments with dates</li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.05.0 (as compared to 5.04.2)</b></p>
    <ul>
      <li>Walk Forward: &quot;Easy&quot; mode in the settings implemented - it
        sets &quot;out-of-sample&quot; parameters automatically based on in-sample
        settings</li>
      <li>GetCursorMouseButtons new flag = 8 - means that current chart just received
        mouse click<br>
          <br>
          <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#008000>/////////////////////////////////////////////////</FONT><FONT COLOR=#000000> <BR>
          </FONT><FONT COLOR=#008000>// Low-level graphic + Interactive GUI control
          sample</FONT><FONT COLOR=#000000> <BR>
            </FONT><FONT COLOR=#008000>// This example shows: </FONT><FONT COLOR=#000000> <BR>
            </FONT><FONT COLOR=#008000>//&nbsp;&nbsp;1. how to draw "buttons"</FONT><FONT COLOR=#000000> <BR>
            </FONT><FONT COLOR=#008000>//&nbsp;&nbsp;2. how to handle mouse clicks</FONT><FONT COLOR=#000000> <BR>
            </FONT><FONT COLOR=#008000>//&nbsp;&nbsp;3. how to implement event
            call-backs</FONT><FONT COLOR=#000000> <BR>
            </FONT><FONT COLOR=#008000>///////////////////////////////////////////////////</FONT><FONT COLOR=#000000> <BR>
            <BR>
            </FONT><FONT COLOR=#0000ff>Version</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>5.04</FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
            requires 5.04 or higher</FONT><FONT COLOR=#000000> <BR>
            <BR>
            </FONT><FONT COLOR=#008000>////////////////////////////////////////////////////</FONT><FONT COLOR=#000000> <BR>
            </FONT><FONT COLOR=#008000>// Part 1: DRAWING TABLE OF BUTTONS</FONT><FONT COLOR=#000000> <BR>
            </FONT><FONT COLOR=#008000>//////////////////////////////////////////////////</FONT><FONT COLOR=#000000> <BR>
            </FONT><FONT COLOR=#0000ff>GfxSetOverlayMode</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>2</FONT><FONT COLOR=#000000> ); <BR>
            </FONT><FONT COLOR=#008000>// formatted text output sample via low-level
            gfx functions </FONT><FONT COLOR=#000000> <BR>
            <BR>
      CellHeight = </FONT><FONT COLOR=#800080>20</FONT><FONT COLOR=#000000>; <BR>
      CellWidth = </FONT><FONT COLOR=#800080>100</FONT><FONT COLOR=#000000>; <BR>
      </FONT><FONT COLOR=#0000ff>GfxSelectFont</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>"Tahoma"</FONT><FONT COLOR=#000000>,
      CellHeight/</FONT><FONT COLOR=#800080>2</FONT><FONT COLOR=#000000> ); <BR>
        <BR>
        </FONT><FONT COLOR=#0000ff>GfxSetBkMode</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ); <BR>
        <BR>
        </FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> PrintInCell(
          string, row, Col ) <BR>
      { <BR>
        </FONT><FONT COLOR=#0000ff>GfxDrawText</FONT><FONT COLOR=#000000>( string,
          Col * CellWidth, row * CellHeight, (Col + </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> )
          * CellWidth, (row + </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> )
          * CellHeight, </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000> ); <BR>
      } <BR>
      <BR>
            </FONT><FONT COLOR=#0000ff>GfxSelectPen</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>colorBlue</B></FONT><FONT COLOR=#000000> ); <BR>
            </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>( i
            = </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>; i &lt; </FONT><FONT COLOR=#800080>10</FONT><FONT COLOR=#000000> && i &lt; </FONT><FONT COLOR=#000000><B>BarCount</B></FONT><FONT COLOR=#000000>;
            i++ ) <BR>
      { <BR>
            </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>( k
            = </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>; k &lt; </FONT><FONT COLOR=#800080>5</FONT><FONT COLOR=#000000>;
            k++ ) <BR>
      { <BR>
&nbsp;&nbsp; PrintInCell( </FONT><FONT COLOR=#800080>"Button "</FONT><FONT COLOR=#000000> +
  i + </FONT><FONT COLOR=#800080>","</FONT><FONT COLOR=#000000> + k, i, k ); <BR>
      } <BR>
      </FONT><FONT COLOR=#0000ff>GfxMoveTo</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>,
      i * CellHeight ); <BR>
      </FONT><FONT COLOR=#0000ff>GfxLineTo</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>5</FONT><FONT COLOR=#000000> *
      CellWidth, i * CellHeight ); <BR>
      } <BR>
      </FONT><FONT COLOR=#0000ff>GfxMoveTo</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>,
      i * CellHeight ); <BR>
      </FONT><FONT COLOR=#0000ff>GfxLineTo</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>5</FONT><FONT COLOR=#000000> *
      CellWidth, i * CellHeight ); <BR>
        <BR>
      </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>( Col = </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>;
      Col &lt; </FONT><FONT COLOR=#800080>6</FONT><FONT COLOR=#000000>; Col++ ) <BR>
      { <BR>
        </FONT><FONT COLOR=#0000ff>GfxMoveTo</FONT><FONT COLOR=#000000>( Col
          * CellWidth, </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>); <BR>
          </FONT><FONT COLOR=#0000ff>GfxLineTo</FONT><FONT COLOR=#000000>( Col
          * CellWidth, </FONT><FONT COLOR=#800080>10</FONT><FONT COLOR=#000000> *
          CellHeight ); <BR>
      } <BR>
      <BR>
      <BR>
          </FONT><FONT COLOR=#008000>/////////////////////////////////////////////////////////</FONT><FONT COLOR=#000000> <BR>
          </FONT><FONT COLOR=#008000>// Part 2: MOUSE BUTTON CALL BACKS</FONT><FONT COLOR=#000000> <BR>
          </FONT><FONT COLOR=#008000>//////////////////////////////////////////////////////////</FONT><FONT COLOR=#000000> <BR>
          </FONT><FONT COLOR=#000000><B>Title</B></FONT><FONT COLOR=#000000>=</FONT><FONT COLOR=#800080>""</FONT><FONT COLOR=#000000>; <BR>
          <BR>
          </FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> DrawButton(
          px, py, Clr1, Clr2, text ) <BR>
      { <BR>
&nbsp;&nbsp;&nbsp;&nbsp; Col = </FONT><FONT COLOR=#0000ff>floor</FONT><FONT COLOR=#000000>(
  px / CellWidth ); <BR>
&nbsp;&nbsp;&nbsp;&nbsp; Row = </FONT><FONT COLOR=#0000ff>floor</FONT><FONT COLOR=#000000>(
  py / CellHeight ); <BR>
      <BR>
&nbsp;&nbsp;&nbsp; <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>GfxGradientRect</FONT><FONT COLOR=#000000>(
  Col * CellWidth, row * CellHeight, (Col + </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> )
  * CellWidth, (row + </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> )
  * CellHeight, <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Clr1,
  Clr2 ); <BR>
      <BR>
&nbsp;&nbsp;&nbsp;&nbsp; PrintInCell( text + </FONT><FONT COLOR=#800080>" "</FONT><FONT COLOR=#000000> +
  row + </FONT><FONT COLOR=#800080>","</FONT><FONT COLOR=#000000> + Col, row, Col
  ); <BR>
      <BR>
      } <BR>
      <BR>
      </FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> OnLMouseButton(x,
      y, px, py) <BR>
      { <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>_TRACE</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"LButton
  x = "</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#0000ff>DateTimeToStr</FONT><FONT COLOR=#000000>(
  x ) + </FONT><FONT COLOR=#800080>" y = "</FONT><FONT COLOR=#000000> + y ); <BR>
      <BR>
&nbsp;&nbsp; DrawButton( px, py, </FONT><FONT COLOR=#0000ff>ColorHSB</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>50</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>255</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>255</FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#0000ff>ColorHSB</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>90</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>255</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>255</FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#800080>"just
  clicked"</FONT><FONT COLOR=#000000> ); <BR>
      } <BR>
      <BR>
      </FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> OnRMouseButton(x,
      y, px, py) <BR>
      { <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>_TRACE</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"RButton
  x = "</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#0000ff>DateTimeToStr</FONT><FONT COLOR=#000000>(
  x ) + </FONT><FONT COLOR=#800080>" y = "</FONT><FONT COLOR=#000000> + y ); <BR>
      } <BR>
      <BR>
      </FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> OnMMouseButton(x,
      y, px, py) <BR>
      { <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>_TRACE</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"MButton
  x = "</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#0000ff>DateTimeToStr</FONT><FONT COLOR=#000000>(
  x ) + </FONT><FONT COLOR=#800080>" y = "</FONT><FONT COLOR=#000000> + y ); <BR>
      } <BR>
      <BR>
      </FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> OnHoverMouse(x,
      y, px, py) <BR>
      { <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>_TRACE</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"LButton
  x = "</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#0000ff>DateTimeToStr</FONT><FONT COLOR=#000000>(
  x ) + </FONT><FONT COLOR=#800080>" y = "</FONT><FONT COLOR=#000000> + y ); <BR>
      <BR>
&nbsp;&nbsp;&nbsp;&nbsp; DrawButton( px, py, </FONT><FONT COLOR=#0000ff>ColorRGB</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>230</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>230</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>230</FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#0000ff>ColorRGB</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>255</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>255</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>255</FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#800080>"mouse
  over"</FONT><FONT COLOR=#000000> ); <BR>
      } <BR>
      <BR>
      </FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> OnLButtonIsDown(x,
      y, px, py) <BR>
      { <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>_TRACE</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"LButton
  x = "</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#0000ff>DateTimeToStr</FONT><FONT COLOR=#000000>(
  x ) + </FONT><FONT COLOR=#800080>" y = "</FONT><FONT COLOR=#000000> + y ); <BR>
      <BR>
&nbsp;&nbsp;&nbsp;&nbsp; DrawButton( px, py, </FONT><FONT COLOR=#0000ff>ColorHSB</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>190</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>255</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>255</FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#0000ff>ColorHSB</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>210</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>255</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>255</FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#800080>"down"</FONT><FONT COLOR=#000000> ); <BR>
      } <BR>
      <BR>
      </FONT><FONT COLOR=#008000>/////////////////////////////////////////////////////////</FONT><FONT COLOR=#000000> <BR>
      </FONT><FONT COLOR=#008000>// Part 3: GENERAL PURPOSE EVENT HANDLER (reusable!
      - may be put into "include" file)</FONT><FONT COLOR=#000000> <BR>
        </FONT><FONT COLOR=#008000>////////////////////////////////////////////////////////</FONT><FONT COLOR=#000000> <BR>
        <BR>
        </FONT><FONT COLOR=#800000><B>function</B></FONT><FONT COLOR=#000000> EventHandler() <BR>
      { <BR>
        </FONT><FONT COLOR=#800000><B>local</B></FONT><FONT COLOR=#000000> b,
          x, y, px, py; <BR>
      b = </FONT><FONT COLOR=#0000ff>GetCursorMouseButtons</FONT><FONT COLOR=#000000>(); <BR>
      <BR>
      </FONT><FONT COLOR=#008000>// retrieve co-ordinates in date/value units</FONT><FONT COLOR=#000000> <BR>
      x = </FONT><FONT COLOR=#0000ff>GetCursorXPosition</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>); <BR>
      y = </FONT><FONT COLOR=#0000ff>GetCursorYPosition</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>); <BR>
      <BR>
      </FONT><FONT COLOR=#008000>// retrieve co-ordinates in pixel units</FONT><FONT COLOR=#000000> <BR>
      px = </FONT><FONT COLOR=#0000ff>GetCursorXPosition</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>); <BR>
      py = </FONT><FONT COLOR=#0000ff>GetCursorYPosition</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000>); <BR>
      <BR>
      </FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( b & </FONT><FONT COLOR=#800080>8</FONT><FONT COLOR=#000000> ) </FONT><FONT COLOR=#008000>//
      flag = 8 is set when window just received mouse click</FONT><FONT COLOR=#000000> <BR>
      { <BR>
&nbsp;&nbsp; </FONT><FONT COLOR=#008000>// not-null means clicked in THIS (current)
  window</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp; </FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>(
  b & </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ) OnLMouseButton(
  x, y, px, py ); <BR>
&nbsp;&nbsp; </FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>(
  b & </FONT><FONT COLOR=#800080>2</FONT><FONT COLOR=#000000> ) OnRMouseButton(
  x, y, px, py ); <BR>
&nbsp;&nbsp; </FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>(
  b & </FONT><FONT COLOR=#800080>4</FONT><FONT COLOR=#000000> ) OnMMouseButton(
  x, y, px, py ); <BR>
      } <BR>
      </FONT><FONT COLOR=#800000><B>else</B></FONT><FONT COLOR=#000000> <BR>
      { <BR>
&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>(
  b == </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000> ) OnHoverMouse(
  x, y, px, py ); </FONT><FONT COLOR=#008000>// no button pressed</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>(
  b == </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ) OnLButtonIsDown(
  x, y, px, py ); </FONT><FONT COLOR=#008000>// button pressed</FONT><FONT COLOR=#000000> <BR>
      } <BR>
      } <BR>
      <BR>
      EventHandler(); <BR>
      </FONT><FONT COLOR=#0000ff>RequestTimedRefresh</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>1</FONT><FONT COLOR=#000000> ); <BR>
      </FONT></CODE><br>
      </li>
      <li>GetCursorXPosition/GetCursorYPosition return non-null values when mouse
        is over the current chart regardless if it was clicked or not</li>
      <li>BUGFIX: trend line sometimes moved to the right edge when drawing/moving
        them while two charts were opened in different periods</li>
      <li>Selector line is not drawn (does not blink) when GfxOverlayMode is set
        to 2</li>
      <li>Walk Forward document can now be closed and/or hidden during WF (it is
        not re-opened constantly)<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.04.2 (as compared to 5.04.1)</b></p>
    <ul>
      <li>New log scale (5.04.1) was not working nicely for small dynamic range
        charts - chart looked compressed. Fixed now.</li>
      <li>Chart Periodicity on MDI tab is now updated when switching</li>
      <li>Trendlines work fine with thick and dotted styles again (broken in 5.04)</li>
      <li>AFL: GetCursorXPosition/GetCursorYPosition functions changed <br>
      1. The functions now by default return NULL (empty value) if mouse is OUTSIDE
        the current window
        <p>2. New &quot;mode&quot; parameter controls what values are returned</p>
        <p>GetCursorXPosition( mode = 0 )<br>
        GetCursorYPosition( mode = 0 )</p>
        <p>mode = -1 - (old compatibility mode) - x - value gives X-coordinate
          in DateTime format. y - value gives PRICE. Values are reported no matter
          where is the mouse (i.e. may refer to window different than current if
          mouse is outside current window).<br>
        mode = 0 - (default) x - value gives X-coordinate in DateTime format. y
        - value gives PRICE. Returns NULL if mouse is outside current window<br>
        mode = 1 - x, y - are mouse coordinates expressed in screen PIXELS. Returns
        NULL if mouse is outside current window<br>
        </p>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.04.1 (as compared to 5.04.0)</b></p>
    <ul>
      <li>WF: Settings &quot;Optimization target&quot; combo box shows all built-in
        fields now</li>
      <li>WF: now combined in-sample and out-sample equities are available by ~~~ISEQUITY
        and ~~~OSEQUITY composite tickers<br>
      (consecutive periods of IS and OOS are concatenated and scaled to maintain
      continuity of equity line - this approach assumes that you generally speaking
      are compounding profits)<br>
      To display IS and OOS equity you may use for example this:<br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>PlotForeign</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"~~~ISEQUITY"</FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#800080>"In-Sample
      Equity"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>styleLine</B></FONT><FONT COLOR=#000000>); <BR>
        </FONT><FONT COLOR=#0000ff>PlotForeign</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"~~~OSEQUITY"</FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#800080>"Out-Of-Sample
          Equity"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorGreen</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>styleLine</B></FONT><FONT COLOR=#000000>); <BR>
              </FONT><FONT COLOR=#000000><B>Title</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#800080>"{{NAME}}
              - {{INTERVAL}} {{DATE}} {{VALUES}}"</FONT><FONT COLOR=#000000>;</FONT></CODE><br>
      </li>
      <li>WF: in-sample best uses &quot;first best&quot; result consistenly instead
        of quicksort (that did not prevent original order) </li>
      <li>WF: the output window is re-open when user closes it during Walk Forward
        optimization</li>
      <li>Log chart scaling enhanced to handle nicely extreme dynamic range<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.04.0 (as compared to 5.03.0)</b></p>
    <ul>
      <li>AFL Formula Editor: Copy-paste does not &quot;eat&quot; last character</li>
      <li>AFL Formula Editor: Edit-&gt;Prettify Selection function added</li>
      <li>Calling Activate() method of Window object does not maximize MDI window
        any more</li>
      <li>Print Preview works fine now with floating windows</li>
      <li>Walk-Forward Optimization implemented (v1)<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.03.0 (as compared to 5.02.2)</b></p>
    <ul>
      <li>Fixed: Pane/Template options do not work on floating window</li>
      <li>Added: Interval linking</li>
      <li>New linking settings are now saved in layouts and restored properly</li>
      <li>(re-)added: Cursor linking - selector line moves together in symbol and/or
        linked charts</li>
      <li>Removed File-&gt;New-&gt;Linked chart (new linking replaces this functionality)</li>
      <li>Fixed: Layouts with old-style linked charts are now automatically converted
        into new scheme when loading layout<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.02.2 (as compared to 5.02.1)</b></p>
    <ul>
      <li>fixed problem with c-like multi-line comments /* */ that appeared in
        5.02.1 beta</li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.02.1 (as compared to 5.01.1)</b></p>
    <ul>
      <li>Implemented Unlimited nesting of #include and #include_once </li>
      <li>True multi-monitor support. Chart windows can now be floated (outside
        main application frame) and moved to different monitors</li>
      <li>Implemented new way of symbol-linking of charts (the button next to scrollbar
        allows to choose linked group (1-9))</li>
      <li>Fixed crash when attempting to backtest on empty watch list (bug introduced
        in 5.01)</li>
      <li>AFL: SetBarFillColor( colorarray ) allows to independently control candlestick,
        bar, cloud, and area chart fill color</li>
      <li>OLE: when Broker.Application reference count drops to zero and AB was
        not running prior to CreateObject() then the AB is closed</li>
      <li>Implemented workaround to Windows XP list view drawing bug (MS KB813791)</li>
      <li>Floating pane title is synchronized now (5.02.0 fix)<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.01.1 (as compared to 5.01.0)</b></p>
    <ul>
      <li>fixed loading of customized toolbars</li>
      <li>toolbar customizations are now stored in Broker.exe-CommandBars51 (number
        increased) to isolate new betas and old versions </li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.01.0 (as compared to 5.00.0)</b></p>
    <ul>
      <li>Tweaks in backtester for improved performance<br>
      Portfolio backtester on average 2x faster for both multiple and single-security
        tests (some trivial, frequently trading systems may observe upto 5x speedup
        on multiple securities during long analysis periods). Note that AFL engine
        speed has NOT changed as compared to 5.00. Speed increase comes from backtester
        tweaks alone, so the longer AFL code is the less speed-up you will see,
        because backtester processing would account for smaller part of overall
        execution time.<br>
      </li>
      <li>Tweaks in quote handling for improved performance</li>
      <li>Code profiler - shows code analysis with detailed per-function timing
        report. Available from AFL Editor: Tools-&gt;Code Check &amp; Profile menu</li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.00.1 (as compared to 5.00.0)</b></p>
    <ul>
      <li> Minor corrections to documentation</li>
      <li>Small changes for compatiblity with 64 bit version</li>
      <li>Version number bumped and release marked as official</li>
    </ul>
    <p><b>CHANGES FOR VERSION 5.00.0 (as compared to 4.99.0)</b></p>
    <ul>
      <li> Database Purify: Date column type in set correctly now so clicking on
        column sorts by date instead of by alpha (FC#1130)</li>
      <li>Elapsed/estimated time is updated constantly when running long optimizations
        (FC#1107)</li>
      <li> Extra characters in the title occuring when using dynamic color with
        Null values in Plot() statements. Fixed. (FC#1129)</li>
      <li> Fixed saving of new commission table (FC#1122)</li>
      <li> In some cases slider did not allow to reach the upper margin of Param()
        when step was decimal fraction like 0.1 due to floating point rounding.
        Now it addressed. (FC#1155)</li>
      <li>Price Chart Style is now saved in a layout/template (FC#1039)</li>
      <li>When Find/Replace dialog is still open while Formula Editor is closed
        it does not cause exception anymore </li>
    </ul>
    <p><b>CHANGES FOR VERSION 4.99.0 (as compared to 4.98.0)</b></p>
    <ul>
      <li>A warning added when closing the last chart window</li>
      <li>Fixed possible stack overflow when using ASCII importer for files without
        extension but with . (dot) in a path (directory) name</li>
      <li>TimeFrameMode(3) (range mode) was not functional in 4.98, now it is fixed</li>
      <li>Fixed calculation of profit of leveraged instruments denominated in non-base
        currency when dynamic fx rate was used </li>
      <li> Private heap allocator implemented for quotes and for trading signals<br>
      This should resolve problem of getting &quot;out of memory&quot; problem
      that could occur during very long optimizations due to poor handling of virtual
      memory in Windows.<br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 4.98.0 (as compared to 4.97.0)</b></p>
    <ul>
      <li>N-tick intervals from View-&gt;Intraday menu are enabled again in tick
        databases (were disabled in 4.97 only)<br>
          <br>
      </li>
      <li> AFL: Status() function: 2 new fields added <br>
          <br>
&quot; axisminy&quot; - retrieves the minimum (bottom) value of Y axis (indicators
  only)<br>
&quot; axismaxy&quot; - retrieves the maximum (top) value of Y axis (indicators
  only)<br>
              <br>
      Example 1:<br>
      <br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#000000><B>Title</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#800080>"Axis
      Min Y = "</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"axisminy"</FONT><FONT COLOR=#000000>)
      + </FONT><FONT COLOR=#800080>"Axis Max Y = "</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"axismaxy"</FONT><FONT COLOR=#000000>); </FONT></CODE><br>
          <br>
      Example 2: <br>
      <br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>SetChartOptions</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#800080>3</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>,
      ChartGridMiddle ); <BR>
      axismin = </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"axisminy"</FONT><FONT COLOR=#000000>); <BR>
      axismax = </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"axismaxy"</FONT><FONT COLOR=#000000>); <BR>
      <BR>
      </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>"Price"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorBlack</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>styleBar</B></FONT><FONT COLOR=#000000> ); <BR>
      <BR>
      </FONT><FONT COLOR=#008000>// draw exactly 5 grid lines</FONT><FONT COLOR=#000000> <BR>
      </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>( i = </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>;
      i &lt; </FONT><FONT COLOR=#800080>5</FONT><FONT COLOR=#000000>; i++ ) <BR>
      { <BR>
&nbsp;&nbsp;y = axismin + i * (axismax - axismin)/</FONT><FONT COLOR=#800080>4</FONT><FONT COLOR=#000000>; <BR>
      </FONT><FONT COLOR=#0000ff> &nbsp;&nbsp;PlotGrid</FONT><FONT COLOR=#000000>(
      y, </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000> );<br>
      } <BR>
        </FONT></CODE><br>
      </li>
      <li>HTML export / import now store extra information about the kind of file
        exported so when you export optimization result and re-import it later
        you will be able to use optimization graph (FC#: 1029)<br>
          <br>
      </li>
      <li> HTML import: sometimes when importing large files duplicate rows appeared
        at the end - now it is fixed (FC#1024)<br>
          <br>
      </li>
      <li> Fixed formatting of numeric values above 100000 after HTML import when
        comma used as thousands separator (FC#: 1029)<br>
          <br>
      </li>
      <li> Added protection against using file-system reserved characters (*?#:|&gt;&lt;/&quot;\)
        in watch list names <br>
          <br>
      </li>
      <li> Implemented 5-tier commission schedule table in backtester (AA-&gt;Settings:
        Commission table : DEFINE...) (FC#270)<br>
          <br>
      </li>
      <li> Account Manager: commission was not subtracted from equity when scaling-in
        position that was open in previous amibroker run, now it is fixed<br>
          <br>
      </li>
      <li> Fixed problem with &quot;Use only local database for this symbol&quot; being
        set to &quot;yes&quot; during loading of the database with absent broker.master
        file<br>
          <br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 4.97.0 (as compared to 4.96.0)</b></p>
    <ul>
      <li> Range Bar compression implemented now (FC#: 210, 1041,897,284)<br>
          <br>
      Range Bars are price-driven bars, with each bar having a required minimum
      high-low range. Source data are consolidated into one bar until the range
      requirement is reached, then a new bar is started. It works best with tick
      data that have only one price per data point. You can use it with other base
      time intervals as well, but please note that if single source bar H-L range
      exceedes desired range, the output will be single bar that has range higher
      than requested. In other words source bars exceeding desired range won't
      be splitted into several range bars. For example if you use 1 minute bars
      and there is $3 dollar movement and you have selected $1 range bars it won't
      be splitted into 3 bars. Instead you will get single bar with original $3
      range.This is so because AB has no idea what happened *inside* the bar. Prices
      could move first downwards and later upwards or opposite or zigzaging several
      times or making any other pattern inside bar and this information is not
      available from source bar that only has OHLC prices. Note that range bar
      compression is not standarised. Some other softwares may attempt to split
      to several artificial bars when range is exceeded, but we belive it is wrong
      since it is based on assumptions about price action inside bar that may and
      usually are wrong. <br>
          <br>
      Range bars can now be selected as custom compression from Tools-&gt;Preferences-&gt;IntradayRange
      bars are also available via TimeFrameMode() function<br>
          <br>
          <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>TimeFrameMode</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#ff00ff>3</FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
          turn on range bars</FONT><FONT COLOR=#000000> <BR>
            </FONT><FONT COLOR=#0000ff>TimeFrameSet</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#ff00ff>1.5</FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
            set compression to 1.5$ range bar</FONT></CODE><br>
            <br>
      </li>
      <li> Mersene Twister MT19937 random number generator added<br>
      Two new AFL functions:<br>
      <br>
      mtRandom( seed = Null ) - returns single random number (scalar) in the range
      [0,1)<br>
      mtRandomA( seed = Null ) - returns array of random numbers in the range of
      [0,1)<br>
          <br>
      seed is random generator seed value. If you don't specify one, the random
      number generator<br>
      is automatically initialized with current time as a seed that guarantees
      unique sequence<br>
          <br>
      Both functions use Mersene Twister mt19973ar-cok algorithm. <br>
      (Copyright (C) 1997 - 2002, Makoto Matsumoto and Takuji Nishimura.)<br>
      <br>
      Mersene Twister is vastly superior to C-runtime pseudo-random generator<br>
      available via Random() function. <br>
      <br>
      It has a period of 219973 = approx 2.9*106012 For more information visit:<br>
      <a href="http://www.math.sci.hiroshima-u.ac.jp/%7Em-mat/MT/emt.html">http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/emt.html</a><br>
      <br>
      See also:<br>
      M. Matsumoto and T. Nishimura, &quot;Mersenne Twister: A 623-Dimensionally
      Equidistributed Uniform Pseudo-Random Number Generator&quot;, ACM Transactions
      on Modeling and Computer Simulation, Vol. 8, No. 1, January 1998, pp 3--30.<br>
          <br>
      </li>
      <li> AFL: PopupWindow() function added (FC#: 840)<br>
      SYNTAX: <br>
      PopupWindow( bodytext, captiontext, timeout = 5, left = -1, top = -1 );<br>
      <br>
      bodytext - the string containing the text of the window body<br>
      caption - the string containing the text of window caption<br>
      timeout - auto-close time in seconds (default 5 seconds)<br>
      left - top-left corner X co-ordinate (default = -1 -means auto-center)<br>
      top - top-left corner Y co-ordinate (default = -1 - means auto-center)<br>
      <br>
      Example code:<br>
      <CODE><FONT COLOR=#000000> <BR>
      </FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>ParamTrigger</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"Display
      Popup Window"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>"Press
      here"</FONT><FONT COLOR=#000000> ) ) <BR>
      { <BR>
&nbsp;&nbsp;&nbsp; </FONT><FONT COLOR=#0000ff>PopupWindow</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"Current
  time is: "</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#0000ff>Now</FONT><FONT COLOR=#000000>(),</FONT><FONT COLOR=#ff00ff>"Alert"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>640</FONT><FONT COLOR=#000000>*</FONT><FONT COLOR=#0000ff>mtRandom</FONT><FONT COLOR=#000000>(), </FONT><FONT COLOR=#ff00ff>480</FONT><FONT COLOR=#000000>*</FONT><FONT COLOR=#0000ff>mtRandom</FONT><FONT COLOR=#000000>());<br>
      } <BR>
      </FONT></CODE><br>
      <br>
      </li>
      <li> ASCII Importer: $TIMESHIFT option added (FC# 1094)<br>
      Added ability to time-shift data at the time of the import.<br>
      <br>
      $TIMESHIFT shift_in_hours<br>
      <br>
      For example:<br>
      <br>
      $TIMESHIFT 2<br>
      <br>
      will import with date/time stamps shifted 2 hours forward<br>
      <br>
      $TIMESHIFT -11.5<br>
      <br>
      will import with date/time stamps shifted 11 and half hour backward<br>
      <br>
      Please note that only INTRADAY data (with TIME component provided) are shifted.
      EOD data (without time field) are unaffected.]<br>
          <br>
      </li>
      <li> AFL: GetPlaybackDateTime() (FC#: 837)<br>
          <CODE><FONT COLOR=#000000> <BR>
      pt = </FONT><FONT COLOR=#0000ff>GetPlaybackDateTime</FONT><FONT COLOR=#000000>(); </FONT><FONT COLOR=#008000>//
      new function to retrieve playback position date/time, </FONT><FONT COLOR=#000000> <BR>
        </FONT><FONT COLOR=#008000>//returns zero if bar replay is NOT active</FONT><FONT COLOR=#000000> <BR>
        <BR>
        </FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( pt ) <BR>
      { <BR>
&nbsp;&nbsp;</FONT><FONT COLOR=#000000><B>Title</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#ff00ff>"Playback
  time: "</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#0000ff>DateTimeToStr</FONT><FONT COLOR=#000000>(
  pt ); <BR>
      } <BR>
      </FONT><FONT COLOR=#800000><B>else</B></FONT><FONT COLOR=#000000> <BR>
      { <BR>
&nbsp;&nbsp;</FONT><FONT COLOR=#000000><B>Title</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#ff00ff>"Bar
  Replay not active"</FONT><FONT COLOR=#000000>;<br>
      } <BR>
      </FONT></CODE><br>
      It returns zero if bar replay is not active.<br>
      <br>
      </li>
      <li>Fixed lockup when bar replay was attempted on base time interval = tick<br>
          <br>
      </li>
      <li> Fixed passing IDispatch parameters to OLE/COM method calls <br>
          <br>
      </li>
      <li>Fixed error message typo in SetCustomBacktestProc (FC: 1085) &quot;exit&quot; vs &quot;exist&quot;<br>
          <br>
      </li>
      <li> 3D optimization chart viewer: added 4x4 Full Screen Anti-Aliasing for
        beautifully smooth 3D charts and improved readability <br>
      4x4 Full-Screen Anti-Aliasing (FSAA) feature is available only on graphic
      cards that support this in hardware (all NVidia GeForce cards, and most recent
      graphic cards that have 3D acceleration). It is not available for low-end
      graphic cards sometimes found in the cheapest notebooks.<br>
      If FSAA is not supported by the hardware View-&gt;Anti-aliasing menu item
      will be disabled (grayed).<br>
      If FSAA is supported in hardware then it will be turned on by default.<br>
      Note that animation speed with FSAA turned on may be lower on slower graphic
      cards. If speed is not acceptable you can turn off anti aliasing by unchecking
      View-&gt;Anti-aliasing menu (or turning off &quot;A&quot; button in the toolbar)
      of 3D chart viewer (O3G.exe).<br>
          <br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 4.96.0 (as compared to 4.95.0)</b><br>
    </p>
    <ul>
      <li>HTML Import to AA result list implemented (FC#579)<br>
      Note that this feature is intended to import only HTML files exported by
        AmiBroker. The HTML parser used is specifically written for this particular
        purpose and expects certain layout of HTML file. HTML files saved by other
        programs can not be imported. Use Automatic Analysis -&gt; File -&gt; Import
        to access this feature.<br>
            <br>
      </li>
      <li>Account manager: added &quot;per-trade&quot; commission setting (FC#:
        973) <br>
          <br>
      </li>
      <li>Two new backtester modes that do not remove redundant signals (FC#: 105)
          <ul>
            <li> RAW MODE: signal-based backtest, redundant (raw) signals are NOT
              removed, only one position per symbol allowed:</li>
            <li> RAW MODE WITH MULTIPLE POSITIONS - signal-based backtest, redundant
              (raw) signals are NOT removed, MULTIPLE positions per symbol will
              be open if BUY/SHORT signal is &quot;true&quot; for more than one
              bar and there are free funds, Sell/Cover exit all open positions
              on given symbol, Scale-In/Out work on all open positions of given
              symbol at once.<br>
                    <br>
                    <br>
            </li>
          </ul>
      </li>
      <li>AFL: new function SetBacktestMode( mode )<br>
      Sets working mode of the backtester:<br>
      <CODE><FONT COLOR=#000000><BR>
      </FONT><FONT COLOR=#008000>// default, as in 4.90, regular, signal-based
      backtest, redundant signals are removed</FONT><FONT COLOR=#000000> <BR>
        </FONT><FONT COLOR=#0000ff>SetBacktestMode</FONT><FONT COLOR=#000000>(
          backtestRegular ); <BR>
                <BR>
        </FONT><FONT COLOR=#008000>// signal-based backtest, redundant (raw)
          signals are NOT removed, only one position per symbol allowed</FONT><FONT COLOR=#000000> <BR>
                  </FONT><FONT COLOR=#0000ff>SetBacktestMode</FONT><FONT COLOR=#000000>(
                  backtestRegularRaw ); <BR>
                  <BR>
                  </FONT><FONT COLOR=#008000>// signal-based backtest, redundant
                  (raw) signals are NOT removed,</FONT><FONT COLOR=#000000> <BR>
                  </FONT><FONT COLOR=#008000>// MULTIPLE positions per symbol will
                  be open if BUY/SHORT signal is "true" for more than one bar and
                  there are free funds</FONT><FONT COLOR=#000000> <BR>
                  </FONT><FONT COLOR=#008000>// Sell/Cover exit all open positions
                  on given symbol, Scale-In/Out work on all open positions of given
                  symbol at once.</FONT><FONT COLOR=#000000> <BR>
                  </FONT><FONT COLOR=#0000ff>SetBacktestMode</FONT><FONT COLOR=#000000>(
                  backtestRegularRawMulti ); <BR>
                  <BR>
                  </FONT><FONT COLOR=#008000>// rotational trading mode - equivalent
                  of EnableRotationalTrading() call</FONT><FONT COLOR=#000000> <BR>
                  </FONT><FONT COLOR=#0000ff>SetBacktestMode</FONT><FONT COLOR=#000000>(
                  backtestRotational );<br>
                  <br>
                </FONT></CODE></li>
      <li> AA window: custom draw buttons (with arrows) are redrawn on killfocus
        event to prevent flickering <br>
          <br>
      </li>
      <li> Fix: when symbol is deleted from database it is removed from all new
        watchlists as well <br>
          <br>
      </li>
      <li>Attempt to assign value to the element of the array named the same as
        the function inside the function declaration produces error 33 now instead
        of crash (FC#: 1011)<br>
          <br>
      </li>
      <li>Clicking RMB-&gt;Watchlist-&gt;Remove inside watch list node was removing
        symbol from all watch lists. Now it is fixed.<br>
          <br>
      </li>
      <li> Fixed cell text truncation that could happen randomly when using HTML
        export<br>
          <br>
      </li>
      <li>Position of compound drawings (retracements/cycles) is updated correctly
        now when &quot;Properties&quot; dialog was choosen from without selecting
        the drawing via LMB click<br>
          <br>
      </li>
      <li> Stops were reset to default values (from settings) when custom backtest
        routine was stored in separate file (not embedded or included in the formula).
        Now it is fixed </li>
    </ul>
    <p>&nbsp;</p>
    <p><b>CHANGES FOR VERSION 4.95.0 (as compared to 4.94.0)</b></p>
    <ul>
      <li> Added support for AFL Code Wizard (<b>Analysis-&gt;AFL Code Wizard </b>menu
        and toolbar button)<br>
          <br>
          <b>AFL Code Wizard is a new add-on for AmiBroker</b>. It allows creation
          of trading system formulas without ANY programming experience. It is
          available for purchase for $49 one-time fee. Further upgrades are free.
          AmiBroker comes with trial version that has all functionality *including*
          export of auto-generated AFL formula to AmiBroker. The only missing feature
          in trial version of AFL COde wizardis saving the project in .awz format.<br>
            <br>
      To run it select Analysis-&gt;AFL Code Wizard menu.<br>
      <br>
      <b>AFL Code Wizard instructional video can be found at</b>: <a href="http://www.amibroker.com/video/amiwiz/AFLWiz1.html" target="_blank">http://www.amibroker.com/video/amiwiz/AFLWiz1.html</a><br>
      <br>
      </li>
      <li> Symbol Tree-&gt;Right click-&gt;Watch List-&gt;Type In works from any
        node now (FC#991)<br>
          <br>
      </li>
      <li> Filter window supports more than 256 watchlists (FC#1006) <br>
          <br>
      </li>
      <li> Aliases are properly recognized when adding symbols to new watchlists <br>
          <br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 4.94.0 (as compared to 4.93.0)</b></p>
    <ul>
      <li> AFL: 23 new low-level graphic functions allowing Windows GDI-like painting <br>
      Completely new low-level graphic AFL interface allows complete flexibility
        in creating any kind of user-defined display.<br>
            <br>
      The interface mimics closely Windows GDI API, with same names for most functions
      for easier use for GDI-experienced programmers. The only differences are:<br>
      1. compared to Windows GDI all functions are prefixed with 'Gfx'<br>
      2. pen/brush/font creation/selection is simplified to make it easier to use
      and you don't need to care about deletion of GDI objects <br>
      3. Three overlay modes are available so you can mix low-level graphics with
      regular Plot() statements<br>
      (mode = 0 (default) - overlay low-level graphic on top of charts, mode =
      1 - overlay charts on top of low-level graphic, mode =2 - draw only low-level
      graphic (no regular charts/grid/titles/etc))<br>
          <br>
      Low-level graphics tutorial: <a href="http://www.amibroker.com/guide/h_lowlevelgfx.html">http://www.amibroker.com/guide/h_lowlevelgfx.html </a><br>
      <br>
      Available low-level gfx functions (click on the links for detailed explanation):<br>
      <b>GfxMoveTo</b>( x, y ) <a href="http://www.amibroker.com/f?gfxmoveto">http://www.amibroker.com/f?gfxmoveto</a><br>
      <b>GfxLineTo</b>( x, y ) <a href="http://www.amibroker.com/f?gfxlineto">http://www.amibroker.com/f?gfxlineto</a><br>
      <b>GfxSetPixel</b>( x, y, color ) <a href="http://www.amibroker.com/f?gfxsetpixel">http://www.amibroker.com/f?gfxsetpixel</a><br>
      <b>GfxTextOut</b>( &quot;text&quot;, x, y ) <a href="http://www.amibroker.com/f?gfxtextout">http://www.amibroker.com/f?gfxtextout</a><br>
      <b>GfxSelectPen</b>( color, width = 1, penstyle = penSolid ) <a href="http://www.amibroker.com/f?gfxselectpen">http://www.amibroker.com/f?gfxselectpen</a><br>
      <b>GfxSelectSolidBrush</b>( color ) <a href="http://www.amibroker.com/f?gfxselectsolidbrush">http://www.amibroker.com/f?gfxselectsolidbrush</a><br>
      <b>GfxSelectFont</b>( &quot;facename&quot;, pointsize, weight = fontNormal,
      italic = False, underline = False, orientation = 0 ) <a href="http://www.amibroker.com/f?gfxselectfont">http://www.amibroker.com/f?gfxselectfont</a> <br>
              <b>GfxRectangle</b>( x1, y1, x2, y2 ) <a href="http://www.amibroker.com/f?gfxrectangle">http://www.amibroker.com/f?gfxrectangle</a> <br>
              <b>GfxRoundRect</b>( x1, y1, x2, y2, x3, y3 ) <a href="http://www.amibroker.com/f?gfxroundrect">http://www.amibroker.com/f?gfxroundrect</a><br>
              <b>GfxPie</b>( x1, y1, x2, y2, x3, y3, x4, y4 ) <a href="http://www.amibroker.com/f?gfxpie">http://www.amibroker.com/f?gfxpie</a><br>
              <b>GfxEllipse</b>( x1, y1, x2, y2 ) <a href="http://www.amibroker.com/f?gfxellipse">http://www.amibroker.com/f?gfxellipse</a><br>
              <b>GfxCircle</b>( x, y, radius ) <a href="http://www.amibroker.com/f?gfxcircle">http://www.amibroker.com/f?gfxcircle</a><br>
              <b>GfxChord</b>( x1, y1, x2, y2, x3, y3, x4, y4 ) <a href="http://www.amibroker.com/f?gfxchord">http://www.amibroker.com/f?gfxchord</a><br>
              <b>GfxArc</b>( x1, y1, x2, y2, x3, y3, x4, y4 ) <a href="http://www.amibroker.com/f?gfxarc">http://www.amibroker.com/f?gfxarc</a><br>
              <b>GfxPolygon</b>( x1, y1, x2, y2, ... ) <a href="http://www.amibroker.com/f?gfxpolygon">http://www.amibroker.com/f?gfxpolygon</a><br>
              <b>GfxPolyline</b>( x1, y1, x2, y2, ... ) <a href="http://www.amibroker.com/f?gfxpolyline">http://www.amibroker.com/f?gfxpolyline</a><br>
              <b>GfxSetTextColor</b>( color ) <a href="http://www.amibroker.com/f?gfxsettextcolor">http://www.amibroker.com/f?gfxsettextcolor</a><br>
              <b>GfxSetTextAlign</b>( align ) <a href="http://www.amibroker.com/f?gfxsettextalign">http://www.amibroker.com/f?gfxsettextalign</a><br>
              <b>GfxSetBkColor</b>( color ) <a href="http://www.amibroker.com/f?gfxsetbkcolor">http://www.amibroker.com/f?gfxsetbkcolor</a><br>
              <b>GfxSetBkMode</b>( bkmode ) <a href="http://www.amibroker.com/f?gfxsetbkmode">http://www.amibroker.com/f?gfxsetbkmode</a><br>
              <b>GfxGradientRect</b>( x1, y1, x2, y2, fromcolor, tocolor ) <a href="http://www.amibroker.com/f?gfxgradientrect">http://www.amibroker.com/f?gfxgradientrect</a><br>
              <b>GfxDrawText</b>( &quot;text&quot;, left, top, right, bottom, format
              = 0 ) <a href="http://www.amibroker.com/f?gfxdrawtext">http://www.amibroker.com/f?gfxdrawtext</a><br>
              <b>GfxSetOverlayMode</b>( mode = 0 ) <a href="http://www.amibroker.com/f?gfxsetoverlaymode">http://www.amibroker.com/f?gfxsetoverlaymode</a><br>
              <br>
      </li>
      <li>AFL: Two new fields in Status() functions: pxwidth and pxheight (<br>
      Status(&quot;pxwidth&quot;) - gives pixel width of chart window (useful for
      low level graphics functions that operate on pixels)<br>
      Status(&quot;pxheight&quot;) - gives pixel height of chart window<br>
      <br>
      </li>
      <li> Better scaling and no more black rectangle on the bottom in images created
        via Edit-&gt;Image-&gt;Copy / Export <br>
          <br>
      </li>
      <li>&quot;New Look&quot; charts (switchable via Tools-&gt;Preferences &quot;Charting&quot;)
        - give cleaner, larger and more readable chart display and printout<br>
          <br>
      </li>
      <li>Printing/copy-metafile function uses now Enhanced Metafile format that
        handles clipping regions (styleClipMinMax)<br>
          <br>
      </li>
    </ul>
    <p> <b>CHANGES FOR VERSION 4.93.0 (as compared to 4.92.0)</b></p>
    <ul>
      <li>Fixed exception that maight occur when copying to clipboard very long
        lines from AA result list <br>
          <br>
      </li>
      <li>CategoryGetName() now returns empty string for non-existing categories
        instead of some uninitialized (random) string<br>
          <br>
      </li>
      <li>Fixed exception when trying to apply commentary on blank chart pane<br>
          <br>
      </li>
      <li> AFL editor fix: right Alt + z does not trigger 'undo' anymore (allows
        to enter Polish z (z-dot-above) letter) <br>
          <br>
      </li>
      <li> Fixed exception occuring when Symbol Information was edited at the same
        time while first auto-analysis was run <br>
          <br>
      </li>
      <li> Fixed bar replay not functioning when viewing interval was the same
        as base time interval and set to less than 5 minute, mixed mode was off,
        and no afterhours/weekend filtering was enabled (FC#: 899)<br>
          <br>
      </li>
      <li> Fix: defined FXRate for the very first symbol in the database is used
        correctly now (FC#: 975)<br>
          <br>
      </li>
      <li> When LoadFormula() method of Analysis object is called parameters are
        reset now (FC#: 958)<br>
          <br>
      </li>
      <li> Ability to export Chart in &quot;portable&quot; format so you can distribute
        chart templates to others and they will be restored together with all linked
        formulas (FC#: 96)<br>
      This feature is available from RIGHT CLICK on chartTemplate-&gt;Save...Template-&gt;Load...<br>
      menus.<br>
      <br>
      In addition to old local template format a new one is added with .chart extensionthat
      keeps not only window sizes and formula references (paths) but also formulas
      themselves,so all you need to do is to save your chart into one file (Chart
      Template, Complete *.chart)and copy that file onto different computer and
      chart will be recreated with all formulas linked to it.<br>
          <br>
      To Save chart into new format do the following:<br>
      <br>
      1. Click with RIGHT MOUSE button over the chart and select Template-&gt;Save...<br>
      <br>
      2. In the file dialog, &quot;Files of type&quot; combo select &quot;Chart
      Template, Complete (*.chart)&quot;<br>
          <br>
      3. Type the file name and click Save.<br>
      <br>
      To load previously saved complete chart do the following:<br>
      <br>
      1. Click with RIGHT MOUSE button over the chart and select Template-&gt;Load...<br>
      <br>
      2. In the file dialog, select previously saved *.chart file and press &quot;Open&quot;<br>
      <br>
      Note: The procedure AmiBroker does internally is as follows: When you save
      the chart into new format it saves XML file with:<br>
          <br>
      a) names of all sheets, panes, their sizes, locations and other settings<br>
      b) paths to all formulas used by all panes<br>
      c) the text of formulas themselves<br>
      <br>
      When you load the chart in new format AmiBroker:<br>
      a) sets up the sheets/panes according to information stored in the file<br>
      b) for each formula stored in the file it checks if the same formula exists
      already on target computer:<br>
      - if it does not exist - it will create one<br>
      - if it exists and the contents is identical to the formula stored in .chart
      file it will do nothing<br>
      - if it exists and the contents is different then it will create NEW formula
      filewith _imported.afl suffix (so old file is not touched) and will reference
      the pane to the _imported.afl formula instead.<br>
          <br>
      IMPORTANT NOTE: if you use any #include files AmiBroker will store the contentsof
      include files as well inside chart file and will attempt to recreate them
      on target machine.Please note that in case of includes it will check if it
      exists and if it is different.If both conditions are met (different file
      exists already) it will ask to replace or not.If you choose to replace -
      it will replace and make backup of existing one with .bak extensionIf you
      are using any files in &quot;standard include files and include them using &lt;&gt; braces,
      AmiBroker will restore files in target machine standard include folder as
      well evenif the standard include folder path is different on the source machine).<br>
          <br>
      Note also - that this functionality is a bit experimental and pretty complex
      internally. There may be some bugs even though it was tested on number of
      different setups. Feedback is welcome. It is intended to be used to port
      charts between different computers. For storing layouts/templates on local
      computer you should rather use old formats as they consume much less space
      (they store only references,not the formulas themselves). One may however
      use new format for archiving purposes as itkeeps formulas and all references
      in one file that is very convenient for backups.</li>
    </ul>
    <p></p>
    <p>&nbsp;</p>
    <p><b>CHANGES FOR VERSION 4.92.0 (as compared to 4.91.1)</b></p>
    <ul>
      <li> Watch list tooltips now show WL ordinal number (index), name and symbol
        count<br>
          <br>
      </li>
      <li> new menu item &quot;WatchLists-&gt;Hide Empty watchlists&quot; allows
        to show/hide empty watchlists<br>
      Note that when you add new watch list AmiBroker will automatically unhide
      empty watch lists so you can see newly added list.<br>
          <br>
      </li>
      <li> AFL: Category* functions work fine now with more than 256 watch lists<br>
          <br>
      </li>
      <li> AFL: new function: CategoryFind() allows to search for category by name<br>
          <br>
      SYNTAX: CategoryFind( &quot;name&quot;, category )<br>
      RETURNS: number<br>
      FUNCTION: It allows to search for category by name. It takes category name
      and kind as parameters and returnsINDEX (ordinal number). For example it
      allows to find watch list index by name:<br>
          <br>
          <CODE><FONT COLOR=#000000>wlnumber = </FONT><FONT COLOR=#0000ff>CategoryFind</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"MyWatch
          List 1"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>categoryWatchlist</B></FONT><FONT COLOR=#000000> ); <BR>
      mysymbols = </FONT><FONT COLOR=#0000ff>CategoryGetSymbols</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>categoryWatchlist</B></FONT><FONT COLOR=#000000>,
      wlnumber );</FONT></CODE><br>
          <br>
      The index (in the above example watch list number) can be later used in functions
      thatneed the index (like CategoryGetSymbols).<br>
          <br>
      </li>
      <li> AFL: new function: InWatchListName() allows to reference watch list
        by name<br>
      It is equivalent to InWatchList function except that it takes watch list
      name as parameter instead of the index.<br>
          <br>
      SYNTAX InWatchListName( &quot;listname&quot; )<br>
      RETURNS NUMBER<br>
      FUNCTION Checks if the stock belongs to a watch list having name of listname.
      If yes - the function returns 1 otherwise 0. <br>
      EXAMPLE <br>
      <br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#000000><B>Filter</B></FONT><FONT COLOR=#000000>= </FONT><FONT COLOR=#0000ff>InWatchListName</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#ff00ff>"mywatchlist"</FONT><FONT COLOR=#000000> ) </FONT><FONT COLOR=#000000><B>OR</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#0000ff>InWatchListName</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#ff00ff>"mysecondwatchlist"</FONT><FONT COLOR=#000000> );</FONT></CODE><br>
      <br>
      Note that this function is a bit slower than InWatchList() function.<br>
      <br>
      </li>
      <li> Fixed Watch List Export - now exports from selected watch lists (not
        only from watch list number zero)<br>
          <br>
      If you select only one watch list to export then original symbol order is
      preserved, multiple watch list export uses alphabetical order to prevent
      duplicates.<br>
          <br>
      </li>
      <li>Fixed Watch List Sorting - now sorts selected watch list (not only watch
        list number zero)<br>
          <br>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 4.91.1 (as compared to 4.91.0)</b></p>
    <ul>
      <li>fixed symbol tree refresh after Watchlist-&gt;Import</li>
    </ul>
    <p><b>CHANGES FOR VERSION 4.91.0 (as compared to 4.90.5)</b></p>
    <ul>
      <li> AA: new options in the context menu &quot;Replace watch list with the
        results/selected results&quot; <br>
      This new option empties the watch list before adding results. The order of
      symbols in the result list is preserved in the watch list.<br>
          <br>
      </li>
      <li>Watchlists: context (right click) menu - now there is no WL selection
        dialog displayed<br>
      If you select the watch list from symbol tree and click with RIGHT mouse
      button to bring up watch list menu the selected watch list is used automatically
      and watchlist selector dialog is not displayed.<br>
          <br>
      </li>
      <li>Watchlists: redesign - now there is <b>no limit on number of watch lists </b>you
        can use<br>
      a) watch lists are now stored as text files inside &quot;Watchlists&quot; folder
      inside database. The folder contains of any number of .TLS files with watch
      lists themselves and index.txt that defines the order of watch lists. You
      can add your own .tls file (one symbol per line) and AmiBroker will update
      index.txt automatically (adding any new watch lists at the end)The .TLS files
      can also be open in AmiQuote.
      <p><br>
        b) watch lists remember the order in which symbols were added, so for example
          if you sort AA result list in some order and then you&quot;add symbols
          to watch list&quot; the order will be kept in the watch list.</p>
      <p><br>
        c) you can now Add/Delete watch lists using Symbol-&gt;Watch List-&gt; menu
        or from watch list context menuNote that if you have done any customization
        to the menu, you may need to go to Tools-&gt;Customize, select &quot;Menu
        Bar&quot; and press &quot;Reset&quot; button for this new menu items to
        appear.</p>
      <p><br>
        d) you can now alphabetically sort the symbols in the watch list </p>
      <p><br>
        e) all watch lists are shown in the symbol tree now, even if they are empty.</p>
      <p><br>
        f) for backward compatibility OLE automation WatchListBits/WatchListBits2
          properties of Stock object continue to work for first 64 watch lists
          (bit states are transparently emulated) </p>
      <p><br>
        g) Watch lists created in 4.91 are not visible for older versions<br>
        <br>
      </p>
      </li>
      <li>
        <p> When changing selected symbol, the tree is not traversed to the bottom
          (root). Instead only current branch is checked and if symbol is selected
          only if it is present under this branch (This prevents unnecessary unfolding
          of &quot;All&quot; and other branches)</p>
      </li>
      <li>
        <p> AFL Editor: AUTOWORDSELECTION turned off<br>
        </p>
      </li>
      <li>
        <p> AFL: switch/case statement added (completed: 2007-03-31) (ext.ID: 580).
          More information: <a href="http://www.amibroker.com/guide/v50/keyword/switch.html">http://www.amibroker.com/guide/v50/keyword/switch.html</a><br>
              <br>
        Example: <br>
        <br>
        <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>(
        n = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>; n &lt; </FONT><FONT COLOR=#ff00ff>10</FONT><FONT COLOR=#000000>;
        n++ ) <BR>
        { <BR>
            </FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"Current
              n = %f\n"</FONT><FONT COLOR=#000000>, n ); <BR>
                            <BR>
                            </FONT><FONT COLOR=#800000><B>switch</B></FONT><FONT COLOR=#000000>(n)
                            { <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>case</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>: <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"The
  number is zero.\n"</FONT><FONT COLOR=#000000>); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>break</B></FONT><FONT COLOR=#000000>; <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>case</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#ff00ff>3</FONT><FONT COLOR=#000000>: <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>case</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#ff00ff>5</FONT><FONT COLOR=#000000>: <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>case</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#ff00ff>7</FONT><FONT COLOR=#000000>: <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"n
  is a prime number\n"</FONT><FONT COLOR=#000000>); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>break</B></FONT><FONT COLOR=#000000>; <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>case</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>: </FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"n
  is a prime number\n"</FONT><FONT COLOR=#000000>); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>case</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#ff00ff>4</FONT><FONT COLOR=#000000>: <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>case</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#ff00ff>6</FONT><FONT COLOR=#000000>: <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>case</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#ff00ff>8</FONT><FONT COLOR=#000000>: <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"n
  is an even number\n"</FONT><FONT COLOR=#000000>); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>break</B></FONT><FONT COLOR=#000000>; <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>case</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>: <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>case</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#ff00ff>9</FONT><FONT COLOR=#000000>: <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"n
  is a perfect square\n"</FONT><FONT COLOR=#000000>); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>break</B></FONT><FONT COLOR=#000000>; <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>default</B></FONT><FONT COLOR=#000000>: <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"Only
  single-digit numbers are allowed\n"</FONT><FONT COLOR=#000000>); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>break</B></FONT><FONT COLOR=#000000>; <BR>
&nbsp;&nbsp; } <BR>
        </FONT></CODE> <br>
        </p>
      </li>
      <li>
        <p> AFL: break/continue statements added (supported inside for/while/do-while/switch
          statements). More information:<br>
              <a href="http://www.amibroker.com/guide/v50/keyword/break.html">http://www.amibroker.com/guide/v50/keyword/break.html</a><br>
              <a href="http://www.amibroker.com/guide/v50/keyword/continue.html">http://www.amibroker.com/guide/v50/keyword/continue.html</a><br>
              <br>
        Example: <br>
        <br>
        <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>(i
        = </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>; i &lt; </FONT><FONT COLOR=#ff00ff>1000</FONT><FONT COLOR=#000000>;
        i *= </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000> ) <BR>
        { <BR>
            </FONT><FONT COLOR=#800000><B> &nbsp;&nbsp;&nbsp;if</B></FONT><FONT COLOR=#000000>(
              i &gt; </FONT><FONT COLOR=#ff00ff>50</FONT><FONT COLOR=#000000> ) </FONT><FONT COLOR=#800000><B>break</B></FONT><FONT COLOR=#000000>; <BR>
                                  </FONT><FONT COLOR=#0000ff>&nbsp;&nbsp;&nbsp;printf</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"%f\n"</FONT><FONT COLOR=#000000>,
                                  i ); <BR>
        }</FONT></CODE> <br>
        </p>
      </li>
      <li>AFL: new C-like assignment operators +=, -=, *=, /=, %=, &amp;=, |=
          <p>New operators are shortcuts for some common operations. </p>
          <p>x += y; is equivalent to x = x + y;<br>
        x -= y; is equivalent to x = x - y;<br>
        x *= y; is equivalent to x = x * y;<br>
        x /= y; is equivalent to x = x / y;<br>
        x %= y; is equivalent to x = x % y;<br>
        x &amp;= y; is equivalent to x = x &amp; y; // bitwise and<br>
        x |= y; is equivalent to x = x | y; // bitwise or<br>
          </p>
          <p>&nbsp; </p>
      </li>
      <li>
        <p>Enanced display in Real Time Quote window (dual-step change coloring
          - when field changes it is highlighted with bright yellow for 0.25 second
          then color changes to pale yellow and after a while to default (white)
          background)) <br>
        </p>
      </li>
    </ul>
    <p><b>CHANGES FOR VERSION 4.90.4 (as compared to 4.90.3)</b></p>
  <ul>
  <li>PointValue is now automatically set to 1 if FuturesMode is NOT enabled for given backtest (pre-4.90 behaviour) <br><br>
  <li>Fixed crash @040ecde occuring when user incorrectly specifed NULL as a plot color (this is user error but anyway should not crash) (FC#: 848) <br><br>
  <li>Fixed problem with data tips non displaying under some rare circumstances(FC#: 844) <br><br>
  <li>Fixed problem with loading layout that referenced non-existing symbol <br><br>
  <li>Max Title len increased to 9K characters (FC#: 534) <br><br>
  <li>Changes made to color/Thickness/Style of LOCKED studies is saved now even if position did not change (FC#: 846) <br><br>
  <li>Ticker bar now only needs pressing ESC once to lose focus (FC#: 842) <br><br>
  </ul>

  <p><b>CHANGES FOR VERSION 4.90.3 (as compared to 4.90.2)</b></p>
<ul>
  <li>Fixed GIF export from OLE level when bitdepth was not specified (FC#816)<br><br>
  </li>
  <li>Notepad DEL key deletes one character now, not two (FC#817)<br><br></li>
   <li>MDITab titles are refreshed properly after loading the layout (FC#811)<br><br></li>
   <li>Layouts switching is faster<br><br></li>
</ul>

  <p><b>CHANGES FOR VERSION 4.90.2 (as compared to 4.90.1)</b></p>
<ul>
  <li>
      new account manager: fixed partial scaling out calcs<br>
      <br>
  </li>
  <li>
    OLE automation server registration checks registry access rights
        correctly on Windows Vista now (this prevents &quot;Failed to update
      registry. Try using REGEDIT&quot; message on Vista)<br>
      <br>
  </li>
  <li>
    Setup program now registers OLE servers by itself using elevated
      rights on Vista (programs run with ordinary rights do not have access to
      OLE
            registration
          on Vista)<br>
          <br>
  </li>
  <li>
    AddToComposite: the combination
          of atcEnableInIndicator + atcDeleteValues now invalidates cached foreign
          data (FC#:
              809)<br>
  </li>
</ul>

  <p><b>CHANGES FOR VERSION 4.90.1 (as compared to 4.90.0)</b></p>
<ul>
  <li>
     Fixed exception @00435766 (displaying Interpretation for blank window) <br>
</li>
  <li>
    Fixed exception @0044F999 (right click on title
      bar area on blank chart to delete non existing section)</li>
</ul>

  <p><b>CHANGES FOR VERSION 4.90.0 (as compared to 4.89.0)</b></p>
  <ul>
    <li> Fixed problem with information window length constraint being set wrong
        sometimes. (for example TickSize in View-&gt;Information was limited <br>
      to 4 digits after entering Currency field) <br>
      <br>
    </li>
    <li> Bar Replay current position static is now updated when changing start
        date <br>
      <br>
    </li>
    <li> Fixed problem RTQ window stopped updating the symbol when it was listed
        twice in different tabs and removed from one (FC#: 439)<br>
      <br>
    </li>
    <li> Fixed data tooltip display when xshift != 0 (FC#: 465)<br>
      <br>
    </li>
    <li> Fixed vertical grid Z-order when graphgridzorder = 1 (FC#: 377)<br>
        <br>
    </li>
    <li> Added &quot;Use as default&quot; box to Horizonal Line properties dialog
        - when checked, current drawing &quot;show value&quot; selection is stored
        as a default for all newly created horizontal lines (FC#: 389)<br>
      <br>
    </li>
    <li> Added File-&gt;New-&gt;Pane (creates blank pane)<br>
        <br>
    </li>
    <li>Added File-&gt;New-&gt;Blank chart (creates blank chart - you can drag-drop
        formulas on it) <br>
      <br>
    </li>
    <li>Window-&gt;New Linked window menu has been replaced by File-&gt;New-&gt;Linked
        Chart<br>
        <br>
    </li>
    <li> #30339 the limit of drawings per symbol has been increased from 5000
        to 65000 <br>
      [And contrary to previous (faulty) behaviour when limit is reached, you don't
      lose your previous drawings. Now you just can't save more than 65000 drawings
      per one symbol.]<br>
        <br>
    </li>
    <li> Renamed Tools-&gt;Auto-update quotes (US &amp; Canada) to Auto-update
        quotes (AmiQuote only) - new installations only <br>
        <br>
    </li>
    <li> Removed Tools-&gt;Export to CSV - new installations only <br>
        <br>
    </li>
    <li> Clipboard copy/paste now works OK on &quot;Symbol ticker&quot; combo
        (in the toolbar)<br>
        <br>
    </li>
    <li>Warning message when deleting symbols changed to &quot;Are you sure to
        delete current symbol from the DATABASE !&quot;<br>
        <br>
    </li>
    <li>Added open interest as a predefined formula<br>
        <br>
    </li>
    <li> Account manager: 5-tier commission table added<br>
        <br>
    </li>
    <li> Duplicate shortcut Alt+d for Edit / Define removed. Define now uses
        'f' shortcut (FC#: 219)<br>
        <br>
    </li>
    <li> BarReplay is now paused temporarily when user is drawing objects or
        printing <br>
        <br>
    </li>
    <li> Thick dotted line is now plotted with geometic pen on Win2000/XP or
        higher (FC#: 720)<br>
        <br>
    </li>
    <li> Fixed problem with passing HGDI handles when printing<br>
        <br>
    </li>
    <li>Account manager cash calculation when scaling in fixed (FC#: 793)<br>
        <br>
    </li>
    <li> Added styleNoRescale to Bollinger Bands in Price (all-in-one).afl <br>
        <br>
    </li>
    <li>ASCII importer: volume is now NOT to adjusted when ADJCLOSE and CLOSE
        is used<br>
      [To turn on adjusting (old, pre-4.90 behaviour) you need to add $SPLITADJVOL
      1 to command to ASCII importer definition]<br>
      <br>
    </li>
    <li>FuturesMode setting set using SetOption #24503 works the same as in the
        settings dialog <br>
      [The difference was due to the fact that PointValue set in the Information
      window was not transfered to the formula when<br>
      Futures Mode was NOT set in the Settings dialog (further change by SetOption
      did not transfer it).<br>
      Now Point Value is transfered always.]<br>
    </li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.89.0 (as compared to 4.88.0)</b></p>
  <ul>
    <li> AFL: Static variables are now case insensitive (FC#: 663)<br>
        <br>
    </li>
    <li>AFL: SetSortColumns() function (FC#: 607)<br>
      SetSortColumns( col1, col2, .... )<br>
      <br>
      sets the columns which will be used for sorting.<br>
        <br>
      col1, col2, ... col10 -Column numbers are ONE-based. Positive number means
      sort ASCENDING, negative number means sort DESCENDING. Upto 10 columns can
      be specified for multiple-column sort. Each subsequent call to SetSortColumns
      overwrites previous one.<br>
        <br>
      Examples:<br>
      <br>
      SetSortColumns( 5 ) - sort by 5th column in ascending order<br>
      <br>
      SetSortColumns( -3 ) - sort by 3rd column in descending order<br>
        <br>
      SetSortColumns( 1, -2 );<br>
      - sort by 1st column in ascending order and then by second column in descending
      order (multiple-column sort).<br>
      <br>
    </li>
    <li>Web Research: Synchronization with currently selected symbol has now
        three options:<br>
      Don't sync - does not synchronize with currently selected symbol<br>
      Sync active - synchronizes only when web research is active (or becomes active
      by clicking on it)<br>
      Sync always - synchronizes web page always, even if web research window is
      not active - warning: resource intensive<br>
        <br>
    </li>
    <li>New Account Manager added (completed: 2006-12-19)<br>
          <br>
      Account manager provides ability to track your account portfolio. Account
      manager functionality provides superset of features offered by old portfolio
      manager, but still some things are left todo namely: multi-currency handling,
      more stats (backtest-like), multi-tiered commission schedules etc.<br>
          <br>
          <b>Short Instructions:</b><br>
          <br>
      CREATE A NEW ACCOUNT:<br>
      <br>
      Use File-&gt;New-&gt;Account menu to create new account<br>
      <br>
      FUNDING AN ACCOUNT:<br>
      <br>
      Before you do any trading, you have to fund your account. To do so press &quot;FUNDING&quot; button
      on the account manager toolbar, then select &quot;Deposit&quot; as operation
      type, enter the DATE when you have funded your account and enter the amount.<br>
      Note that funding date must PRECEDE any trading, as account manager won't
      allow you to trade prior to funding date. Initial deposit will show as &quot;initial
      equity&quot; in summary tab.<br>
      <br>
      CHECK THE SETTINGS<br>
      <br>
      It is good idea to go to &quot;Summary tab&quot; and setup commissions and
      trading mode. If this account is used for End-of-day trading you should set &quot;EOD
      Mode&quot; to YES, otherwise (if you trade intraday) you should set &quot;EOD
      Mode&quot; to NO. Depending on this setting Buy/Sell dialogs will allowyou
      to enter date and time of the trade or only date.<br>
      <br>
      Commission schedule currently is only one-tier, in the future multiple-tier
      commission schedules will be possible.<br>
      <br>
      ENTERING TRADES:<br>
      <br>
      Once you funded an account you can enter trades.To buy (enter long position
      or cover short position ) click on &quot;BUY&quot; button.<br>
      <br>
      Then in the Buy dialog you need to select the symbol, the trade date/time.
      Once they are entered AmiBroker will display price of given symbol at the
      selected date/time (or preceding one if no exact match is found). It will
      also calculate maximum possible quantity taking price and available funds
      into account.<br>
      <br>
      You can change the price and quantity manually. <br>
      <br>
      All other values (net market valye, commission, market deposit, currency,
      fx rate) are calculated or retrieved automatically from Symbol-&gt;Information
      page. Once values are good, click OK to confirm transaction. If you made
      mistake, you can press UNDO (Edit-&gt;Undo) to revert last transaction.<br>
      <br>
      Similar procedure is for selling (entering short positions or closing longs)
      with the exception that you should press &quot;SELL&quot; button instead.<br>
      <br>
      All transactions that you made are listed in the &quot;Transactions&quot; sheet.
      All open positions are listed in &quot;Open Positions&quot; sheet. If you
      enter the trade for symbol that has position already open, AMiBroker will
      adjust &quot;open positions&quot; accordingly (perform scaling in/out). Once
      open position is closed it is removed from &quot;open positions&quot; list
      and moved to &quot;Closed trades&quot; sheet.<br>
      <br>
      After each transaction, &quot;Equity history&quot; sheet is updated with
      current account equity value and also &quot;Summary&quot; page is updated
      with basic open/long/short trade stats.(More stats are to come).<br>
      <br>
      IMPORTANT:<br>
      <br>
      You have to remember that you must enter all transactions in chronological
      manner(oldest first, newest last), as account manager won't allow you to
      add trades out-of-order. If you make mistake, there is one-level undo that
      you can use to revert to state before last transaction. If you made more
      mistakes, the only option is to close account without saving and re-open
      original file.<br>
      <br>
      SAVING YOUR ACCOUNT DATA:<br>
      <br>
      To save edits made to account use File-&gt;Save (or File-&gt;Save As to save
      under new name). Note that account files are NOT encrypted now, and it is
      quite easy to read the file for everyone who has the access to it. So make
      sure not to leave your files on some public computer. Password protection/encryption
      is planned but NOT implemented yet.<br>
      <br>
      OPENING PREVIOUSLY CREATED ACCOUNT:<br>
      <br>
      To open account file, go to File-&gt;Open, in the File dialog,select &quot;Account
      (*.acx)&quot; from &quot;Files of type&quot; combo-box, and select the account
      file you want to load.<br>
      <br>
      MULTIPLE ACCOUNTS:<br>
      <br>
      You can create/open multiple accounts at once (just use File-&gt;New-&gt;Account,
      File-&gt;Open many times).<br>
      <br>
    </li>
    <li> Vertical selector line has now user-definable color / bold style and
        it is plotted behind all graphs so it does not affect readability <br>
      Use Tools-&gt;Preferences-&gt;Color to adjust selector line color and style<br>
      <br>
    </li>
    <li> Charts: by default extra 3% space is added on the top of chart compared
        to previous versions (4.88 or earlier) <br>
        <br>
    </li>
    <li> printf/strformat are now protected against buffer overrun (1024 bytes)<br>
        <br>
    </li>
    <li> Scroll-Bar Zoom feature implemented (dragging left or right edge of
        chart scrollbar resizes it allowing to zoom in/out from the scrollbar)
        (FC#619)<br>
      [To turn it OFF use<br>
      Tools-&gt;Preferences &quot;Charting&quot; tab:<br>
      UNCHECK &quot;Enable Scroll Bar Zoom&quot; box.]<br>
      <br>
    </li>
    <li>RequestTimedRefresh() was not always starting up correctly since 4.86
        - fixed now.<br>
        <br>
    </li>
    <li> Range markers are now green (begin) and red (end) and are plotted with
        lines with small 'flag-like' rectangle at the end <br>
        <br>
    </li>
    <li>When user types non-existing symbol in ticker box, AmiBroker asks whenever
        it should be added or not <br>
      This allows very quick adding of new symbols directly from ticker box.<br>
      Just type symbol and press ENTER - if it does not exist - it will be added
      and backfilled if you use real time data source<br>
        <br>
    </li>
    <li> When adding/deleting symbols, charts displayed keep selected symbol <br>
        <br>
    </li>
    <li> Added ability to create composites (using AddToComposite) inside indicator
        code via new atcFlagEnableInIndicator flag (FC#: 191)<br>
        <br>
    </li>
    <li> AA window: now 'Sync chart' box is hidden when result list is maximized<br>
        <br>
    </li>
    <li> AFL: Implemented Say(&quot;text&quot;) function that speaks provided
        text (Windows XP, on lower-end Windows you need to install Microsoft Speech
        API, voice settings are in Windows Control Panel) <br>
      Example:<br>
      <br>
      Say(&quot;Testing text to speech engine&quot;);<br>
      <br>
    </li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.88.0 (as compared to 4.87.1)</b></p>
  <ul>
    <li>Automatic Analysis window: Added &quot;Sync chart on select&quot; checkbox <br>
      when turned ON, selection of any line from result list automatically synchronizes
        (displays) relevant chart. Selection can be made not only by mouse but
        also by keyboard effectivelly allowing you to scroll through AA result
        list using key down button and charts will be switching automatically.
        Also when you press SPACE button, the arrows for selected trade/signal
        will appear (only after backtest / scan)<br>
      <br>
    </li>
    <li> AFL Lexer code optimizations<br>
      Removed strncmp() C runtime calls from lexer and replaced it with hand optimized
        code, gives on average 15% speed improvement on AFL execution on larger
        formulas. NB. multi-line comment handling is speeded up this way as much
        as 7 times.<br>
      <br>
    </li>
    <li> Bar Replay feature implemented (<b>Tools-&gt;Bar Replay</b>) <br>
      Bar Replay feature plays back data for ALL SYMBOLS at once. It means that
        data for all symbols will end at specified &quot;playback position&quot;.This
        affects all formulas (no matter if they are used in charts or auto-analysis).<br>
      <br>
      Controls description:<br>
      <br>
      <b> |&lt;&lt; </b>- rewinds back to the beginning<br>
      <b>&lt;</b> - one step back<br>
      <b> [ ]</b> - stop - turns bar replay OFF (chart are not affected by bar
        reply)<br>
      <b> ||</b> - pause - pauses current playback or enters pause mode that
        allows to manually drag the slider bar and affect chart display - in PAUSE
        mode data are internally modified so quotes past selected &quot;playback&quot; position
        are invisible to any part of AmiBroker ( charts / automatic analysis ),
        except quotation editor<br>
      <b>&gt; Play</b> - playback bars history<br>
      <b>&gt;</b> - one step forward<br>
      <b>&gt;&gt; |</b> - goes to end of selected range<br>
      <br>
      <b>Slider bar </b>- allows to see the playback progress as well as MANUALLY
        move back and forward by dragging the slider thumb.<br>
      <br>
      <b>Start/End </b>- controls provide start and end simulation dates. The
        playback works so that all data UPTO currently selected &quot;Playback
        position&quot; are visible. Data past this position are invisible. &quot;Playback
        position&quot; can change from user-defined &quot;Start&quot; to &quot;End&quot;dates.
        The small <b>^</b> buttons on the right side of Start / End date fields
        allow to set Start/End to currently selected date on the chart.<br>
      <br>
      <b>Step interval</b> - defines interval of the step. Recommended setting
        is base interval of your database. So if you have 1-minute database, step
        interval should be 1 minute. If you have EOD database, step interval should
        be daily, however it is allowed to select higher step intervals. Note that
        chart viewing interval is independent from that. So you can playback 1
        minute database and watch 15 minute bars (they will look like real - building
        last &quot;ghost&quot; bar as new data come in)<br>
      <br>
      <b> Speed</b> parameter defines step frequency. It means how many steps
        will be played back within one second.Default is 1. Maximum is 5 minimum
        is 0.1. If you select 3 for example, AmiBroker will play one step every
        0.333 sec giving total of 3 steps per second. <br>
      <br>
      <b> Skip afterhours</b> - when turned on, playback skips hours outside
        regular trading hours as defined in File-&gt;Database Settings-&gt;Intraday
        Settings<br>
      <br>
      <b>Skip weekends</b> - when turned on, playback skips Saturdays and Sundays<br>
      <br>
      To ENTER PLAYBACK mode - press PLAY or PAUSE buttons - then data are truncated
      at current &quot;playback position&quot;)To EXIT PLAYBACK mode - press STOP
      button or close Bar Replay dialog - the full data set will be restored.<br>
      <br>
      Note that playback simulation is done internally and the database is kept
      untouched in fact (all data are still visible in Quote Editor), so there
      is no risk using Bar Reply. <br>
        <br>
    </li>
    <li>Added Insert-&gt;Select to Tools-&gt;Customize-&gt;Keyboard command list
        to allow customers to add keyboard accelerator to this action <br>
        <br>
    </li>
    <li> Fib. TIME extensions , &quot;lock position&quot; now works correcly.
        Also &quot;bold&quot; attribute can be now applied <br>
        <br>
    </li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.87.1 (as compared to 4.87.0)</b></p>
  <ul>
    <li>fixed symbol tree, right mouse click on the watch list causing exception</li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.87.0 (as compared to 4.86.0)</b></p>
  <ul>
    <li> Added &quot;Request data on save&quot; checkbox to File-&gt;Database
        Settings-&gt;Intraday Settings<br>
      When this is turned ON, AmiBroker will query data plugin for fresh data when
      saving database. This ensures that all collected real time data is transferred
      to AmiBroker's own database. <br>
      Caveats: <br>
      1. if external data source uses automatic backfill - it may cause triggering
      backfills during saving 2. turning this feature ON may slightly increase
      CPU load<br>
      Recommendations:<br>
      Generally speaking all data sources with no backfill or slow backfill should
      turn ON this feature,others (with fast backfill covering long histories)
      should have this turned OFF.<br>
      IB plugin: recommended setting: ON<br>
      This feature is designed specifically with IB plugin in mind as it has very
      limited backfill capabilities and it is good to savedata so it does not need
      to be re-filled on next session.<br>
      eSignal plugin: recommended setting: OFF<br>
      Using eSignal with this feature turned on may cause excessive backfills and
      exceeding eSignal symbol limit<br>
      IQFeed plugin: recommended setting: OFF <br>
      DDE plugin: recommended setting: ON<br>
      <br>
    </li>
    <li> Fixed minor save on exit problem<br>
        <br>
    </li>
    <li> New menu options <br>
      1. File-&gt;New -&gt; Default Chart replaces Window-&gt;New<br>
      2. File-&gt;New -&gt; Web Browser - creates new web browser window tab<br>
      3. File-&gt;New -&gt; Account - creates new account manager window (still
      in development, not available now) (Tools-&gt;Portfolio manager will soon
      become obsolete)<br>
      4. File-&gt;New -&gt; Database - replaces File-&gt; New database<br>
      5. File-&gt;Save / Save As.- allows to save current document (such as HTML
      page from the browser, or account information (in development))<br>
      6. File-&gt;Save All - saves ALL modified, open documents including all open
      formula files<br>
      7. File-&gt;Close - closes currently open document (chart, browser or account)<br>
      <br>
      Removed View-&gt;Profile menu option as it is now replaced by superior File-&gt;New-&gt;Web
      Research<br>
      <br>
    </li>
    <li>Added Web Research window: multi-tab web browser with multiple built-in
        financial sites templatized shortcuts <br>
      This feature effectively replaces and extends previous View-&gt;Profile functionality
      that allowed to view single symbol profile web page. Now via File-&gt;New
      -&gt; Web Research you can open multiple (unlimited) tabbed web browsers
      that allow to display unlimited(user configurable in Tools-&gt;Customize-&gt;Web
      Pages. In addition to that the browser now features regular &quot;Address&quot; bar
      that allows to type ANY URL address and use it as regular web browser.<br>
&quot; Open in New Window&quot; option available from right click menu now opens
  new web browser inside tab.<br>
  &quot; 
      Sync&quot; button when activated synchronizes web page with currently selected
        symbol, so you can browse for example profiles of different symbols by
        simply switching active symbol from the tree or combo box, without having
        to type complex URL addresses.<br>
      <br>
    </li>
    <li> Added Customizing of Web Research addresses in Tools-&gt;Customize-&gt;Web
        Pages dialog<br>
      Configuration data are stored in webpages.cfg plain text file that holds
      any number of URL templates in the form of:<br>
        <br>
      URLTemplate|Description<br>
      <br>
      Description part is optional.URL template may use {t} marker that will be
      replaced in runtime with currently selected ticker. For more info see:http://www.amibroker.com/guide/h_profiles.html(note
      that old profile window is no longer available however, the URL template
      encoding remains the same)<br>
      <br>
    </li>
    <li>Added ability to turn off MDI tabs (Tools-&gt;Customize-&gt;Appearance &quot;Show
        MDI tabs&quot;) - note however that it is not recommeded to turn them off
        since window navigation will be more difficult <br>
        <br>
    </li>
    <li> Added Symbol-&gt;Next Sibling / Symbol-&gt;Prev Sibling commands to
        Tools-&gt;Customize-&gt;Keyboard page (FC#.ID: 550)<br>
      This allows to navigate through symbols WITHIN selected category. On NEW
      installations it will default to Alt+Shift+Left arrow/Right arrow<br>
        <br>
    </li>
    <li> Fixed &quot;Remove&quot; button positioning in Organize assignments
        dialog <br>
        <br>
    </li>
    <li>Fixed combo box contents when &quot;Indexes&quot; are choosen in Assignment
        organizer <br>
        <br>
    </li>
    <li> Implemented File-&gt;Save All - which saves all open, MODIFIED documents/files,
        including AFL formulas<br>
      Note that because there is no editing functionality for HTML pages (Web Research
      window) they are never in modified state, so they never get saved using &quot;Save
      All&quot;. To save HTML page you need to manually do Save on selected HTML
      doc.<br>
        <br>
    </li>
    <li> Pane Up/Pane Down function does not change the original height of panes
        moved<br>
    </li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.86.0 (as compared to 4.85.0)</b></p>
  <ul>
    <li>
      <p>Added 'every tick' RT chart refresh in Professional Edition to already
          existing 1-sec and up refresh intervals<br>
        To enable 'every tick' chart refresh in Professional Edition, go to Tools-&gt;Preferences,
        Intraday tab and enter ZERO (0) into &quot;Intraday chart refresh interval&quot; field.
      (note Standard Edition won't allow to do that).</p>
      <p> Once you enter zero, AmiBroker will refresh all charts with every new
          trade arriving provided that the formulasyou use execute fast enough.
          If not, it will dynamically adjust refresh rate to maintain maximum possible
          refresh rate without consuming more than 50% of CPU (on average). So
          for example if your charts take 0.2 sec to execute AmiBrokerwill refresh
        them on average 2.5 times per second.</p>
      <p> Note: built-in Windows Performance chart shows cumulated CPU consumption
          for all processes, to display PER-PROCESS CPU load use SysInternals free
        software <a href="http://www.sysinternals.com/Utilities/ProcessExplorer.html">http://www.sysinternals.com/Utilities/ProcessExplorer.html</a></p>
    <li>
      <p>MDI tabs implemented</p>
    <li>
      <p>AFL: Added GetPerformanceCounter( bReset = False ) function</p>
      <p>SYNTAX: GetPerformanceCounter( bReset = False )</p>
      <p>RETURNS: Number</p>
      <p>GetPerformanceCounter retrieves the current value of the high-resolution
          performance counter. Returned value is in milliseconds. Resolution is
          upto 0.001 ms (1 microsecond).The value of high-resolution counter represents
          number of milliseconds from either system start (boot) or from last counter
          reset.To reset the counter you need to call GetPerformanceCounter function
          with bReset parameter set to True. Note that reseting counters inside
          one formula does not affect counters in other formulas.Since returned
          values are very large (time in milliseconds since system start is usually
          quite large), for precise measurements of single function or small function
          block execution times it is strongly recommended to reset counter at
          the beginning of the block so floating point resolution (7 digits) does
        not affect the precision of measurement. Example:</p>
      <p><CODE><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>GetPerformanceCounter</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>True</B></FONT><FONT COLOR=#000000>); </FONT><FONT COLOR=#008000>//
              reset counter to zero</FONT><FONT COLOR=#000000> <BR>
              </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>(
              i = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>; i &lt; </FONT><FONT COLOR=#ff00ff>1000</FONT><FONT COLOR=#000000>;
              i++ ) <BR>
        { <BR>
&nbsp;&nbsp; k = </FONT><FONT COLOR=#0000ff>sin</FONT><FONT COLOR=#000000>( i
  ); <BR>
        } <BR>
        <BR>
        elapsed=</FONT><FONT COLOR=#0000ff>GetPerformanceCounter</FONT><FONT COLOR=#000000>(); <BR>
        <BR>
      </FONT><FONT COLOR=#ff00ff>"Time [ms] = "</FONT><FONT COLOR=#000000>+elapsed;</FONT></CODE></p>
      <p><br>
        The code above shows that 1000 iterations of sin() calculation takes about
          1.7 milliseconds. Note that call to the GetPerformanceCounter() has overhead
        of about 0.015 ms (15 microseconds)</p>
      GetPerformanceCounter function may also be used to report time since system
        start:
      <p><CODE><FONT COLOR=#000000>elapsed=</FONT><FONT COLOR=#0000ff>GetPerformanceCounter</FONT><FONT COLOR=#000000>(); <BR>
              <BR>
        </FONT><FONT COLOR=#0000ff>StrFormat</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"Time
          since system start %.0f days, %.0f hours, %.0f minutes, %.0f seconds,
          %.0f milliseconds "</FONT><FONT COLOR=#000000>, <BR>
          </FONT><FONT COLOR=#0000ff>floor</FONT><FONT COLOR=#000000>(elapsed/(</FONT><FONT COLOR=#ff00ff>24</FONT><FONT COLOR=#000000>*</FONT><FONT COLOR=#ff00ff>60</FONT><FONT COLOR=#000000>*</FONT><FONT COLOR=#ff00ff>60</FONT><FONT COLOR=#000000>*</FONT><FONT COLOR=#ff00ff>1000</FONT><FONT COLOR=#000000>)), <BR>
          </FONT><FONT COLOR=#0000ff>floor</FONT><FONT COLOR=#000000>( elapsed/(</FONT><FONT COLOR=#ff00ff>60</FONT><FONT COLOR=#000000>*</FONT><FONT COLOR=#ff00ff>60</FONT><FONT COLOR=#000000>*</FONT><FONT COLOR=#ff00ff>1000</FONT><FONT COLOR=#000000>)
          ) % </FONT><FONT COLOR=#ff00ff>24</FONT><FONT COLOR=#000000>, <BR>
          </FONT><FONT COLOR=#0000ff>floor</FONT><FONT COLOR=#000000>( elapsed/(</FONT><FONT COLOR=#ff00ff>60</FONT><FONT COLOR=#000000>*</FONT><FONT COLOR=#ff00ff>1000</FONT><FONT COLOR=#000000>)
          ) % </FONT><FONT COLOR=#ff00ff>60</FONT><FONT COLOR=#000000>, <BR>
          </FONT><FONT COLOR=#0000ff>floor</FONT><FONT COLOR=#000000>( elapsed/</FONT><FONT COLOR=#ff00ff>1000</FONT><FONT COLOR=#000000> )
          % </FONT><FONT COLOR=#ff00ff>60</FONT><FONT COLOR=#000000>, <BR>
      elapsed % </FONT><FONT COLOR=#ff00ff>1000</FONT><FONT COLOR=#000000> );</FONT></CODE></p>
      <p></p>
      <p>It can be also used in trading system automation to measure time in
          milliseconds between various events (just subtract values returned by
        GetPerformanceCounter() during two different events)</p>
      <p>Caveat: this function relies on Windows API QueryPerformanceCounter
          function and CPU RTDSC instruction and it may yield to inaccurrate results
          if you have multiple-core processor and AMD's &quot;Cool and Quiet&quot; enabled
          in BIOS or other CPU clock stepping technologies enabled. If this applies
        to you, you may check Microsoft hotfix to this problem at: <a href="http://support.microsoft.com/?id=896256">http://support.microsoft.com/?id=896256</a></p>
    <li>
      <p>Fixed crash that sometimes occurred when chart using RequestTimedRefresh()
        was closed </p>
    <li>
      <p>Added &quot;Cancel&quot; button to &quot;Do you want to save database:
        Yes/No&quot; dialog that appears on AB exit when database is modified</p>
    <li>
      <p>Added registry key for controlling built-in exception handling.</p>
      <p>If you are 3rd party developer working with Visual C++ debugger and
          wanting exceptions to be caught by Visual Studio debugger instead of
          AmiBroker's built-in crash recovery system contact AmiBroker support
        and we will provide instructions how to disable it.</p>
    <li>
      <p>AFL: atan2( y, x ) implemented<br>
          <br>
        atan2 returns the arctangent of y/x. If x is 0, atan returns 0. If both
        parameters of atan2 are 0, the function returns 0. While atan returns a
        value in the range &#8211;PI/2 to PI/2 radians; atan2 returns a value in
        the range &#8211;PI to PI radians, using the signs of both parameters to
      determine the quadrant of the return value.</p>
    <li>
      <p>AFL: FFT( array, size = 0 ) function implemented </p>
      <p>FFT( array, len = 0 )</p>
      <p>performs FFT (Fast Fourier Transform) on last 'len' bars of the array,
          if len is set to zero, then FFT is performed<br>
      on entire array. len parameter must be even.</p>
      <p>Result:</p>
      <p>function returns array which holds FFT bins for first 'len' bars. There
          are len/2 FFT complex bins returned,<br>
        where bin is a pair of numbers (complex number): first is real part of
        the complex number and second number<br>
      is the imaginary part of the complex number.</p>
      <p>result = FFT( array, 256 );</p>
      <p>where:<br>
        0th bin (result[0] and result[1]) represents DC component,<br>
        1st bin (result[1 ] and result[2]) represents real and imaginary parts
        of lowest frequency range<br>
      and so on upto result[ len - 2 ] and result[ len - 1 ]</p>
      <p>remaining elements of the array are set to zero.</p>
      <p>FFT bins are complex numbers and do not represent real amplitude and
          phase. To obtain amplitude and<br>
        phase from bins you need to convert inside the formula. The following code
      snipplet does that:</p>
      <p><CODE><FONT COLOR=#000000>ffc = </FONT><FONT COLOR=#0000ff>FFT</FONT><FONT COLOR=#000000>(data,Len); <BR>
        </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>( i = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>;
          i &lt; Len - </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>;
          i = i + </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000> ) <BR>
        { <BR>
&nbsp;&nbsp; amp[ i ] = amp[ i + </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> ]
  = </FONT><FONT COLOR=#0000ff>sqrt</FONT><FONT COLOR=#000000>(ffc[ i ]^ </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>&nbsp;&nbsp;+&nbsp;&nbsp;ffc[
  i + </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> ]^</FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>);&nbsp;&nbsp; <BR>
&nbsp;&nbsp; phase[ i ] = phase[ i + </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> ]
  = </FONT><FONT COLOR=#0000ff>atan2</FONT><FONT COLOR=#000000>( ffc[ i + </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>],
  ffc[ i ] ); <BR>
      }</FONT></CODE></p>
      <p>IMPORTANT note: input array for FFT must NOT contain any Null values.
          Use Nz() function to convert Nulls to zeros<br>
      if you are not sure that input array is free from nulls.</p>
      <p></p>
      <p>Example formula:</p>
      <p><CODE><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>SetBarsRequired</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>100000</FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#ff00ff>100000</FONT><FONT COLOR=#000000>); <BR>
              <BR>
        Len = </FONT><FONT COLOR=#0000ff>Param</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"FFT
        Length"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>1024</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>64</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>10000</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>10</FONT><FONT COLOR=#000000> ); <BR>
            <BR>
        Len = </FONT><FONT COLOR=#0000ff>Min</FONT><FONT COLOR=#000000>( Len, </FONT><FONT COLOR=#000000><B>BarCount</B></FONT><FONT COLOR=#000000> ); <BR>
        <BR>
        x = </FONT><FONT COLOR=#0000ff>BarIndex</FONT><FONT COLOR=#000000>(); <BR>
        x1 = x - </FONT><FONT COLOR=#000000><B>BarCount</B></FONT><FONT COLOR=#000000> +
        Len; <BR>
            <BR>
            <BR>
        input = </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>; <BR>
        a = </FONT><FONT COLOR=#0000ff>LastValue</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>LinRegIntercept</FONT><FONT COLOR=#000000>(
        input, Len - </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> )
        ); <BR>
        b = </FONT><FONT COLOR=#0000ff>LastValue</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>LinRegSlope</FONT><FONT COLOR=#000000>(
        input, Len - </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> )
        ); <BR>
            <BR>
            <BR>
        Lr = a + b * x1; <BR>
        <BR>
        data = input - Lr;</FONT><FONT COLOR=#008000>// de-trending</FONT><FONT COLOR=#000000> <BR>
        <BR>
        ffc = </FONT><FONT COLOR=#0000ff>FFT</FONT><FONT COLOR=#000000>(data,Len); <BR>
        <BR>
        </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>( i = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>;
        i &lt; Len - </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>; i
        = i + </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000> ) <BR>
        { <BR>
&nbsp;&nbsp; amp[ i ] = amp[ i + </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> ]
  = </FONT><FONT COLOR=#0000ff>sqrt</FONT><FONT COLOR=#000000>(ffc[ i ]^ </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>&nbsp;&nbsp;+&nbsp;&nbsp;ffc[
  i + </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> ]^</FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>);&nbsp;&nbsp; <BR>
&nbsp;&nbsp; phase[ i ] = phase[ i + </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> ]
  = </FONT><FONT COLOR=#0000ff>atan2</FONT><FONT COLOR=#000000>( ffc[ i + </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>],
  ffc[ i ] ); <BR>
        } <BR>
        <BR>
        auto = </FONT><FONT COLOR=#0000ff>ParamToggle</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"Auto
        dominant cycle"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>"No|Yes"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> ); <BR>
        sbar = </FONT><FONT COLOR=#0000ff>Param</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#ff00ff>"Which
        FFT bin"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>50</FONT><FONT COLOR=#000000> ); <BR>
            <BR>
        skipbin1 = </FONT><FONT COLOR=#0000ff>ParamToggle</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"Skip
        1st FFT bin"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>"No|Yes"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> ); <BR>
            <BR>
            </FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>(
              auto ) <BR>
        { <BR>
&nbsp;&nbsp; sbar = </FONT><FONT COLOR=#0000ff>int</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>LastValue</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#0000ff>ValueWhen</FONT><FONT COLOR=#000000>(
  amp == </FONT><FONT COLOR=#0000ff>LastValue</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#0000ff>Highest</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>IIf</FONT><FONT COLOR=#000000>(
  skipbin1 </FONT><FONT COLOR=#000000><B>AND</B></FONT><FONT COLOR=#000000> x &lt; </FONT><FONT COLOR=#ff00ff>4</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000> ,
  amp ) )), x / </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000> )) ); <BR>
        } <BR>
        <BR>
        fv = </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"firstvisiblebar"</FONT><FONT COLOR=#000000>); <BR>
        <BR>
        thisbar = </FONT><FONT COLOR=#0000ff>Ref</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>int</FONT><FONT COLOR=#000000>(x/</FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>)
        == sbar, -fv); <BR>
        </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>Ref</FONT><FONT COLOR=#000000>(amp,-fv), <br>
        </FONT><FONT COLOR=#ff00ff>"amplitude (bin "</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#0000ff>Ref</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>int</FONT><FONT COLOR=#000000>(x/</FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>),
        -fv ) +</FONT><FONT COLOR=#ff00ff>")"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>IIf</FONT><FONT COLOR=#000000>(
        thisbar, </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorBlack</B></FONT><FONT COLOR=#000000> ),</FONT><FONT COLOR=#000000><B>styleArea</B></FONT><FONT COLOR=#000000>); <BR>
            <BR>
            </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>IIf</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>BarCount</B></FONT><FONT COLOR=#000000> - </FONT><FONT COLOR=#0000ff>BarIndex</FONT><FONT COLOR=#000000>() &lt; Len,
              data, </FONT><FONT COLOR=#000000><B>Null</B></FONT><FONT COLOR=#000000> )
              ,<br>
              </FONT></CODE><CODE><FONT COLOR=#ff00ff>"de-trended input ("</FONT><FONT COLOR=#000000>+Len+</FONT><FONT COLOR=#ff00ff>" bars)"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorOrange</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>styleLeftAxisScale</B></FONT><FONT COLOR=#000000> ); <BR>
              </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>cos</FONT><FONT COLOR=#000000>(
              phase[ sbar * </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000> ]
              + (sbar) * x1 * </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000> * </FONT><FONT COLOR=#ff00ff>3.1415926</FONT><FONT COLOR=#000000> /
              Len ), </FONT><FONT COLOR=#ff00ff><br>
        " 
                dominant cycle "</FONT><FONT COLOR=#000000>+ Len/(sbar) + </FONT><FONT COLOR=#ff00ff>"("</FONT><FONT COLOR=#000000> +
                sbar + </FONT><FONT COLOR=#ff00ff>" bin) bars"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorBlue</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>styleOwnScale</B></FONT><FONT COLOR=#000000> ); <BR>
                <BR>
                </FONT><FONT COLOR=#000000><B>GraphZOrder</B></FONT><FONT COLOR=#000000>=</FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>; <BR>
                </FONT><FONT COLOR=#000000><B>GraphXSpace</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#ff00ff>10</FONT><FONT COLOR=#000000>; <BR>
            </FONT></CODE></p>
    <li>
      <p>Fixed: pre-defined color table in broker.prefs sometimes got corrupted</p>
    <li>
      <p>Repainting of RT quote window is now flicker-free on Windows XP and
        higher</p>
    <li>
      <p>Symbol-&gt;Organize assignments, added ability to remove multiple symbols
        at once from watch list, index and favourite categories </p>
  </ul>
  <p>&nbsp;</p>
  <p><b>CHANGES FOR VERSION 4.85.0 (as compared to 4.84.0)</b></p>
  <ul>
    <li>AFL: Added DateTimeConvert function (FC#: 297)<br>
        <b>DateTimeConvert</b>( format, date, time = Null )<br>
        <br>
      The function allows to convert from DateTime format to DateNum and TimeNum
      and vice versa.<br>
      <br>
      format parameter controls the direction of conversion:<br>
      <br>
      format = 0 - converts DateTime format to DateNum format, example <br>
      <br>
      <CODE><FONT COLOR=#000000>mydatenum = </FONT><FONT COLOR=#0000ff>DateTimeConvert</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>DateTime</FONT><FONT COLOR=#000000>()
      );</FONT><FONT COLOR=#008000>// - this returns DateNum</FONT></CODE> <br>
      <br>
      date argument should be in datetime formattime argument in this case should
      not be used <br>
      <br>
      format = 1 - converts DateTime format to TimeNum format, example: <br>
      <br>
      <CODE><FONT COLOR=#000000>mytimenum = </FONT><FONT COLOR=#0000ff>DateTimeConvert</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>DateTime</FONT><FONT COLOR=#000000>()
      ); </FONT><FONT COLOR=#008000>// - returns timenum </FONT></CODE><br>
      <br>
      date argument should be in datetime formattime argument in this case should
      not be used <br>
      <br>
      format = 2 - converts from DateNum and optionally TimeNum to DateTime format,
      example: <br>
      <br>
      <CODE><FONT COLOR=#000000>mydatetime = </FONT><FONT COLOR=#0000ff>DateTimeConvert</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>DateNum</FONT><FONT COLOR=#000000>(), </FONT><FONT COLOR=#0000ff>TimeNum</FONT><FONT COLOR=#000000>()
      ); </FONT></CODE><br>
      <br>
      date argument should be in datenum formattime argument (optional) should
      be in timenum format. In case of EOD data you can skip time argument: <br>
      <br>
      <CODE><FONT COLOR=#000000>mydatetime = </FONT><FONT COLOR=#0000ff>DateTimeConvert</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>DateNum</FONT><FONT COLOR=#000000>()
      );</FONT></CODE><br>
      <br>
    </li>
    <li> K-ratio is now reported with 4 decimal places (FC#: 357)<br>
        <br>
    </li>
    <li>Added 'left side' display option to horizontal line labels and fixed
        problem with label sometimes disappearing (completed: 2006-08-15) (FC#:
        342)<br>
        <br>
    </li>
    <li>AFL: <b>fgetstatus</b>( filename, what, format = 0 ) <br>
      Implemented <br>
      <br>
      <b>fgetstatus</b>( filename, what, format = 0 )<br>
      <br>
      function that retrieves file properties/status.<br>
      <br>
      Returns NUMBER or STRING depending on format parameter<br>
      If file does not exist it returns Null.<br>
      <br>
      Parameters:<br>
      <br>
      filename - the name of the file (with or without full path) to query<br>
      what - specifies what file property to retrieve, allowable values<br>
      0 - the date/time the file was created<br>
      1 - the date/time the file was last modified<br>
      2 - the date/time the file was last accessed for reading<br>
      3 - the file size in bytes<br>
      4 - attribute byte of the file<br>
      <br>
      format - specifies return format of date/time values (format specifications
      are the same as in Now() function):<br>
      allowed values:<br>
      0 - returns string containing date/time formatted according to system settings <br>
      1 - returns string containing date only formatted according to system settings <br>
      2 - returns string containing time only formatted according to system settings <br>
      3 - returns DATENUM number with date <br>
      4 - returns TIMENUM number with time <br>
      5 - returns DATETIME number with date/time <br>
      6 - returns date DAY (1..31) <br>
      7 - returns date MONTH (1..12) <br>
      8 - returns date YEAR (four digit) <br>
      9 - returns date DAY OF WEEK (1..7, where 1=Sunday, 2=Monday, and so on) <br>
      10 - returns date DAY OF YEAR (1..366) <br>
      <br>
      Note that Windows supports only 2 second resolution of file date/time stamps.<br>
      <br>
      Example:<br>
      <br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#008000>// get modification
      date string of portfolio.afl file</FONT><FONT COLOR=#000000> <BR>
      </FONT><FONT COLOR=#0000ff>fgetstatus</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"formulas\\Equity\\portfolio.afl"</FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>);</FONT></CODE><br>
    </li>
    <li> AFL: GetTradingInterface uses WaitForInputIdle now instead of fixed
        interval wait when launching IB interface <br>
        <br>
    </li>
    <li>Disabled snapping to pixel resolution after manual editing of drawings
      #32071</li>
  </ul>
  <ul>
  </ul>
  <p><b>CHANGES FOR VERSION 4.84.0 (as compared to 4.83.1)</b></p>
  <ul>
    <li> Added GradientFillSlow code to support gradients on printers and metafiles
        which do not support them natively (completed: 2006-07-28)<br>
      <br>
    </li>
    <li>Added GraphGridZOrder variable to control when grid lines are plotted
        (completed: 2006-07-31) (ext.ID: 351)<br>
      When you specify<br>
      GraphGridZOrder = 1;<br>
      then grid lines are plotted on top of any charts<br>
      <br>
    </li>
    <li>AFL: new function RequestTimedRefresh( interval, onlyvisible = True )
        (completed: 2006-08-06)<br>
          <br>
          <b>RequestTimedRefresh</b>( interval, onlyvisible = True )<br>
          <br>
      - causes given indicator window to refresh automatically every &lt;interval&gt; seconds
      regardless of data source used or connection state. <br>
      <br>
      <b>interval</b> parameter defines timeout in seconds between refreshes.
        AmiBroker attempts to align refreshes to second boundaryso if you call
        it RequestTimedRefresh( 5 ) you should get refreshes at 0, 5, 10, 15, 20,
        25, 30, 35, 40, 45, 50 and 55 second of the minute.Due to the way how regular
        (low overhead) timers are implemented in Windows they have accurracy of
        +/-55ms providedthat CPU is not very busy. Don't expect to get first line
        of your code to execute exactly at .000 milliseconds. This varies depending
        on machine load, number of quotes, system time slice and tens of other
        factors.Usually (on my testing machines) the first line of the code executes
        anywhere in the first 100 ms of the second, provided that other processes
        do not interfere. Windows is not real-time operating system and it does
        not guarantee any fixed execution/reaction times.<br>
      <br>
      <b>onlyvisible</b> parameter set to True (default value) means that refreshes
        are triggered only for visible and not minimised windows. This applies
        also to main AmiBroker window - when it is minimised charts are NOT refreshed
        by default. To force refreshes when window is minimised you need to set
        this parameter to False. Note that this visibility applies to mostly to
        'minimised' state or the situation when you move chart outside the boundary
        of physical screen so it is not visible to an eye but still open. It does
        not apply to chart windows that are on placed on inactive sheets, as they
        do not really exist until they are shown (this way AmiBroker conserves
        memory and CPU) and as non-existing, can not be refreshed.<br>
      <br>
      Example:<br>
      <br>
      RequestTimedRefresh( 5 ); // automatically refresh this particular chart
      every 5 seconds<br>
      <br>
      Hint: to detect whenever given refresh comes from timer or user action you
      can use Status(&quot;redrawaction&quot;) function. It returns 0 for regular
      refresh (user action) and 1 for timer-refresh<br>
      <br>
    </li>
    <li>AFL: Status(&quot;redrawaction&quot;) added (completed: 2006-08-06)<br>
      Status function now supports new field: redrawaction<br>
      <br>
      <CODE><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"redrawaction"</FONT><FONT COLOR=#000000>)</FONT></CODE><br>
      <br>
      It returns 0 (zero) for regular refreshes, and 1 for refreshes triggered
      via RequestTimedRefresh(). Note that in the future more return values can
      be added.<br>
        <br>
      Example:<br>
      <br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"redrawaction"</FONT><FONT COLOR=#000000>)
      ==</FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> ) <BR>
      { <BR>
      </FONT><FONT COLOR=#0000ff>_TRACE</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"\nTIMED
        REFRESH"</FONT><FONT COLOR=#000000>+</FONT><FONT COLOR=#0000ff>Now</FONT><FONT COLOR=#000000>()); <BR>
      } <BR>
        </FONT><FONT COLOR=#0000ff>RequestTimedRefresh</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>);<br>
        <br>
    </FONT></CODE></li>
    <li> CreateStaticObject() actually calls internal CreateStaticObject :-)
        - for some reason it was calling regular CreateObject() instead. (completed:
        2006-07-27)<br>
        <br>
    </li>
    <li>Fixed problem with HoldMinDays sometimes allowing exit too soon (completed:
        2006-07-29)<br>
        <br>
    </li>
    <li> Fixed: Custom metric sort problem in optimization result list (occurred
        in 4.83 only) (completed: 2006-07-29) (ext.ID: 345)<br>
        <br>
    </li>
    <li> Pane resizing algorithm changed so if you drag the divider between panes
        only neighbouring panes are resized (others remain unchanged)<br>
        <br>
    </li>
    <li> Real time quote parent window has WS_CLIPCHILDREN style in order to
        fix some minor redraw issue (completed: 2006-07-31)<br>
    </li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.83.1 (as compared to 4.83.0)</b></p>
  <ul>
    <li>Fix to FC#302 caused problems with calling COM properties with parameters.
      This is now fixed.</li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.83.0 (as compared to 4.82.0)</b></p>
  <ul>
    <li>Added detection of multiple copies of plugins for the same data source
        (completed: 2006-07-26)<br>
      This (multiple copies of the plugins for same data source) was causing problems
      and lots of support issues because people were using old plugins even if
      they installed (newer) copy of the plugin. This was so becasue AB always
      used first one encountered in given directory and it usually was the oldest
      one. Now AB displays warning message that there are multiple copies of the
      same plugin and then they must be renamed or removed. <br>
      <br>
    </li>
    <li>Added HoldMinDays and EarlyExitDays options to SetOption() (completed:
        2006-07-27)<br>
      In addition to already exitsing functionality of HoldMinBars / EarlyExitBars,
      new options to specify min hold/penalty period in CALENDAR DAYS (as opposed
      to bars). <br>
        <br>
        <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>SetOption</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"HoldMinDays"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>30</FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
          set minimum holding period to 30 calendar days</FONT><FONT COLOR=#000000> <BR>
          </FONT><FONT COLOR=#0000ff>SetOption</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"EarlyExitDays"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#800080>90</FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
        set penalty period to 90 calendar days</FONT></CODE><br>
        <br>
      Note that you can use one or another (not both at the same time) for one
      parameter, so you can specify minimum holding period in either days or bars
      (but not both at the same time). The same with EarlyExit period. You may
      however use different specifications (i.e. days/bars) for EarlyExit and HoldMin
      (they are independent from each other).<br>
      <br>
      <br>
    </li>
    <li>Added <b>scoreExitAll</b> constant that causes rotational mode backtester
        to exit all positions regardless of HoldMinBars (completed: 2006-07-27)<br>
      Note that this is global flag and it is enough to set it for just any single
      symbol to exit all currently open positions, no matter on which symbol you
      use scoreExitAll (it may be even on symbol that is not currently held). By
      setting PositionScore to scoreExitAll you exit all positions immediatelly
      regardless of HoldMinBars setting.<br>
        <br>
      Example:<br>
      <br>
      <CODE><FONT COLOR=#000000><B>PositionScore</B> = ..your normal score.. <BR>
      </FONT><FONT COLOR=#008000>// if market timing signal goes negative close
      all posiitons</FONT><FONT COLOR=#000000> <BR>
        <B>PositionScore</B> = </FONT><FONT COLOR=#0000ff>IIf</FONT><FONT COLOR=#000000>(
        MarketTimingSignal &lt; </FONT><FONT COLOR=#800080>0</FONT><FONT COLOR=#000000>, <b>scoreExitAll</b>, <B>PositionScore</B> ); </FONT></CODE><br>
        <br>
      NOTE: This flag works ONLY in rotational trading mode (in regular mode it
      is easy to generate such global exit by ORing sell signal with global sell
      signal).<br>
      <br>
    </li>
    <li>CBT: Added <b>ExitReason</b> property to Trade object (completed: 2006-07-18)
        (FC#: 88)<br>
      <br>
    </li>
    <li>Chart Tree - RMB - Edit - now restores and focuses to already opened
        formula editor (if it is during editing) (completed: 2006-07-24) (FC#:
        300)<br>
      Note that you can still open NEW instance of the editor with the very same
      file (for comparison and to see the original contents) by holding down SHIFT
      key when choosing &quot;EDIT&quot; menu.<br>
        <br>
    </li>
    <li>Eliminated extra unnecessary refreshes of commentary window when new
        symbol was picked from ticker selector (completed: 2006-07-24) <br>
      <br>
    </li>
    <li>Fixed calling parameter-less JScript functions from AFL level via GetScriptObject()
        (completed: 2006-07-19) (FC #: 302) <br>
      <br>
    </li>
    <li> Fixed: wrong estimated time in progress dialog when number of steps
        is greater than 2^32 (4294967296) (allocated to: 4.80.2) (completed: 2006-07-24) <br>
      <br>
    </li>
    <li>AFL: Added Gradient background coloring (SetChartBkGradientFill function)
        (completed: 2006-07-26)<br>
      Gradient fill of chart interior is now available via SetChartBkGradientFill
      function.<br>
      Please note that this is independent from chart background color (background
      color fills entire pane, gradient fill is only for actual chart interior,
      so axes area is not affected by gradient fill)<br>
        <br>
        <b>SetChartBkGradientFill</b>( topcolor, bottomcolor, titlebkcolor =
          default )<br>
        <br>
      topcolor - specifies top color of the gradient fill <br>
      bottomcolor - specifies bottom color of the gradient fill<br>
      titlebkcolor - (optional) the background color of title text. If not specified
      then top color is automatically used for title background.<br>
        <br>
      Example:<br>
      <br>
      <CODE><FONT COLOR=#0000FF>SetChartBkGradientFill</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>ParamColor</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"BgTop"</FONT><FONT COLOR=#000000>, <B>colorWhite</B>),</FONT><FONT COLOR=#0000ff>ParamColor</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#800080>"BgBottom"</FONT><FONT COLOR=#000000>, <B>colorLightYellow</B>));</FONT></CODE><br>
      <br>
    </li>
    <li>Multiple tabs in RTQ window (completed: 2006-07-18) (FC#: 22)<br>
      RT quote window tabs behave the same as chart tabs: can be renamed with right
        mouse button and dragged from one place to another.<br>
      20 tabs are currently available.<br>
      <br>
    </li>
    <li> Non-numeric custom trade metrics are not formatted with thousands separators
        anymore (completed: 2006-07-21) (FC#: 314) <br>
      <br>
    </li>
    <li>now Tools-&gt;Preferences-&gt;Misc &quot;Decimal places in RT quote window&quot; allows
        to specify upto 6 decimal places. (completed: 2006-07-25)<br>
        <br>
    </li>
    <li>OLE: Fixed default property (Item) marker for Windows collection (completed:
        2006-07-18) <br>
          <br>
    </li>
    <li> Progress dialog: now estimated time is displayed in years/days if it
        is large enough (completed: 2006-07-24) <br>
        <br>
    </li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.82.0 (as compared to 4.81.1)</b></p>
  <ul>
    <li>OLE: Quotations collection does not have _Item hidden property so it
      should fix problems with Delphi </li>
    <li> OLE: fixed Documents collection Item method returning always first document
      object regardless of parameter value</li>
    <li>OLE: Documents collection prepared to support multiple document types </li>
    <li> OLE Added Windows collection, Document property and Activate and Close
        methods to Window object (FC #272)<br>
      <br>
      Windows collection has one method:<br>
      <br>
      Add - adds new window<br>
      <br>
      and two properties:<br>
      <br>
      Count - returns the number of windows within given document<br>
      <br>
      Item( i ) - returns the i-th window object<br>
      <br>
      <br>
      Window object has two new methods:<br>
      <br>
      Activate() - makes window active (focused)<br>
      Close() - closes given window<br>
      <br>
      and one new property:<br>
      <br>
      Document - gives parent document object<br>
      <br>
      EXAMPLE CODE (JScript):
      <pre><code><span class="jscript1-identifier">outBuffer</span><span class="jscript1-space"> </span><span class="jscript1-symbol">=</span><span class="jscript1-space"> &quot;&quot;</span><span class="jscript1-symbol">;</span><span class="jscript1-space"> </span><span class="jscript1-comment">// global output string buffer

</span><span class="jscript1-reservedword">function</span><span class="jscript1-space"> </span><span class="jscript1-identifier">output</span><span class="jscript1-symbol">(</span><span class="jscript1-space"> </span><span class="jscript1-identifier">string</span><span class="jscript1-space"> </span><span class="jscript1-symbol">)
{
</span><span class="jscript1-space">   </span><span class="jscript1-identifier">outBuffer</span><span class="jscript1-space"> </span><span class="jscript1-symbol">=</span><span class="jscript1-space"> </span><span class="jscript1-identifier">outBuffer</span><span class="jscript1-space"> </span><span class="jscript1-symbol">+</span><span class="jscript1-space"> </span><span class="jscript1-identifier">string</span><span class="jscript1-space"> </span><span class="jscript1-symbol">+</span><span class="jscript1-space"> &quot;\n&quot;</span><span class="jscript1-symbol">;
}

</span><span class="jscript1-identifier">AB</span><span class="jscript1-space"> </span><span class="jscript1-symbol">=</span><span class="jscript1-space"> </span><span class="jscript1-reservedword">new</span><span class="jscript1-space"> </span><span class="jscript1-identifier">ActiveXObject</span><span class="jscript1-symbol">(</span><span class="jscript1-space"> &quot;Broker.Application&quot;</span><span class="jscript1-symbol">);

</span><span class="jscript1-identifier">Docs</span><span class="jscript1-space"> </span><span class="jscript1-symbol">=</span><span class="jscript1-space"> </span><span class="jscript1-identifier">AB</span><span class="jscript1-symbol">.</span><span class="jscript1-identifier">Documents</span><span class="jscript1-symbol">;
</span><span class="jscript1-identifier">DocsQty</span><span class="jscript1-space"> </span><span class="jscript1-symbol">=</span><span class="jscript1-space"> </span><span class="jscript1-identifier">Docs</span><span class="jscript1-symbol">.</span><span class="jscript1-identifier">Count</span><span class="jscript1-symbol">;

</span><span class="jscript1-reservedword">for</span><span class="jscript1-symbol">(</span><span class="jscript1-space"> </span><span class="jscript1-identifier">i</span><span class="jscript1-space"> </span><span class="jscript1-symbol">=</span><span class="jscript1-space"> 0</span><span class="jscript1-symbol">;</span><span class="jscript1-space"> </span><span class="jscript1-identifier">i</span><span class="jscript1-space"> </span><span class="jscript1-symbol">&lt;</span><span class="jscript1-space"> </span><span class="jscript1-identifier">DocsQty</span><span class="jscript1-symbol">;</span><span class="jscript1-space"> </span><span class="jscript1-identifier">i</span><span class="jscript1-symbol">++</span><span class="jscript1-space"> </span><span class="jscript1-symbol">)
{
</span><span class="jscript1-space">   </span><span class="jscript1-identifier">Doc</span><span class="jscript1-space"> </span><span class="jscript1-symbol">=</span><span class="jscript1-space"> </span><span class="jscript1-identifier">Docs</span><span class="jscript1-symbol">(</span><span class="jscript1-space"> </span><span class="jscript1-identifier">i</span><span class="jscript1-space"> </span><span class="jscript1-symbol">);

</span><span class="jscript1-space">   </span><span class="jscript1-identifier">output</span><span class="jscript1-symbol">(</span><span class="jscript1-space"> &quot;Document &quot; </span><span class="jscript1-symbol">+</span><span class="jscript1-space"> </span><span class="jscript1-identifier">i</span><span class="jscript1-space"> </span><span class="jscript1-symbol">+</span><span class="jscript1-space"> &quot; name : &quot; </span><span class="jscript1-symbol">+</span><span class="jscript1-space"> </span><span class="jscript1-identifier">Doc</span><span class="jscript1-symbol">.</span><span class="jscript1-identifier">Name</span><span class="jscript1-space"> </span><span class="jscript1-symbol">);

</span><span class="jscript1-space">   </span><span class="jscript1-identifier">Windows</span><span class="jscript1-space"> </span><span class="jscript1-symbol">=</span><span class="jscript1-space"> </span><span class="jscript1-identifier">Doc</span><span class="jscript1-symbol">.</span><span class="jscript1-identifier">Windows</span><span class="jscript1-symbol">;
</span><span class="jscript1-space">   </span><span class="jscript1-identifier">WinsQty</span><span class="jscript1-space"> </span><span class="jscript1-symbol">=</span><span class="jscript1-space"> </span><span class="jscript1-identifier">Windows</span><span class="jscript1-symbol">.</span><span class="jscript1-identifier">Count</span><span class="jscript1-symbol">;

</span><span class="jscript1-space">   </span><span class="jscript1-reservedword">for</span><span class="jscript1-symbol">(</span><span class="jscript1-space"> </span><span class="jscript1-identifier">j</span><span class="jscript1-space"> </span><span class="jscript1-symbol">=</span><span class="jscript1-space"> 0</span><span class="jscript1-symbol">;</span><span class="jscript1-space"> </span><span class="jscript1-identifier">j</span><span class="jscript1-space"> </span><span class="jscript1-symbol">&lt;</span><span class="jscript1-space"> </span><span class="jscript1-identifier">WinsQty</span><span class="jscript1-symbol">;</span><span class="jscript1-space"> </span><span class="jscript1-identifier">j</span><span class="jscript1-symbol">++</span><span class="jscript1-space"> </span><span class="jscript1-symbol">)
</span><span class="jscript1-space">   </span><span class="jscript1-symbol">{
</span><span class="jscript1-space">	    </span><span class="jscript1-identifier">Win</span><span class="jscript1-space"> </span><span class="jscript1-symbol">=</span><span class="jscript1-space"> </span><span class="jscript1-identifier">Windows</span><span class="jscript1-symbol">(</span><span class="jscript1-space"> </span><span class="jscript1-identifier">j</span><span class="jscript1-space"> </span><span class="jscript1-symbol">);</span><span class="jscript1-space"> 

		</span><span class="jscript1-identifier">output</span><span class="jscript1-symbol">(</span><span class="jscript1-space"> &quot;  Window &quot; </span><span class="jscript1-symbol">+</span><span class="jscript1-space"> </span><span class="jscript1-identifier">j</span><span class="jscript1-space"> </span><span class="jscript1-symbol">+</span><span class="jscript1-space"> &quot; Selected tab &quot; </span><span class="jscript1-symbol">+</span><span class="jscript1-space"> </span><span class="jscript1-identifier">Win</span><span class="jscript1-symbol">.</span><span class="jscript1-identifier">SelectedTab</span><span class="jscript1-space"> </span><span class="jscript1-symbol">);
</span><span class="jscript1-space">   </span><span class="jscript1-symbol">}

}</span><span class="jscript1-space"> 

</span><span class="jscript1-identifier">WScript</span><span class="jscript1-symbol">.</span><span class="jscript1-identifier">echo</span><span class="jscript1-symbol">(</span><span class="jscript1-space"> </span><span class="jscript1-identifier">outBuffer</span><span class="jscript1-space"> </span><span class="jscript1-symbol">);

</span><span class="jscript1-identifier">WScript</span><span class="jscript1-symbol">.</span><span class="jscript1-identifier">echo</span><span class="jscript1-symbol">(</span><span class="jscript1-space"> &quot;Now will add one window&quot; </span><span class="jscript1-symbol">);
</span><span class="jscript1-identifier">Doc</span><span class="jscript1-space"> </span><span class="jscript1-symbol">=</span><span class="jscript1-space"> </span><span class="jscript1-identifier">Docs</span><span class="jscript1-symbol">(</span><span class="jscript1-space"> 0 </span><span class="jscript1-symbol">);
</span><span class="jscript1-identifier">Windows</span><span class="jscript1-space"> </span><span class="jscript1-symbol">=</span><span class="jscript1-space"> </span><span class="jscript1-identifier">Doc</span><span class="jscript1-symbol">.</span><span class="jscript1-identifier">Windows</span><span class="jscript1-symbol">;

</span><span class="jscript1-identifier">NewWindow</span><span class="jscript1-space"> </span><span class="jscript1-symbol">=</span><span class="jscript1-space"> </span><span class="jscript1-identifier">Windows</span><span class="jscript1-symbol">.</span><span class="jscript1-identifier">Add</span><span class="jscript1-symbol">();

</span><span class="jscript1-identifier">WScript</span><span class="jscript1-symbol">.</span><span class="jscript1-identifier">echo</span><span class="jscript1-symbol">(</span><span class="jscript1-space"> &quot;and close it&quot; </span><span class="jscript1-symbol">);

</span><span class="jscript1-identifier">NewWindow</span><span class="jscript1-symbol">.</span><span class="jscript1-identifier">Close</span><span class="jscript1-symbol">();
</span></code></pre>
    </li>
    <li> New menu Symbol-&gt;Favorities and new item &quot;Erase favourities&quot; to
        empty the list of favourities (FC#: 280)<br>
    <li> Horizonal line value label added (use new Study properties -&gt; Show
        Y Value checkbox available for horizonal lines) (FC# 271)<br>
    <li> Fixed crash when clicking on Watch List using RMB (problem occurred
        in 4.81 beta) (FC# 243)<br>
    <li> Fix: Status('lastvisiblebarindex&quot;) and Status(&quot;lastvisblebar&quot;)
        now return zero based index instead of one-based (FC# 265)<br>
    <li>Fix: removed spikes from styleCloud when plotted in non-continouous way
        (with nulls in the middle of the array) (FC# 283)<br>
    <li>Fix rounding problem in AA in futures mode when difference between entry
        and exit prices was very small and pointvalue large (added extra rounding
        to profit calculation) (FC# 135)<br>
    <li> Delete key now works in real time quote window (FC# 266)<br>
    <li> AddTextColumn produces now LEFT-justified output (FC# 291)<br>
  </ul>
  <p><b>CHANGES FOR VERSION 4.81.1 (as compared to 4.81.0)</b></p>
  <ul>
    <li>fixed problem with some of the watch lists not showing up in 4.81.0</li>
  </ul>
  
    
      <p><b>CHANGES FOR VERSION 4.81.0 (as compared to 4.80.2)<br>
      </b></p>
    <ul>
    <li>Database structure changed to hold new fundamental data - quarterly EAT/EBT/Sales
        figures, Code and Nominal value have been replaced by new fields.<br>
        <br>
      Despite these changes files are still backward and forward compatible - so
      it can be read by any other AB version, the only minor inconvenience is that
      if you load new file into old version (pre-4.81) of AmiBroker you will see
      weird numbers in old &quot;Finances&quot; dialog as well as in &quot;Shares
      out.&quot; and &quot;Book Value&quot; fields.<br>
        <br>
    </li>
    <li>Implemented new View-&gt;Information property page featuring extra fundamental
        data fields <br>
              <br>
    </li>
    <li>
      
         OLE: added new fundamental data fields to Stock object <br>
            <br>
          Stock object has now the following properties:<br>
          <br>
          string <b>Ticker</b>;<br>
          Collection <b>Quotations</b>;<br>
          string <b>FullName</b>;<br>
          boolean <b>Index</b>;<br>
          boolean <b>Favourite</b>;<br>
          boolean <b>Continuous</b>;<br>
          long <b>MarketID</b>;<br>
          long <b>GroupID</b>;<br>
          float <b>Beta</b>;<br>
          float <b>SharesOut</b>;<br>
          float <b>BookValuePerShare</b>;<br>
          float <b>SharesFloat</b>;<br>
          string <b>Address</b>;<br>
          string <b>WebID</b>;<br>
          string <b>Alias</b>;<br>
          boolean <b>IsDirty</b>;<br>
          long <b>IndustryID</b>;<br>
          long <b>WatchListBits</b>;<br>
          long <b>DataSource</b>;<br>
          long <b>DataLocalMode</b>;<br>
          float <b>PointValue</b>;<br>
          float <b>MarginDeposit</b>;<br>
          float <b>RoundLotSize</b>;<br>
          float <b>TickSize</b>;<br>
          long <b>WatchListBits2</b>;<br>
          string <b>Currency</b>;<br>
          string <b>LastSplitFactor</b>;<br>
          DATE <b>LastSplitDate</b>;<br>
          float <b>DividendPerShare</b>;<br>
          DATE <b>DividendPayDate</b>;<br>
          DATE <b>ExDividendDate</b>;<br>
          float <b>PEGRatio</b>;<br>
          float <b>ProfitMargin</b>;<br>
          float <b>OperatingMargin</b>;<br>
          float <b>OneYearTargetPrice</b>;<br>
          float <b>ReturnOnAssets</b>;<br>
          float <b>ReturnOnEquity</b>;<br>
          float <b>QtrlyRevenueGrowth</b>;<br>
          float <b>GrossProfitPerShare</b>;<br>
          float <b>SalesPerShare</b>;<br>
          float <b>EBITDAPerShare</b>;<br>
          float <b>QtrlyEarningsGrowth</b>;<br>
          float <b>InsiderHoldPercent</b>;<br>
          float <b>InstitutionHoldPercent</b>;<br>
          float <b>SharesShort</b>;<br>
          float <b>SharesShortPrevMonth</b>;<br>
          float <b>ForwardDividendPerShare</b>;<br>
          float <b>ForwardEPS</b>;<br>
          float <b>EPS</b>;<br>
          float <b>EPSEstCurrentYear</b>;<br>
          float <b>EPSEstNextYear</b>;<br>
          float <b>EPSEstNextQuarter</b>;<br>
          float <b>OperatingCashFlow</b>;<br>
          float <b>LeveredFreeCashFlow</b>;<br>
          <br>
      </li>
    <li>
      
         AFL: new function GetFnData() - allows accessing fundamental data <br>
                      <br>
          SYNTAX: <b>GetFnData</b>(&quot;field&quot;)<br>
          RETURNS: number<br>
          <br>
&quot;field&quot; can be one of the following:<br>
          <br>
&quot;EPS&quot;<br>
&quot;EPSEstCurrentYear&quot;<br>
&quot;EPSEstNextYear&quot;<br>
&quot;EPSEstNextQuarter&quot;<br>
&quot;PEGRatio&quot;<br>
&quot;SharesFloat&quot;<br>
&quot;SharesOut&quot;<br>
&quot;DividendPayDate&quot;<br>
&quot;ExDividendDate&quot;<br>
&quot;BookValuePerShare&quot;<br>
&quot;DividendPerShare&quot;<br>
&quot;ProfitMargin&quot;<br>
&quot;OperatingMargin&quot;<br>
&quot;OneYearTargetPrice&quot;<br>
&quot;ReturnOnAssets&quot;<br>
&quot;ReturnOnEquity&quot;<br>
&quot;QtrlyRevenueGrowth&quot;<br>
&quot;GrossProfitPerShare&quot;<br>
&quot;SalesPerShare&quot;<br>
&quot;EBITDAPerShare&quot;<br>
&quot;QtrlyEarningsGrowth&quot;<br>
&quot;InsiderHoldPercent&quot;<br>
&quot;InstitutionHoldPercent&quot;<br>
&quot;SharesShort&quot;<br>
&quot;SharesShortPrevMonth&quot;<br>
&quot;ForwardDividendPerShare&quot;<br>
&quot;ForwardEPS&quot;<br>
&quot;OperatingCashFlow&quot;<br>
&quot;LeveredFreeCashFlow&quot;<br>
&quot;Beta&quot;<br>
&quot;LastSplitRatio&quot;<br>
&quot;LastSplitDate&quot;<br>
          <br>
      </li>
    <li>
      
         ASCII importer: added support for new fundamental data fields :<br>
              <br>
          $FORMAT command now supports additional fields:<br>
              <br>
          DIV_PAY_DATE<br>
          EX_DIV_DATE<br>
          LAST_SPLIT_DATE<br>
          LAST_SPLIT_RATIO<br>
          EPS<br>
          EPS_EST_CUR_YEAR <br>
          EPS_EST_NEXT_YEAR <br>
          EPS_EST_NEXT_QTR <br>
          FORWARD_EPS <br>
          PEG_RATIO <br>
          BOOK_VALUE (requires SHARES_OUT to be specified as well)<br>
          BOOK_VALUE_PER_SHARE <br>
          EBITDA <br>
          PRICE_TO_SALES (requires CLOSE to be specified as well)<br>
          PRICE_TO_EARNINGS (requires CLOSE to be specified as well)<br>
          PRICE_TO_BV (requires CLOSE to be specified as well)<br>
          FORWARD_PE (requires CLOSE to be specified as well)<br>
          REVENUE <br>
          SHARES_SHORT <br>
          DIVIDEND <br>
          ONE_YEAR_TARGET <br>
          MARKET_CAP (requires CLOSE to be specified as well - it is used to calculate
          shares outstanding)<br>
          SHARES_FLOAT <br>
          SHARES_OUT <br>
          PROFIT_MARGIN <br>
          OPERATING_MARGIN <br>
          RETURN_ON_ASSETS <br>
          RETURN_ON_EQUITY <br>
          QTRLY_REVENUE_GROWTH <br>
          GROSS_PROFIT <br>
          QTRLY_EARNINGS_GROWTH <br>
          INSIDER_HOLD_PERCENT <br>
          INSTIT_HOLD_PERCENT <br>
          SHARES_SHORT_PREV <br>
          FORWARD_DIV <br>
          OPERATING_CASH_FLOW <br>
          FREE_CASH_FLOW <br>
          BETA <br>
          <br>
          <br>
          (see Formats\aqfe.format and Formats\aqfn.format files for example usage)<br>
          <br>
      </li>
    <li>
      
         Removed Stock-&gt;Information and Stock-&gt;Finances dialogs (this
            functionality is replaced by View-&gt;Information - new dockable property
            window) <br>
              <br>
      </li>
    <li>
      
         AFL: new function StrReplace( string, oldsubstring, newsubstring
            )<br>
              <br>
      </li>
    <li>
      
         Fixed crash occuring sometimes if &quot;Symbol-&gt;Watch List-&gt;Type-in&quot; symbol
            was longer than maximum allowable length (allocated to: 4.80.2) <br>
                      <br>
      </li>
    <li>
      
         Foreign() function changed. Now by default missing data bar OHL
            fields are filled using previous bar Close and volume is set to zero. <br>
          It is possible to turn old behaviour (filling missing bar OHL fields
          using previous bar OHL fields and copying previous bar volume) if you
          use<br>
          Fixup parameter set to 2.<br>
          Foreign(&quot;MSFT&quot;,&quot;O&quot;, 2 ); // old-style (pre-4.81)
          fill<br>
              <br>
      </li>
    <li>
      
         Scaling-in profit% calculations modified to use total cost instead
            of max. pos value <br>
                      <br>
      </li>
    <li>
      
        ships with AmiQuote 1.90 featuring automatic download and import
            of fundamental data from Yahoo Finance. See <a href="AmiQuote%5CReadMe2.html">AmiQuote\ReadMe2.html</a> for
            the details.<br>
      </li>
  </ul>
  
    
      <p><b>CHANGES FOR VERSION 4.80.2 (as compared to 4.80.1)</b></p>
    <ul>
    <li>
      Changed %profit calculation when scaling-in is used to use maximum
          number of shares ever held as a &#8220;base&#8221; of %profit calculation
          - this leads to &#8220;most conservative&#8221; % figures, compared to
          using just initial entry value. <br>
      </li>
    <li>
      Prec() function improved so it does not show rounding errors when
        working on integer </li>
  </ul>
  
    <ul>
    </ul>
    <p><b>CHANGES FOR VERSION 4.80.1 (as compared to 4.80.0)</b></p>
  <ul>
    <li>fixed problem with Easy Alert window not accepting new alerts in some
        circumstances <br>
    </li>
    <li>included new IB plugin version 1.6.2 (FC issue #54)</li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.80.1 (as compared to 4.80.0)</b></p>
<ul>
  <li>fixed problem with Easy Alert window not accepting new alerts in some circumstances    <br>    
  </li>
  <li>included new IB plugin version 1.6.2 (FC issue #54)</li>
</ul>

  <p><b>CHANGES FOR VERSION 4.80.0 (as compared to 4.79.0)</b></p>
<ul>
  <li>
    Added extra information to &quot;detailed log&quot; to show commissions
    charged during scaling and both average and current exit price<br>
    <br>
  </li>
  <li>
     Partial exit (scale-out) profits are included now in trade stats<br>
      <br>
  </li>
  <li>
     Fix EOD missing Friday if &quot;Filter weekedns&quot; is turned
      ON and Daily compression uses Night / Day session settings (#28659)<br>
      <br>
  </li>
  <li>
     AFL Editor: Added F1 handling of for/while/do-while/if-else<br>
      <br>
  </li>
  <li>
     &quot;SCAN&quot; now displays prices using 4 decimal places<br>
      <br>
  </li>
  <li>
     Fixed problem with progress bar locking active window instead of
      AA window when in run-every mode<br>
      <br>
  </li>
  <li>
     Fixed: Layouts messed up with multiple instances running (ext.ID:
      3)<br>
      <br>
  </li>
  <li>
     &quot;Margin requirement&quot; in the AA settings renamed to &quot;ACCOUNT
      margin&quot; to clearly show that it is NOT futures margin<br>
      <br>
  </li>
  <li>
      Eliminated resource leak in ExportImage OLE function<br>
      <br>
  </li>
  <li>
     Fixed potential thread interlock in Indicator Maintenance wizard
      (should prevent hangup especially on multi-CPU/core machines)<br>
      <br>
  </li>
  <li>
     Indicator tables are written to file (broker.newcharts) after each
                          chart insert, before and after Ind. Maintenance just to prevent data loss
      if AB is not closed properly<br>
      <br>
  </li>
  <li>
     Symbol-&gt;Watch List-&gt;Import refreshes entire symbol tree,
      not only watch list leaf<br>
      <br>
  </li>
  <li>added few new formulas into Formulas\Indicators folder<br>
    <br>
  </li>
</ul>

  <p><strong>CHANGES FOR VERSION 4.79.0 (as compared to 4.78.1)</strong></p>
  <ul>
    <li> Added HoldMinBars feature that disables exit during user-specified number
                              of bars even if signals/stops are generated during that period<br>
      Please note that IF during HoldMinBars period ANY stop is generated it is
                            ignored. Also this period is ignored when it comes to calculation of trailing
                            stops (new highest highs and drops below trailing stops generated during
                            HoldMinBars are ignored).This setting, similar to EarlyExitFee/EarlyExitBars
                            is available on per-symbol basis (i.e. it can be set to different value for
                            each symbol)<br>
      <br>
      <br>
      Example:<br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>SetOption</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"HoldMinBars"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>127</FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000>=</FONT><FONT COLOR=#0000ff>BarIndex</FONT><FONT COLOR=#000000>()==</FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>; <BR>
      </FONT><FONT COLOR=#000000><B>Sell</B></FONT><FONT COLOR=#000000>=</FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>; <BR>
      </FONT><FONT COLOR=#008000>// even if sell signals are generated each day, </FONT><FONT COLOR=#000000> <BR>
      </FONT><FONT COLOR=#008000>//they are ignored until bar 128</FONT></CODE><br>
      <br>
    </li>
    <li>additional checks added to ensure proper operation of individual equity
                              chart<br>
      AA window generates error if it can not write LastBacktestFormula to the
                            registry AA complains with error message when individual equity formula does
                            not contain #include @LastBacktestFormula statement that is required for
                            proper operation<br>
      (it includes the formula used in last backtest so Equity() function can process
                            it)<br>
        <br>
    </li>
    <li>AFL formula editor toolbar / menu is now customizable<br>
        <br>
      Asc() function for converting first character of the string to the ASCII
                            code<br>
        <br>
      Asc( string, pos = 0 )<br>
      <br>
      Returns the ANSI character code corresponding to the first letter in a string
                            (if position is not specified) or code of character at specified position.
                            If you don't specify position (pos argument) then first character is used.
                            Negative values of pos reference characters counting from the end of string.<br>
      <br>
      Useful for creation of exploration that displays single letters for signals
                            instead of numbers.<br>
      <br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#0000ff>Cross</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#0000ff>MACD</FONT><FONT COLOR=#000000>(),</FONT><FONT COLOR=#0000ff>Signal</FONT><FONT COLOR=#000000>()); <BR>
      </FONT><FONT COLOR=#000000><B>Sell</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#0000ff>Cross</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#0000ff>Signal</FONT><FONT COLOR=#000000>(),</FONT><FONT COLOR=#0000ff>MACD</FONT><FONT COLOR=#000000>()); <BR>
      <BR>
      </FONT><FONT COLOR=#000000><B>Filter</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#000000><B>OR</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#000000><B>Sell</B></FONT><FONT COLOR=#000000>; <BR>
      <BR>
      </FONT><FONT COLOR=#0000ff>AddColumn</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>IIf</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000>,
      Asc(</FONT><FONT COLOR=#ff00ff>"B"</FONT><FONT COLOR=#000000>), Asc(</FONT><FONT COLOR=#ff00ff>"S"</FONT><FONT COLOR=#000000>)), </FONT><FONT COLOR=#ff00ff>"Signal"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>formatChar</B></FONT><FONT COLOR=#000000> );</FONT></CODE><br>
      <br>
    </li>
    <li>Changed EarlyExitFee functionality so it does NOT affect equity (and
                              stats like drawdowns) if position is not liquidated during early bars<br>
        <br>
    </li>
    <li> Chart sheet tabs improvements: added drag-drop moving, quick selection
                              menu, home/end buttons<br>
      <br>
    </li>
    <li>Fix: double click on Y axis does not turn &lt;&gt; range markers anymore
                              (allocated to: 4.79.0)<br>
      <br>
    </li>
    <li>Fix: Param slider, when step =2 and start is odd (for example 3 ) then
                              subsequent values were even (they should be odd 3, 5, 7,...) now it is
                              fixed<br>
        <br>
    </li>
    <li> Fixed handling of mixed color encodings in AddColumn (pre-defined color
                              constants did not work together with ColorRGB / ColorHSB, now it is fixed)<br>
      <br>
      Example of code that did not work correctly in 4.78.1 and earlier but now
                            works fine.<br>
      <br>
      <CODE><FONT COLOR=#000000> <BR>
      </FONT><FONT COLOR=#000000><B>Filter</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>; <BR>
      <BR>
      </FONT><FONT COLOR=#0000ff>AddColumn</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>Close</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>"Close"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>1.2</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorDefault</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>ColorRGB</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>255</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>)
                              );&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>//&nbsp;&nbsp;&nbsp;this
                              works</FONT><FONT COLOR=#000000> <BR>
                              </FONT><FONT COLOR=#0000ff>AddColumn</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>Close</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>"Close"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>1.2</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>ColorRGB</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>255</FONT><FONT COLOR=#000000>), </FONT><FONT COLOR=#0000ff>ColorRGB</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>255</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>));&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>//&nbsp;&nbsp;&nbsp;this
                              works</FONT><FONT COLOR=#000000> <BR>
                              </FONT><FONT COLOR=#0000ff>AddColumn</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>Close</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>"Close"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>1.2</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorBlue</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>ColorRGB</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>255</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>)); </FONT><FONT COLOR=#008000>//
                              this works in 4.79, but didn't in previous versions</FONT><FONT COLOR=#000000> <BR>
                              <BR>
                              </FONT><FONT COLOR=#0000ff>AddTextColumn</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>" "</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>" "</FONT><FONT COLOR=#000000>); <BR>
                              <BR>
                              </FONT><FONT COLOR=#0000ff>AddColumn</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>Close</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>"Close"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>1.2</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>ColorRGB</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>255</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>), </FONT><FONT COLOR=#000000><B>colorDefault</B></FONT><FONT COLOR=#000000>); </FONT><FONT COLOR=#008000>//&nbsp;&nbsp;&nbsp;this
                              works</FONT><FONT COLOR=#000000> <BR>
                              </FONT><FONT COLOR=#0000ff>AddColumn</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>Close</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>"Close"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>1.2</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>ColorRGB</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>255</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>), </FONT><FONT COLOR=#0000ff>ColorRGB</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>255</FONT><FONT COLOR=#000000>)
                              );&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>//&nbsp;&nbsp;&nbsp;this
                              works</FONT><FONT COLOR=#000000> <BR>
                              </FONT><FONT COLOR=#0000ff>AddColumn</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>Close</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>"Close"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>1.2</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>ColorRGB</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>255</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>), </FONT><FONT COLOR=#000000><B>colorBlue</B></FONT><FONT COLOR=#000000>); </FONT><FONT COLOR=#008000>//
      this works in 4.79, but didn't in previous versions</FONT></CODE><br>
      <br>
    </li>
    <li>Fractional increments on Y axis: added 1/320 increment (to use for example
                              with ZT contract) and changed display method so integer part is separated
                              from fractional part by ^ character<br>
        <br>
    </li>
    <li> Implemented easy real-time alerts (allocated to: 4.79.0)<br>
&quot;easy alerts&quot; are available from RTquote window context menu.<br>
      (Click on Real Time Quote window with RIGHT mouse button and select &quot;Easy
                            Alerts&quot; option<br>
      - then define alerts you want to generate using real time streaming quotes).<br>
      If you add any alerts, please note that symbols used in alerts add up to
                            total number of streaming symbols, so if you have 50 symbol limit on your
                            data source and have 40 symbols in your real time quote window you will be
                            able to setup alerts for only 10 extra symbols (if you use the same symbols
                            as in real time quote window then it does not add up to the total count)<br>
      <br>
    </li>
    <li>OLE: added ability to control sorting in AA window from OLE level<br>
      Object: <br>
      Analysis<br>
      <br>
      New method:<br>
      SortByColumn( iColumn, bAscending, bMultiMode )<br>
        <br>
        <br>
      where iColumn - is zero-based column index to sort bybAscending - true/false
                            decides the order we wantbMulti - if set to false - it means that we want
                            to sort by single column or we define starting column for multi-column sortif
                            set to true - it means that we are defining additional columns for multiple-column
                            sort.So to sort by many columns you need to call SortByColumn once with bMulti
                            set to false and then call SortByColumn for all remaining sort columns with
                            bMulti set to true.<br>
        <br>
      Example (multiple column sort by column 1 and 2):<br>
      <CODE><FONT COLOR=#000000> <BR>
      AB = new ActiveXObject(</FONT><FONT COLOR=#ff00ff>"Broker.Application"</FONT><FONT COLOR=#000000>);AA
                            = AB.Analysis; <BR>
        <BR>
      </FONT><FONT COLOR=#008000>// sort by date/time column</FONT><FONT COLOR=#000000> <BR>
      AA.SortByColumn( </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>False</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>False</B></FONT><FONT COLOR=#000000> ); <BR>
      <BR>
      </FONT><FONT COLOR=#008000>// add secondary sort column (see last argument
                            = True)</FONT><FONT COLOR=#000000> <BR>
      AA.SortByColumn( </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>False</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>True</B></FONT><FONT COLOR=#000000> ); </FONT></CODE><br>
      <br>
    </li>
    <li> OLE: added Application.Visible property<br>
        <br>
        <CODE><FONT COLOR=#000000>AB = new ActiveXObject(</FONT><FONT COLOR=#ff00ff>"Broker.Application"</FONT><FONT COLOR=#000000>); <BR>
        AB.Visible = </FONT><FONT COLOR=#000000><B>True</B></FONT><FONT COLOR=#000000>; <BR>
        WScript.Sleep(</FONT><FONT COLOR=#ff00ff>1000</FONT><FONT COLOR=#000000>); <BR>
        AB.Visible = </FONT><FONT COLOR=#000000><B>False</B></FONT><FONT COLOR=#000000>; <BR>
        WScript.Sleep(</FONT><FONT COLOR=#ff00ff>1000</FONT><FONT COLOR=#000000>); <BR>
        AB.Visible = </FONT><FONT COLOR=#000000><B>True</B></FONT><FONT COLOR=#000000>; <BR>
        WScript.Sleep(</FONT><FONT COLOR=#ff00ff>1000</FONT><FONT COLOR=#000000>); <BR>
      AB.Quit();</FONT></CODE><br>
      <br>
    </li>
    <li> OLE: when AmiBroker is created from OLE, it loads default layout now
                              (previous versions did not<br>
        <br>
    </li>
    <li> Scaling in/out fixes: added extra checks not to exceed available cash
                              (scaling-in) and not to drop below zero shares (scaling out)<br>
        <br>
    </li>
    <li> Time&amp;sales now allows the user to disable display of bid/ask and/or
                              trades<br>
      By default both trades and bidl/ask quotes are shown, but now you can decide
                            to turn off either one or both by clicking with RIGHT mouse button over Time&amp;Sales
                            window and checking/unchecking &quot;Show Trades&quot; and &quot;Show Bid
                            / Ask Quotes&quot;<br>
      menu items.<br>
      <br>
    </li>
    <li>Tools: Preferences: Misc, renamed &quot;Save on exit&quot; to &quot;Auto-save&quot; and
                              changed auto-save logic, so layouts are saved on each change<br>
        <br>
      When Auto-save: Layouts is turned ON, currently loaded layout is saved on
                            change (i.e. when another layout is loaded, previously selected layout changes
                            are saved first), the same with database load - if you load different database
                            then recently used layout is stored automatically. IMPORTANT: changes are
                            saved now to most recently loaded layout (not to 'default' one as it was
                            before). So default layout is NOT affected by auto-save if you manually loaded
                            different layout.<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.78.1 (as compared to 4.78.0)</strong></p>
  <ul>
    <li> atcFlagEnableInPortfolio now works fine with atcFlagCompositeGroup flag. <br>
      Previously using atcFlagCompositeGroup (or atcFlagDefaults) prevented creation
                              of composite in custom backtest procedure (even if atcFlagEnableInPortfolio
                              was specified). atcFlagEnableInPorfolio worked only without it. Now it
                              is fixed (works fine with or without atcFlagCompositeGroup)<br>
      <br>
    </li>
    <li>AFLEditor: Edit-&gt;Replace fixed<br>
      <br>
    </li>
    <li>HTMLExport: fixed crash occuring sometimes when lots of columns were
                              used<br>
      <br>
    </li>
    <li>HTMLExport: fix: colorDefault is not BLACK for background (bgcolor in &lt;TD&gt; tag
                              is skipped) [(this also reduces file size)<br>
        <br>
    </li>
    <li>HTMLExport: header row is in separate line (CR at the end)<br>
      <br>
    </li>
    <li>backward compatiblity fix for ExportImage() function (when width and
                              height are not provided then default - current window size - is used)<br>
      (NOTE: this also fixes Edit-&gt;Image-&gt;Export )<br>
      <br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.78.0 (as compared to 4.77.0)</strong></p>
  <ul>
    <li>AA: HTML export added that supports FULL COLOR output<br>
      To export to HTML just click &quot;EXPORT&quot; button in AA window and select &quot;HTML
                            files&quot; from &quot;Files of type&quot; combo box in file dialog. <br>
        <br>
      You can also use OLE interface Export method - if EXTENSION provided in the
                            file name is .html then AmiBroker will output HTML file, <br>
      otherwise it will output CSV (text) file. If you want colorful output in
                            Excel, just EXPORT the file to HTML and load it into Excel (or drag-drop
                            to excel). <br>
      <br>
      Please note that Excel color palette is limited (not all 16 million colors
                            available in AmiBroker can be represented in Excel) Example colorful test
                            exploration:<br>
      <br>
      <CODE><FONT COLOR=#000000><B>Filter</B></FONT><FONT COLOR=#000000>=</FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>; <BR>
      </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>( i = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>;
                              i &lt; </FONT><FONT COLOR=#ff00ff>256</FONT><FONT COLOR=#000000>; i = i
                              + </FONT><FONT COLOR=#ff00ff>16</FONT><FONT COLOR=#000000> ) <BR>
                            </FONT><FONT COLOR=#0000ff>AddColumn</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>"C"</FONT><FONT COLOR=#000000>+i, </FONT><FONT COLOR=#ff00ff>1.2</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorDefault</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>ColorHSB</FONT><FONT COLOR=#000000>(
                            ( </FONT><FONT COLOR=#0000ff>BarIndex</FONT><FONT COLOR=#000000>() + i )
                            % </FONT><FONT COLOR=#ff00ff>256</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>255</FONT><FONT COLOR=#000000>-i, </FONT><FONT COLOR=#ff00ff>255</FONT><FONT COLOR=#000000> )
                            ); <br>
                            <br>
    </FONT></CODE></li>
    <li>List control code reviewed for better 64bit compatibility<br>
        <br>
    </li>
    <li> List selection is maintained after sorting<br>
      <br>
    </li>
    <li>Multiple column sort implemented in AA result list (and other list controls
                              as well)<br>
          <br>
      To sort by more than one column: <br>
      a) click the FIRST column then <br>
      b) SHIFT-click second, third, fourth column ... and so on (upto 40 columns
                            can be sorted at once) <br>
      (to SHIFT-click means to click with left mouse button while having SHIFT
                            key pressed down) <br>
      c) to change the Asc/Desc order click on the same column again <br>
      <br>
      To restart sorting, release SHIFT key and click on column (it will become
                            first). <br>
        <br>
      Subsequent columns (in the order you have clicked on them) are marked with
                            1, 2, 3, 4, 5, 6, 7, 8, 9 numbers <br>
      (if you select more than 10 columns, then all columns above 10th will be
                            marked with '...') <br>
      <br>
    </li>
    <li> Backtester: added EarlyExitBars/EarlyExitFee functionality (not supported
                              by old (v.4.4) backtester)<br>
        <br>
      Early exit (redemption) fee is charged when trade is exited during first
                            N bars since entry. <br>
      The fee is added to exit commission and you will see it in the commissions
                            reported for example in detailed log. It is also reflected in the portfolio
                            equity (so for first N bars since entry portfolio equity is lower by early
                            exit fee).<br>
        <br>
        <br>
        <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#008000>// these two new
                                options can be set on per-symbol basis</FONT><FONT COLOR=#000000> <BR>
                                </FONT><FONT COLOR=#008000>// how many bars (trading days) </FONT><FONT COLOR=#000000> <BR>
                                </FONT><FONT COLOR=#008000>// an early exit (redemption) fee is applied </FONT><FONT COLOR=#000000> <BR>
                                </FONT><FONT COLOR=#0000ff>SetOption</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"EarlyExitBars"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>128</FONT><FONT COLOR=#000000> ); <BR>
                                </FONT><FONT COLOR=#008000>// early redemption fee (in percent)</FONT><FONT COLOR=#000000> <BR>
        </FONT><FONT COLOR=#0000ff>SetOption</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"EarlyExitFee"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000> );</FONT></CODE><br>
        <br>
      (note 180 calendar days is 128 or 129 trading days)<br>
      <br>
      <CODE><FONT COLOR=#008000>// how to set it up on per-symbol basis?</FONT><FONT COLOR=#000000> <BR>
          </FONT><FONT COLOR=#008000>// it is simple - use 'if' statement</FONT><FONT COLOR=#000000> <BR>
          </FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>Name</FONT><FONT COLOR=#000000>()
                                  == </FONT><FONT COLOR=#ff00ff>"SYMBOL1"</FONT><FONT COLOR=#000000> ) <BR>
                            { <BR>
                            </FONT><FONT COLOR=#0000ff>SetOption</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"EarlyExitBars"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>128</FONT><FONT COLOR=#000000> ); <BR>
                            </FONT><FONT COLOR=#0000ff>SetOption</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"EarlyExitFee"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000> ); <BR>
                            } <BR>
                            <BR>
                            </FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>Name</FONT><FONT COLOR=#000000>()
                            == </FONT><FONT COLOR=#ff00ff>"SYMBOL2"</FONT><FONT COLOR=#000000> ) <BR>
                            { <BR>
                            </FONT><FONT COLOR=#0000ff>SetOption</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"EarlyExitBars"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>25</FONT><FONT COLOR=#000000> ); <BR>
                            </FONT><FONT COLOR=#0000ff>SetOption</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"EarlyExitFee"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> ); <BR>
                            }<br>
                            <br>
    </FONT></CODE></li>
    <li> AA: &quot;Scan every&quot; feature has been renamed to &quot;Run every&quot; and
                              allows automatic repeat of scan or exploration (new feaeture) it allows
                              also shorter intervals<br>
        <br>
      Run every intervals can now be defined in MINUTES (default) or SECONDS.<br>
      To enter run-every interval in seconds simply add &quot;s&quot; or &quot;sec&quot; at
                            the end of interval value, for example:<br>
        <br>
      10 sec - for run every 10 seconds<br>
      5 s - for run every 5 seconds<br>
      13 min - for run every 13 minutes<br>
      35 m - for run every 35 minutes<br>
      7 - for run every 7 minutes (if time unit is not specified then by default
                            minutes are used)<br>
      <br>
    </li>
    <li>OLE: ExportImage() now supports Width and Height parameters<br>
        <br>
      ExportImage function that now allows to specify width and height.<br>
      So to export say 640x480 gif image you need to write:<br>
        <br>
      AB = new ActiveXObject(&quot;Broker.Application&quot;);<br>
      Win = AB.ActiveWindow;<br>
      Win.ExportImage( &quot;test.gif&quot;, 640, 480 );<br>
      <br>
      and you will get perfect image with no jagginess or any scaling artifacts.<br>
      And it works independently of your current window size and it does NOT affect<br>
      your current window size.<br>
      <br>
    </li>
    <li>fix: customColor1 can be selected again using color picker <br>
        <br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.77.0 (as compared to 4.76.0)</strong></p>
  <ul>
    <li>styleDashed now uses correct background color when it is modified using
                              SetChartBkColor<br>
        <br>
    </li>
    <li>AFL Editor: when there is nothing more to undo/redo beep sound is produced<br>
        <br>
    </li>
    <li>AFL: OBV() and AccDist() now work correctly with TimeFrameSet (#26768)<br>
          <br>
    </li>
    <li>AFL Editor: Edit-&gt;Replace implemented (Ctrl+H shortcut)<br>
        <br>
    </li>
    <li>CBT: AddCustomMetric now has new parameter that controls number of decimal
                              places used to display custom metric<br>
        <br>
      Trade.AddCustomMetric( &quot;Name&quot;, value, [optional] decplaces = 2
                            );<br>
        <br>
      Backtester.AddCustomMetric( &quot;Name&quot;, Value, [optional] LongOnlyValue
                            = Null, [optional] ShortOnlyValue = Null, [optional] decplaces = 2 );<br>
      <br>
      where<br>
      decplaces defines how many decimal places are used to display given metric
                            in the report.If not specified it defaults to 2 decimal places.<br>
      <br>
      Example code:<br>
      <br>
      <CODE><FONT COLOR=#000000>bo.AddCustomMetric( </FONT><FONT COLOR=#ff00ff>"Somestat"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>100</FONT><FONT COLOR=#000000>*kr, </FONT><FONT COLOR=#000000><B>Null</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>Null</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>4</FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
                            5th parameter controls number of decimal places <br>
      <br>
    </FONT></CODE></li>
    <li>Tooltip &quot;value&quot; field now uses Prefs setting (Tools-&gt;Preferences-&gt;Misc: &quot;Decimal
                              places in chart titles/tools&quot;) + 1 digit decimal points<br>
      <br>
    </li>
    <li>All Fibonbacci tools now use user-defined number of decimal places (Tools-&gt;Preferences-&gt;Misc: &quot;Decimal
                              places in chart titles/tools&quot;).<br>
        <br>
      Note that this setting applies to NEWLY drawn or MODIFIED fibonacci retracements.
                            Already existing ones won't be affected until you modify/move them.<br>
      <br>
    </li>
    <li>Added new submenu under &quot;Symbol&quot;: &quot;Real Time Quote&quot; with
                              3 new options: Add selected symbol / Add watch list / Remove all symbols<br>
      IMPORTANT NOTE: to see new menu you need to go to Tools-&gt;Customize, select &quot;MENU&quot; bar
                            and press &quot;RESET&quot; button<br>
      <br>
    </li>
    <li>AFL: PlotText(&quot;Text&quot;, x, y, color, bkcolor = colorDefault )<br>
        <br>
      New AFL function:<br>
      <br>
      PlotText( &quot;text&quot;, x, y, color, bkcolor = colorDefault )<br>
        <br>
      Writes text in specified co-ordinates<br>
      <br>
      where <br>
      x - is x-coordinate in bars (like in LineArray)<br>
      y - is y-coordinate in dollars<br>
      <br>
      color is text color<br>
      bkcolor is background color <br>
      <br>
      If bkcolor is NOT specified (or equal to colorDefault) text is written with
                            TRANSPARENT background<br>
      any other value causes solid background with specified background color<br>
      <br>
      Example:<br>
      <br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#ff00ff>"Price"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorBlack</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>styleLine</B></FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#0000ff>MA</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#ff00ff>20</FONT><FONT COLOR=#000000>),</FONT><FONT COLOR=#ff00ff>"MA20"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000> ); <BR>
      <BR>
      </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000>=</FONT><FONT COLOR=#0000ff>Cross</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>MA</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#ff00ff>20</FONT><FONT COLOR=#000000> )
                            ); <BR>
      </FONT><FONT COLOR=#000000><B>Sell</B></FONT><FONT COLOR=#000000>= </FONT><FONT COLOR=#0000ff>Cross</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>MA</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>20</FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000> ); <BR>
      <BR>
      dist = </FONT><FONT COLOR=#ff00ff>1.5</FONT><FONT COLOR=#000000>*</FONT><FONT COLOR=#0000ff>ATR</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>10</FONT><FONT COLOR=#000000>); <BR>
      <BR>
      </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>( i = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>;
                            i &lt; </FONT><FONT COLOR=#000000><B>BarCount</B></FONT><FONT COLOR=#000000>;
                            i++ ) <BR>
                            { <BR>
                            </FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000>[i]
                              ) </FONT><FONT COLOR=#0000ff>PlotText</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#ff00ff>"Buy\n@"</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>[
                              i ], i, </FONT><FONT COLOR=#000000><B>L</B></FONT><FONT COLOR=#000000>[
                              i ]-dist[i], </FONT><FONT COLOR=#000000><B>colorGreen</B></FONT><FONT COLOR=#000000> ); <BR>
                              </FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>Sell</B></FONT><FONT COLOR=#000000>[i]
                              ) </FONT><FONT COLOR=#0000ff>PlotText</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#ff00ff>"Sell\n@"</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>[
                              i ], i, </FONT><FONT COLOR=#000000><B>H</B></FONT><FONT COLOR=#000000>[
                              i ]+dist[i], </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorYellow</B></FONT><FONT COLOR=#000000> ); <BR>
                            } <BR>
                            <BR>
                              </FONT><FONT COLOR=#0000ff>PlotShapes</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000> * </FONT><FONT COLOR=#000000><B>shapeUpArrow</B></FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#000000><B>Sell</B></FONT><FONT COLOR=#000000> * </FONT><FONT COLOR=#000000><B>shapeDownArrow</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>IIf</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorGreen</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000> )
      );</FONT></CODE><br>
      <br>
    </li>
    <li> AFL: VarGetText<br>
      New function<br>
      <br>
      VarGetText( &quot;varname&quot; )<br>
      <br>
      the same as VarGet but always returns always string values <br>
      (if underlying variable has different type it is converted to string)<br>
      <br>
      Allows for example appending to text variable no matter if it is defined
                            earlier or not:<br>
      <br>
      Title = VarGetText(&quot;Title&quot;) + &quot;something&quot;; // this will
                            work correctly regardless of whenever title was defined earlier or not]<br>
      <br>
    </li>
    <li>VarSetText<br>
      New function<br>
      <br>
      VarSetText( &quot;varname&quot;, &quot;value&quot; )<br>
      <br>
      the same as VarSet but operates on string values.<br>
        <br>
    </li>
    <li>Auto-analysis backtest result summary modified (added row count and removed
                              wordwrap)<br>
          <br>
    </li>
    <li> Enlarged &quot;Additional commands&quot; field in ASCII Import Wizard<br>
      <br>
    </li>
    <li>CBT: Fixed &quot;Out of range&quot; message generated by OLE wrappers
                              when GetValue method of CBT Metrics object returned infinite value (for
                              example as result of division by zero)<br>
      <br>
    </li>
    <li>Fixed handling of CLICK - DRAW - CLICK drawing mode (#26994) during RT
                              refresh<br>
        <br>
    </li>
    <li> Fixed incorrect candle color occuring sometimes when candle body was
                              only 1-pixel high<br>
        <br>
    </li>
    <li>Fixed potential crash occuring sometimes when RTQ window was never shown
                              but RT update arrived<br>
        <br>
    </li>
    <li> Fixed problem with double arrows appearing on chart with ID == 1<br>
        <br>
    </li>
    <li>Fixed problem with selected date in Print/PrintPreview/Image copy<br>
      <br>
    </li>
    <li>RTQ context menu &quot;Delete symbol&quot; renamed to &quot;Remove symbol&quot;<br>
      <br>
    </li>
    <li>UI: simplification, Removed (default) from File-&gt;Database Settings
                              Base Time interval Combo and &quot;(default)&quot; from local data storage
                              and removed &quot;IMPORTANT ...&quot; static<br>
        <br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.76.0 (as compared to 4.75.2)</strong></p>
  <ul>
    <li> Renamed &quot;Number of bars to load&quot; to just &quot;Number of bars&quot; <br>
        <br>
    </li>
    <li>Fixed problem with weird Time&amp;sales background colors (bug introduced
                              in 4.75.x)<br>
        <br>
    </li>
    <li> Fixed 1.#INF in P/E colum (RT quote window)<br>
        <br>
    </li>
    <li> Editor: fixed actionBacktest / actionExplore mix in auto-complete dropdown<br>
        <br>
    </li>
    <li> Chart Y-axis can now be displayed as fractions (1/4, 1/8, 1/16, 1/32,
                              1/64, 1/128) - to switch this use Parameters -&gt; GRID -&gt; FORMAT<br>
      <br>
    </li>
    <li> CBT: Trade object has now &quot;Handle&quot; property that can be passed
                              to ExitTrade and ScaleTrade methods instead of symbol to allow control
                              over exiting/scaling multiple positions of the same symbol<br>
      <br>
      <CODE><FONT COLOR=#000000> <BR>
      </FONT><FONT COLOR=#008000>// This is sample formula that allows </FONT><FONT COLOR=#000000> <BR>
      </FONT><FONT COLOR=#008000>// to open multiple, separate positions on the
                              same symbol </FONT><FONT COLOR=#000000> <BR>
                              </FONT><FONT COLOR=#008000>// without averaging effect (i.e. each position
                              on the same </FONT><FONT COLOR=#000000> <BR>
                              </FONT><FONT COLOR=#008000>// symbol is completely independent). </FONT><FONT COLOR=#000000> <BR>
                              </FONT><FONT COLOR=#008000>// </FONT><FONT COLOR=#000000> <BR>
                              </FONT><FONT COLOR=#008000>// Sample code is provided for trading one symbol </FONT><FONT COLOR=#000000> <BR>
                              </FONT><FONT COLOR=#008000>// Enter symbol you want to trade below </FONT><FONT COLOR=#000000> <BR>
                            Symbol = </FONT><FONT COLOR=#ff00ff>"MSFT"</FONT><FONT COLOR=#000000>; <BR>
                            <BR>
                            </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000>=</FONT><FONT COLOR=#000000><B>Sell</B></FONT><FONT COLOR=#000000>=</FONT><FONT COLOR=#000000><B>Short</B></FONT><FONT COLOR=#000000>=</FONT><FONT COLOR=#000000><B>Cover</B></FONT><FONT COLOR=#000000>=</FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>; </FONT><FONT COLOR=#008000>//
                            real rules are defined inside custom backtest proc </FONT><FONT COLOR=#000000> <BR>
                            <BR>
                            </FONT><FONT COLOR=#0000ff>SetCustomBacktestProc</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>""</FONT><FONT COLOR=#000000>); </FONT><FONT COLOR=#008000>//
                              enable custom backtest </FONT><FONT COLOR=#000000> <BR>
                              <BR>
                              </FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>Status</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"action"</FONT><FONT COLOR=#000000>)
                              == </FONT><FONT COLOR=#000000><B>actionPortfolio</B></FONT><FONT COLOR=#000000> ) <BR>
                            { <BR>
&nbsp;&nbsp; </FONT><FONT COLOR=#008000>// actual backtest routine </FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp; </FONT><FONT COLOR=#008000>// (low-level) </FONT><FONT COLOR=#000000> <BR>
      <BR>
&nbsp;&nbsp; bo = </FONT><FONT COLOR=#0000ff>GetBacktesterObject</FONT><FONT COLOR=#000000>(); <BR>
      <BR>
&nbsp;&nbsp; </FONT><FONT COLOR=#0000ff>SetForeign</FONT><FONT COLOR=#000000>(
                        Symbol ); <BR>
&nbsp;&nbsp; </FONT><FONT COLOR=#008000>// make sure to calculate actual buy
                        and buyprice arrays for symbol we need to backtest </FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp; </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>; </FONT><FONT COLOR=#008000>//
                        For testing purposes just enter new position every bar</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp; </FONT><FONT COLOR=#000000><B>BuyPrice</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#000000><B>Open</B></FONT><FONT COLOR=#000000>; <BR>
&nbsp;&nbsp; </FONT><FONT COLOR=#0000ff>RestorePriceArrays</FONT><FONT COLOR=#000000>(); <BR>
      <BR>
&nbsp;&nbsp; </FONT><FONT COLOR=#008000>// actual backtest loop </FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp; bo.PreProcess(); <BR>
      <BR>
&nbsp;&nbsp; </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>(
                        i = </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>; i &lt; </FONT><FONT COLOR=#000000><B>BarCount</B></FONT><FONT COLOR=#000000>;
                        i++ ) <BR>
&nbsp;&nbsp; { <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>// first update
                        backtest stats and handle stops </FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bo.UpdateStats( i, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000> ); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bo.HandleStops( i ); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bo.RawTextOutput(</FONT><FONT COLOR=#ff00ff>"Bar "</FONT><FONT COLOR=#000000> +
                        i ); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000>[
                        i - </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> ] ) </FONT><FONT COLOR=#008000>//
                        if buy signal in previous bar </FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bo.EnterTrade( i, Symbol, </FONT><FONT COLOR=#000000><B>True</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>BuyPrice</B></FONT><FONT COLOR=#000000>[
                        i ], </FONT><FONT COLOR=#ff00ff>500</FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#008000>/*
                        $5000 into one trade */</FONT><FONT COLOR=#000000>); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <BR>
                        <BR>
&nbsp;&nbsp;&nbsp; <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>(
                        OpenPos = bo.GetFirstOpenPos(); OpenPos; OpenPos = bo.GetNextOpenPos() ) <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>//
                        exit positions if their age is &gt; 5 bars and they are profitable </FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>(
                        OpenPos.BarsInTrade &gt; </FONT><FONT COLOR=#ff00ff>5</FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#000000><B>AND</B></FONT><FONT COLOR=#000000> OpenPos.GetProfit() &gt; </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000> ) <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>//
                        HERE IS A NEW PART !!!</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>//
                        WE ARE PASSING HANDLE instead of ticker symbol</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>//
                        THIS ENSURES PROPER OPERATION even if we have multiple positions of the same </FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>//
                        stock</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bo.ExitTrade(
                        i, OpenPos.Handle, OpenPos.GetPrice( i, </FONT><FONT COLOR=#ff00ff>"O"</FONT><FONT COLOR=#000000> )
                        ); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <BR>
                        <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bo.RawTextOutput(</FONT><FONT COLOR=#ff00ff>"Number
                        of open positions: "</FONT><FONT COLOR=#000000> + bo.GetOpenPosQty() ); <BR>
                        <BR>
                        <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bo.UpdateStats( i, </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000> ); <BR>
&nbsp;&nbsp; } <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR>
&nbsp;&nbsp; bo.PostProcess(); <BR>
      } <br>
    </FONT></CODE></li>
    <li> CBT: Small fix for low-level CBT backtest - internal current bar counter
                              is set now via UpdateStats<br>
      <br>
    </li>
    <li>ASCII import wizard: Additional commands field accepts &quot;ENTER&quot; key
                              alone (previously one needed CTRL+ENTER to create new line)<br>
        <br>
    </li>
    <li> ASCII importer limits the volume to 2147483647 so after convertion to
                              32bit integer it never becomes negative<br>
        <br>
    </li>
    <li>Added parameter list to backtest report (Settings page)<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.75.2 (as compared to 4.75.1)</strong></p>
  <ul>
    <li> when no data we available chart background is correct now (it was black
                              instead of one choosen in prefs in 4.75.x) <br>
        <br>
    </li>
    <li> Added ability to disable fixed ruin stop<br>
      When you add <br>
      <br>
      SetOption(&quot;DisableRuinStop&quot;, True);<br>
      <br>
      to your formula the backtester will not use built in 99.96% loss stop (ruin)
                            Note: it is recommended NOT to use it unless you really have to.<br>
      <br>
    </li>
    <li> added new option to SetOption: <br>
        <br>
      SetOption(&quot;EveryBarNullCheck&quot;, True)<br>
      <br>
      SetOption(&quot;EveryBarNullCheck&quot;, True)- allows to turn on checking
                            for Nulls in arithmetic operations on every bar in the array(by default it
                            is OFF - i.e. AmiBroker checks for nulls that appear in the beginning of
                            the arrayand in the end of the array and once non-null value is detected
                            it assumes no further holes (nulls) in the middle). Turning &quot;EveryBarNullCheck&quot; to
                            True allows to extend these checks to each and every barwhich is the way
                            4.74.x and earlier versions worked.<br>
      <br>
      Note however that turning it on gives huge performance penalty (arithmetic
                            operations are performed even 4x slower when this option is ON, so don't
                            use it unless you really have to).<br>
      <br>
    </li>
    <li> Added small result summary after backtest in the status line<br>
      <br>
    </li>
    <li> Fixed problem with plotting xshifted charts occuring when formula referenced
                              future bars<br>
        <br>
    </li>
    <li> logical (boolean) operators check for nulls on every bar and treat null
                              as &quot;false&quot; to maintain backward compatibility with formulas written
                              for previous versions<br>
      <br>
    </li>
    <li> Modified file dialog buffer size from 262144 (0x40000) bytes to 262143
                              (0x3FFFF) to workaround 16 bit (64KB) buffer limit of Windows 95/98/NT4
                              (yes surprisingly NT4 is limited to 64K buffer in file dialogs)<br>
        <br>
      16-bit windows (95/98) and NT4 were treating 0x40000 as 0 (zero) because
                            only lower 16 bits were interpreted. Thanks to move to 0x3FFFF it is now
                            interpreted as 0xFFFF on 16 bit windows.<br>
        <br>
    </li>
    <li>Potential crash fixed when formula using AddToComposite atcEnableInBacktest
                              is verified in the AFL editor<br>
      <br>
    </li>
    <li> Added XShift parameter to PlotOHLC and PlotForeign functions<br>
      <br>
    </li>
    <li>fixed re-mapping of built-in and custom colors in grid color picker <br>
        <br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.75.1 (as compared to 4.75.0)</strong> </p>
  <ul>
    <li> ParamColor now accepts 24 bit colors without crashing <br>
        <br>
    </li>
    <li> Null values appearing at the end of data series (array) are handled
                              appropriately (propagate through arithmetic operators)<br>
      This fixes problem that 4.75.0 had with &quot;trendline&quot; formulas that
                            used Null values put into the array at the end of the data series. <br>
      <br>
    </li>
    <li> Most recently picked drawing tool color is preserved between runs<br>
        <br>
    </li>
    <li>EncodeColor was not handling all 24 bit color combinations correctly.
                              Fixed now.<br>
      <br>
    </li>
    <li>Chart tree fix: Moving or renaming formula in charts tree now updates
                              all paths in indicators that use this formula<br>
          <br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.75.0 (as compared to 4.74.6)</strong> </p>
  <ul>
    <li>New chart style (styleCloud) to be used to create &quot;cloud&quot; chart
                              as in Ichimoku charts. Also useful for indicator charts like MACD.<br>
        <br>
      This style fills non-rectangular (free shaped) area between HIGH and LOW
                            arrays provided<br>
      by PlotOHLC function. Open and Close arrays are not relevant for plotting
                            however Close<br>
      is used as usual to display value label and title. So recommended use is
                            to use &quot;upper&quot; bounding value<br>
      in Open and High arrays and &quot;lower&quot; bounding value in &quot;Low&quot; and &quot;Close&quot; arrays
      <p>Sample Ichimoku cloud:</p>
      <p><CODE><FONT COLOR=#000000>SL = ( </FONT><FONT COLOR=#0000ff>HHV</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>H</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>26</FONT><FONT COLOR=#000000> )
                                  + </FONT><FONT COLOR=#0000ff>LLV</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>L</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>26</FONT><FONT COLOR=#000000>)
                                  )/</FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>; <BR>
                              TL = ( </FONT><FONT COLOR=#0000ff>HHV</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>H</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>9</FONT><FONT COLOR=#000000> )
                              + </FONT><FONT COLOR=#0000ff>LLV</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>L</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>9</FONT><FONT COLOR=#000000> )
                              )/</FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>; <BR>
                              DL = </FONT><FONT COLOR=#0000ff>Ref</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>25</FONT><FONT COLOR=#000000> ); <BR>
                              Span1 = </FONT><FONT COLOR=#0000ff>Ref</FONT><FONT COLOR=#000000>( ( SL
                              + TL )/</FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>, -</FONT><FONT COLOR=#ff00ff>25</FONT><FONT COLOR=#000000> ); <BR>
                              Span2 = </FONT><FONT COLOR=#0000ff>Ref</FONT><FONT COLOR=#000000>( (</FONT><FONT COLOR=#0000ff>HHV</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>H</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>52</FONT><FONT COLOR=#000000>)
                              + </FONT><FONT COLOR=#0000ff>LLV</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>L</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>52</FONT><FONT COLOR=#000000>))/</FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>,
                              -</FONT><FONT COLOR=#ff00ff>25</FONT><FONT COLOR=#000000>); <BR>
                                  <BR>
                                  <BR>
                                  </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>"Price"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorBlack</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>styleCandle</B></FONT><FONT COLOR=#000000> ); <BR>
                                  </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( SL, </FONT><FONT COLOR=#ff00ff>"SL"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>styleThick</B></FONT><FONT COLOR=#000000> ); <BR>
                                  </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( TL, </FONT><FONT COLOR=#ff00ff>"TL"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorGreen</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>styleThick</B></FONT><FONT COLOR=#000000> ); <BR>
                                  </FONT><FONT COLOR=#0000ff>PlotOHLC</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>,
            span1, span2, span2, </FONT><FONT COLOR=#ff00ff>"Cloud"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorLightOrange</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>styleCloud</B></FONT><FONT COLOR=#000000> );</FONT></CODE></p>
      <p>Simple MACD cloud:</p>
      <p><CODE><FONT COLOR=#000000>m = </FONT><FONT COLOR=#0000ff>MACD</FONT><FONT COLOR=#000000>(); <BR>
        </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>Signal</FONT><FONT COLOR=#000000>(), </FONT><FONT COLOR=#ff00ff>"Signal"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorBlue</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>styleThick</B></FONT><FONT COLOR=#000000> ); <BR>
        </FONT><FONT COLOR=#0000ff>PlotOHLC</FONT><FONT COLOR=#000000>( m,m,</FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>,m, </FONT><FONT COLOR=#ff00ff>"MACD"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>IIf</FONT><FONT COLOR=#000000>(
      m &gt; </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorGreen</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#000000><B>styleCloud</B></FONT><FONT COLOR=#000000> );</FONT></CODE></p>
      <p>Another MACD cloud (difference):</p>
      <p><CODE><FONT COLOR=#000000>m = </FONT><FONT COLOR=#0000ff>MACD</FONT><FONT COLOR=#000000>(); <BR>
        s = </FONT><FONT COLOR=#0000ff>Signal</FONT><FONT COLOR=#000000>(); <BR>
        </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( s, </FONT><FONT COLOR=#ff00ff>"Signal"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorBlue</B></FONT><FONT COLOR=#000000>); <BR>
        </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( m, </FONT><FONT COLOR=#ff00ff>"MACD"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorRed</B></FONT><FONT COLOR=#000000> ); <BR>
        </FONT><FONT COLOR=#0000ff>PlotOHLC</FONT><FONT COLOR=#000000>( m,m,s,m, </FONT><FONT COLOR=#ff00ff>"MACD"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>IIf</FONT><FONT COLOR=#000000>(
                              m &gt; s, </FONT><FONT COLOR=#000000><B>colorLime</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorLightOrange</B></FONT><FONT COLOR=#000000>), </FONT><FONT COLOR=#000000><B>styleCloud</B></FONT><FONT COLOR=#000000> );</FONT></CODE><br>
      </p>
    </li>
    <li> when File->Open database or MRU list is choosen then old database is
                              saved first<br>
              <br>
    </li>
    <li>When default database is deleted, AB now asks for new default database
                              folder, instead of re-creating it<br>
            <br>
    </li>
    <li>when database is deleted from the outside and user picks it via MRU list
                              -then gets removed from MRU list and is not recreated anymore<br>
            <br>
    </li>
    <li>When AmiBroker is launched with incorrect "Start in" (working directory)
                              then it automatically switches to "last good" path<br>
            <br>
        &quot; 
            Last good&quot; path is saved in the registry HKEY_CURRENT_USER\TJP\Broker\Defaults\LastGoodPath,
                                    during successful launch in correct directory (whenever working directory
                                    is correct or not it is determined by checking for presence of Broker.chm
                                    file (help file))<br>
            <br>
      Using correct working directory is important because AmiBroker uses relative
                            paths to most components.<br>
      <br>
    </li>
    <li>AFL: new function: StaticVarRemove()<br>
        <br>
      StaticVarRemove(&quot;varname&quot;)<br>
      removes static variable and releases associated memory<br>
      <br>
    </li>
    <li>Start-up time decreased significantly by implementation of on-demand
                              loading of formulas<br>
            <br>
      (on slow, low-end machines loading time decreases from 10 seconds to just
                            0.5 second)<br>
            <br>
    </li>
    <li>printf/StrFormat/SelectedValue functions no longer affect number of extra
                              future bars calculated by QuickAFL<br>
            <br>
    </li>
    <li>Minor plugin status change (as in IB backfill) does not cause sound (only
                              tooltip is displayed)<br>
            <br>
    </li>
    <li>Increased the limit of files that can be selected using Windows file
                              dialog<br>
      Now import wizard and ascii importer file dialogs use 256KB buffer for file
                            names that on average should allow 20000 files to be selected at once.<br>
            <br>
    </li>
    <li>Further speed improvements by rewriting chart ID lookup routine (GetChartInfoByID)<br>
            <br>
    </li>
    <li>Chart title string is clipped so Y axis is never obscured<br>
            <br>
    </li>
    <li>Chart title can be automatically wrapped now<br>
      Use 'Parameters' window,<br>
&quot; Axes &amp; Grid&quot; tab,<br>
      Miscellaneous-&gt;Wrap title: YES<br>
      <br>
      If you want to set it programmatically from the formula use<br>
      SetChartOptions( 2, chartWrapTitle );<br>
      <br>
    </li>
    <li>Auto-hide panes slide slightly faster<br>
            <br>
    </li>
    <li>All basic array arithmetic and logical operators inlined and hand optimized
                              on assembly level for speed, gives upto 450% speed increase in basic array
                              calculations<br>
            <br>
      Example speed increases:<br>
      <br>
      a) purely &quot;theoretical&quot; example<br>
      million iterations of array addition<br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>(
                            i = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>; i &lt; </FONT><FONT COLOR=#ff00ff>1000</FONT><FONT COLOR=#000000>;
                            i++ ) <BR>
                                  </FONT><FONT COLOR=#800000><B> &nbsp;for</B></FONT><FONT COLOR=#000000>(
                                    k = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>; k &lt; </FONT><FONT COLOR=#ff00ff>1000</FONT><FONT COLOR=#000000>;
                                    k++ ) <BR>
&nbsp;&nbsp; Sumh = </FONT><FONT COLOR=#000000><B>H</B></FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#000000><B>L</B></FONT><FONT COLOR=#000000>;</FONT></CODE><br>
      <br>
      runs 4.8 times (+480%) faster (5 seconds in 4.75 compared to 24 seconds in
                            4.74 and older, Athlon64@2GHz)<br>
      2000 data bars.<br>
      <br>
      This gives ( 2000 * 1000000 additions ) / 5 sec = 400 MEGAFLOPS (millions
                            of floating point operations per second) AFL array-based AFL execution speed.<br>
        <br>
      b) &quot;real-world&quot; examples:<br>
&quot; Projection Oscillator&quot; <br>
      <a href="http://www.amibroker.com/library/detail.php?id=344" target="_blank">http://www.amibroker.com/library/detail.php?id=344</a><br>
      single security optimization runs 85% faster<br>
      (13 seconds (4.75) compared to 24 seconds (4.74 or older) )<br>
      <br>
&quot; RSIS&quot;<br>
      <a href="http://www.amibroker.com/library/detail.php?id=153" target="_blank">http://www.amibroker.com/library/detail.php?id=153</a><br>
      single-security optimization 5000 iterations runs 21% faster<br>
      (28 seconds (4.75) compared to 34 seconds (4.74 or older))<br>
      <br>
      NOTE: Performance increase depends on complexity of the formula. Biggest
                            gains can be observed for formula doing LOTS of mathematical calculations
                            on arrays (using lots of +, -, *, /, ^, %, comparisions &lt;, &gt;, ==, !=, &lt;=, &gt;=,
                            etc).<br>
        <br>
    </li>
    <li>AFL: new function: SetChartBkColor( color )<br>
      sets chart background to user-specified color<br>
      <br>
    </li>
    <li>Added View->Time & Sales menu back<br>
            <br>
    </li>
    <li>Added chart timing display (you can turn it on via Tools->Preferences->Display
                              chart timing)<br>
              <br>
      when turned on, in the bottom of each chart the following information is
                            displayed:<br>
      Total time X sec, AFL exec time Y sec (Z %), # extra bars back Q, fwd R<br>
            <br>
      where <br>
      X - is total time in second spent during chart refresh ( this includes AFL
                            execution and actual screen painting/drawing, grid / scale calculations,
                            etc)<br>
      Y - is time spent in chart AFL execution only (without any actual screen
                            painting, grid / scale calcs)<br>
      Z - is percentage of time that AFL execution takes compared to total time
                            required for refresh<br>
      Q - is a number of previous bars (before first visible bar) that are needed
                            to calculate the indicator (QuickAFL estimation)<br>
      R - is the number of future bars (after last visible bar) that are needed
                            to calculate the indicator (QuickAFL estimation)<br>
            <br>
    </li>
    <li>Added asin/acos to the AFL function reference<br>
            <br>
    </li>
    <li>AFL: 24-bit (16 million) truecolor support for indicators and exploration
                              output.<br>
        <br>
    </li>
    <li> new ColorRGB() and ColorHSB functions to access full 24 bit palette<br>
            <br>
      ColorRGB( red, green, blue )<br>
      <br>
      returns color value to be used in Plot/PlotOHLC/AddColumn/AddTextColumn<br>
      red, green, blue - represent color component values in range 0..255 each<br>
      <br>
      For more information about RGB color model please read:<br>
      <a href="http://en.wikipedia.org/wiki/RGB_color_model" target="_blank">http://en.wikipedia.org/wiki/RGB_color_model</a><br>
      <br>
      ColorHSB( hue, saturation, brightness )<br>
      <br>
      returns color value to be used in Plot/PlotOHLC/AddColumn/AddTextColumn<br>
      <br>
      hue - represents gradation of color within the optical spectrum (as in rainbow)<br>
      saturation represents &quot;vibrancy&quot; of the color<br>
      brightness represents brightness.<br>
      <br>
      Each parameter ranges from 0 to 255, where 0 represents 0% saturation/brightness <br>
      or 0 degree hue in HSV color wheel,<br>
      and 255 represents 100% saturation/brightness or 360degrees hue in HSV color
                            wheel<br>
            <br>
      When you modify hue from 0 to 255 you will see consecutive<br>
      rainbow colors starting from red, through yellow and green to blue and violet.<br>
            <br>
      For more information about HSB color space please read:<br>
      <a href="http://en.wikipedia.org/wiki/HSB_color_space" target="_blank">http://en.wikipedia.org/wiki/HSB_color_space</a><br>
      <br>
      <br>
      Example MA rainbow chart (bring up parameters dialog and play with it):<br>
      <br>
      <CODE><FONT COLOR=#000000>side = </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>; <BR>
      increment = </FONT><FONT COLOR=#0000ff>Param</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"Increment"</FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>10</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>( i = </FONT><FONT COLOR=#ff00ff>10</FONT><FONT COLOR=#000000>;
                            i &lt; </FONT><FONT COLOR=#ff00ff>80</FONT><FONT COLOR=#000000>; i = i +
                            increment ) <BR>
                            { <BR>
&nbsp;&nbsp;&nbsp; up = </FONT><FONT COLOR=#0000ff>MA</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>,
                        i ); <BR>
&nbsp;&nbsp;&nbsp; down = </FONT><FONT COLOR=#0000ff>MA</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>,
                        i + increment ); <BR>
            <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>ParamToggle</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"3D
                        effect?"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>"No|Yes"</FONT><FONT COLOR=#000000> )
                        ) <BR>
&nbsp;&nbsp;&nbsp; side = </FONT><FONT COLOR=#0000ff>IIf</FONT><FONT COLOR=#000000>(up&lt;=down </FONT><FONT COLOR=#000000><B>AND</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#0000ff>Ref</FONT><FONT COLOR=#000000>(
                        up&lt;=down, </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0.6</FONT><FONT COLOR=#000000> ); <BR>
                              <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>PlotOHLC</FONT><FONT COLOR=#000000>(
                        up,up,down,down, </FONT><FONT COLOR=#ff00ff>"MA"</FONT><FONT COLOR=#000000>+i, </FONT><FONT COLOR=#0000ff>ColorHSB</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#ff00ff>3</FONT><FONT COLOR=#000000>*(i
                        - </FONT><FONT COLOR=#ff00ff>10</FONT><FONT COLOR=#000000>), <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>Param</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"Saturation"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>128</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>255</FONT><FONT COLOR=#000000> ), <BR>
&nbsp;&nbsp;&nbsp; side * </FONT><FONT COLOR=#0000ff>Param</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"Brightness"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>255</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>255</FONT><FONT COLOR=#000000> )
                        ), </FONT><FONT COLOR=#000000><B>styleCloud</B></FONT><FONT COLOR=#000000> | </FONT><FONT COLOR=#000000><B>styleNoLabel</B></FONT><FONT COLOR=#000000> ); <BR>
      }</FONT></CODE><br>
      <br>
      ///////<br>
      Color-parade exploration<br>
      <br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#000000><B>Filter</B></FONT><FONT COLOR=#000000>=</FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>; <BR>
      </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>( i = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>;
                            i &lt; </FONT><FONT COLOR=#ff00ff>256</FONT><FONT COLOR=#000000>; i = i + </FONT><FONT COLOR=#ff00ff>16</FONT><FONT COLOR=#000000> ) <BR>
                              </FONT><FONT COLOR=#0000ff>&nbsp;&nbsp;AddColumn</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>"C"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>1.2</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorDefault</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#0000ff>ColorHSB</FONT><FONT COLOR=#000000>(
                                ( </FONT><FONT COLOR=#0000ff>BarIndex</FONT><FONT COLOR=#000000>() +
                                i ) % </FONT><FONT COLOR=#ff00ff>256</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>255</FONT><FONT COLOR=#000000>-i, </FONT><FONT COLOR=#ff00ff>255</FONT><FONT COLOR=#000000> )
                                ); <BR>
      </FONT></CODE></li>
  </ul>
  <p><br>
  </p>
  <p><strong>CHANGES FOR VERSION 4.74.6 (as compared to 4.74.5)</strong> </p>
  <ul>
    <li> Fixed problem with RTQuote failing to load symbol list during first
                              show<br>
        <br>
    </li>
    <li>Fixed problem in AA-Apply To-Date that was introduced because of tab
                              order change<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.74.5 (as compared to 4.74.4)</strong></p>
  <ul>
    <li> Toolbar theme was reset when entering Formula Editor, now it is fixed<br>
        <br>
    </li>
    <li>Quote Editor list now remembers columns size and order between runs<br>
        <br>
    </li>
    <li>Keyboard shortcut editor now allows using punctation characters like
                              Ctrl+[, Ctrl+], - =, etc<br>
      <br>
    </li>
    <li>Automatic Analysis: Pick button now has shortcut on Alt+I to avoid conflict
                              with Alt+P (Parameters), also fixed tab order<br>
        <br>
    </li>
    <li>Fixed ParamDate to return DateNum instead of YYYYMMDD (4 digit year)<br>
    </li>
  </ul>
  <p> <strong>CHANGES FOR VERSION 4.74.4 (as compared to 4.74.3)</strong></p>
  <ul>
    <li> New &quot;Appearance&quot; tab in Tools-&gt;Customize, allowing to select
                              menu/toolbar/docking pane themes and tab location<br>
        <br>
    </li>
    <li>Layout and Symbol trees are marked for refresh when database is changed
                              and refreshed when user brings them up<br>
        <br>
    </li>
    <li>Fixed exception that occurred after customization when ticker bar was
                              removed from all toolbars<br>
        <br>
    </li>
    <li>Fixed ticker bar losing focus when Shift/Insert/CapsLock/NumLock pressed<br>
          <br>
    </li>
    <li>Real-time Quote column order/size is remembered correctly again<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.74.3 (as compared to 4.74.2)</strong></p>
  <ul>
    <li>Fixed losing focus by ticker combobox when Shift, CapsLock, NumLock,
      Insert keys were pressed</li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.74.2 (as compared to 4.74.1)</strong></p>
  <ul>
    <li> Ticker combo is now correctly refreshed on database change even if moved
                              to other toolbar than default<br>
        <br>
    </li>
    <li>Previously when Reset was used on Ticker toolbar it became blank - now
                              it is fixed, ticker combo is refilled after closing customization mode<br>
        <br>
    </li>
    <li> Edit field in Ticker combobox does not scroll horizontally now when
                              edited text is too long<br>
        <br>
    </li>
    <li>Numeric keypad keys now work with File MRU menu (most recently used files)<br>
        <br>
    </li>
    <li>Global shortcuts continue to work when focus is inside ticker combo<br>
          <br>
    </li>
    <li>&quot;Profile&quot; button in View toolbar works correctly now<br>
          <br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.74.1 (as compared to 4.74.0)</strong></p>
  <ul>
    <li>Fixed incorrect message displayed in the progress window during some
      longer explorations</li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.74.0 (as compared to 4.73.0)</strong></p>
  <ul>
    <li> New user interface: fully user-customizable advanced docking panes/toolbars/menus.<br>
            <br>
      New UI features:
      <ul>
        <li> Tear-Off Tabs </li>
        <li> Nested docking pane grouping </li>
        <li> WYSIWYG docking </li>
        <li> sliding auto-hide pinnable windows </li>
        <li> modern &quot;Whidbey&quot; look </li>
        <li> Tear-Off menus and toolbars </li>
        <li>Add/copy/Delete/Modify/drag-drop commands </li>
        <li>User-defined toolbars</li>
      </ul>
      <br>
      <br>
      For a little video presentation see: http://www.amibroker.com/video/uicustomize.htmlNote:
                            toolbar and keyboard customizations made in old versions need to be re-done
                            because they can not be imported by new system due to fundamental differences
                            (I am sorry about that)]<br>
      <br>
    </li>
    <li> GroupID(), IndustryID(), SectorID, MarketID(), InWatchList(), IsIndex()
                              and IsContinuous() functions are now affected by SetForeign<br>
        <br>
    </li>
    <li>Removed debug messages cluttering DebugView output (that appeared in
                              4.73)<br>
        <br>
    </li>
    <li> Changed the way drawing color picker is working: now it works like in
                              Word (or other text editor) - keeps selected color even if drawing with
                              different color is clicke<br>
      <br>
    </li>
    <li> Fixed false message &quot;The note has been modified outside the notepad
                              editor.&quot; occuring when file did not exist<br>
        <br>
    </li>
    <li> OLE: Changed Window.LoadTemplate to return FALSE when file can not be
                              found<br>
        <br>
    </li>
    <li>OLE: Window.LoadTemplate now refreshes display so it is not necessary
                              to use SelectedTab = 0<br>
          <br>
    </li>
    <li> Removed constant RT refreshes in interpretation window when text does
                              not change<br>
        <br>
    </li>
    <li>ZoomToRange: last selected bar in range is visible after zooming now</li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.73.0 (as compared to 4.72.1)</strong></p>
  <ul>
    <li>OLE: Window object, new method ZoomToRange( From, To ) <br>
      ZoomToRange( From, To )<br>
      From and To parameters are of any type that can be converted to date(you
                            can use string or OLE date for example).<br>
        <br>
      Example code (JScript):<br>
        <br>
      AB=new ActiveXObject(&quot;Broker.Application&quot;);<br>
      AW = AB.ActiveWindow;<br>
      if( AW.ZoomToRange( &quot;2005-04-01&quot;, &quot;2005-08-01&quot; ) )<br>
      { <br>
&nbsp;&nbsp; WScript.Echo(&quot;Zoom successfull&quot; );<br>
      }<br>
      <br>
    </li>
    <li>Fixed: Chart got shrinked a bit with each overlaid plot, now the Y scale
                              does not change (unless really needed) <br>
          <br>
    </li>
    <li>Fixed: XShift now works correctly with styleOwnScale and styleLeftScale<br>
        <br>
    </li>
    <li> Fixed: Volume chart overlaid on price chart in log scale (overlay) was
                              compressed to flat line, now it is fixed (volume chart overlay uses linear
                              scale always)<br>
      [#22262]<br>
      <br>
    </li>
    <li> AFL: Added AlmostEqual function (completed: 2005-09-16)<br>
        <br>
      AlmostEqual( x, y, ulps = 5 )<br>
      <br>
      this is a helper function for comparing floating point numbers.It returns
                            True if x and y are equal or almost equal upto defined accurracy (ulps).It
                            is recommended to use this function instead of equality check (==) as itleads
                            to more reliable comparisons and less headache caused by IEEE floating pointacurracy
                            issues.<br>
        <br>
      Parameters:x, y - the numbers or arrays to be compared,Ulps stands for &quot;units
                            in last place&quot; and represents maximum relative error of the comparison.
                            Since 32 bit IEEE floating point numbers have accurracy of 7 significant
                            digits, 1 unit in last place(ulp) represents relative error of 0.00001 %.
                            The default value of ulps parameter is 5 which gives roughtly 0.00005% &quot;comparison
                            sensitivity&quot;.<br>
        <br>
        <br>
      Example code:<br>
      <br>
      if( 1/3 == 0.3333333 ) <br>
      { <br>
&nbsp; printf(&quot;32-bit Floating point IEEE exact equality\n&quot;);<br>
      }<br>
      <br>
      if( AlmostEqual( 1/3, 0.3333333 ) ) <br>
      { <br>
&nbsp;&nbsp;printf(&quot;Numbers are almost equal\n&quot;);<br>
      }<br>
      <br>
      Thanks to Bruce Dawson for his fast routine.<br>
      <br>
    </li>
    <li> Optimize() function now checks if min &lt; max, step &gt; 0 and checks
                              if parameter name is not empty <br>
          <br>
    </li>
    <li> Made Time&amp;Sales case insensitive (when &quot;case sensitive tickers&quot; option
                              is turned off&quot;) <br>
          <br>
    </li>
    <li> OBV/AccDist/Chaikin functions adjusted to be SetForeign-aware<br>
          <br>
    </li>
    <li> OLE: Application object new methods<br>
      BOOL LoadLayout( filename )<br>
      BOOL SaveLayout( filename )<br>
      <br>
      AB = new ActiveXObject(&quot;Broker.Application&quot;);<br>
      AB.LoadLayout(&quot;C:\\Program Files\\AmiBroker\\Data\\Layouts\\Default.awl&quot;);<br>
        <br>
    </li>
    <li>OLE: Window object new property: SelectedTab <br>
        <br>
      AB = new ActiveXObject(&quot;Broker.Application&quot;);<br>
      AW = AB.ActiveWindow;<br>
      tabindex = AW.SelectedTab; // read selected tab<br>
      AW.SelectedTab = 3; //switch to tab 3<br>
      AW.SelectedTab = tabindex; // restore originally selected tab<br>
      <br>
    </li>
    <li> Fixed: Exception was generated when GetRTDataForeign was called with
                              non-existing ticker<br>
          <br>
    </li>
    <li> OLE: Window object new methods: LoadTemplate, SaveTemplate<br>
          <br>
      AB = new ActiveXObject(&quot;Broker.Application&quot;);<br>
      AW = AB.ActiveWindow;<br>
      AW.SaveTemplate(&quot;Test.abt&quot;);<br>
      AW.LoadTemplate(&quot;Test.abt&quot;);<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.72.1 (as compared to 4.72.0)</strong></p>
  <ul>
    <li>fixed out-of-memory problem sometimes occuring during scan of large (&gt;512MB)
      databases</li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.72.0 (as compared to 4.71.1)</strong><br>
  </p>
  <ul>
    <li>&quot; Currency&quot; field support in ASCII importer <br>
      added command: <br>
      $CURRENCY USD<br>
      <br>
      and field:<br>
      <br>
      $FORMAT Name,Currency$OVERWRITE 1$AUTOADD 1]<br>
      <br>
    </li>
    <li>Added &quot;Additional commands&quot; field in the Import wizard for
                              typing any extra $- commands that are not available via checkboxes <br>
        <br>
    </li>
    <li> Added parameter to AddColumn/AddTextColumn to control column width <br>
        <br>
      AddColumn( ARRAY, &quot;Caption&quot;, format = 1.2, color = colorDefault,
                            bgcolor = colorDefault, width = -1); <br>
      AddTextColumn( &quot;Text&quot;, &quot;Caption&quot;, format = 1.2, color
                            = colorDefault, bgcolor = colorDefault, width = -1 );<br>
      <br>
    </li>
    <li> AddToComposte new flag to work when Status(&quot;action&quot;)== actionPortfolio
                              (completed: 2005-09-09)<br>
      new flag is called atcEnableInPortfolio<br>
      <br>
      Example:<br>
      <br>
      if( Status(&quot;action&quot; ) == actionPortfolio )<br>
      <br>
      {<br>
      ... Custom backtest mode here ....<br>
      AddToComposite( some_array, &quot;~COMPOSITE&quot;, &quot;X&quot;, atcFlagEnableInPortfolio
                            | atcFlagDefaults );<br>
      <br>
      }<br>
      <br>
    </li>
    <li> AFL added: tanh(), sinh(), cosh() functions <br>
      Hyperbolic tangent, sine and cosine function<br>
      <br>
    </li>
    <li> AFL functions: StrToUpper and StrToLower <br>
          <br>
    </li>
    <li> Fixed: Tick ASCII import: last tick of previous import was deleted on
                              subsequent import, now it is corrected <br>
      <br>
    </li>
    <li>Function to detect mouse button state <br>
          <br>
      GetCursorMouseButtons() returns mouse button state at the time when chart
                            formula is executed<br>
          <br>
      0 - if no mouse button is pressed<br>
      1 - if left mouse button is pressed<br>
      2 - if right mouse button is pressed<br>
      4 - if middle mouse button is pressed<br>
      <br>
      plus combinations:3 - left + right5 - left + middle6 - right + middle 7 -
                            left + right + middle]<br>
        <br>
    </li>
    <li> GetRTDataForeign (retrieving values for other symbols) <br>
      GetRTDataForeign( &quot;field&quot;, &quot;symbol&quot;)<br>
      <br>
    </li>
    <li> Pane is not deleted if shrinked down to zero (prevents from accidential
                              deletion of panes) <br>
          <br>
    </li>
    <li> Plot function now has xshift parameter that allows to visually shift
                              the chart past the last bar <br>
      Example 20-bar Moving average shifted 10 bars into the future past the last
                            bar:<br>
      <br>
      Plot(Close,&quot;Close&quot;,colorBlack,styleCandle);Plot(MA(Close,20), &quot;Shifted
                            MA&quot;, colorRed, styleLine, Null, Null, 10 );<br>
      <br>
      Note that shift occurs during plotting and does not affect source array<br>
      <br>
    </li>
    <li> Removed data source selection from preferences because it caused user
                              confusion way too often <br>
        <br>
    </li>
    <li> Stock.Currency available via OLE<br>
        <br>
    </li>
    <li> Title variable now supports new special token {{OHLCX}} which is replaced
                              at runtime by string &quot;Open ..., Hi .... Lo ... Close (...%)&quot; showing
                              current price<br>
        <br>
      This way it is possible to implement formula that will show OHLC prices with
                            number of decimal places set in the preferences.<br>
        <br>
      Example:<br>
      <br>
      SetChartOptions(0,chartShowArrows|chartShowDates);<br>
      _N(Title = &quot;{{NAME}} - {{INTERVAL}} {{DATE}} {{OHLCX}} {{VALUES}}&quot; );<br>
      Plot( C, &quot;Close&quot;, ParamColor(&quot;Color&quot;, colorBlack ), styleNoTitle
                            | ParamStyle(&quot;Style&quot;) | GetPriceStyle() );<br>
      <br>
    </li>
    <li> user-definable number of decimal places in chart titles (completed:
                              2005-09-09)<br>
      Number of decimal places displayed in default chart title is now user-definable
                            inTools-&gt;Preferences-&gt;Miscellaneous&quot;Decimal places in chart titles&quot;.<br>
        <br>
      Allowable values:<br>
      -1 - dynamic mode (number of decimal places automatically adjusted)<br>
      0..6 - fixed number of decimal places <br>
      <br>
    </li>
    <li> QuoteArray resizing now uses heuristic algorithm to minimize memory
                              fragmentation and increase performance <br>
        <br>
    </li>
    <li> atcFlagDeleteValues now highlighted properly in the AFL editor<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.71.1 (as compared to 4.71.0)</strong></p>
  <ul>
    <li>fixed compatibility problem with AmiQuote (due to changed order of OLE
      properties/method while AmiQuote was using old ones)</li>
    <li>now ASCII importer in $TICKMODE does not delete quotes older than oldest
                              (first) record in the imported file, so you can safely import tick data
      from subsequent files (older first, newest later)</li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.71.0 (as compared to 4.70.5)</strong></p>
  <ul>
    <li>AFL: added GetCursorXPosition() and GetCursorYPosition() functions<br>
      <br>
      Functions return current mouse cursor position. <br>
      Values returned are equal to those visible in the status bar, and these functions
                            require status bar to be visible. Returned values represent cursor position
                            at the formula execution time (or few milliseconds before it) and accurracy
                            is subject to pixel resolution of the screen (first cursor position is read
                            in screen pixels (integer) and then converted to actual value therefore for
                            example when screen resolution is 1024x768 maximum obtainable resolution
                            in X direction is 0.1% and in Y direction 0.13%), also X values are snap
                            to datetime of nearest data bar.<br>
      <br>
      It only makes sense to use these functions in indicator/interpretation code. <br>
            <br>
      Using them in AA window may yield random values.GetCursorXPosition() function
                            returns X position in DateTime format (the same as used by DateTime() function).You
                            can convert it to string using DateTimeToStr() function.GetCursorYPosition()
                            returns Y position (as displayed in Y axis of the chart).
      <p><br>
      Example:</p>
      <p><br>
      ToolTip=&quot;X=&quot;+DateTimeToStr(GetCursorXPosition()) +&quot;\nY=&quot;+GetCursorYPosition();</p>
      <p>&nbsp; </p>
    </li>
    <li>
      <p>AFL: added DateTimeToStr() and StrToDateTime() functions <br>
          <br>
      These functions allow to convert string to datetime format and vice versa.</p>
      <p><br>
        Example:<br>
        <br>
      ToolTip=&quot;X=&quot;+DateTimeToStr(GetCursorXPosition()) +&quot;\nY=&quot;+GetCursorYPosition();] </p>
    </li>
    <li>
      <p> Added ability to store charts as .GIF (in addition to PNG)</p>
      <p>&nbsp; </p>
    </li>
    <li>
      <p>ASCII importer maximum supported line length is increased to 2048 characters </p>
      <p>&nbsp; </p>
    </li>
    <li>
      <p>Fixed: .aflsafe files didn't get deleted automatically</p>
      <p>&nbsp; </p>
    </li>
    <li>Added N-volume bars charts and timeframe support.<br>
        <br>
      Custom N-volume bar intervals are definable (as usual) in Tools-&gt;Preferences-&gt;Intraday.<br>
      <br>
      TimeFrame functions were also extended to support N-volume bars using new
                            TimeFrameMode() function calling<br>
            <br>
      TimeFrameMode( 0 ); <br>
      <br>
      - switches time frame functions to time-based operation (the default)<br>
                    <br>
      TimeFrameMode( 1 ); <br>
      <br>
      - switches time frame functions to N-tick operation (positive values passed
                            to TimeFrameSet are treated now as N-tick)<br>
                    <br>
      TimeFrameMode( 2 ); <br>
      <br>
      - switches time frame functions to N-volume bar operation (positive values
                            passed to TimeFrameSet are treated nowas N-volme bars)
      <p><br>
        Example:<br>
        <br>
        TimeFrameMode( 2 );<br>
        TimeFrameSet( 50000 ); // 50'000 share bars.. <br>
        ...do something ...<br>
      TimeFrameRestore();</p>
      <p><br>
        Note: N-volume bars are somewhat weird (compression of data to N-volume
                                bar may actually deliver MORE output bars - for example if one tick is
                                1000 shares and you have specified 100V bars then single tick will be
                                expanded to TEN 100V bars - ten times original size)<br>
        TimeFrame functions are protected against array overrun and will not decompress
                              beyond original array size (you will get an &quot;Error 47. N-volume bar
                              compressed data longer than base time frame&quot;).<br>
        Also switching main time frame to some weird N-volume bar value will result
                              in limiting the output to maximum twice original data size(without error
                              message). <br>
        You should keep that in mind and avoid using too small N-volume bar intervals
                              that could lead to such condition.<br>
        Also due to the nature of N-volume bars the only TimeFrameSet() function
                              will yield correct N-volume bar values, TimeFrameGetPrice() may give slightly
                              distorted results.<br>
        It is also possible to use n-volume bars in TimeFrame functions without
                              calling TimeFrameMode() - it is then necessary to specify n-volume bars
                              as negative number offset by -1000000 (minus one million):<br>
                        <br>
        TimeFrameSet( -1000000 - 2000 ); <br>
        <br>
        // gives 2000V barsSimilarly formatted negative numbers will be reported
      by Interval() function when n-volume bars are selected.</p>
      <p></p>
      <p>&nbsp;</p>
    </li>
    <li>
      <p>OLE: Save As PNG / GIF callable from automation <br>
          <br>
        Example script:<br>
        <br>
        AB = new ActiveXObject(&quot;Broker.Application&quot;);<br>
      AB.ActiveWindow.ExportImage(&quot;Test.png&quot;);</p>
    </li>
    <li>
      <p> Plugin is not called when GetExtraData is used for symbol that has &quot;use
                                only local database&quot; flag turned on, and NULL is returned instead
        of an error </p>
      <p>&nbsp; </p>
    </li>
    <li>
      <p> Protected against changing application's current working directory
        by printing to file</p>
      <p>&nbsp; </p>
    </li>
    <li>
      <p> Toolbar does not get wrapped when main frame window is resized </p>
      <p>&nbsp; </p>
    </li>
    <li>
      <p>OLE: Analysis object has new method MoveWindow( x, y, width, height)
                                that allows to control position and size of automatic analysis window<br>
              <br>
        AB = new ActiveXObject(&quot;Broker.Application&quot;);<br>
      AB.Analysis.MoveWindow( 10, 10, 200, 200 );</p>
      <p><br>
        It has some restrictions on size: specified size can not besmaller than
                                10x10 pixels and can not be bigger than entire screen dimensions.<br>
        Also when &quot;No minimum size for resizing dialogs&quot; box in UNCHECKED
                              in Tools-&gt;Prefs-&gt;Misc it won't shink AA window below default size
      necessary to fully display all controls.</p>
      <p>&nbsp; </p>
    </li>
    <li>
      <p>ASCII importer: added ability to import tick data from text files <br>
                                  <br>
      ASCII importer now allows tick data files to be imported.</p>
      <p> Tick data files consist of several records having the same timestamp.This
                                makes it impossible to use normal import mode which assumes different
                                (unique) timestampsfor each data row (when same timestamp is found then
        new data overwrites old).</p>
      <p><br>
        To turn on TICK mode you need to add manually<br>
        <br>
        $TICKMODE 1<br>
        <br>
      line to ASCII importer definition file.</p>
      <p><br>
        $TICKMODE is a special mode of importer that allows to import quotes that
                                haveduplicate time stamps. <br>
                                    <br>
        It makes two assumptions:<br>
        a) input data should come in the ascending time order (i.e. OLDER records
                              first, LATEST records last)<br>
        b) input data should consist of entire tick history because importer will
                              DELETE any existing quotes (to avoid creating multiple copies of the same
      ticks).</p>
      <p> Once again: Turning on <br>
        $TICKMODE 1<br>
        will DELETE ANY QUOTES that already exist in the database and then will
                              import all ticks from input data file.<br>
      You have been warned.</p>
      <p><br>
      For example data files like this:</p>
      <p> MOL,0,20050606,162959,16400.0000,16400.0000,16400.0000,16400.0000,2MOL,0,20050606,162959,16400.0000,16400.0000,16400.0000,16400.0000,11MOL,0,20050606,162959,16400.0000,16400.0000,16400.0000,16400.0000,40</p>
      <p><br>
      Can be imported using the following definition file:</p>
      <p><br>
        $FORMAT Ticker, Skip, Date_YMD, Time, Open, High, Low, Close, Volume<br>
        $SKIPLINES 1<br>
        $SEPARATOR ,<br>
        $CONT 1<br>
        $GROUP 255<br>
        $AUTOADD 1<br>
        $DEBUG 1<br>
      $TICKMODE 1</p>
      <p><br>
        Sometimes it happens that input files have invalid timestamps (seconds &gt; 59).<br>
        <br>
        For example:<br>
                                    <br>
        MOL,0,20050606,162970,16400.0000,16400.0000,16400.0000,16400.0000,2<br>
        <br>
        Please take a closer look at first line shown in this example it has time:16:29:70
      (you see 70 seconds !)</p>
      <p> So I had to add a special flag to the importer that works around such
                                data errors.<br>
                                    <br>
        It is called $ALLOW99SECONDS 1 and will convert all records with invalid
                              seconds (i.e greater than 59)to 59s. <br>
      So record stamped 16:29:70 will be treated as 16:29:59</p>
      <p> Now for tick mode to work with such incorrect records you would need
        to add two lines to ASCII importer definition:</p>
      <p> $TICKMODE 1<br>
        $ALLOW99SECONDS 1<br>
      </p>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.70.5 (as compared to 4.70.4)</strong></p>
<ul>
  <li>
     Fixed problem with Indicator Maintenance wizard not
        reading certain layouts correctly, thus deleting indicators that were
      in fact in use (allocated to: 4.70.5) (completed: 2005-05-08)<br>
  </li>
  <li>
     Custom backtester: EnterTrade method uses RoundLotSize
          parameter from the AA settings if none is specified in function call
      and RoundLotSize field in Symbol-&gt;Information is set to zero (allocated
      to: 4.70.5) (completed: 2005-05-04)<br>
  </li>
  <li>
     StaticVarSet - increased resolution to maximum supported
      by 32-bit IEEE (allocated to: 4.70.5) (completed: 2005-05-08)<br>
  </li>
  <li>
     When trade size limit expressed as % of bar volume shrinks
            down the trade below &quot;MinPosValue&quot; then such trade is not
            entered (allocated to: 4.70.5) (completed: 2005-05-04)</li>
</ul>

  <p><strong>CHANGES FOR VERSION 4.70.4 (as compared to 4.70.3)</strong></p>
<ul>
  <li>
    Closing editor window while AA operation is running
          does not result in crash if formula generates error (allocated to:
      4.70.4) (completed: 2005-05-01)<br>
      <br>
  </li>
  <li>
      When margin requirement was set to 100 (no margin) then
        very small artifacts (0.0000000000001) were displayed as margin loan, this
      is now corrected (allocated to: 4.70.4) (completed: 2005-05-01)<br>
      <br>
  </li>
  <li>
     Added message &quot;Formula execution halted because
          of an error - no chart to display&quot; instead of &quot;black pane&quot; (allocated
      to: 4.70.4) (completed: 2005-04-30)<br>
      <br>
  </li>
  <li>
     AFL Editor: Fixed problem with errorneous horizontal
            scrolling when editing lines longer than 256 characters (allocated to: 4.70.4)
      (completed: 2005-04-19)<br>
      <br>
  </li>
  <li>
     Default layout is saved automatically when Tools-&gt;Indicator
        Wizard menu is selected (allocated to: 4.70.4) (completed: 2005-04-30)<br>
        <br>
  </li>
  <li>
     Fixed styleThick and styleLine small 'dash' artifact
      (allocated to: 4.70.4) (completed: 2005-04-30)<br>
      <br>
  </li>
  <li>
     Setup: Mixed mode EOD/Intraday is selected in demo eSignal
        database (allocated to: 4.70.4) (completed: 2005-04-30)<br>
        <br>
  </li>
  <li>
     Time-compressed N-minute bars are no longer reset on
                  USA EST 00:00:00 when align to session times is turned on (allocated to:
                  4.70.4) (completed: 2005-04-21)<br>
                  <br>
  </li>
  <li>
     Time-compression of bars: open interest is now correctly
                    using &quot;last&quot; value (allocated to: 4.70.4) (completed:
                    2005-04-15)<br>
                    <br>
  </li>
  <li>
    Tools-&gt;Indicator Wizard keeps old built-in indicator slots untouched<br>
  </li>
</ul>

  <p><strong>CHANGES FOR VERSION 4.70.3 (as compared to 4.70.1)</strong></p>
<ul>
  <li>
    Added &quot;TIME&quot; control to Text study properties (allocated to:
    4.70.3) (completed: 2005-03-24) <br>
  </li>
  <li>
    Assigning hyper-long strings to Title variable does not cause program
            termination anymore (allocated to: 4.70.3) (completed: 2005-03-18)<br>
  <li>Modified daily time compression and weekend filtering when daily bars
          are set to use day/night session start/end times (allocated to: 4.70.3)
          (completed: 2005-03-24)<br>
    [Now it works so that if day/night session is enabled then weekend begins with
    the start of Friday night session and ends with the beginning of Sunday night
    session]
    <br>  
  <li>&quot;Filter weekends&quot; option added to View-&gt;Intraday menu,
          so now it is not necessary to go to File-&gt;Database Settings-&gt;Intraday
          settings to change it (allocated to: 4.70.3) (completed: 2005-03-24)
          <br>  
  <li>&quot;Override weekly/monthly bars use date of last trade&quot; Preferences
          setting was affecting daily charts too. Now it is fixed (only weekly
          and monhtly charts are affected) (allocated to: 4.70.3) (completed:
    2005-03-24)<br>
  </li>
  <li>Exception when using a left open Param window after the indicator has
          been closed (allocated to: 4.70.3) (status: fixed) (completed: 2005-03-21)<br>
    [now if Param window is closed if corresponding indicator pane is closed]<br>
  </li>
  <li>Fixed crash occuring sometimes when #included file was missing (allocated
          to: 4.70.3) (completed: 2005-03-21)<br>
  </li>
  <li>Fixed crash occuring when run-time or syntax error occurred in the #included
          file that was longer than 16000 characters (allocated to: 4.70.3) (completed:
          2005-03-24)<br>
  </li>
  <li>Fixed GetCommission() method in Trade object not to ignore bInclExit
          parameter (allocated to: 4.70.3) (completed: 2005-03-24)<br>
  </li>
  <li>Control over tooltip text from AFL formula level (allocated to: 4.70.3)
          (completed: 2005-03-24)<br>
    [available now via new reserved variable called TooltipTooltip = &quot;My Tooltip
    text shows Close &quot; + Close;note that X/Y coords are displayed in the
    tooltip anyway and that custom tooltip text length is limited to 1000 characters.]<br>
  </li>
  <li>GetPositionValue() method of Trade object returned entry value instead
          of current value. Now it is fixed (i.e. CURRENT value is returned) (allocated
          to: 4.70.3) (completed: 2005-03-24)<br>
  </li>
  <li>Implemented &quot;Min. pos value&quot; in addition to &quot;Min. shares&quot; (allocated
          to: 4.70.3) (completed: 2005-03-24)<br>
    [This sets global minimum on position (trade) size. Backtester will
          not open trades below this limit. Default value is zero (no minimum
          trade size).The
    setting is available via: AA, Settings: Min. Pos. Value field, and via SetOption(&quot;MinPosValue&quot;,
    ... )]<br>
  </li>
  <li>Updated &quot;READ ME&quot; and some minor corrections in the User's
          Guide (allocated to: 4.70.3) (completed: 2005-03-24)<br>
  </li>
  <li>&quot;Max. trade drawdown&quot; for short trades was incorrect, now
          fixed (allocated to: 4.70.3) (completed: 2005-03-24)<br>
  </li>
</ul>
</blockquote>

  <p><strong>CHANGES FOR VERSION 4.70.1 (as compared to 4.70.0)</strong></p>
<ul><li>
    Updated old parts of the User's Guide to present current status-quo.<br>
    </li>
  <li>
    First
          trade exit price was sometime reported as -1#QNAN, this should be fixed
          now (allocated
          to:
          4.70.1)
          (completed:
          2005-03-16)<br>
  </li>
  <li>
     &quot;Delete indicator&quot; in CONTEXT (chart) menu (allocated to:
      4.70.1) (completed: 2005-03-10)<br>
  </li>
  <li>
     Add ownStyle scaling factor so it is not necessary to use Highest(V) in
        volume chart (allocated to: 4.70.1) (completed: 2005-03-15)<br>
  </li>
  <li>
     Added Help-&gt;AFL functions by name, Help-&gt;AFL functions by category,
        Help-&gt;AFL reference menu items to AFL editor (allocated to: 4.70.1)
        (completed: 2005-03-15)<br>
  </li>
  <li>
     added maskAll, maskDefault, maskPrice maskHistogram, chartShowDates, chartLogarithmic,
        chartShowArrows constants to syntax-colorizer def (allocated to: 4.70.1)
        (completed: 2005-03-12)<br>
  </li>
  <li>
     Adjusted formatting of param window min/max values so it does not use engineering
        notation (xEy) for numbers smaller than 1e8 (100 million) (allocated to:
        4.70.1) (completed: 2005-03-12)<br>
  </li>
  <li>
     BUG: Applying preferences resets price style to candlesticks even if
      something different is selected in View-&gt;Price chart style (allocated
      to: 4.70.1) (status: fixed) (completed: 2005-03-15)<br>
  </li>
  <li>
     BUG: Choosing File-&gt;Print and then pressing &quot;CANCEL&quot; button
        blocked further RT refreshes, now fixed. Also now page count is set to 1
        (avoid &quot;Next page&quot;) (allocated to: 4.70.1) (status: fixed)
        (completed: 2005-03-15)<br>
  </li>
  <li>
     BUG: GetPriceStyle() included styleDots even if currently selected style
        was candlestick or bar (allocated to: 4.70.1) (status: fixed) (completed:
        2005-03-15)<br>
  </li>
  <li>
     BUG: RT Quote, Context menu -&gt; HIDE - does not shrink the panel
      (allocated to: 4.70.1) (status: fixed) (completed: 2005-03-15)<br>
  </li>
  <li>
     Change default include directory to &quot;Formulas\Include&quot; (allocated
        to: 4.70.1) (completed: 2005-03-15)<br>
  </li>
  <li>
     Display chart ID in Axes/Grid: Misc: part of parameters dialog and adjust
        description of Study() (allocated to: 4.70.1) (completed: 2005-03-12)<br>
  </li>
  <li>
     Make IDR_BROKERTYPE and IDR_MAINFRAME menus the same (allocated to: 4.70.1)
        (completed: 2005-03-15)<br>
  </li>
  <li>
     Modify registration checking to allow only licenses 4.20 and above (allocated
        to: 4.70.1) (completed: 2005-03-15)<br>
  </li>
  <li>
     New version of IB plugin: 1.3.6 - max. number of streaming symbols increased
        to 100 (allocated to: 4.70.1) (completed: 2005-03-02)<br>
  </li>
  <li>
     Pressing 'X' button in the main frame during Print preview closes print
        preview only instead of exiting application (allocated to: 4.70.1) (completed:
        2005-03-15)<br>
  </li>
  <li>
     Quotes for symbols beginning with non-US characters are not saved (should &quot;land&quot; in
        '_' folder but they don't) (allocated to: 4.70.1) (completed: 2005-03-12)<br>
  </li>
  <li>
     Replaced IQFeed plugin with smaller (release) version (allocated to: 4.70.1)
        (completed: 2005-03-12)<br>
  </li>
  <li>
     Symbol-&gt;Categories, &quot;This group uses own intraday settings&quot; checkbox
        and button are now repositioned correctly when dialog is resized (allocated
        to: 4.70.1) (completed: 2005-03-12)<br>
        <br>
  </li>
</ul>

  <p><strong>CHANGES FOR VERSION 4.70.0 (as compared to 4.69.8)</strong></p>
<ul>
  <li>Rewriten all price formulas to use GetPriceStyle()
    <br>  
  <li>_DEFAULT_NAME() uses indicator title if there is no _SECTION defined
    <br>
  <li>Changed default background color for the charts
    <br>
  <li>Removed obsolete color pickers from preferences
    <br>
  <li>when styleOwnScale is selected and min scale value is &lt;= 0 then logarithmic
    scaling is turned off for this particular plot
    <br>
  <li>data plugin interface adjusted back to allow NULL RecentInfo pointer even
    if ticker is not null
    <br>
  <li>Removed all obsolete specialized drawing routines for old built-in charts <br>
  <li>Syntax highlighting: default text and number color changed from pink to
    violet (easier for the eyes) <br>
  <li>Hiding chart pane causes auto-arrange (if selected in preferences)
    <br>  
  <li>Chart panes with date axis displayed take more space than panes without
    axis if auto-arrange selected
    <br>  
  <li>fixed problem with handling scripting parts written in language that is
    new-line sensitive (VBScript) <br>
  <li>Changed &quot;cyclic&quot; colors in ParamColor <br>
  <li>fixed display of negative parameter values in Param dialog <br>
  <li>Fixed &quot;scale shrinking&quot; effect when no plot is drawn <br>
  <li>ParserCleanup is called when exception occurs inside interpretation <br>
  <li>if no GraphXSpace variable is defined then default 2% extra space is added <br>
  <li>support for TWS API 8.30 - add primaryExchange=Exchange = &quot;SMART&quot; (or &quot;BEST&quot;)
</ul>
  <p><br>
  </p>
  <p><strong>CHANGES FOR VERSION 4.69.8 (as compared to 4.69.0)</strong></p>
  <ul>
    <li> Added copying error message in AFL editor (Edit-&gt;Copy Error Message)<br>
    </li>
    <li> New column in AA Trade List report: Scale In/Out - showing the number
          of scale-in and scale-out operations within given trade <br>
    </li>
    <li> Added protection against re-opening the same formula in multiple editor
          windows via &quot;Edit Formula&quot; <br>
    </li>
    <li> Price chart style switchable from the menu
        <ul>
          <li>new AFL function:<br>
            <strong>GetPriceStyle</strong>() returns price chart style value
                  to be used in Plot statement <br>
          Returned value depends on selection in View-&gt;Price chart style menu</li>
          <li>added View-&gt;Price chart style-&gt;Line with dots<br>
          </li>
        </ul>
    </li>
    <li> IB plugin auto-refresh configurable via File-&gt;Database Settings-&gt;Configure, &quot;Force
          instant quote retrieval for all symbols&quot; <br>
    </li>
    <li> Fold/unfold directory in Chart tree causes inserting chart (fix double
          click handler)<br>
    </li>
    <li> Fixed 1-tick interval handling when mixed eod/intraday data was enabled <br>
    </li>
    <li> Fix toolbar display problem when manually sizing down the editor window
          to zero, closing and re-opening the editor <br>
    </li>
    <li> Bar requirements were not recalculated after modifying formula since
          introduction of drag-drop. Fixed now.<br>
    </li>
    <li>Added: You are about to save the file that is located in hidden drag-drop
          folder, do you want to move it to Custom folder so it is visible in the
          chart tree?&quot; message<br>
    </li>
    <li>Plot() function protected against specifying negative color <br>
    </li>
    <li>Indicator exception handler calls now CleanupParser when exception occurred
          outside parser but still somewhere inside drawing routine so other indicators
          continue to work even if fatal exception occurred during drawing<br>
    </li>
    <li>added<strong> #include_once</strong> preprocessor command <br>
    </li>
    <li> When a formula was drag-and-dropped from the Chart tree on to the AA
          window, the formula loaded, but all the parameters were not reset from
      the previous formula. Fixed now. </li>
    <li></li>
    <li> ApplyStop changes: Fixed problem with trailing stop and exitatstop=2
          in regular mode. Also better consistency of trailing stops between &quot;Allow
          same day stop&quot; mode set to true and false<br>
    </li>
    <li> action* constants now highlighted by AFL editor <br>
    </li>
    <li> additional PositionSize methods<br>
      New SetPositionSize function:<br>
      <br>
      <br>
      <strong>SetPositionSize</strong>( size, method )<br>
      'size' and 'method' parameters are ARRAYS:<br>
      'method' can be one of:<br>
      spsValue (=1) - dollar value of size (as in previous versions)<br>
      spsPercentOfEquity (=2) - size expressed as percent of portfolio-level equity
        (size must be from ..100 (for regular accounts) or .1000 for margin accounts)<br>
      spsShares (=4) - size expressed in shares/contracts (size must be &gt; 0
        )<br>
      spsPercentOfPosition (=3) - size expressed as percent of currently open position
        (for SCALING IN and SCALING OUT ONLY)<br>
      <br>
      <br>
      For example to liquidate 50% of position simply use<br>
      <br>
      SetPositionSize( 50, spsPercentOfPosition * ( Buy == sigScaleOut ) );<br>
      <br>
      spsNoChange (=0) - don't change previously set size for given bar (allows
        to write constructs like that):<br>
      <br>
      SetPositionSize( 100, spsShares ); // 100 shares by default<br>
      SetPositionSize( 50, IIF( buy == sigScaleOut, spsPercentOfPosition, spsNoChange
        ) ); // for scale-out use 50% of current position size<br>
      <br>
      <br>
      New SetPositionSize function automatically encodes new methods of expressing
        position size into old &quot;positionsize&quot; variable as follows:<br>
      values below -2000 encode share count,<br>
      values between -2000 and -1000 encode % of current position<br>
      values between -1000 and 0 encode % of portfolio equity<br>
      values above 0 encode dollar value<br>
      <br>
      Although it is possible to assign these values directly to old-style PositionSize
        variable, new code should use SetPositionSize function for clarity. <br>
      <br>
      Example of code that exits 50% on first profit target, 50% on next profit
        target and everything at trailing stop:<br>
      <br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#0000ff>Cross</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>MA</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>10</FONT><FONT COLOR=#000000> ), </FONT><FONT COLOR=#0000ff>MA</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>50</FONT><FONT COLOR=#000000> )
          ); <BR>
      </FONT><FONT COLOR=#000000><B>Sell</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>; <BR>
      <BR>
      </FONT><FONT COLOR=#008000>// the system will exit</FONT><FONT COLOR=#000000> <BR>
      </FONT><FONT COLOR=#008000>// 50% of position if FIRST PROFIT TARGET stop
          is hit</FONT><FONT COLOR=#000000> <BR>
          </FONT><FONT COLOR=#008000>// 50% of position is SECOND PROFIT TARGET stop
          is hit</FONT><FONT COLOR=#000000> <BR>
          </FONT><FONT COLOR=#008000>// 100% of position if TRAILING STOP is hit</FONT><FONT COLOR=#000000> <BR>
          <BR>
        FirstProfitTarget = </FONT><FONT COLOR=#ff00ff>10</FONT><FONT COLOR=#000000>; </FONT><FONT COLOR=#008000>//
        profit </FONT><FONT COLOR=#000000> <BR>
        SecondProfitTarget = </FONT><FONT COLOR=#ff00ff>20</FONT><FONT COLOR=#000000>; </FONT><FONT COLOR=#008000>//
        in percent</FONT><FONT COLOR=#000000> <BR>
        TrailingStop = </FONT><FONT COLOR=#ff00ff>10</FONT><FONT COLOR=#000000>; </FONT><FONT COLOR=#008000>//
        also in percent</FONT><FONT COLOR=#000000> <BR>
        <BR>
        priceatbuy=</FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>; <BR>
        highsincebuy = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>; <BR>
        <BR>
        exit = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>; <BR>
        <BR>
        </FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>( i = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>;
        i &lt; </FONT><FONT COLOR=#000000><B>BarCount</B></FONT><FONT COLOR=#000000>;
        i++ ) <BR>
        { <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>(
    priceatbuy == </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#000000><B>AND</B></FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000>[
    i ] ) <BR>
&nbsp;&nbsp;&nbsp; { <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; priceatbuy = </FONT><FONT COLOR=#000000><B>BuyPrice</B></FONT><FONT COLOR=#000000>[
    i ]; <BR>
&nbsp;&nbsp;&nbsp; } <BR>
      <BR>
&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>(
    priceatbuy &gt; </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000> ) <BR>
&nbsp;&nbsp;&nbsp; { <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; highsincebuy = </FONT><FONT COLOR=#0000ff>Max</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>High</B></FONT><FONT COLOR=#000000>[
    i ], highsincebuy ); <BR>
      <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>(
    exit == </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#000000><B>AND</B></FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT COLOR=#000000><B>High</B></FONT><FONT COLOR=#000000>[
    i ] &gt;= ( </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> + FirstProfitTarget
    * </FONT><FONT COLOR=#ff00ff>0.01</FONT><FONT COLOR=#000000> ) * priceatbuy ) <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>//
    first profit target hit - scale-out</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit = </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>; <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000>[
    i ] = </FONT><FONT COLOR=#000000><B>sigScaleOut</B></FONT><FONT COLOR=#000000>; <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <BR>
      <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>(
    exit == </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> </FONT><FONT COLOR=#000000><B>AND</B></FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </FONT><FONT COLOR=#000000><B>High</B></FONT><FONT COLOR=#000000>[
    i ] &gt;= ( </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> + SecondProfitTarget
    * </FONT><FONT COLOR=#ff00ff>0.01</FONT><FONT COLOR=#000000> ) * priceatbuy ) <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>//
    second profit target hit - exit</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit = </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>; <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#000000><B>SellPrice</B></FONT><FONT COLOR=#000000>[
    i ] = </FONT><FONT COLOR=#0000ff>Max</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>Open</B></FONT><FONT COLOR=#000000>[
    i ], ( </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> + SecondProfitTarget
    * </FONT><FONT COLOR=#ff00ff>0.01</FONT><FONT COLOR=#000000> ) * priceatbuy ); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <BR>
      <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>Low</B></FONT><FONT COLOR=#000000>[
    i ] &lt;= ( </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> - TrailingStop
    * </FONT><FONT COLOR=#ff00ff>0.01</FONT><FONT COLOR=#000000> ) * highsincebuy
    ) <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#008000>//
    trailing stop hit - exit</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit = </FONT><FONT COLOR=#ff00ff>3</FONT><FONT COLOR=#000000>;&nbsp;&nbsp;&nbsp; <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#000000><B>SellPrice</B></FONT><FONT COLOR=#000000>[
    i ] = </FONT><FONT COLOR=#0000ff>Min</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>Open</B></FONT><FONT COLOR=#000000>[
    i ], ( </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> - TrailingStop
    * </FONT><FONT COLOR=#ff00ff>0.01</FONT><FONT COLOR=#000000> ) * highsincebuy
    ); <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <BR>
      <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>(
    exit &gt;= </FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000> ) <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000>[
    i ] = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>; <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</FONT><FONT COLOR=#000000><B>Sell</B></FONT><FONT COLOR=#000000>[
    i ] = exit + </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>; </FONT><FONT COLOR=#008000>//
    mark appropriate exit code</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;exit = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>; <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;priceatbuy = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>; </FONT><FONT COLOR=#008000>//
    reset price</FONT><FONT COLOR=#000000> <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;highsincebuy = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>; <BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; } <BR>
&nbsp;&nbsp;&nbsp; } <BR>
      } <BR>
      <BR>
      </FONT><FONT COLOR=#0000ff>SetPositionSize</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#ff00ff>50</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>spsPercentOfEquity</B></FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#0000ff>SetPositionSize</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#ff00ff>50</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>spsPercentOfPosition</B></FONT><FONT COLOR=#000000> *
        ( </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000> == </FONT><FONT COLOR=#000000><B>sigScaleOut</B></FONT><FONT COLOR=#000000> )
        ); </FONT><FONT COLOR=#008000>// scale out 50% of position </FONT><FONT COLOR=#000000> <BR>
      </FONT></CODE> <br>
      <br>
    </li>
    <li>Change default value of &quot;stop parsing at first error&quot; pref
          switch to FALSE<br>
    </li>
    <li> Context-sensitive help system (press F1, and help page relevant to current
          dialog / menu is brought up)<br>
      <br>
      Note that help itself is from version 4.60, so some topics may be missing
        yet, but it will be all updated with official release 4.70 as it will come
        with a new Users Guide.<br>
    </li>
    <li>Fixed bug: Drag-drop from one editor instance to another sometimes generated
          random characters in source editor<br>
    </li>
    <li>Added &quot;Error 46. Missing comma&quot; error message to the error
          list <br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.69.0 (as compared to 4.68.2)</strong></p>
  <ul>
    <li> Extended error information available now by pressing F1 key after highlighting
      error line</li>
    <li>&quot;Syntax error&quot; message improved<br>
      [Now the parser attempts to tell you what is the exact reason of the error,
          so it may tell you for example that:a) there is probably missing semicolon
          in the previous lineb) that it is expecting '{' at the beginning of function
          bodyc) that it expects ( after &quot;if&quot; , &quot;for&quot; and &quot;while&quot;etc,
      etc.]</li>
    <li>&quot;Missing comma&quot; error message added if there is no comma in
      variable declaration list or formal parameter list of the function</li>
    <li>Error line position calculated correctly even if using #include in the
      formula</li>
    <li>Word wrap feature removed (as it caused problems with reporting line
      number on syntax errors)</li>
    <li>Fixed handling of &quot;Parameter&quot; dialog inside Auto-Analysis</li>
    <li>Empty block statement allowed {}</li>
    <li> Edit button in AA window has now Alt-D shortut instead of Alt-E (no
      conflict with &amp;Exploration)</li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.68.2 (as compared to 4.68.1)</strong></p>
  <ul>
    <li> Improved syntax checking so it points to correct row/col even if case
          of block statements (completed: 2005-01-25)<br>
      [also with &quot;bad arguments&quot; error message arguments are now counted
        from 1 (instead of 0).]<br>
      <br>
    </li>
    <li> AFL editor now highlights with yellow color the line in which error
          occurred (Win XP, Win 2000 only) (completed: 2005-01-25)<br>
      [(there is a setting that allows to turn of this feature in Tools-&gt;Preferences-&gt;Editor &quot;Highlight
        error line&quot;)]<br>
      <br>
    </li>
    <li> Error list in AFL editor (completed: 2005-01-25)<br>
      [All error messages are now displayed in the listbox beneath AFL editor.
          When you click on each error message, appropriate code line in the editor
          is localized.]<br>
        <br>
    </li>
    <li> Improved handing of &quot;stop on first error&quot; flag (completed:
          2005-01-25)<br>
      [Previously only syntax errors were terminating parsing, now also run time
        errors terminate parsing on first error (when &quot;stop on first error&quot; flag
        is set)]<br>
      <br>
    </li>
    <li> Added protection against parser re-entry during formula execution (completed:
          2005-01-25)<br>
    </li>
    <li> ListTrades method of Backtester object now produces output only when &quot;Trade
          List&quot; mode is selected in the settings (completed: 2005-01-25)<br>
      [In previous versions (4.68.x) this method listed trades regardless of output
        mode selected causing misaligned output when &quot;summary&quot; mode was
        selected or optimization was run]<br>
      <br>
    </li>
    <li>Summary mode shows backtester metrics again (somehow it got broken in
          4.68.1) (completed: 2005-01-25)<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.68.1 (as compared to 4.68.0)</strong></p>
  <ul>
    <li>When re-displaying resizable window its stored size and position is now
          adjusted to fit on screen, also maximized state is stored separately (category:
          UI - General) (status: fixed) (completed: 2005-01-23)<br>
      [(sometimes users moved windows outside desktop and had trouble getting them
        back)]<br>
    </li>
    <li> The reminder message about &quot;Show trade arrows&quot; working in
          trade list mode is shown only once per session (category: UI - General)
          (status: changed) (completed: 2005-01-23)<br>
    </li>
    <li> Allow custom metrics to work with 3D optimization charts (category:
          AFL - Backtester) (status: fixed) (completed: 2005-01-23)
        <p></p>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.68.0 (as compared to 4.67.0)</strong></p>
  <ul>
    <li> added: Default Custom backtest proc file path setting in the AA Settings
          -allows to define external formula that will be default user-defined backtester
          applied to all formulas that do not use its own procedure<br>
    </li>
    <li> added: SetCustomBacktestProc function to allow changing custom backtest
          procedure file from formula level <br>
        <br>
      SetCustomBacktestProc( &quot;filename&quot;, enable = True )<br>
      filename parameter instructs backtester to use external formula file as custom
        backtest procedure<br>
      if empty - it means use current formula<br>
      <br>
      enable = True (default) - enables custom backtesting procedure (the same
        as SetOption(&quot;UseCustomBacktestProc&quot;, True );<br>
      enable = False - disables custom proc<br>
    </li>
    <li> added: new ListTrades method of Backtest object and NoTradeList optional
          parameter in Backtest method <br>
        <br>
      This allows easier implementation of custom per-trade metrics. One can use
        Backtest( 1 ) to disable default listing of trades then iterate via position
        and trade list and then call ListTrades method. This is somewhat simpler
        then implementing entire backtest loop just to add few per-trade metrics.<br>
    </li>
    <li> added: Per-trade metrics <br>
      Trade object now features AddCustomMetric method. <br>
      <br>
      Note that in contrast to Backtest.AddCustomMetric method that is usually
        called after PostProcess, the Trade.AddCustomMetric should be called before
        PostProcess call because PostProcess lists trades. Using Trade.AddCustomMetric
        after PostProcess gives no result, because trades are already listed.<br>
    </li>
    <li> added: new field suppoted by SetOption(): PortfolioReportMode<br>
      0 - trade list<br>
      1 - detailed log<br>
      2 - summary<br>
      3 - no output (custom only)<br>
    </li>
    <li> Fixed crash occuring when trying to display error message about COM
          exception and COM <br>
    </li>
    <li> Fixed &quot;Reverse signal forces exit&quot; handled incorrectly in
          4.67.0<br>
    </li>
    <li>changed: BarsInTrade in Trade object should start from 1, not from 2<br>
      BarsInTrade property of Trade object is now zero-based. Note however that
          the value of zero is available only when trade is just opened in &quot;low-level&quot; approach,
          so normally you would see numbers &gt;= 1 (all other reporting in AB remains
          as it was, so enter today and exit tommorrow counts as 2-bar trade)<br>
    </li>
    <li> fixed: click on &quot;NEW&quot; button in Formula editor should generate
          new file name in the toolbar<br>
    </li>
    <li> fixed: Re-enable SAVE button when formula name changes<br>
    </li>
    <li>added: Raw text output (allocated to: 4.68) <br>
      Backtester object features now RawTextOutput method that just outputs any
          string to the backtest result list at the time of the call. The user can
          output text formatted in multiple columns using \t (tab) character.<br>
    </li>
    <li> quick access to price arrays of open positions in Trade object (GetPrice
          method)<br>
        <br>
      GetPrice( Bar, Field ) method of Trade object retrieves the values of the
        following fields:<br>
      O (Open)<br>
      H (High)<br>
      L (Low)<br>
      C (Close)<br>
      F (Fx currency rate)<br>
      <br>
      NOTES:<br>
      1. GetPrice function is available only for OPEN POSITIONS, when called on
        closed trade returns Null value<br>
      2. Open interest field is not available GetPrice<br>
      3. Bar must be between 0..BarCount-1, otherwise exception will occur<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.67.0 (as compared to 4.66.2)</strong></p>
  <ul>
    <li> when copy-paste results from Exploration, color codes appeared in Excel
          as &quot;square&quot; characters. Now it is fixed.<br>
    </li>
    <li> Automation interface change:<br>
      _Item (default property) with id of zero added to Stock.Quotations collection
          Old Item() property remains with id of 5. This should ensure backward-compatibility.<br>
    </li>
    <li> removed FreeExtra function to avoid possible memory fragmentation caused
          by constant growing/shrinking memory when accessing data from RT sources
          when requested bar count was twice as much as retrieved.<br>
    </li>
    <li> added error message when the plugin returns incorrect size of quote
          array<br>
    </li>
    <li>removed requesting of quotes from RT data plugins during database save
          (this should address exceeding symbol count when saving large databases
          running with eSignal plugin)<br>
    </li>
    <li>new method of Analysis OLE automation object:<br>
      Edit( [optional] ForceReload = False )<br>
      <br>
      - displays AFL Editor window for currently loaded formula in AA window, optional
        ForceReload parameter (default=false) allows to force AFL edito to reload
        the formula from the file.<br>
        <br>
        <code>AB = new ActiveXObject(&quot;Broker.Application&quot;);<br>
        AA = AB.Analysis.<br>
        AA.LoadFormula(&quot;myFormula.afl&quot;);<br>
        AA.Edit( 1 ); // force reload<br>
    </code></li>
    <li> new method of Analysis OLE automation object:<br>
      ShowWindow( nShowCmd ) - allows to show/minimize/maximize/restore AA window
          nShowCmd uses standard WinAPI values, few most popular:<br>
          <br>
      SW_HIDE	0<br>
      SW_SHOWNORMAL 1<br>
      SW_SHOWMINIMIZED 2<br>
      SW_SHOWMAXIMIZED 3<br>
      SW_RESTORE 9<br>
    </li>
    <li> Scaling-in and scaling-out (pyramiding) is now supported by the backtester.<br>
      Two special constants: sigScaleIn / sigScaleOut added to provide means to
          tell the backtester when you want to scale-in/out<br>
        <br>
      All you have to do to implement pyraminding is to:<br>
      - Assign sigScaleIn to BUY/SHORT variable if you want to scale-in (increase
        size of) LONG/SHORT position<br>
      - Assign sigScaleOut to BUY/SHORT variable if you want to scale-out (decrease
        size of) LONG/SHORT position<br>
      <br>
      Scaling size is defined by PositionSize variable which in case of scaling
        defines not absolute positionsize but dollar increase or decrease.<br>
      <br>
      IMPORTANT: Please note that backtester treats trade that you scale-in/out
        as SINGLE trade (i.e. will show single row in trade list). The only difference
        versus plain trade is that it will calculate average entry price (and avg.
        entry fx rate) based on all partial entries and average exit price (and avg.
        exit fx rate) based on all parial exits and will show average prices in entry/exit
        price field. The commission is of course applied correctly to each (partial)
        entry/exit depending on partial buy/sell size.<br>
      <br>
      If you want to see details about scaling you have to run backtest in &quot;DETAIL
        LOG&quot; mode as only then you will see how scaling-in /out works and how
        average prices are calculated.<br>
      <br>
      Note also that scaling-in/-out and multiple-currency support is available
        only in portfolio backtester. Old backtester as well as Equity() function
        do NOT handle scaling-in/out nor multiple currencies (they simply ignore
        scaling commands).<br>
      <br>
      Easy examples:<br>
      <br>
      a) dollar-cost averaging (each month you buy stocks for fixed dollar amount)<br>
      <br>
      <CODE><FONT COLOR=#000000>FixedDollarAmount = </FONT><FONT COLOR=#ff00ff>500</FONT><FONT COLOR=#000000>; <BR>
      MonthBegin = </FONT><FONT COLOR=#0000ff>Month</FONT><FONT COLOR=#000000>()
        != </FONT><FONT COLOR=#0000ff>Ref</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>Month</FONT><FONT COLOR=#000000>(),
        -</FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> ); <BR>
        <BR>
        FirstPurchase = </FONT><FONT COLOR=#0000ff>Cum</FONT><FONT COLOR=#000000>(
        MonthBegin ) == </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>; <BR>
        <BR>
        </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#0000ff>IIf</FONT><FONT COLOR=#000000>(
          FirstPurchase, </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#008000>//
          True (or 1) represents regular buy signal</FONT><FONT COLOR=#000000> <BR>
          </FONT><FONT COLOR=#0000ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IIf</FONT><FONT COLOR=#000000>(
          MonthBegin, </FONT><FONT COLOR=#000000><B>sigScaleIn</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#008000>//
          each month increase position</FONT><FONT COLOR=#000000> <BR>
          </FONT><FONT COLOR=#ff00ff>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0</FONT><FONT COLOR=#000000> )
          ); </FONT><FONT COLOR=#008000>// otherwise no signal</FONT><FONT COLOR=#000000> <BR>
          <BR>
          </FONT><FONT COLOR=#000000><B>Sell</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>; </FONT><FONT COLOR=#008000>//
          we do not sell</FONT><FONT COLOR=#000000> <BR>
          </FONT><FONT COLOR=#000000><B>PositionSize</B></FONT><FONT COLOR=#000000> =
      FixedDollarAmount;</FONT></CODE><br>
      <br>
      b) dollar-cost averaging <br>
      (simplified formula because AB treats first sigScaleIn as buy anyway)<br>
      <br>
      <CODE><FONT COLOR=#000000>FixedDollarAmount = </FONT><FONT COLOR=#ff00ff>500</FONT><FONT COLOR=#000000>; <BR>
      MonthBegin = </FONT><FONT COLOR=#0000ff>Month</FONT><FONT COLOR=#000000>()
        != </FONT><FONT COLOR=#0000ff>Ref</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>Month</FONT><FONT COLOR=#000000>(),
        -</FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> ); <BR>
        <BR>
        FirstPurchase = </FONT><FONT COLOR=#0000ff>Cum</FONT><FONT COLOR=#000000>(
        MonthBegin ) == </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>; <BR>
        <BR>
        </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#0000ff>IIf</FONT><FONT COLOR=#000000>(
          MonthBegin, </FONT><FONT COLOR=#000000><B>sigScaleIn</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
          each month increase position</FONT><FONT COLOR=#000000> <BR>
          <BR>
          </FONT><FONT COLOR=#000000><B>Sell</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#ff00ff>0</FONT><FONT COLOR=#000000>; </FONT><FONT COLOR=#008000>//
          we do not sell</FONT><FONT COLOR=#000000> <BR>
          <BR>
          </FONT><FONT COLOR=#000000><B>PositionSize</B></FONT><FONT COLOR=#000000> =
      FixedDollarAmount;</FONT></CODE><br>
      <br>
      <br>
      c) increasing position when profit generated by trade without pyramiding<br>
      becomes greater than 5% and decreasing position when loss is greater than
        -5%<br>
      <br>
      <CODE><FONT COLOR=#008000>// percent equity change threshold when pyramiding
        is performed</FONT><FONT COLOR=#000000> <BR>
        PyramidThreshold = </FONT><FONT COLOR=#ff00ff>5</FONT><FONT COLOR=#000000>; <BR>
        <BR>
        </FONT><FONT COLOR=#008000>// regular trading rules (no pyramiding)</FONT><FONT COLOR=#000000> <BR>
        </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#0000ff>Cross</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>MACD</FONT><FONT COLOR=#000000>(), </FONT><FONT COLOR=#0000ff>Signal</FONT><FONT COLOR=#000000>()
        ); <BR>
        </FONT><FONT COLOR=#000000><B>Sell</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#0000ff>Cross</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>Signal</FONT><FONT COLOR=#000000>(), </FONT><FONT COLOR=#0000ff>MACD</FONT><FONT COLOR=#000000>()
        ); <BR>
        <BR>
        e = </FONT><FONT COLOR=#0000ff>Equity</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>); </FONT><FONT COLOR=#008000>//
        generate equity without pyramiding effect</FONT><FONT COLOR=#000000> <BR>
        <BR>
        PcntProfit = </FONT><FONT COLOR=#ff00ff>100</FONT><FONT COLOR=#000000> *
        ( e - </FONT><FONT COLOR=#0000ff>ValueWhen</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000>,
        e ) )/</FONT><FONT COLOR=#0000ff>ValueWhen</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000>,
        e ); <BR>
        <BR>
        InTrade = </FONT><FONT COLOR=#0000ff>Flip</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>Sell</B></FONT><FONT COLOR=#000000> ); <BR>
        <BR>
        </FONT><FONT COLOR=#008000>// ExRem is used here to ensure that scaling-in/out
        occurs</FONT><FONT COLOR=#000000> <BR>
        </FONT><FONT COLOR=#008000>// only once since trade entry</FONT><FONT COLOR=#000000> <BR>
        DoScaleIn = </FONT><FONT COLOR=#0000ff>ExRem</FONT><FONT COLOR=#000000>(
        InTrade </FONT><FONT COLOR=#000000><B>AND</B></FONT><FONT COLOR=#000000> PcntProfit &gt; PyramidThreshold, </FONT><FONT COLOR=#000000><B>Sell</B></FONT><FONT COLOR=#000000> ); <BR>
        DoScaleOut = </FONT><FONT COLOR=#0000ff>ExRem</FONT><FONT COLOR=#000000>(
        InTrade </FONT><FONT COLOR=#000000><B>AND</B></FONT><FONT COLOR=#000000> PcntProfit &lt; -PyramidThreshold, </FONT><FONT COLOR=#000000><B>Sell</B></FONT><FONT COLOR=#000000> ); <BR>
        <BR>
        </FONT><FONT COLOR=#008000>// modify rules to handle pyramiding</FONT><FONT COLOR=#000000> <BR>
        </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#000000><B>Buy</B></FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#000000><B>sigScaleIn</B></FONT><FONT COLOR=#000000> *
        DoScaleIn + </FONT><FONT COLOR=#000000><B>sigScaleOut</B></FONT><FONT COLOR=#000000> *
        DoScaleOut; <BR>
        <BR>
        </FONT><FONT COLOR=#000000><B>PositionSize</B></FONT><FONT COLOR=#000000> = </FONT><FONT COLOR=#0000ff>IIf</FONT><FONT COLOR=#000000>(
          DoScaleOut, </FONT><FONT COLOR=#ff00ff>500</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>1000</FONT><FONT COLOR=#000000> ); </FONT><FONT COLOR=#008000>//
      enter and scale-in size $1000, scale-out size: $500</FONT></CODE><br>
      <br>
    </li>
    <li> fixed appearent hang occuring on rare occassions when backtesting very
          large symbol set with trade size limit and round lot sizes enabled. Under
          such conditions the price cache that backtester uses could fill up due
          to the delayed release when limit of trade volume was hit and round lot
          size or min. shares setting did not allow to enter smaller trade.<br>
        <br>
    </li>
    <li>AFL editor changes:<br>
        <ul>
          <li> added separate menu</li>
          <li> auto-saving of formula when user triggers analysis from AA window
            instead of AFL editor</li>
          <li> when analysis is triggered from AA window and editor window is
                open then any parsing error brings editor to the top<br>
          </li>
        </ul>
    </li>
    <li> AFL OLE support extended to allow SETTING OLE properties (previously
          only calling methods and getting properties was possible)<br>
        <br>
      Now AFL supports setting/getting properties in usual (brace-less) way:<br>
        <br>
      For example:<br>
      <br>
      <CODE><FONT COLOR=#000000>AB = </FONT><FONT COLOR=#0000ff>CreateObject</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"Broker.Application"</FONT><FONT COLOR=#000000>); <BR>
      Stock = AB.Stocks(</FONT><FONT COLOR=#ff00ff>"MSFT"</FONT><FONT COLOR=#000000>); <BR>
      Stock.FullName = </FONT><FONT COLOR=#ff00ff>"Microsoft"</FONT><FONT COLOR=#000000>; </FONT><FONT COLOR=#008000>//
      setting OLE property</FONT></CODE><br>
        <br>
    </li>
    <li> (for advanced users only, work in progress)<br>
      implemented new interface allowing to control 2nd phase of portfolio backtest<br>
      <br>
      This allows multitude of applications including, but not limited to:<br>
      <br>
      a) position sizing based on portfolio-level equity<br>
      b) implementing advanced rotational systems (you have now access to ranking
        arrays and can decide what trades to take after knowing which symbols scores
        best on bar-by-bar basis)<br>
      c) adding your custom metrics to backtest and optimization statistics<br>
      d) implementing custom formulas for slippage control<br>
      e) advanced scaling-in/-out based on portfolio equity and other run-time
        stats<br>
      f) advanded trading systems that use portfolio-level statistics evaluated
        on bar-by-bar basis to decide which trades to take<br>
        <br>
      Full documentation on this new interface will be posted in a separate document.<br>
        <br>
      Note: this interface is work-in-progress and any documentation is preliminary
        and subject to change<br>
    </li>
    <li>logical operators between number and dispatch (OLE) objects are performed
          OK now.	Also dispatch objects may be used in conditional expressions.<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.66.2 (as compared to 4.66.1)</strong></p>
  <ul>
    <li>Custom Tools menu re-enabled again (it was disabled in 4.66.0 and 4.66.1)</li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.66.1 (as compared to 4.66.0)</strong></p>
  <ul>
    <li>fixed problem with duplicate chart sheets (which appeared in 4.66.0)</li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.66.0 (as compared to 4.65.2)</strong></p>
  <ul>
    <li> Multiple-currency support in backtester.<br>
      Now backtester allows to backtest systems on securites denominated in different
          currencies. It includes ability to use historical (variable) currency rates.
          Currency rates are definable in &quot;Currencies&quot; page in the preferences.
          The currency in which given symbol is denominated in can be entered in
          Symbol-&gt;Information page<br>
    </li>
    <li>&quot;Currencies&quot; page in Preferences - allows to define base currency
          and exchange rates (fixed or dynamic)<br>
      for different currencies. This allows to get correct backtest results when
        testing securities denominated in different currency than your base portfolio
        currency.<br>
    </li>
    <li>(for advanced users only, beginners should leave it untouched)<br>
      ability to change AFL formula root folder. Tools-&gt;Preferences-&gt;AFL<br>
      <br>
      This not only changes preferences setting but also moves all formula files
        from old location to new one and<br>
      re-links all charts to files in new location. If you specify new folder please
        make sure to create an empty one. Do NOT use root directories like 'C:\'<br>
      (Please use this feature with caution, as it may cause problems if you have
        more than one copy of AmiBroker installed in different directories, and upgrade
        scripts may not find your new formula folder automatically, thus formulas
        shipped with AB may not be updated on next installation *)<br>
      * - actually I will make installers aware of new folder location but this
        will only work if you have one installation or if multiple installations
        use the same formula folder.<br>
    </li>
    <li>Custom indicator storage increased to 3000 slots<br>
    </li>
    <li> Tools-&gt;Preferences-&gt;Data, new settings<br>
&quot;In-memory cache size max MegaBytes&quot; -<br>
      now allows to limit the in-memory cache size to certain amount of megabytes
        (in addition to limiting number of symbols). The default value is 20% of
        physical RAM size (calculated by AB at first run) <br>
    </li>
    <li>Indicator Maintenance Wizard (in Tools menu)<br>
&quot;Indicator Maintenance Wizard&quot; scans all your hard drives for layout
    files, then reads them all and checks which indicators are in use, then presents
    you with a list of files that are not in-use and can be<br>
      deleted. Folders in drag-drop folder are automatically marked for deletion,
        the other can be marked manually. And with one click you can delete unused
        ones. The wizard can be run on whenever you need.<br>
    </li>
    <li>new Interactive Brokers plugin (1.3.0) that collects data for all symbols
          in RT quote window and forces AB to retrieve collected data even if no
          chart is displayed for given symbol nor any scan is run <br>
      (note this feature requires not only new plugin but also AmiBroker 4.66.0
        or higher)<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.65.2 (as compared to 4.65.1)</strong></p>
  <ul>
    <li> AFL Formula Editor: toolbar truncation problem solved</li>
    <li> AFL Formula Editor: new &quot;Analysis&quot; button with submenu allows
          launching AA Scan/Exploration/Backtest/Optimize directly from the editor.
      Subsequent clicks on &quot;Analysis&quot; button repeat last selected action.</li>
    <li> Automatic Analysis window redesigned:
        <ul>
          <li> removed formula edit field - replaced by common editor that is
            accessible via &quot;Edit&quot; button, </li>
          <li>changing active formula via &quot;Pick&quot; button</li>
          <li> layout modifed - now more space for result list</li>
          <li> additional button ^ allows to extend result list to cover entire
            area of Auto-Analysis window.</li>
          <li>Now it is easy to have the same formula for indicator and AA. Just
                edit the formula and insert chart and use the very same formula in
                AA. Now when you modify the formula and save it - the changes will
            be immediatelly applied to both AA and IB.</li>
        </ul>
    </li>
    <li> Analysis menu accessible from Formula tree allows to load any formula
          from tree directly to AA window.<br>
      AA window is also drag-drop target window so you can load the formula to
        it via drag-drop too.<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.65.1 (as compared to 4.65.0)</strong></p>
  <ul>
    <li> fixed unexpected exit of AmiBroker that happened when your formula had
      SetChartOptions() call and AFL Editor-&gt; Verify or Insert chart was used</li>
    <li> added automatic saving of fail-safe copy before &quot;Verify&quot; in
          AFL editor. Fail-safe copy is saved with .aflsafe extension. The copy is
          automatically deleted if check was OK and no crash occurred. In case of
          crash you can load the backup file to AFL editor (change &quot;Files of
          type&quot; combo to &quot;Fail-safe AFL backup&quot; in the Open File dialog)<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.65.0 (as compared to 4.64.3)</strong></p>
  <ul>
    <li> AFL formula tree fold/unfold state restoring works with unlimited nesting
      levels</li>
    <li> files and entire folders can be now moved using drag &amp; drop mechanism
          in AFL formula tree. To MOVE files/folders drag them with RIGHT MOUSE BUTTON,
      to overlay on indicators - drag them using LEFT mouse button</li>
    <li> unnecessary formula tree refreshes removed</li>
    <li> multiple-level UNDO in AFL editor </li>
    <li> multiple-level REDO in AFL editor </li>
    <li> other minor 'undo' feature improvements (entering new line character
      triggers undo)</li>
    <li> fixed crash when clicked AA-&gt;Parameters-&gt;Reset All</li>
    <li> Formula Editor has now &quot;Formula name&quot; field that allows to
          specify file name quickly and save it without need to open &quot;Save As&quot; dialog<br>
    Files are stored by default in Formulas\Custom folder</li>
    <li> Save As... toolbar icon replaced by Save drop down menu</li>
    <li> Save function now uses &quot;formula name&quot; field (no need to open
      file dialog)</li>
    <li> Scaling Min/Max properties now use plain edit fields (no sliders)</li>
    <li> Negative custom scale works again </li>
    <li> Numeric parameter editing enhanced:<br>
      - if you click on left-side part of the parameter value field then regular
          edit field is displayed<br>
      - if you click on right-side part of the parameter value field then slider
        control is displayed<br>
      - when &quot;Step&quot; argument in Param() function call is equal to zero,
    then slider is disabled and parameter is editable only via regular edit control</li>
    <li> Formula Editor now features &quot;Apply indicator&quot; button that
          works like old &quot;Apply&quot;<br>
      (i.e. checks syntax, saves and inserts ONCE) as well as &quot;Insert indicator&quot; (available
        from submenu) that allows to insert multiple chart panes linked to the same
    formula</li>
    <li> Formula Editor now has &quot;Verify AFL&quot; button that allows to
          verify syntax of your AFL<br>
    formula without saving</li>
    <li>Automatic Analysis -&gt; Individual Equity and Portfolio Equity now link
          directly to<br>
&quot;Formulas\Equity\Individual.afl&quot; and &quot;Formulas\Equity\Portfolio.afl&quot; files.
    If you want to have your own customized equity chart you can modify those files
    (remember that they will be overwritten by setup program). You can also have
    unlimited number of your own equity charts defined as custom indicators.</li>
    <li>Portfolio equity chart allows to turn on/off cash/drawdown/bars since
          last high/lin reg parts using Parameter dialog (by default they are all
          off)<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.64.3 (as compared to 4.64.2)</strong></p>
  <ul>
    <li>fixed broker.newcharts file saving routine (should solve 'black panes'
      problem that appeared in 4.64.0)</li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.64.2 (as compared to 4.64.1)</strong></p>
  <ul>
    <li> during Layout/Template save, all currently used formulas are marked
          as 'used' so they do not get deleted if the user closes the pane using
          the same formula in some other layout. (Should solve 'black panes' problem
      that appeared in 4.64.0)</li>
    <li>when choosing &quot;Delete&quot; option from the formula tree AmiBroker
          displays the warning message that the formula may be in used in some indicators
          if the formula was 'linked' to some pane at least once.<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.64.1 (as compared to 4.64.0)</strong></p>
  <ul>
    <li> formula tree is refreshed after using &quot;Save As...&quot; function
      in Formula editor (to show any newly created files)</li>
    <li>&quot;Parameters&quot; menu option is turned on always<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.64.0 (as compared to 4.63.1)</strong></p>
  <ul>
    <li> QuickAFL is turned ON always<br>
      (it does not affect regular AFL code, only may affect some loops and/or plugins
          but a graceful period of almost 2 years was given to every user to get
          used to it and adjust the code if necessary, note: if particular formula
      needs all bars use SetBarsRequired function)</li>
    <li> Quick built-in charts is turned ON always </li>
    <li> Y-axis drag area is now thinner (to make de-selecting date easier)</li>
    <li> resizing dialogs remember not only size but also position</li>
    <li> time&amp;sales windows remember size and positions separately for each
      symbol </li>
    <li> time&amp;sales window now uses TimeShift setting from &quot;Intraday
      Settings&quot; screen </li>
    <li> max. trade drawdown stat figure is now also updated at exit price of
      the max. loss stop</li>
    <li> on startup all formulas (built-in and custom) that were stored in broker.charts
          / broker.bcharts files are now automatically converted to individual AFL
          files and stored under: Formulas\Old\Built-in<br>
    and Formulas\Old\Custom </li>
    <li> found and fixed few byte memory leak when using #include</li>
    <li> #include can now read from registry using @ character<br>
      #include @LastBacktestFormula<br>
      will include the formula that was used in last backtest run (useful for custom
    equity formulas)</li>
    <li> Workspace tab control now sizes down without displaying tab scroll bar </li>
    <li> all TimeFrame* AFL functions extended to work with N-tick bars too.
          N-tick intervals are specified by NEGATIVE numbers passed in 'interval'
          parameter.<br>
      So for example:<br>
    TimeFrameSet( -10 ); // switch to 10-tick interval</li>
    <li> Workspace -&gt; Charts tree now supports file deletion, renaming, creation
          of new files and folders plus more via Right-mouse button (RMMB) menu.
          Options available from RMB menu:
        <ul>
          <li> <strong>Insert</strong> - creates a copy of the selected file,
            insert _SECTIONS if necessary and inserts charts into new pane</li>
          <li><strong>Insert Linked</strong> - just inserts chart into new pane
                - the pane links directly to selected formula (so if you have more
                than one pane using the same formula, modifying it will modify the
            chart in all panes linked to it)</li>
          <li> <strong>Overlay</strong> - overlays selected formula onto &quot;active&quot; pane.
            Active pane is the pane you have clicked on recently</li>
          <li> <strong>Edit</strong> - opens Formula Editor and loads selected
            file for editing</li>
          <li> <strong>Rename</strong> - allows to rename formula file</li>
          <li> <strong>Delete</strong> - deletes the formula (permanently !)
            - charts panes linked to it will become black</li>
          <li> <strong>New-&gt;Formula</strong> - creates new formula file</li>
          <li> <strong>New-&gt;Folder </strong>- creates new folder</li>
          <li> <strong>Refresh</strong> - refreshes directory/file tree</li>
        </ul>
    </li>
    <li> Indicator builder removed and replaced by &quot;Formula Editor&quot;</li>
    <li> you can now control axis and grid settings from &quot;Parameters&quot; dialog</li>
    <li>&quot;Main&quot; chart, &quot;Indicators&quot; and &quot;Other indicators&quot; preference
      pages removed. Now all charts use new drag &amp; drop system</li>
  </ul>
  <p></p>
  <p><strong>CHANGES FOR VERSION 4.63.1 (as compared to 4.63.0)</strong></p>
  <ul>
    <li> fixed one more multiple-monitor problem with color popup control </li>
    <li> Parameters dialog works again in Automatic-Analysis window</li>
    <li> new AFL function: ParamTrigger<br>
        <br>
      ParamTrigger( &quot;Name&quot;, &quot;Button text&quot;)<br>
      - to be used in indicator builder - to create triggers (buttons).<br>
      <br>
      If you place ParamTrigger in the indicator code it will create a &quot;button&quot; in
        Parameter dialog that can be pressed.<br>
      Normally ParamTrigger will return zero (0) but when button in the param window
        is pressed then it will refresh the chart and ParamTrigger will return 1
        (one) for this single execution (further refreshes will return zero, until
        the button is pressed again)<br>
        <br>
      Example:<br>
      <br>
      <CODE><FONT COLOR=#000000>trigger = </FONT><FONT COLOR=#0000ff>ParamTrigger</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"Place
        Order"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>"Click here
        to place order"</FONT><FONT COLOR=#000000>); <BR>
          <BR>
          </FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( trigger
            ) <BR>
        { <BR>
          </FONT><FONT COLOR=#008000>&nbsp;&nbsp;// your</FONT><FONT COLOR=#008000> one-shot
            code here</FONT><FONT COLOR=#000000><BR>
      } </FONT></CODE><br>
    </li>
    <li> new AFL function: ParamList<br>
        <br>
      ParamList( &quot;Name&quot;, &quot;Values&quot;, default = 0 )<br>
      - generates the parameter that consist of the list of choices (specified
        in &quot;values&quot; parameter - | or comma separated). default parameter
        defines ordinal position of the default string value specified in &quot;values&quot; parameter.<br>
      Returned value is a STRING representing choosen item. <br>
      <br>
      Example:<br>
      <br>
      <CODE><FONT COLOR=#000000>OrderType = </FONT><FONT COLOR=#0000ff>ParamList</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"Order
    Type"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>"MKT|LMT|STP"</FONT><FONT COLOR=#000000> );</FONT></CODE></li>
  </ul>
  <p></p>
  <p><strong>CHANGES FOR VERSION 4.63.0 (as compared to 4.62.1)</strong></p>
  <ul>
    <li> 6th parameter for the Param() - sincr - now has correct default value
      of zero.</li>
    <li>trading arrows are correctly aligned again - there was a problem introduced
      in 4.62.1 with arrows alignment</li>
    <li> fixed redraw problem of layers list</li>
    <li> new AFL function added:<br>
      GetTradingInterface(&quot;Name&quot;) <br>
      - retrieves OLE automation object to automatic trading interface. &quot;Name&quot; is
        the interface name. You have to have trading interface installed separately
        to make it work otherwise you will get the error message attempting to use
        this function. Trading interface for Interactive Brokers will be released
    separately.</li>
    <li> layer list item width is adjusted automatically now when sizing the
      workspace pane</li>
    <li> colour-popup is aware of multiple-monitor configurations now and opens
      up on correct monitor.</li>
    <li> 'Arrange' works properly now after 'pane maximize'</li>
    <li> added warning message when dropping files to AFL formula window.</li>
    <li> added realtime Time&amp;Sales window (View-&gt;Time &amp; Sales, or
          right click over real time quote window)<br>
      Standard Edition: only one time &amp; sales window open <br>
      Professional Edition: no limits on simultaneously open Time &amp; Sales windows<br>
      Note that Time &amp; Sales window requires true tick-by-tick streaming data
        source (like eSignal) to operate properly. Certain feeds may not provide
        enough information to allow time&amp;sales window operation. eSignal has
        been tested and it works fine, as for the others - there will be 'compatibility
        guide' published soon.<br>
    </li>
    <li>added automatic marking on &quot;show arrows&quot; flag for old-style
      Price chart</li>
    <li> new AFL function (advanced users only)<br>
      SetChartOptions( Mode = 0, Flags = 0, gridFlags = chartGridMiddle )<br>
      allows to set/clear/overwrite/set defaults for chart pane options <br>
      <ul>
        <li>Mode - specifies how options are set:
          <ul>
            <li> 0 - set only the DEFAULT values for new chart. Defaults are
                  applied only once when chart is inserted in a new pane, so later
              you can modify any option using Indicator Builder</li>
            <li> 1 - overwrite - the values specified in 2nd and 3rd argument
              overwrite any previously set values</li>
            <li> 2 - set flag - flags specified in 2nd and 3rd parameter are
                  binary-ORed with the current values, so effectively these options
              are set while remaining are unchanged</li>
            <li> 3 - reset flag - flags specified in 3nd and 3rd parameter are
                  cleared while the others remain unchanged.<br>
            </li>
          </ul>
        </li>
        <li>Flags - allowable flags are:<br>
        chartShowDates, chartLogarithmic, chartShowArrow </li>
        <li>gridFlags - (for internal AmiBroker use - do not use it in your own
            coding as this parameter will be eventually removed) allowable values
            are: chartGridDiv100, chartGridPercent, chartGridDiv1000, chartGridMargins<br>
          chartGridMiddle, chartGrid0, chartGrid30, chartGrid70, chartGrid10, chartGrid90,<br>
          chartGrid50,chartGrid100,chartGrid20,chartGrid80,chartGrid1<br>
          <br>
          Example:<br>
          to mark &quot;Show arrows&quot; by default in a new chart use<br>
          SetChartOptions( 0, chartShowArrows );<br>
        </li>
      </ul>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.62.1 (as compared to 4.62.0)</strong></p>
  <ul>
    <li> new AFL function<br>
      ParamStyle(&quot;name&quot;, default = styleLine, mask = maskDefault ) -
        allows to select the styles applied to plot<br>
    </li>
    <li> new constants:<br>
      styleHidden - a combination of styleNoDraw | styleNoRescale<br>
      styleDashed - dashed line<br>
      to be used with ParamStyle<br>
      maskDefault - show thick, dashed, hidden, own scale styles (this is default
        mask for ParamStyle)<br>
      maskAll - show all style flags<br>
      maskPrice - show thick, hidden, own scale, candle, bar<br>
      maskHistogram - show histogram, thick, hidden, own scale,	area<br>
    </li>
    <li> colorCycle - accepted only by ParamColor function as default value,
          causes that default color cycles through red, blue, green, turquoise, gold,
          violet, bright green, dark yellow <br>
    </li>
    <li> added new setting in Preferences-&gt;Charting &quot;Ask for parameters
          of newly inserted indicators&quot;<br>
      (default = TRUE) ensures that AmiBroker displays parameter dialog when inserting
        or dropping new indicators<br>
    </li>
    <li> removed obsolete &quot;max number of custom indicators&quot; setting<br>
    </li>
    <li> Param() function accepts 6 parameters now<br>
      Param(&quot;name&quot;, defvalue, min = 0, max = 100, step = 1, sincr = 0
        );<br>
      (Only for advanced users)<br>
      a new parameter sincr is defines the increase of default value when more
        than one section of the same kind is inserted (dropped) onto the chart<br>
      For example:<br>
      Periods = Param(&quot;Periods&quot;, 15, 2, 200, 1, 10 );<br>
      Plot( MA( P, Periods ), _DEFAULT_NAME(), ParamColor( &quot;Color&quot;, colorCycle
        ), ParamStyle(&quot;Style&quot;) ); <br>
      <br>
      now when more than one moving average is dropped onto the chart then subsequent
        moving averages default to 15, 25, 35, 45, ... and so on (starting value
    is 15, increase per new section is 10)</li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.62.0 (as compared to 4.61.0)</strong></p>
  <ul>
    <li> implemented indicator drag and drop mechanism. See video tutorial: <a href="http://www.amibroker.net/video/dragdrop1.html" target="_blank">http://www.amibroker.net/video/dragdrop1.html</a></li>
    <li> new &quot;Chart&quot; tab in the workspace window (lists all AFL files
      and directories from &quot;Formulas&quot; subfolder)</li>
    <li>Automatic Analysis formula window is now drag&amp;drop target too (you
      can drag formulas and AFL files onto it)</li>
    <li>new AFL special functions used to automatically create formulas from
          code snipplets dragged onto the the indicator pane.<br>
    _SECTION_BEGIN, _SECTION_END, _SECTION_NAME, _DEFAULT_NAME, _PARAM_VALUES</li>
    <li>new styleNoTitle causing that given Plot name and values are not included
      in the title bar of the indicator</li>
    <li>new ParamField function allowing to pick price field</li>
    <li>new ParamToggle function allowing for boolean (Yes/No) parameters</li>
    <li>In Tools-&gt;Preferences , Keyboard you can how define single key shortcut
      for maximizing and restoring chart pane via View : PaneToggle</li>
    <li>&quot;Allow mixed EOD/intraday data&quot; switch does not affect N-day
      bars anymore</li>
    <li>Parameters are not reset to default values when changing the formula-
      user-edited values are kept</li>
    <li>new parameters dialog allowing using sections (for example from drag&amp;drop
      generated code)</li>
    <li> parameters dialog displays the items in the order as they appear in
      the formula</li>
    <li>fixed Y-axis scale shrinking problem occuring when styleOwnScale was
          used for all plots<br>
    </li>
    <li>Insert-&gt;Standard Charts, Insert-&gt;Custom Indicators menu options
          removed (now everything is handled by drag &amp; drop) (You can still insert
          old indicators from Indicator Builder dialog though)<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.61.0 (as compared to 4.60.4)</strong></p>
  <ul>
    <li> custom time interval support extended to N-day bars.<br>
        <br>
      Now you can define N-day bars in Preferences (Intraday tab) as well as you
        can use N-day bars via TimeFrame functions. For example<br>
      TimeFrameSet( 3 * inDaily ); // switch to 3-day time frame <br>
      <br>
      VERY IMPORTANT:<br>
      inWeekly constant is now 432001 ( 5*inDaily + 1 ) - in previous version it
        was 432000<br>
      inMonthly constant is now 2160001 ( 25*inDaily + 1 ) - in previous version
        it was 2160000<br>
        <br>
      It is changed because now N-day custom intervals are supported and they will
        interfere with weekly/monthly.<br>
      Note that 5*inDaily is now DIFFERENT than inWeekly. 5*inDaily creates 5-day
        bars that DO NOT necesarily cover Monday-Friday <br>
      while inWeekly ALWAYS creates bars that begin on Monday and end on Friday.
        Also 25*inDaily creates 25-day bars that DO NOT necesarily represent full
        month, while inMonthly always begins with first day of the month and ends
        at the last day of the month<br>
      <br>
      CAVEAT:<br>
      if your code uses hard-coded numbers like 432000 for weekly and 2160000 for
        monthly then you MUST change your code to use inWeekly constant and inMonthly
        constant instead.<br>
      <br>
    </li>
    <li> Study properties dialog has now new checkbox<br>
&quot;Lock position&quot; - when checked study can not be moved or re-sized<br>
    </li>
    <li> ExitAtStop has a new meaning for N-BAR stop type.<br>
      If ExitAtStop = 0 then N-bar stop has the lowest priority (so if for example
          profit target stop is hit on the same bar then profit target is evaluated
          first)<br>
      If ExitAtStop = 1 then N-bar stop has highest priority and it is evaluated
        before all other stops.<br>
      The same effect is obtained by checking &quot;Has priority&quot; box in AA
        Settings window.<br>
      <br>
    </li>
    <li>new maximizing/restoring chart pane functionality available via:<br>
      View-&gt;Pane-&gt;Maximize<br>
      View-&gt;Pane-&gt;Restore<br>
      as well as via right click menu.<br>
      <br>
      Remember that you can assign your own keyboard shortcuts for that using Tools-&gt;Preferences-&gt;Keyboard<br>
    </li>
    <li> New drawing tool: Arrow<br>
      - draws a line that ends with an arrow<br>
    </li>
    <li>New drawing tool: zig-zag line <br>
      draws a series of connected trend lines (Hint: press ESC key to finish the
          series)<br>
    </li>
    <li> new File functions in AFL:<br>
        <ul>
          <li><strong>fdelete</strong>( &quot;filename&quot; ) - deletes file<br>
&quot;filename&quot; is path to the file name (relative or full path).<br>
            If just file name without path is specified then AmiBroker directory
            is used, returns TRUE if file successfully deleted, FALSE otherwise<br>
          </li>
          <li> <strong>fmkdir</strong>( &quot;dirname&quot; ) - creates (makes)
                a directory<br>
&quot;dirname&quot; specifies path of the directory to be created. Please note
    that this function creates only ONE directory at a time.<br>
            So if you want to create nested directory tree you have to call it multiple
            times, for example to create C:\MyDirectory\MySubDirectory folder you
            have to call it twice:<br>
            <br>
            <code> fmkdir( &quot;C:\\MyDirectory&quot; );<br>
            fmkdir( &quot;C:\\MyDirectory\\MySubDirectory&quot; );</code><br>
            <br>
            Note also that it is safe to call it even if directory already exists
            (then no change to file system is applied)<br>
            Returns TRUE if directory successfully created, FALSE otherwise<br>
          </li>
          <li><strong> frmdir</strong>( &quot;dirname&quot; ) - removes a directory<br>
&quot;dirname&quot; specifies path of the directory to be removed. Please note
    that this function removes only ONE directory at a time.<br>
            So if you want to remove nested directory tree you have to call it multiple
            times, for example:<br>
            <br>
            <code> fmkdir( &quot;C:\\MyDirectory\\MySubDirectory&quot; ); //
                delete nested subdir first<br>
            fmkdir( &quot;C:\\MyDirectory&quot; );</code><br>
            <br>
            Note that directory must be empty before removing it otherwise it will
            not be possible to remove it.<br>
          Returns TRUE if directory successfully removed, FALSE otherwise</li>
        </ul>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.60.3 (as compared to 4.60.2)</strong></p>
</div>
<ul>
  <li>
     third point in 3-point drawing tools like triangle, pitchfork
      and fib extensions is now snapped precisely when snap-to-price is enabled</li>
  <li>
     user can override the maximum number of bars per symbol that AB allows </li>
</ul>

  <p><strong>CHANGES FOR VERSION 4.60.2 (as compared to 4.60.1)</strong></p>
  <ul>
    <li> october appears on date axis on weekly charts</li>
    <li> fixed small issue with returning global variables from functions (problem
      appeared in 4.60.1 only)</li>
    <li> zero level in performance grid is plotted with default grid color</li>
    <li> fixed adding separator characted when percent scale is used</li>
    <li> fixed problem with N/A results occuring when trade size limit by symbol
      volume was hit and round lot size was set to zero.</li>
    <li> Title variable templates: making Title statements easy.<br>
      Now you can embed special tokens in Title variable <br>
      that are replaced by appropriate values at run-time.<br>
      if you use {{VALUES}} inside Title string<br>
      it will be replaced by automatic-values generated by Plot function calls.<br>
      if you use {{NAME}} it will be replaced by ticker symbol.<br>
      if you use {{DATE}} it will be replaced by selected date<br>
      if you use {{INTERVAL}} it will be replaced by name of the interval<br>
      Example: <br>
      Title = &quot;{{NAME}} - {{INTERVAL}} {{DATE}} - MyChart : {{VALUES}}&quot;;<strong><br>
    </strong></li>
    <li> added information about the length of the cycle (in bars) when using<br>
    cycle drawing tool</li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.60.1 (as compared to 4.60.0)</strong></p>
  <ul>
    <li> AA-&gt;Settings-&gt;Portfolio &quot;Disable trade size limit if data
        bar has the volume of zero&quot; (true by default). When it is turned ON
        and the entry bar volume is zero<br>
      the backtesterwill not apply the &quot;limit trade size as % of entry bar
      volume&quot;- this is to allow backtesting mutual funds that come with zero
      volume data When it is OFF and entry bar volume is zero then backtester will
      not allow to enter the trade on such bar.<br>
    </li>
    <li>AA-&gt;Settings-&gt;Portfolio &quot;Use Previous Bar Equity For Pos Sizing&quot; and
        new field supported by SetOption/GetOption:<br>
&quot;UsePrevBarEquityForPosSizing&quot; <br>
      Affects how percent of current equity	position sizing is performed.<br>
      False (default value) means: use current (intraday) equity to perform position
      sizing,<br>
      True means: use previous bar closing equity to perform position sizing<br>
    </li>
    <li> cosmetic issues: <br>
      - replaced &quot;stock&quot; with &quot;symbol&quot; in some strings<br>
      - fixed minor painting problem occuring with cycle study drawn on intraday
      charts<br>
      - using SelectedValue function does not grow future bar requirements anymore<br>
    </li>
    <li> added StaticVarGetText to make using text static variables easier<br>
      <a href="http://www.amibroker.com/f?staticvargettext">http://www.amibroker.com/f?staticvargettext</a><br>
    </li>
    <li> new built-in chart: Relative Performance - use right-click &quot;Parameters&quot; to
        change the ticker list.<br>
    </li>
    <li> ATR uses more bars now when quickafl is on <br>
    </li>
    <li> scoreNoRotate is now highlighted in AFL editor<br>
    </li>
    <li> fixed problem with access violations occuring sometimes when calling
        the same function many times in single line and return statement in the
        form: return varname;<br>
    </li>
    <li>Status function supports now<br>
&quot;firstvisiblebar&quot;, &quot;lastvisiblebar&quot;, &quot;firstvisiblebarindex&quot;, &quot;lastvisiblebarindex&quot;<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.60.0 (as compared to 4.59.0)</strong></p>
  <ul>
    <li> fixed problem with not displaying 3D charts when profit was &gt;1000% <br>
      (comma used as a thousand separator was causing problems - now the separator
        is removed from the data file)<br>
    </li>
    <li> O3G 3D graphing program improvements:
        <ul>
          <li> optional flat orthogonal view</li>
          <li> translucent water level surface. You can move water level using
              PageUp/PageDown keys and/or toolbar buttons Thanks to Mark Feierstein
            for suggesting this.</li>
          <li> sizing and centering works much better now</li>
          <li> better font spacing/sizing </li>
          <li> you can now view the 3D chart of ANY statistic from optimization
              results just CLICK on the list column HEADER you wish to chart and
              then choose Report-&gt;3D graph and you will see the chart of selected
              metric.<br>
          </li>
        </ul>
    </li>
    <li>charting improvements
        <ul>
          <li> when text tool is active, selecting other tool automatically accepts
              the text tool entry (no need for additional click on a chart to accept).
            (You can of course abandon edits by pressing ESC key)</li>
          <li>trend-line bug (affecting other drawing tools) eliminated. (sometime
              on multi-chart and multi-symbol setups the trendline randomly become
            almost horizontal, now it is fixed)</li>
          <li>new drawing tool: CYCLE study<br>
          - pick start and end points and AmiBroker will plot 30 equally-spaced
          cycles toward the past and 30 cycles towards the future</li>
          <li>new drawing tool: Fibonacci Extensions (Price) <br>
          - pick start and end point of the controlling trend line, then pick THIRD
            point where extension lines will start<br>
          </li>
          <li> new drawing tool: Fibonacci Time Extensions<br>
          - pick start and end point and AmiBroker will plot time cycle lines that
            will represent fibonacci ratios multiplied by the number of bars between
            start and end point<br>
          </li>
          <li>drawing three point objects (triangle, pitchfork, and Fib Extensions)
              simplified(now you can just click in three places - it is easier
              for the beginners than clicking, holding down and dragging as it
            worked previously. Old mode of operation works too)</li>
        </ul>
    </li>
    <li> minor other fixes<br>
      - % sign appears again on grids using percent style<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.59.0 (as compared to 4.58.0)</strong></p>
  <ul>
    <li> added 3D, animated surface graph showing 2-parameter optimization results <br>
      (Automatic Analysis, Optimize button menu -&gt; View 3D optimization graph<br>
      <br>
      O3G - the 3D graphing program is pretty self-explaining.<br>
      Please note that you can move/rotate/animate the surface plot by mouse, keyboard
      and toolbar buttons.<br>
      <br>
      Mouse controls:<br>
      - to Rotate - hold down LEFT mouse button and move in X/Y directions<br>
      - to Zoom-in, zoom-out - hold down RIGHT mouse button and move in X/Y directions<br>
      - to Move (translate) - hold down LEFT mouse button and CTRL key and move
      in X/Y directions<br>
      - to Animate - hold down LEFT mouse button, drag quickly and release button
      while dragging<br>
      <br>
      Keyboard controls:<br>
      SPACE - animate (auto-rotate)<br>
      LEFT ARROW KEY - rotate vert. left<br>
      RIGHT ARROW KEY - rotate vert. right<br>
      UP ARROW KEY - rotate horiz. up<br>
      DOWN ARROW KEY - rotate horiz. down<br>
      NUMPAD + (PLUS) - Near (zoom in)<br>
      NUMPAD - (MINUS) - Far (zoom out)<br>
      NUMPAD 4 - move left<br>
      NUMPAD 6 - move right<br>
      NUMPAD 8 - move up<br>
      NUMPAD 2 - move down<br>
      <br>
      You can also copy the image as bitmap using Edit-&gt;Copy image <br>
    </li>
    <li>intraday bar's portfolio equity (IBPE) is calculated from current bar
        open price (IBPE is used only to calculate position size values when %
        of portfolio is specified and reported only in 'detail log' mode). end-of-bar
        equity (reported by equity chart) is calculated from close price (as it
        always was)<br>
    </li>
    <li> status bar is automatically shown when Crosshair tool is turned on</li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.58.0 (as compared to 4.57.0)</strong></p>
  <ul>
    <li> 9 new AFL functions: <br>
        <br>
      <strong>NoteGet</strong>( &quot;Symbol&quot; );<br>
      - retrieves note linked to &quot;symbol&quot;. If symbol is &quot;&quot; (empty
      string) then current symbol is used<br>
      <br>
      <strong>NoteSet</strong>( &quot;Symbol&quot;, &quot;Text...&quot; );<br>
      - sets text of the note linked to &quot;symbol&quot;. <br>
      If symbol is &quot;&quot; (empty string) then current symbol is used. <br>
      <br>
      If you overwrite note from AFL level that is opened at the same time in Notepad
      editor the editor will ask you (when you switch the focus to it) if it should
      reload new text or allow to save your manually entered text. <br>
      <br>
      Example:<br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#0000ff>NoteSet</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"AMD"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>"Jun
      15, 2004: AMD will deliver its first multi-core processors next year"</FONT><FONT COLOR=#000000>);</FONT></CODE><br>
      <br>
      <strong>ClipboardSet</strong>( &quot;Text&quot; );<br>
      - copies the &quot;text&quot; to the Windows clipboard<br>
      <br>
      <strong>ClipboardGet</strong>()<br>
      - retrieves current contents of Windows clipboard<br>
      <br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#008000>// this can be used
      to put dynamically-constructed texts into</FONT><FONT COLOR=#000000> <BR>
      </FONT><FONT COLOR=#008000>// clipboard</FONT><FONT COLOR=#000000> <BR>
      </FONT><FONT COLOR=#008000>// </FONT><FONT COLOR=#000000> <BR>
      </FONT><FONT COLOR=#0000ff>ClipboardSet</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#ff00ff>"The
        price of "</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#0000ff>FullName</FONT><FONT COLOR=#000000>()
      + </FONT><FONT COLOR=#ff00ff>" is "</FONT><FONT COLOR=#000000> + </FONT><FONT COLOR=#000000><B>Close</B></FONT><FONT COLOR=#000000> );</FONT></CODE><br>
      <br>
      <strong>VarSet</strong>( &quot;varname&quot;, value )<br>
      - sets the value of dynamic variable*<br>
      <br>
      <strong>VarGet</strong>( &quot;varname&quot; )<br>
      - gets the value of dynamic variable*<br>
      <br>
      <strong>StaticVarSet</strong>( &quot;varname&quot;, value )<br>
      <strong>StaticVarSetText</strong>( &quot;varname&quot;, &quot;value&quot; )<br>
      - sets the value of static variable**<br>
      <br>
      <strong>StaticVarGet</strong>( &quot;varname&quot; )<br>
      - gets the value of static variable**<br>
      <br>
      * <em>Dynamic variables</em> are variables that are named dynamically, typically
      by creating a variable name from a static part and a variable part. For example,
      the following example dynamically constructs the variable name from a variable
      prefix and a static suffix.<br>
      <br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#800000><B>for</B></FONT><FONT COLOR=#000000>(
        i = </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>; i &lt; </FONT><FONT COLOR=#ff00ff>10</FONT><FONT COLOR=#000000>;
        i++ ) <BR>
      { <BR>
        </FONT><FONT COLOR=#0000ff>VarSet</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#ff00ff>"C"</FONT><FONT COLOR=#000000>+i, </FONT><FONT COLOR=#0000ff>Ref</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>,
        -i ) ); <BR>
      } <BR>
      <BR>
        </FONT><FONT COLOR=#008000>// creates variables C1, C2, C3, C4, ...., C10
        equal to Ref( C, -1 ), Ref( C, -2 ),&nbsp;&nbsp;&nbsp;..., Ref( C, -10
        )</FONT><FONT COLOR=#000000> <BR>
        </FONT><FONT COLOR=#008000>// respectively</FONT></CODE><br>
      <br>
      ** <em>Static variable </em>- the variable has static duration (it is allocated
      when the program begins and deallocated when the program ends)<br>
      and initializes it to Null unless another value is specified. Static variables
      allow to share values between various formulas.<br>
      Only NUMBER and STRING static variables are supported now (not ARRAYS).<br>
    </li>
    <li>new Preferences: Intraday setting<br>
&quot;Override: Weekly/monthly bars use day of last trade&quot;<br>
      when checked (default) then weekly/monthly charts always use timestamp of
      the day of last trade within a week/month (may not be Friday or last day
      of the month) regardless of what is set in &quot;Time stamp of compressed
      intraday bars shows&quot; radio buttons<br>
      If you uncheck this box and &quot;time stamp of compressed intraday bar&quot; is
      set to END TIME of the interval, then weekly bars will be time-stamped with
      last day of the week (sunday) and monthly bars will be time-stamped with
      last day of the month regardless if trading has occured on that day or not.<br>
    </li>
    <li> AddToComposite now by default deletes all previous data instead of setting
        existing fields to zero at the start of the scan.<br>
      The flag default flag 1 has now the name of atcFlagDeleteValues the old flag
      (now optional) atcFlagResetValues now has value of 32. Most formulas using
      ATC should not be affected by that change.<br>
    </li>
    <li>AA: Settings: &quot;Pad and align to reference symbol&quot; is now available
        for all AA modes (not only portfolio backtest).<br>
      This allows for example to turn on aligning when running scans with AddToComposite
      and thus ensuring that data holes do not generate valleys in composites.
      This is useful to create intraday composites when data holes/misalignment
      is often. (when creating intraday composites it is now recommended to check
      alignining as well as changing &quot;Time compressed bars use START (or END)
      time of interval&quot; in Tools-&gt;Preferences-&gt;Intraday)<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.57.0 (as compared to 4.56.1)</strong></p>
  <ul>
    <li> profit distribution chart took a bit long when profits were extremely
      large - now it is fixed</li>
    <li> changed vertical line selection code to prevent line disappearing after
      RT update</li>
    <li> vertical line selection is now working fine in multiple linked windows
      displaying different time frames</li>
    <li>chart panes can be now moved up/down using View-&gt;Pane-&gt;Move Up/Down
      without need to re-insert everything to change the order</li>
    <li>fixed 'approx. X days' text in the &quot;Database Settings&quot; window
      that reported wrong values in versions 4.53..4.56</li>
    <li> when &quot;show arrows&quot; option is selected in AA window then correct
        interval is selected in the chart (it was not functioning properly for
      beta versions 4.53..4.56 and intraday data)</li>
    <li> added Notepad window (View-&gt;Notepad) that allows to store free-text
        notes about particular security. Just type any text and it will be automatically
        saved / read back as you browse through symbols. Notes are global and are
        saved in &quot;Notes&quot; subfolder as ordinary<br>
    text files.</li>
    <li> implemented browser-like history Back/Forward in menu View-&gt;History
        and in the toolbar,(keyboard shortcuts Back: Ctrl+Alt+LEFT, Forward: Ctrl+Alt+RIGHT,
        you can change it in Tools-&gt;Prefs-&gt;Keyboard) Please note that due
        to customization features of the toolbar on old installations the Back/Forward
        buttons will not appear unless added manually (click with RIGHT mouse button
        over standard toolbar, select &quot;CUSTOMIZE&quot; menu and add Back/Forward
        buttons.)<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.56.1 (as compared to 4.56.0)</strong></p>
  <ul>
    <li> fixed crash at address: 0x474f54</li>
    <li> fixed K-ratio calculation. Now follows exactly corrected Excel sheet
        from page 89 of &quot;Quantitative Trading Strategies&quot; by Lars Kestner
      (published 2003).</li>
    <li> because of many people not reading the comment regarding new &quot;Limit
        trade size as % of entry bar volume&quot; setting, implemented checking
        for volume = 0 in data files. If volume is equal to 0 in your data file
        then this trade size limit does not apply.<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.56.0 (as compared to 4.55.1)</strong></p>
  <ul>
    <li> fixed crash when RT quote window ticker list contained symbol that did
        not exist in the database<br>
    </li>
    <li> added Toolbar customization:<br>
      right-click over any toolbar and choose &quot;CUSTOMIZE&quot; menu to add/remove/arrange
      toolbar buttons. You can also press ALT key and move/arrange buttons within
      one toolbar without needing to open &quot;customize&quot; dialog<br>
    </li>
    <li> eSignal plugin 1.7.1: fixed problem with zero data when the user selected
        not enough bars to load (mixed mode requires a bit more bars)<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.55.1 (as compared to 4.55.0)</strong></p>
  <ul>
    <li> implemented workaround to Windows XP status bar display problem causing
        plugin status indicator not 'disappearing' sometimes<br>
    </li>
    <li>fixed problem with crash sometimes occuring when calling Import() OLE
        automation method<br>
      when AB was not running.<br>
      Versions 4.54-4.55 are localization-enabled and month names are localized
      too, localized strings have to be setup at the start of the program, but
      this was working correctly only if GUI was launched. When creating AB OLE
      object without GUI month name string were not<br>
      set-up correctly and this caused problems. (This fixes problems with CSI/UA
      export as well as AQ trying to import to non-existing instance of AB)<br>
    </li>
    <li> fputs/fgets/fclose/feof file functions are now protected against using
        null file handle<br>
      (common coding error among AFL users)<br>
    </li>
    <li> Parameter names are not truncated in the parameter list <br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.55.0 (as compared to 4.54.0)</strong></p>
  <ul>
    <li> Median and Percentile calculations include current bar</li>
    <li> new symbols added via CategoryAddSymbol trigger workspace ticker list
        refresh<br>
    </li>
    <li> calling COM methods returning nothing (void) does not cause &quot;type
        mismatch&quot; message<br>
    </li>
    <li> duplicate parameters are no longer produced when user specifies parameter
        names with trailing/leading spaces in Param()/ParamStr()/ParamColor() <br>
    </li>
    <li> now it is safe to call AB.RefreshAll() from inside of AmiBroker because
        this method is protected against locking up / looping by not allowing consequent
      refresh if previous refresh occured in less than one second</li>
    <li> Parameters window now is resizable</li>
    <li> Parameters window now support date and time parameters.<br>
      Corresponding new AFL functions are:<br>
      <br>
      ParamDate( &quot;Name&quot;, &quot;Default date&quot;, format = 0 ); <br>
      <br>
      where:<br>
&quot;Name&quot; is a string holding parameter name<br>
&quot;Default date&quot; is a string holding date in any any format:<br>
      YYYY-MM-DD<br>
      MM/DD/YY<br>
      DD-MM-YY<br>
      etc, etc.<br>
      <br>
      format - defines return value format, allowable values are:<br>
      0 - return value is a NUMBER and holds DateNum. Ie: 990503 for May 3, 1999,<br>
      1 - return value is a STRING formatted holding date according to your windows
      regional settings<br>
      <br>
      ParamTime( &quot;Name&quot;, &quot;Default time&quot;, format = 0 );<br>
      where:<br>
&quot;Name&quot; is a string holding parameter name<br>
&quot;Default time&quot; is a string holding date in any of the following formats:<br>
      HH:MM:SS<br>
      HH:MM<br>
      <br>
      format - defines return value format, allowable values are:<br>
      0 - return value is a NUMBER and holds TimeNum. Ie: 133515 for 13:35:15 <br>
      1 - return value is a STRING formatted holding time according to your windows
      regional settings<br>
      <br>
      <br>
      Examples:<br>
      <code>Title = WriteVal( ParamDate(&quot;ParamDateAsDateNum&quot;,&quot;2004-05-14&quot;),
      7.0 );<br>
    Title = ParamDate(&quot;ParamDateAsString&quot;,&quot;2004-05-17&quot;,1); </code></li>
  </ul>
  <ul>
    <li> portfolio/individual backtester/optimizer, new setting in AA-&gt;Settings-&gt;Portfolio:<br>
&quot;Limit trade size as % of entry bar volume&quot; (default = 10%)<br>
      <br>
      This prevents from entering the trades greater than given percentage of entry
      bar's volume.<br>
      For example if backtesting daily data and today's volume for thinly traded
      stock is 177,000 shares, setting this to 10% will limit the maximum trade
      size to 17,700 shares (10% of total daily volume). This prevents from 'affecting
      the market'<br>
      by huge orders. <br>
      <br>
      IMPORTANT NOTE:<br>
      Some instruments like MUTUAL FUNDS come without VOLUME data. To backtest
      such instruments please set this field to ZERO (0). This effectively turns
      OFF this feature. Otherwise you won't be able to enter any trade at all.
      Suggestions are welcome how to handle this problem automatically (maybe just
      detect if bar's volume is ZERO and then allow entering any size?)<br>
    </li>
    <li> K-ratio calculation changed following the change made by its creator,
        Mr. Lars Kestner.<br>
        <br>
      Quoting from the book &quot;Quantitative Trading Strategies&quot; from 2003
      by Lars Kestner:<br>
        <em><br>
      [ - - - ]<br>
&quot; The K-ratio is a unitless measure of performance that can be compared
  across markets and time periods. [ - - - ] Traders should <br>
      search for strategies yielding K-ratios greater than +0.50. Together, the
      Sharpe ratio and K-ratio are the most important<br>
      measures when evaluating trading strategy performance. Note: When I created
      the K-ratio in 1996, I thought I had created a <br>
      robust measure to evaluate performance. In mid-2000, trader Bob Fuchs brought
      a small error to my attention regarding the <br>
      scaling of the K-ratio. He was correct in his critique and I have corrected
      the error in this text. Publications prior to 2002 will <br>
      show a different formula for the K-ratio. The updated formula in this book
      is correct.&quot; </em>
      <p>Mr Lars Kestner has corrected his formula based on this critique:</p>
        K-ratio = slope / ( sterr * per )
        <p>slope: Linear regression slope of equity line <br>
        sterr: Standard error of slope<br>
      per: Number of periods in the performance test</p>
        <p>Special thanks to Jeremy Berkovits who brought that to my attention.<br>
      </p>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.54.0 (as compared to 4.53.1)</strong></p>
  <ul>
    <li>&quot;Allow mixed EOD/intraday data&quot; mode added (controllable from
        File-&gt;Database Settings-&gt;Intraday, checkbox with the same name) it
        allows to work with database that has a mixture of intraday and EOD data
        in one data file. If this is turned on then in intraday modes EOD bars
        are removed on-the-fly and in daily mode EOD bars are displayed instead
        of time compressed intraday or if there is no EOD bar for corresponding
        day then intraday bars are compressed as usual.
        <p> This mode works in conjunction with new versions of plugins that
            allow mixed data. Mixed mode is now supported by MarketCast plugin
          (1.1 or higher)(Australia) and eSignal plugin (1.7.0 or higher) only.</p>
        <p> Mixed mode allows intraday plus very long daily histories in one
          database.</p>
        <p> Note that this is EXPERIMENTAL feature. </p>
        <p>+ Real-Time quote window enhanced<br>
        Now only fields that are changed change the background to 'yellow' and
          if the value in given field increases then it is displayed in green if
          decreases then is displayed in red. This allows easy identification of
        movement.</p>
        <p>+ all strings in the program moved to resources for easy localization </p>
        <p>+ fixed problem with SetForeign()+FullName() returning symbol instead
          of full name of foreign security.</p>
        <p>+ added new AFL function IsContinuous() to check if &quot;continuous&quot; flag
          is turned on in Symbol-&gt;Information window</p>
        <p>+ OLE properties can be retrieved (DISPATCH_PROPERTYGET) directly
            from AFL now using parameterless function syntax. This allows reading
          values exposed by OLE automation directly from AFL code. Example:</p>
        <p> <CODE><FONT COLOR=#000000>AB = </FONT><FONT COLOR=#0000ff>CreateObject</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"Broker.Application"</FONT><FONT COLOR=#000000>); <BR>
        Stocks = AB.Stocks(); </FONT><FONT COLOR=#008000>// get collection</FONT><FONT COLOR=#000000> <BR>
        Stock = Stocks.Item( </FONT><FONT COLOR=#0000ff>Name</FONT><FONT COLOR=#000000>()
        ); </FONT><FONT COLOR=#008000>// currently selected</FONT><FONT COLOR=#000000> <BR>
        <BR>
        </FONT><FONT COLOR=#ff00ff>"FullName : "</FONT><FONT COLOR=#000000> +
          Stock.FullName(); <BR>
        </FONT><FONT COLOR=#ff00ff>"Alias : "</FONT><FONT COLOR=#000000> + Stock.Alias(); <BR>
        </FONT><FONT COLOR=#ff00ff>"Address : "</FONT><FONT COLOR=#000000> +
          Stock.Address(); <BR>
        </FONT><FONT COLOR=#ff00ff>"Shares: "</FONT><FONT COLOR=#000000> + Stock.Issue(); <BR>
        </FONT><FONT COLOR=#ff00ff>"Book value: "</FONT><FONT COLOR=#000000> +
          Stock.BookValue(); <BR>
        </FONT><FONT COLOR=#ff00ff>"Market : "</FONT><FONT COLOR=#000000> + Stock.MarketID(); <BR>
        </FONT><FONT COLOR=#ff00ff>"WebID : "</FONT><FONT COLOR=#000000> + Stock.WebID();</FONT></CODE></p>
        <p> You can check if OLE object is valid by calling IsNull() function,
          example:</p>
        <p> <CODE><FONT COLOR=#000000>AB = </FONT><FONT COLOR=#0000ff>CreateObject</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"Broker.Application"</FONT><FONT COLOR=#000000>); <BR>
        Stocks = AB.Stocks(); </FONT><FONT COLOR=#008000>// get collection</FONT><FONT COLOR=#000000> <BR>
        Stock = Stocks.Item( </FONT><FONT COLOR=#ff00ff>"INTC"</FONT><FONT COLOR=#000000> ); <BR>
        <BR>
        </FONT><FONT COLOR=#800000><B>if</B></FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#0000ff>IsNull</FONT><FONT COLOR=#000000>(
        Stock ) ) <BR>
        { <BR>
&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"COM
  object invalid (Null) - symbol does not exist\n"</FONT><FONT COLOR=#000000>); <BR>
        } <BR>
        </FONT><FONT COLOR=#800000><B>else</B></FONT><FONT COLOR=#000000> <BR>
        { <BR>
&nbsp;&nbsp;</FONT><FONT COLOR=#0000ff>printf</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#ff00ff>"COM
  object valid - you can access its methods\n"</FONT><FONT COLOR=#000000>); <BR>
      }&nbsp;&nbsp;</FONT></CODE></p>
        <p>+ IsEmpty/IsNull and IsTrue functions operate with scalars and OLE
            dispatches without upsizing them to array<br>
      </p>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.53.1 (as compared to 4.53.0)</strong></p>
  <ul>
    <li> addressed problem with broker.layers file. Now version 4.53.1 correctly
        reads broker.layers file saved with older versions however note that old
      versions are not compatible with new format.</li>
    <li>layer properties dialog provides more comfortable setting of layer visibility </li>
    <li> other minor fixes<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.53.0 (as compared to 4.52.0)</strong></p>
  <ul>
    <li> per-group intraday settings (filtering/daily compression) Use Symbol-&gt;Categories: &quot;GROUP&quot; -&gt; Use
        own intraday settings, click<br>
      on &quot;Intraday settings&quot; button to define intraday settings specific
      to given group.<br>
    </li>
    <li>intraday settings now allow to specify separate day (RTH) and night (ETH)
        sessions<br>
    </li>
    <li>time filtering now allows to display:<br>
      a) 24 hours trading (no filtering)<br>
      b) day session only<br>
      c) night session only<br>
      d) day and night sessions only<br>
    </li>
    <li>new intraday time compression mode: Day/Night - shows two bars (day and
        night) per day<br>
    </li>
    <li> daily compression can be now based on<br>
      a) exchange time (available since 4.00)<br>
      b) local time (available since 4.50)<br>
      c) day/night session times definable by the user (new)<br>
    </li>
    <li>when &quot;activatestopsimmediately&quot; is turned ON then cash from
        stopped out positions is NOT available to enter trades the same day<br>
    </li>
    <li> easy access to selected category settings from Symbol-&gt;Information
        window.<br>
    </li>
    <li>Workspace tree supports in-place editing of market, group, sector, industry
        and watch list names. Single click on category name and just enter the
        name<br>
    </li>
  </ul>
  <p><strong>CHANGES FOR VERSION 4.52.0 (as compared to 4.51.1)</strong></p>
  <ul>
    <li> fixed problem with fixup=0 and handling multiple data holes in a row<br>
    </li>
    <li>added new commands to ASCII format definitions:<br>
      $MINTICKERLEN &lt;number&gt; - defines minimum accepted length of the ticker
      symbol<br>
      $MAXTICKERLEN &lt;number&gt; - defines maximum accepted length of the ticker
      symbol <br>
      For example ASX users may wish to use<br>
      $MAXTICKERLEN 3<br>
      to make sure that ASCII importer accepts only symbols that have no more than
      3 characters (this excludes ASX options and warrants)<br>
    </li>
    <li>fixed problem with incorrect very first value of the array returned by
        variable-period version of HHV/LLV <br>
    </li>
    <li>fixed Procedure/function parameter overwrite issue when using built-in
        price arrays and variable overwrite issue<br>
    </li>
    <li> memory allocated for return value is marked for earlier freeing so calling
        user-defined functions inside loops should consume less memory <br>
    </li>
    <li> Interval() function enhanced. Now accepts format parameter:<br>
      Interval( format = 0 );<br>
      possible values:<br>
      format = 0 - returns bar interval in seconds<br>
      format = 1 - as above plus TICK bar intervals are returned with negative
      sign<br>
      so Interval() function applied to 10 tick chart will return -10<br>
      format = 2 - returns STRING with name of interval such as &quot;weekly/monthly/daily/hourly/15-minute/5-tick&quot;<br>
    </li>
    <li> vertical quote selection line in linked windows is now independent <br>
    </li>
    <li>changing &quot;same day stops&quot; via SetOption(&quot;ActivateStopsImmediately&quot;)
        in portfolio backtest mode has an effect now (previously reacted only on
        manual settings)<br>
    </li>
    <li> SetOption(&quot;CommissionMode&quot;, mode ) works now in portfolio
        mode too (previously worked<br>
      in old backtest mode only)<br>
    </li>
    <li> SetOption(&quot;CommissionAmount&quot;, amount ) works now in portfolio
        mode too (previously worked<br>
      in old backtest mode only)<br>
    </li>
    <li> $SEPARATOR command in ASCII importer definitions now allows to import
        files that have fields separated by more than one separator characters
        Separator string (array of characters) must be enclosed in quotation marks.
        If there is only one separator character (as in old versions) then quotation
        marks are needed.<br>
      For example files with joined date and time<br>
      <br>
      $SEPARATOR &quot;, &quot;<br>
      $FORMAT DATE_YMD,TIME,OPEN,HIGH,LOW,CLOSE<br>
      <br>
      will be able to import file like this:<br>
      2004-02-04 12:30,3.41,3.44,3.40,3.42 <br>
      (note date and time field are separated by space not by comma)<br>
    </li>
    <li>Import wizard now supports new separators 'comma or space', 'semicolon
        or space' and 'tab or space' <br>
    </li>
    <li> ASCII importer and Quote Editor properly <br>
      distinguish records with time specified as 00:00:00 from EOD records (without
      time)</li>
  </ul>
  <p>&nbsp;</p>
  <p><strong>CHANGES FOR VERSION 4.51.1 (as compared to 4.51.0)</strong></p>
  <ul>
    <li> OLE interface methods numbering adjusted to maintain backward compatibility
        with previous versions and other programs referring to old OLE interface<br>
    </li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.51.0 (as compared to 4.50.10)</b></p>
  <ul>
    <li>OLE automation interface changes:
        <p> Analysis.Backtest and Analysis.Optimize now support new &quot;Type&quot; parameter.<br>
        Type can be one of the following values:<br>
        0 : portfolio backtest/optimize<br>
        1 : individual backtest/optimize<br>
        2 : old backtest/optimize<br>
        <br>
        For backward compatibility Type parameter is optional and defaults to 2<br>
      (old backtest/optimize)</p>
        <p> Example code:<br>
            <br>
        AB = new ActiveXObject(&quot;Broker.Application&quot;);<br>
        AB.Analysis.Backtest( 0 ); // perform portfolio backtest<br>
      AB.Analysis.Optimize( 0 ); // perform portfolio optimize</p>
    </li>
    <li>
      <p> OLE automation interface new object: &quot;Commentary&quot;<br>
            <br>
        This object has 5 methods:<br>
        - BOOL LoadFormula( STRING pszFileName ) - loads the formula<br>
        - BOOL SaveFormula( STRING pszFileName ) - saves the formula<br>
        - void Apply() - displays the commentary <br>
        - BOOL Save( STRING pszFileName ); - saves commentary output (result) to
        the file (use after call to Apply())<br>
      - void Close() - closes the commentary window</p>
      <p> Commentary object is accessible from Broker.Application object via
        Commentary property:</p>
      <p> Example code:<br>
          <br>
        AB = new ActiveXObject(&quot;Broker.Application&quot;);<br>
        AB.Commentary.LoadFormula(&quot;C:\\Program Files\\AmiBroker\\AFL\\MACD_c.afl&quot;);<br>
        AB.Commentary.Apply();<br>
        AB.Commentary.Save(&quot;Test.txt&quot;);<br>
        AB.Commentary.SaveFormula(&quot;MACDTest.afl&quot;);<br>
      //AB.Commentary.Close();</p>
    </li>
    <li>
      <p>AFL function Now( format = 0 ) accepts new parameter values </p>
      <p> Returns current date / time in numerous of formats: <br>
        // formats supported by old versions<br>
        format = 0 - returns string containing current date/time formatted according
        to system settings <br>
        format = 1 - returns string containing current date only formatted according
        to system settings <br>
        format = 2 - returns string containing current time only formatted according
        to system settings <br>
        format = 3 - returns DATENUM number with current date <br>
        format = 4 - returns TIMENUM number with current time <br>
        format = 5 - returns DATETIME number with current date/time <br>
        // new formats available from version 4.51<br>
        format = 6 - returns current DAY (1..31) <br>
        format = 7 - returns current MONTH (1..12)<br>
        format = 8 - returns current YEAR (four digit) <br>
        format = 9 - returns current DAY OF WEEK (1..7, where 1=Sunday, 2=Monday,
        and so on)<br>
      format = 10 - returns current DAY OF YEAR (1..366)</p>
    </li>
    <li>
      <p> Custom indicators:<br>
        If plot name is empty the value of such plot does not appear in the title<br>
      and does not appear in the data tool tip</p>
      <p> Plot( C, &quot;Price&quot;, colorWhite, styleCandle );<br>
        Plot( MA( C, 10 ), &quot;&quot;, colorRed ); // NOTE that this plot name/value
        will NOT appear in the title<br>
      Plot( MA( C, 20 ), &quot;MA20&quot;, colorGreen );</p>
    </li>
    <li>
      <p> SetOption( &quot;field&quot;, value )<br>
        accepts new fields:<br>
&quot;CommissionMode&quot; - <br>
        0 - use portfolio manager commission table<br>
        1 - percent of trade<br>
        2 - $ per trade<br>
      3 - $ per share/contract</p>
      <p> &quot;CommissionAmount&quot; - amount of commission in modes 1..3</p>
      <p> &quot;MarginRequirement&quot; - account margin requirement (as in settings),
        100 = no margin</p>
      <p> &quot;ReverseSignalForcesExit&quot; - reverse entry signal forces exit
        of existing trade (default = True )</p>
    </li>
    <li>
      <p> new AFL function: GetOption( &quot;field&quot; ) - retrieves the settings,
        accepted fields the same as in SetOption.</p>
      <p> Example:</p>
      <p> PositionSize = -100 / GetOption(&quot;MaxOpenPositions&quot;);</p>
    </li>
    <li>
      <p> new AFL function: GetRTData( &quot;field&quot; )<br>
        - retrieves the LAST (the most recent) value of the following fields<br>
        reported by streaming real time data source )<br>
        (Note 1: this function is available ONLY in PROFESSIONAL edition,<br>
        calling it using Standard edition will give you NULL values for all fields)<br>
        (Note 2: works only if data source uses real time data source (plugin)
        )<br>
        (Note 3: availablity of data depends on underlying data source<br>
        - check the real-time quote window to see if given field is available )<br>
        (Note 4: function result represents the current value at the time of the
        call<br>
        /formula execution/, and they will be refreshed depending on chart or commentary
        refresh interval<br>
        /settable in preferences/. Built-in real time quote window is refreshed<br>
      way more often (at least 10 times per second) ) </p>
      <p> Supported fields:<br>
&quot;Ask&quot; - current best ask price <br>
&quot;AskSize &quot; - current ask size<br>
&quot;Bid&quot; - current best bid price <br>
&quot;BidSize &quot; - current bid size<br>
&quot;52WeekHigh&quot; - 52 week high value<br>
&quot;52WeekHighDate&quot; - 52 week high date (in datenum format)<br>
&quot;52WeekLow&quot; - 52 week low value<br>
&quot;52WeekLowDate&quot; - 52 week low date (in datenum format)<br>
&quot;Change&quot; - change since yesterdays close<br>
&quot;Dividend&quot; - last dividend value<br>
&quot;DivYield&quot; - dividend yield<br>
&quot;EPS&quot; - earnings per share<br>
&quot;High&quot; - current day's high price<br>
&quot;Low&quot; - current day's low price<br>
&quot;Open&quot; - current day's open price<br>
&quot;Last&quot; - last trade price<br>
&quot;OpenInt&quot; - current open interest<br>
&quot;Prev&quot; - previous day close<br>
&quot;TotalVolume&quot; - total today's volume<br>
&quot;TradeVolume&quot; - last trade volume<br>
&quot;ChangeDate&quot; - datenum (YYYMMDD) of last data change<br>
&quot;ChangeTime&quot; - timenum (HHMMSS) of last data change<br>
&quot;UpdateDate&quot; - datenum (YYYMMDD) of last data update<br>
&quot;UpdateTime&quot; - timenum (HHMMSS) of last data update<br>
&quot;Shares&quot; - total number of shares </p>
      <p> Example:<br>
&quot;Bid = &quot;+GetRTData(&quot;Bid&quot;);<br>
&quot;Ask = &quot;+GetRTData(&quot;Ask&quot;);<br>
&quot;Last = &quot;+GetRTData(&quot;Last&quot;);<br>
&quot;Vol = &quot;+GetRTData(&quot;TradeVolume&quot;);</p>
      <p> &quot;EPS = &quot;+GetRTData(&quot;EPS&quot;);<br>
&quot;52week high = &quot;+GetRTData(&quot;52weekhigh&quot;);</p>
    </li>
    <li>
      <p> Custom indicators:<br>
        Default names and graph values appear in the title <br>
      when using old-style graph0, graph1, graph2 statements in the custom indicators </p>
    </li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.50.5 (as compared to 4.50.4)</b></p>
<ul>
  <li>
    very minor fixes and cosmetics</li>
</ul>

  <p><b>CHANGES FOR VERSION 4.50.4 (as compared to 4.50.3)</b></p>
  <ul>
    <li>portfolio report now shows &quot;N/A&quot; instead of -1#INF and similar
        strange looking things that appeared when there were no trades (division
      by zero)</li>
    <li>removed the extra 'z' letter in fprintf formatting sequence (that caused
      crash on exit when saving params)</li>
    <li> correct column type (alpha) is set for the first column in individual
      backtest </li>
    <li> 'show current trade arrows' works OK after portfolio backtest</li>
    <li> when timeshift is not equal zero in intraday databases then DateNum(),
        Day(), Month(), Year(), DayOfWeek() and DayOfMonth() functions adjust date
      (day) when bar time is 'shifted' outside 0..24 hour range. </li>
    <li> rotational mode: all OHLC fields in artificial future bar are filled
        with close price of last bar for consistency with regular mode and to prevent
        problems with stops hit on artificial future bar in rotational mode.<br>
    </li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.50.3 (as compared to 4.50.2)</b></p>
  <ul>
    <li> the formula names with dash '-' character are now properly displayed
      in the reports</li>
    <li>fixed problem with Equity/SetForeign (introduced in 4.50)</li>
    <li> MAE/MFE charts X-axis layout improved</li>
    <li> new report - trade list: profit, pos. size, cum. profit and profit/bar
      columns use fixed format with 2 decimal places now (no scientific format)</li>
    <li> EnableTextOutput() works again (thx. Greg)</li>
    <li> fixed rounding in Stock.NominalValue</li>
    <li> other minor fixes:<br>
      + better CRC calculation method for #include<br>
      + sellprice/coverprice are written back with updated prices for stops in
      case of Equity(1)<br>
      + fixed menu-button owner draw painting code (thx. Herman)<br>
      + progress window is displayed in single-stock optimization with new backtester
    too</li>
  </ul>
  <p></p>
  <p><b>CHANGES FOR VERSION 4.50.2 (as compared to 4.50.0)</b></p>
  <ul>
    <li> fixed problem with 'exit date' showing in fact 'entry date' in trade
      list (problem introduced in 4.50.0)</li>
    <li> fixed crash @0x482898 <br>
    </li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.50.0 (as compared to 4.49.0)</b></p>
  <ul>
    <li>old backtester uses now also &quot;MinShares&quot; Setting, so it will
        not enter trade with share position size lower than 'min. shares'. Due
        to this change. 'min. shares' setting has been moved from 'Portfolio' to
        'General' setting page.<br>
    </li>
    <li> changed handling of open positions in old backtester to match with portfolio
        backtester and equity plot:<br>
      - exit commissions are taken from open position profit (previously they were
      not taken)<br>
      - open positions are closed always at CLOSE price (previously were closed
      at trade price)<br>
    </li>
    <li> LineArray( x0, y0, x1, y1, extend = 0, usebarindex = False )<br>
      - has new parameter (usebarindex) - False by default that switches allows
        to specify x parameters as bar Indexes (as returned by BarIndex() function).<br>
    </li>
    <li>fixed problem with displaying exploration results having more than 100
        columns<br>
    </li>
    <li>portfolio backtests/optimizations should be 2x faster on average (* excluding
        scanning phase)<br>
    </li>
    <li>layout of AA window changed. Now (new) PORFOLIO backtest and PORTFOLIO
        optimize modes are default and available from &quot;Backtest&quot; and &quot;Optimize&quot; buttons.
        Other modes are available from drop down menus added to &quot;Backtest&quot; and &quot;Optimize&quot; buttons.
        Portfolio report is no longer automatically displayed after portfolio backtest.
        Please click &quot;Report&quot; button to display it. The same applies
        to portfolio equity.<br>
    </li>
    <li> layout of settings page changed. Old backtester settings moved to 'old'
        page.<br>
    </li>
    <li> new &quot;individual backtest&quot; mode: allows to run new backtester
        separately on each symbol in the selected &quot;apply to&quot; group. (Replaces
        old backtester functionality in testing multiple stocks and provides new
        reports)<br>
    </li>
    <li> settings and formula used are automatically saved after portfolio backtests<br>
    </li>
    <li> new reports are now divided into separate pages: Statistics, Charts,
        Trades, Formula, Settings, Symbols <br>
    </li>
    <li> each backtest report is now automatically stored &quot;Reports&quot; subfolder
        of AmiBroker directory. The results.rlst holds tab separated list of all
        backtests results while corresponding subdirectories hold reports of backtest.
        REMEMBER to delete old reports periodically (using Report Explorer), otherwise
        your hard disk would fill up!<br>
    </li>
    <li> New add-on program (free) included: Report Explorer that allows to browse
        / sort / view / delete results of backtests.<br>
      Available from AA window Report -&gt; Report Explorer.<br>
    </li>
    <li> new AFL function:<br>
      SetFormulaName( string )<br>
      allows to programatically change the name of the formula that is displayed
      in the backtest result explorer<br>
    </li>
    <li> fixed cases when GetChartID() used in AA did not return zero<br>
    </li>
    <li> Window-&gt;Clone has been renamed to Window-&gt;New Linked to better
        describe its function<br>
    </li>
    <li> other minor fixes<br>
    </li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.49.0 (as compared to 4.48.2)</b></p>
  <ul>
    <li> new Percentile function<br>
        <br>
      Percentile( array, period, rank )<br>
      <br>
      rank is 0..100 - defines percentile rank in the array<br>
      <br>
      Example:<br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#000000><B>Volume</B></FONT><FONT COLOR=#000000> &gt; </FONT><FONT COLOR=#0000ff>Percentile</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>Volume</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>100</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>70</FONT><FONT COLOR=#000000> );</FONT></CODE><br>
      <br>
      means: current day volume ranks within TOP 30% of volumes of last 100 bars
      (is above 70th percentile)<br>
      <br>
      <CODE><FONT COLOR=#000000></FONT><FONT COLOR=#000000><B>Volume</B></FONT><FONT COLOR=#000000> &lt; </FONT><FONT COLOR=#0000ff>Percentile</FONT><FONT COLOR=#000000>( </FONT><FONT COLOR=#000000><B>Volume</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>100</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>30</FONT><FONT COLOR=#000000> );</FONT></CODE><br>
      means: current day volume ranks within BOTTOM 30% of volumes of last 100
      bars (is below 30th percentile)<br>
      <br>
      (performance note: the implementation of percentile function involves sorting
    that is relatively slow process even though that quicksort algorithm is used)</li>
    <li> new function <br>
        <br>
      LineArray( x0, y0, x1, y1, extend = 0 )<br>
      <br>
      generates array equivalent to trend line drawn from point x0, y0 to point
      x1, y1. x coordinates are in bars (zero based), y coordinates are in dollars
      Note: x0 must be SMALLER than x1. Note 2: the function accepts only numbers
      therefore<br>
      generates single line. To produce multiple lines you have to call it many
      times with different co-ordinates.<br>
      if extend is 1 then line is right extended.<br>
      if extend is 2 then line is left extended<br>
      if extend is 3 then line is left and right extended<br>
      <br>
      Example:<br>
      <CODE><FONT COLOR=#000000>y0=</FONT><FONT COLOR=#0000ff>LastValue</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#0000ff>Trough</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>L</B></FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#ff00ff>5</FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>)); <BR>
      y1=</FONT><FONT COLOR=#0000ff>LastValue</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#0000ff>Trough</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>L</B></FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#ff00ff>5</FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>)); <BR>
      x0=</FONT><FONT COLOR=#000000><B>BarCount</B></FONT><FONT COLOR=#000000> - </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> - </FONT><FONT COLOR=#0000ff>LastValue</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#0000ff>TroughBars</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>L</B></FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#ff00ff>5</FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#ff00ff>2</FONT><FONT COLOR=#000000>)); <BR>
      x1=</FONT><FONT COLOR=#000000><B>BarCount</B></FONT><FONT COLOR=#000000> - </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> - </FONT><FONT COLOR=#0000ff>LastValue</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#0000ff>TroughBars</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>L</B></FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#ff00ff>5</FONT><FONT COLOR=#000000>,</FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000>)); <BR>
      Line = </FONT><FONT COLOR=#0000ff>LineArray</FONT><FONT COLOR=#000000>( x0,
      y0, x1, y1, </FONT><FONT COLOR=#ff00ff>1</FONT><FONT COLOR=#000000> ); <BR>
      </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>(</FONT><FONT COLOR=#000000><B>C</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#ff00ff>"C"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorWhite</B></FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>styleCandle</B></FONT><FONT COLOR=#000000>); <BR>
      </FONT><FONT COLOR=#0000ff>Plot</FONT><FONT COLOR=#000000>( Line, </FONT><FONT COLOR=#ff00ff>"Trend
      line"</FONT><FONT COLOR=#000000>, </FONT><FONT COLOR=#000000><B>colorBlue</B></FONT><FONT COLOR=#000000> );</FONT></CODE><br>
    </li>
    <li> new function sign( x )<br>
      (x can be number or array).<br>
      Returns 1 if x is positive, returns -1 if x is negative, and returns 0 if
      x is zero.<br>
    </li>
    <li> ApplyStop : 'exitatstop' parameter extended:<br>
      ApplyStop( Type, Mode, Amount, ExitAtStop = 1, Volatile = False, ReentryDelay
        = 0 )<br>
            <br>
      ExitAtStop = 0 - means check stops using only trade price and exit at regular
      trade price<br>
      (if you are trading on close it means that only close price will be checked
      for exits and exit will be done at close price)<br>
      ExitAtStop = 1 - check High-Low prices and exit intraday on price equal to
      stop level on the same bar when stop was triggered<br>
      ExitAtStop = 2 - check High-Low prices but exit NEXT BAR on regular trade
      price.<br>
      <br>
      ( first two modes 0 and 1 are the same as in old versions )<br>
          <br>
      Note on using stops:<br>
      <strong>Scenario 1:</strong> <br>
      you trade on next bar OPEN and want to exit intraday on stop price<br>
      <br>
      Correct settings: <br>
      ActivateStopsImmediately turned ON<br>
      ExitAtStop = 1<br>
      Trade delays set to one<br>
      Trade price set to open<br>
      <br>
      <strong> Scenario 2:</strong> <br>
      you trade on today's close and want to exit intraday on stop price<br>
      Correct settings: <br>
      ActivateStopsImmediately turned OFF<br>
      ExitAtStop = 1<br>
      Trade delays set to zero<br>
      Trade price set to close<br>
      <br>
      <strong> Scenario 3:</strong> <br>
      you trade on next day OPEN and want to exit by stop on OPEN price when PREVIOUS
      day H-L range hits stop<br>
      Correct settings: <br>
      <ul>
        <li> (if you want to have stops executed AFTER regular signals, so cash
          from stopped out positions is NOT available to enter trades the same
          day) <br>
          ActivateStopsImmediately turned ON <br>
        </li>
        <li>b) (if you want to have stops executed BEFORE regular signals, so cash
          from stopped out positions IS available to enter new trades the same
          day)<br>
        ActivateStopsImmediately turned OFF </li>
      </ul>
      <br>
      ExitAtStop = 2	(NEW)<br>
      Trade delays set to one<br>
      Trade price set to open<br>
      <br>
      <strong> Scenario 4:</strong> <br>
      you trade on today's close and want to exit only when today's close price
      hits the stop level<br>
        <br>
      Correct settings: <br>
      ActivateStopsImmediately turned OFF<br>
      ExitAtStop = 0<br>
      Trade delays set to zero<br>
      Trade price set to close<br>
    </li>
    <li> portfolio backtester: MAE/MFE are now updated with exit price in case
        when profit has been hit intraday and activate stops immediatelly was turned
        off.<br>
    </li>
    <li> portfolio backtester: 'activate stops immediately'=TRUE and 'same bar
        exit'=FALSE combination works OK now<br>
    </li>
    <li>'auto-tile windows' feature now tiles windows only it two cases:<br>
      - when new window is open<br>
      - when RT quote window is shown/hidden<br>
    </li>
    <li>in versions 4.48.0-4.48.2 cloned windows were sometimes saved in two
        or more copies, now it is fixed. This bug caused also crashes when switching
        layouts. Fixed.<br>
    </li>
    <li> portfolio backtester now allows custom exit labeling as old backtester<br>
    </li>
    <li>fixed range unmarking by double click in cloned windows<br>
    </li>
    <li> all listviews now use alternate background colors for odd/even rows
        this feature can be turned off using Tools-&gt;Preferences-&gt;Miscellaneous &quot;Use
      alternate row colors&quot;</li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.48.2 (as compared to 4.48.1)</b></p>
  <ul>
    <li>once more changed slightly HTML copy routine and turned it off by default</li>
    <li>added a switch to Tools-&gt;Preferences-&gt;Editor that allows to turn &quot;Copy
      as HTML&quot; feature on, on those machines having no problems (like mine)</li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.48.1 (as compared to 4.48.0)</b></p>
  <ul>
    <li>Changed code that copies HTML format from AFL editor to clipboard. (this
      hopefully will address problems with pasting on some machines)</li>
    <li>MFE/MAE distribution charts are now available in Professional Edition
      only</li>
    <li> zooming is now independent in cloned windows</li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.48.0 (as compared to 4.47.0)</b></p>
  <ul>
    <li> window linking with different bar interval works now.<br>
      Just use Window-&gt;Clone menu ... this will create a clone of currently
      selected window. The difference from previous version is that you can now
      select different interval for this cloned window. Cloned windows are numbered.
      You can have infinite number of cloned windows and they are linked within
      group (change symbol in one window causes change in every linked window)
      but the viewing interval is independent.<br>
    </li>
    <li> cloned windows are now properly saved in a layout. (note that format
        has changed slightly and you may get problems<br>
      trying to load into old version the layout saved with NEW version)<br>
    </li>
    <li> portfolio backtester: added support for backtesting futures<br>
    </li>
    <li>portfolio backtest report:<br>
      + added profit distribution chart <br>
      + added MAE distribution chart (Pro version only)<br>
      + added MFE distribution chart (Pro version only)<br>
    </li>
    <li> portfolio trade list: Max. Adverse Excursion (MAE) and Max. Favorable
        Excurison (MFE) added<br>
    </li>
    <li> ApplyStop / ExitAtStop=False feature in rotational mode works as in
        regular mode now (checks only trade price for stops, not H-L range. H-L
        is checked when ExitAtStop is True)<br>
    </li>
    <li> AFL Editor - Edit-&gt;Copy puts &quot;HTML Format&quot; and &quot;DwHt&quot; (Dreamweaver
        HTML format) into clipboard in addition to TXT and RTF formats. This provides
        ability to paste nicely formatted codes directly into Outlook Express and
        Macromedia Dreamweaver <br>
    </li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.47.0 (as compared to 4.46.3)</b></p>
  <ul>
    <li> in regular detailed log does not show more than 2 * MaxOpenPositions
        top ranked entry (buy/short) signals since anyway they won't ever be entered.<br>
    </li>
    <li> Regular mode: &quot;Max # of tracked signals&quot; setting removed.
        Now <strong>_all_</strong> exit signals are tracked.<br>
    </li>
    <li> fixed offset in day numbers returned by DayOfWeek() function for dates
        prior to 1970<br>
    </li>
    <li> added InterestEarning calculation to Portfolio backtest <br>
    </li>
    <li> now single bar 'long side' and 'short side' exposure is calculated as
        value of long positions and short positions (respectively) divided by overall
        equity value. (previously it was divided by long equity / short equity
        value but it caused problems for systems that were constantly loosing on
        short side causing that short side dropped below zero)<br>
    </li>
    <li> other minor fixes<br>
    </li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.46.3 (as compared to 4.46.2)</b></p>
  <ul>
    <li> thousand separator is removed automatically in StrToNum to prevent problems
      with conversion of numbers &gt; 1000 when thousand separator is enabled</li>
    <li> fixed issue with rotational mode, entering other symbols when trade
      on top ranked symbol has been stopped and re-entry delay &gt; 0</li>
    <li> detailed log mode does not affect drawdown calculation (previously it
        could result in slightly bigger drawdowns reported in 'detailed log' mode
        due to the fact that exit bar close was included in drawdown calculations
      even when exiting on open.)</li>
    <li> still open trades are listed in HTML report too.<br>
    </li>
    <li> trade list in HTML portfolio report can be turned OFF using Settings: &quot;Report&quot;,
        Trade list: &lt;no trade list&gt; setting.<br>
      (this setting page will be cleaned up at some point when there will be one
      backtester only).<br>
    </li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.46.2 (as compared to 4.46.1)</b></p>
  <ul>
    <li> AA settings, switch: &quot;Add artificial future bar&quot; - now artificial
        future bar is has incremented date, volume set to zero and all prices (OHLC)
        set to CLOSE price of last available data bar. (this is done to prevent
        the closed-out value of open positions)<br>
    </li>
    <li>new AFL function:<br>
      Median( array, period ) - finds median (middle element) value over period
      elements</li>
    <li>now trade list in portfolio mode displays reason for exit (if trade has
        been closed by stop)<br>
    </li>
    <li> trade list is now included in the report<br>
    </li>
    <li> rotational mode: profit target stop was broken, now it is fixed<br>
    </li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.46.1 (as compared to 4.46.0)</b></p>
  <ul>
    <li> scoreNoRotate now works again </li>
    <li> small fix in regarding month boundary handling in &quot;Use local time
        for daily compression&quot; mode.<br>
    </li>
    <li> AA settings, new switch: &quot;Add artificial future bar&quot;. When
        checked AmiBroker adds tommorrow's bar and this enables you to see tommorrow's
        (or next bar) trade recommendations when your system uses one bar delay.
        Artificial future bar is a copy of last available data bar but has of course
        incremented date and volume set to zero.<br>
    </li>
    <li> two functions (where present in 4.46.0 but not documented)<br>
      IsFavourite() - returns 'true' if current symbol belongs to favorites<br>
      IsIndex() - returns 'true' if current symbol belongs to index category<br>
    </li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.46.0 (as compared to 4.45.0)</b></p>
  <ul>
    <li>New AFL functions<br>
        <ul>
          <li> added <strong>NumToStr</strong> as synonum of WriteVal (as this
            function did not 'write' anything, just returned string)</li>
          <li>added <strong>StrToNum</strong>( string ) - converts string to
            numbe</li>
          <li>added <strong>StrFind</strong>( string, substring ) - finds first
              occurrence of substring in string. returns 0 if not found, otherwise
            returns character index (one-based) of first occurrence </li>
          <li>added <strong>StrFormat</strong>( formatstr, ... ) that performs
            sprintf-like formatting and returns string</li>
          <li><strong>CategoryGetName</strong>( category, number) function -
            returns name of category (market/group/sector/industry/watchlist)</li>
          <li> <strong>CategoryGetSymbols</strong>( category, number ) added
              - synonym to GetCategorySymbols<br>
          </li>
          <li><strong>CategoryAddSymbol</strong>( symbol, category, number );
              - adds the symbol to given category, note that for markets, groups,
              industries 'adding' means moving from one category to another, since
              the symbol is assigned always to one and only one market, group,
              industry and sector. This limitation does not apply to watchlists,
              favorites, and index categories. When symbol string is empty (&quot;&quot;)
            then current symbol is used.</li>
          <li> <strong>CategoryRemoveSymbol</strong>( symbol, category, number
              ); - removes the symbol to given category, note that for markets,
              groups, industries 'removing' means moving from given category to
              category with number zero, since the symbol is assigned always to
              one and only one market, group, industry and sector. This limitation
              does not apply to watchlists, favorites, and index categories. When
              symbol string is empty (&quot;&quot;) then current symbol is used.<br>
          </li>
        </ul>
    </li>
    <li>added new AFL functions for output/file handling (almost exactly like
      in C run-time): </li>
    <ul>
      <li><strong>printf</strong>( formatstr, ... ) - output formatted text to
          the commentary/interpretation (note 1: for numbers always use %f, %e
          or %g formatting, %d or %x will not work because there are no integers
          in AFL, note 2: as of now only numbers and arrays can now be printed.
        For arrays 'selected value' is printed)</li>
      <li><strong>fopen</strong>( filename, mode ) - opens file, returns filehandle
          . Mode can be &quot;r&quot; - for reading, &quot;w&quot; for writing, &quot;a&quot; for
        appending (and all other regular C-runtime library modes)</li>
      <li><strong>fclose</strong>( filehandle ); - closes file</li>
      <li><strong>fputs</strong>( string, filehandle ) - puts (writes) string
        to file</li>
      <li><strong>fgets</strong>( filehandle ) - gets (reads) string from file
        (returns string)</li>
      <li><strong>feof</strong>( filehandle ) - detects end-of-file marker (
        gives True - if end of file reached )</li>
    </ul>
    <li> PositionScore table is now shifted according to buy trade delay in regular
        mode too. (it was shifted so in rotational mode already). Caveat: make
        sure to set long and short delays to the same values if you are trading
        both long and short sides, otherwise only long trades get correct ranks.
        Note 2: PositionSize is not and was never shifted with trade delays<br>
      to allow code for purchasing N stocks working with any delay, example PositionSize
    = 5 * BuyPrice</li>
  </ul>
  <ul>
    <li> added new option to File-&gt;Database Settings-&gt;Intraday settings &quot;Use
        local time for daily compression&quot;.<br>
      All previous versions used exchange or data vendor time to do build daily
      bars (this means that regardless of your time shift settings daily bars looked
      the same because they used exchange or data source time (for example if you
      are using QuoteTracker it was US EST time) - this caused problems for Australian
      users using QuoteTracker as data source because QuoteTracker reported ASX
      quotes with US time that lead to invalid daily bars. Now if you check &quot;Use
      local time for daily compression&quot; AmiBroker will use your local time
      (according to 'time shift' setting) to build daily bars. Note that switching
      this on means that daily bars may look different when you change time zone
      (i.e. time shift setting)<br>
    </li>
    <li> ASCII importer: support for importing unadjusted Yahoo data performing
        adjustment on the fly: <br>
         <ul>
           <li> new field <strong>ADJCLOSE</strong> - to read adj. close column
               from Yahoo. Works _only_ in conjunction with CLOSE field. When both
               CLOSE and ADJCLOSE are present in the ASCII format definition then
               importer calculates split factor by dividing ADJCLOSE/CLOSE. It
               then multiples OPEN, HIGH, LOW and CLOSE fields by this factor and
               divides VOLUME field by this factor. This effectively converts unadjusted
               prices to split adjusted prices. Split ratio gets locked once ADJCLOSE
               drops below 0.05.<br>
           </li>
           <li> new command <strong>$ROUNDADJ</strong> <em>decimaldigits</em> -
               causes split-adjusted prices (see above) to be rounded to 'decimaldigits'
               precision. By default no rounding is done.<br>
           </li>
           <li> new command <strong>$RECALCSPLITS 1</strong> - (off by default)
               causes that splits are recalculated by AmiBroker<br>
          by the algorithm that tries to construct correct adjusted price, based
          on inaccurate information provided by Yahoo.<br>
          Note that Yahoo provides only 2 decimal digits in adj. close field therefore
          the more adj. close approaches zero due to adjustements the error grows.
          The option $RECALCSPLITS 1 is intended to address this problem (at least
          partially).<br>
          It works as follows:<br>
          1. for each bar ratio ADJCLOSE/CLOSE is calculated<br>
          2. if the ratio changes in two consecutive bars by more than 10% it means
          that<br>
          split happened that bar. True split ratio is guessed by matching true
          fraction<br>
          in the format of X/Y, where X and Y = 1..9, to the change in ratios.<br>
          3. Then true split ratio is used to adjust all past bars until new split
          is detected.<br>
           </li>
           <li> new command <strong>$RAWCLOSE2OI 1 </strong> - (off by default)
               - causes that OpenInterest field gets assigned CLOSE (raw close)
               field value multiplied by 100<br>
           </li>
         </ul>
    </li>
    <li>new aqh.format file included in &quot;formats&quot; subfolder using new
        ASCII importer commands to import and adjust prices from Yahoo. Compatible
      with existing AmiQuote versions.</li>
  </ul>
  <ul>
  </ul>
  <p><b>CHANGES FOR VERSION 4.45.0 (as compared to 4.44.1)</b></p>
  <ul>
    <li> score of 999999 is no longer recognized. Use constant scoreNoRotate
        instead.<br>
    </li>
    <li> UI simplification:<br>
      Rotational mode: separate settings for rotational mode trade price and delay
        and worst rank held have been removed.<br>
      Rotational mode now uses buy price and buy delay settings from &quot;Trade&quot; tab.
      You can also set delay from the code SetTradeDelays( 1, 1, 1, 1 ); will give
      you one bar delay. To set 'worst rank held' use SetOption function in your
      formula:<br>
      SetOption(&quot;WorstRankHeld&quot;, 5 );<br>
    </li>
    <li> stops implemented in rotational trading mode (limitation: stops in rotational
        mode can only be static, they can not change<br>
      'stop amount' from symbol to symbol or from bar to bar like in regular mode)<br>
    </li>
    <li> re-entry delay implemented for all kind of stops<br>
    </li>
    <li> user interface added in the settings for n-bar stops<br>
    </li>
    <li> ApplyStop function now takes 6 parameters:<br>
      ApplyStop( Type, Mode, Amount, ExitAtStop = True, Volatile = False, ReentryDelay
        = 0 )<br>
    </li>
    <li>rotational mode docs moved to <a href="http://www.amibroker.com/guide/afl/afl_view.php?name=ENABLEROTATIONALTRADING" target="_blank">this
        page</a></li>
  </ul>
  <p><b>CHANGES FOR VERSION 4.44.1 (as compared to 4.44.0)</b></p>
  <ul>
    <li>fixed problem with rotational mode, trading price: open</li>
  </ul>
  
    
      
        
          
            
              
                
                  <p><b>CHANGES FOR VERSION 4.44.0 (as compared to 4.43.2)</b></p>
                <ul>
    <li>
      
        
          
            fixed crash with 'detail mode' and large number of open positions/ranks
                used<br>
            </li>
    <li>
      
        
          
             max. in-memory cache size can be set now to 20000 (please note
                that this large cache requires lots of RAM (more than 512MB))<br>
            </li>
    <li>
      
        
          
            listview copy to clipboard feature now copies also column header
                names<br>
            </li>
    <li>
      
        
          
            SetForeign( ticker, fixup = True, tradeprices = False) and <br>
              RestorePriceArrays( tradeprices = False ) <br>
            have new flag now: tradeprices (False by default)
        
          
            when tradeprices is set to TRUE, then not only OHLC, V, OI,
                Avg arrays are set to foreign symbol values, but also BuyPrice,
                SellPrice, ShortPrice, CoverPrice, PointValue, TickSize, RoundLotSize,
              MarginDeposit variables are set to correspond to foreign security.
        
          
            This allows Equity() to work well with SetForeign.
        
          
             Example:
        
          
             <code>// your rules<br>
              buy = ...<br>
              sel = ...<br>
              SetForeign(&quot;MSFT&quot;, True, True );<br>
              e = Equity(); // backtest on MSFT<br>
              RestorePriceArrays( True ); // &lt;- should match parameter used
              in SetForeign<br>
      </code>
        
          
            </li>
    <li>
      
        
          
             Name(), FullName(), GetExtraData() work well with SetForeign()
                (i.e. give foreign name/data instead of currently selected)<br>
            </li>
    <li>
      
        
          
             SetOption(&quot;PriceBoundChecking&quot;, False ); - disables
                checking and adjusting buyprice/sellprice/coverprice/shortprice
                arrays to current symbol High-Low range.<br>
            </li>
    <li>
      
        
          
             % profit added to detailed log mode<br>
            </li>
    <li>
      
        
          
             fixed bug in portfolio backtester occuring when 'allow same
                bar exit' was turned off and 'immediate stops' was turned on 2
                buys and 2 sells occurred the in 2 bars in row<br>
            
        
          </li>
    <li>
      
        
          
             Auto Analysis/Settings,setting modified &quot;portfolio report
                mode: trade list/detailed log&quot; moved to &quot;report&quot; tab<br>
            
        
          
            </li>
    <li>
      
        
          
             Auto Analysis/Settings, rotational mode: added selection of
                trade price and trade delay to portfolio settings page<br>
            
        
          </li>
    <li>
      
        
          
             Auto Analysis/Settings, portfolio backtester (both regular
                and rotational modes): added ability to pad and align all symbols
                to reference symbol. Note: by default this setting is OFF. Use
                responsibly. It may slow down backtest and introduce some slight
                changes to indicator values when your data has holes and holes
                are filled with previous bar data. The feature is intended to be
                used ONLY when your system uses general market timing (generates
                global signals based on data and/or indicators calculated using
                Foreign from 'reference' symbol). Note 2: if reference symbol does
                not exist, data won't be padded.<br>
            
        
          
            </li>
    <li>
      
        
          
             Auto Analysis/Settings, report tab: added ability to define
                risk-free rates for Sharpe and Ulcer Performance Index calculations.<br>
            
        
          
            </li>
  </ul>
  
    
      
        <b>CHANGES FOR VERSION 4.43.2 (as compared to 4.43.0)</b><ul>
    <li>
      
        
          
             backtester generates now error message when someone attempts
              to use buy/sell/short/cover signals in rotational mode</li>
    <li>column headings fixed in AA porfolio backtest report</li>
  </ul>
  
    
      
        
          <p><b>CHANGES FOR VERSION 4.43.0 (as compared to 4.42.0)</b></p>
        <ul>
    <li>
      
        
          
             Portfolio Optimize mode added
                
          </li>
    <li>
      
        
          
            in regular backtest mode now it is possible to specify the score
                of the symbol (on bar-by-bar basis) via PositionScore variable.
                In this mode the score is used only at trade ENTRY to decide which
                securities should be traded in case when there are more simultaneous
                entry signals than max. allowable positions or available funds.
                AmiBroker will 'prefer' securities with higher absolute value of
                the score. If PositionScore is not used then it is assumed to be
              1 for all securities.
        
          
            NOTE: regular mode must be used for all your backtesting except
                the cases when you want rotational-trading (fund switching). Only
                regular mode uses buy/sell/short/cover signals.<br>
            
        
          
          </li>
    <li>
      
        
          
            rotational-trading mode must now be turned on by calling new
              EnableRotationalTrading() function at the top of your formula.
        
          
        
          
             AA / Settings / Portfolio:<br>
              1. Max. Traded renamed to more meaningfull &quot;Max. Open Positions&quot; -
              defines the maximum number of positions (trades) that can be open
              simultaneously (at any time)<br>
              2. Max. Ranked renamed to more meaningfull &quot;Worst Rank Held&quot; (rotational
              trading mode only) - must be equal or greater than max. open positions,
              if it is greater than Max. open positions then once a position is
              taken in a security it will not be exited until the ranking of that
              security drops below &quot;Worst Rank Held&quot;<br>
          </li>
    <li>
      
        
          
            &quot;Allow same day exit (single bar trade)&quot; now affects
                Portfolio test too.<br>
          </li>
    <li>
      
        
          
             SetOption() calls affect Portfolio backtest now added:<br>
              SetOption(&quot;MaxOpenPositions&quot;) <br>
              SetOption(&quot;WorstRankHeld&quot;)<br>
              SetOption(&quot;MinShares&quot;)<br>
          </li>
    <li>
      
        
          
             fixed Avg Profit/Loss figures in &quot;all trades&quot; section
                of portfolio report<br>
          </li>
    <li>
      
        
          
             added average PERCENT profit/loss figures<br>
          </li>
    <li>
      
        
          
             internal accuracy of calculations of LinearReg, LinRegSlope,
                LinRegIntercept, StdErr, TSF raised from 32 bit floating point
                to 64 bit floating point<br>
          </li>
    <li>
      
        
          
             fix: rotational trading mode does not enter position when score
                is 999999<br>
          </li>
    <li>
      
        
          
             fixed column setup in AA<br>
          </li>
    <li>
      
        
          
             other minor fixes<br>
          </li>
    <li>
      
        
          
            as a temporary solution for people using Rx new version now
                uses HTMLView2.exe (that is shipped with the beta) to display the
                portfolio report.<br>
          </li>
  </ul>
  
    
      
        <b>CHANGES FOR VERSION 4.42.0 (as compared to 4.41.2)</b><ul>
    <li>
      
        
          
            <b>first (incomplete) early beta version of the portfolio backtester</b></li>
    <li>fixed plot of Null arrays using styleArea</li>
    <li>fixed display problem with % progress in single-stock optimization</li>
    <li>other minor fixes<br>
    </li>
  </ul>
  
    
      
        
          <p><b>CHANGES FOR VERSION 4.41.2 (as compared to 4.41.1)</b></p>
        <ul>
        <li>
           now Sum produces values for periods upto and including BarCount,
            so Sum( array, BarCount ) gives the value instead of Null </li>
        <li>
           fixed problem with saving parameters on exit when the user did
            not specify default value for string parameter using ParamStr(&quot;name&quot;, &quot;&quot;)</li>
        <li>
           fixed 38-byte memory leak when returning values from user-defined
            functions</li>
        <li>
           real-time mode: after AFL syntax error commentary AFL editor
              is not refreshed until error is fixed and user presses 'apply'<br>
          </li>
        <li>
           eSignal 1.6.0 plugin <br>
          (available separately from<a href="http://www.amibroker.com/bin/eSignal160.exe"> http://www.amibroker.com/bin/eSignal160.exe</a>):<ul>
            <li>
               much quicker backfills</li>
            <li>
               implemented force-reconnect feature in eSignal plugin</li>
            <li>
               fixed minor timing issue in eSignal plugin </li>
            <li>implemented workaround to invalid tick numbers sent sometimes
              by eSignal's data manager.</li>
          </ul>
        </li>
      </ul>
    <blockquote>
    
      
        thanks to all users for reporting errors and helping ironing out
            outstanding issues.<br>
</blockquote>
  
    <b>CHANGES FOR VERSION 4.41.1 (as compared to 4.41.0)</b><ul>
    <li>
       fixed chart refresh locking that happened when user was drawing some
        object and abandonend it by pressing ESC key.</li>
    <li>
      View-&gt;Refresh and View-&gt;Refresh All menus now reset internal
        chart refresh lock flag just in case.</li>
    <li>
       plugin status is refreshed more often<br>
      </li>
    <li>
       maximum number of chart sheets increased to 60 (Caveat: when you
          increase the number of sheets you would not be able to use the layouts
        with OLDER versions of the software)</li>
    <li>
       TimeFrameSet() now affects result of Interval() AFL function. TimeFrameRestore()
        resets it back.</li>
    <li>
       Plot() makes copies of OHL arrays when styleCandle or styleBar is
          used so statements like<br>
              <code>SetForeign(&quot;AAPL&quot;);<br>
        Plot( C, &quot;Price&quot;, colorYellow, styleCandle );<br>
        SetForeign(&quot;MSFT&quot;);<br>
        Plot( C, &quot;Price 2&quot;, colorBlue, styleCandle );<br>
        </code>plot correctly. Previously one would need to use PlotOHLC()
                or PlotForeign()<br>
      </li>
    <li>
      separate heap for syntax tree walker implemented, so larger AFL programs
          like PortfolioTrader should execute faster while retaining the speed
        improvement gained in 4.40.4 for small formulas.</li>
  </ul>
  
    <p></p>
    <p><b>CHANGES FOR VERSION 4.41.0 (as compared to 4.40.4)</b></p>
  <ul>
    <li>
       legacy 'stoch()' function removed. Use StochK and StochD instead.</li>
    <li>
       weekly / monthly charts are not affected by intraday compression
          settingsin preferences any more and always use last available day date
        for time stamp of time-compressed bar. </li>
    <li>
      
        Pref: Misc: auto-hide timeout field: added check for allowed values
          from 1...32<br>
    </li>
    <li>
      <strong>TimeFrameSet</strong>( interval ) function implemented<br>
        - replaces current price/volume arrays: open, high, low, close, volume,
          openint, avg with time-compressed bars of specified interval once you
          switched to a different time frame all calculations and built-in indicators
          operate on selected time frame. To get back to original interval call
          TimeFrameRestore() funciton.<br>
    </li>
    <li>
      <strong>TimeFrameRestore</strong>()<br>
        - restores price arrays replaced by SetTimeFrame.
        Note that only OHLC, V, OI and Avg built-in variables are restored
            to original time frame when you call TimeFrameRestore(). All other
            variables created when being in different time frame remain compressed.
            To de-compress them to original interval use TimeFrameExpand<br>
    </li>
    <li>
       <strong>TimeFrameCompress</strong>( array, interval, mode = compressLast
          )<br>
        - compresses single array to given interval using given mode, available
        modes:<br>
        compressLast - last (close) value of the array within interval<br>
        compressOpen - open value of the array within interval<br>
        compressHigh - highest value of the array within interval<br>
        compressLow - lowest value of the array within interval<br>
        compressVolume - sum values of the array within interval<br>
    </li>
    <li>
      <strong>TimeFrameExpand</strong>( array, interval, mode = expandLast
          )<br>
        - expands time-compressed array from 'interval' time frame<br>
        ('interval' must match the value used in TimeFrameCompress or TimeFrameSet)<br>
        Available modes:<br>
      <ul>
        <li>
          expandLast - the compressed value is expanded starting from last
              bar within given period (so for example weekly close/high/low is
            available on Friday's bar)</li>
        <li>
          expandFirst - the compressed value is expanded starting from first
              bar within given period<br>
            (so for example weekly open is available from Monday's bar)<br>
        </li>
        <li>expandPoint - the resulting array gets not empty values only for
            the last bar within given period (all remaining bars are Null (empty))<br>
          Caveat: expandFirst used on price different than open may look into the
          future.<br>
          For example if you create weekly HIGH series, expanding it to daily interval
          using expandFirst will enable you to know on MONDAY what was the high
          for entire week.<br>
                      <br>
                      <code>graph0 = TimeFrameExpand( TimeFrameCompress( Close,
                        inWeekly, compressLast ), inWeekly, expandLast );<br>
          graph1 = TimeFrameExpand( TimeFrameCompress( Open, inWeekly, compressOpen
          ), inWeekly, expandFirst );<br>
                      </code></li>
      </ul>
    </li>
    <li>
      <strong>TimeFrameGetPrice</strong>( pricefield, interval, shift =
          0, mode = expandFirst );<br>
        - references OHLCV fields from other time frames.<br>
        <u>This works immediatelly without need to call TimeFrameSet<br>
        <br>
        </u><code>TimeFrameGetPrice( &quot;O&quot;, inWeekly, -1 )</code> - gives
        you previous week OPEN price<br>
                          <code>TimeFrameGetPrice( &quot;C&quot;, inWeekly, -3
                          )</code> - gives you weekly Close price 3 weeks ago<br>
                          <code>TimeFrameGetPrice( &quot;H&quot;, inWeekly, -2
                          )</code> - gives you weekly High price 2 weeks ago<br>
        <code>TimeFrameGetPrice( &quot;O&quot;, inWeekly, 0 )</code> - gives
              you this week open price.<br>
        <code>TimeFrameGetPrice( &quot;H&quot;, inDaily, -1 )</code> - gives previous
      day high when working on intraday data<br>
      Price field is one of the following<br>
&quot;O&quot;, &quot;H&quot;, &quot;L&quot;, &quot;C&quot;, &quot;V&quot;, &quot;I&quot; (open
  interest)<br>
      <br>
      Shift works as in Ref() function but it is applied to compressed time frame.<br>
      Note these functions work like these 3 nested functions<br>
      <code>TimeFrameExpand( Ref( TimeFrameCompress( array, interval, compress(depending
      on field used) ), shift ), interval, expandFirst )</code><br>
      therefore if shift = 0 compressed data may look into the future ( weekly
      high can be known on monday ). If you want to write a trading system using
      this function please make sure to reference PAST data by using negative shift
      value.<br>
      The only difference is that TimeFrameGetPrice is 2x faster than nested Expand/Compress.<br>
    </li>
    <li>
       new interval / timeframe constants:<br>
        <strong>in1Minute</strong> = 60<br>
        <strong>in5Minute</strong> = 5 * 60 <br>
        <strong>in15Minute</strong> = 15 * 60 <br>
        <strong>inHourly</strong> = 3600 <br>
        <strong>inDaily</strong> = 24 * 3600<br>
        <strong>inWeekly</strong> = 5 * 24 * 3600 <br>
      <strong>inMonthly</strong> = 25 * 24 * 3600 <br>
      <strong>compressLast</strong> = 0 <br>
      <strong>compressOpen</strong> = 1 <br>
      <strong>compressHigh</strong> = 2 <br>
      <strong>compressLow</strong> = 3 <br>
      <strong>compressVolume</strong> = 4 <br>
      <br>
      <strong>expandLast</strong> = 0 <br>
      <strong>expandFirst</strong> = 1 <br>
      <strong>expandPoint</strong> = 2 <br>
    </li>
    <li>
       <strong>SetForeign</strong>( 'ticker' )<br>
        - replaces current price/volume arrays with those of foreign security,
          returns True if ticker exists, False otherwise.<br>
        If ticker does not exist (and function returns false) price arrays are
      not changed at all.<br>
      Equivalent to the following sequence:<br>
      <code>C = Foreign( &quot;ticker&quot;, &quot;C&quot; );<br>
      O = Foreign( &quot;ticker&quot;, &quot;O&quot; );<br>
      H = Foreign( &quot;ticker&quot;, &quot;H&quot; );<br>
      L = Foreign( &quot;ticker&quot;, &quot;L&quot; );<br>
      V = Foreign( &quot;ticker&quot;, &quot;V&quot; );<br>
      OI = Foreign( &quot;ticker&quot;, &quot;I&quot; );<br>
      Avg = ( C + H + L )/3;</code><br>
      <br>
      but 6x faster (SetForeign takes about the same time as single foreign). To
      restore original prices call<br>
      RestorePriceArrays();<br>
      <br>
      EXAMPLE:<br>
      <code>SetForeign( &quot;MSFT&quot; );<br>
      dm = MACD(); // dm holds MACD of MSFT regardless of currently selected symbol<br>
      RestorePriceArrays();<br>
      Plot( dm, &quot;MACD of MSFT&quot;, colorRed );<br>
      Plot( MACD(), &quot;MACD of &quot; + Name(), colorBlue );<br>
    </code></li>
    <li>
      <strong>RestorePriceArrays</strong>();<br>
      restores arrays overwritten by SetForeign/TimeFrameSet</li>
  </ul>
  <p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
          4.40.3 (as compared to 4.40.2)</b></font></p>
<ul>
  <li>
     Stochastic Slow has now separate settings for %K and %D slowing inTools-&gt;Preferences-&gt;Indicators</li>
  <li>
     StochK and StochD AFL functions now provide new parameters for control
      over smoothing <br>
      StochK( range = 14, Ksmooth = 3 );<br>
      StochD( range = 14, Ksmooth = 3, Dsmooth = 3 );</li>
  <li>
    other minor fixes <br>
      (hangup when rescaling Y-axis in log mode)<br>
      (improved display of value labels for very low values)<br>
      (Tools-&gt;Preferences-&gt;Main chart VAP: &quot;none&quot; works again)</li>
  <li>
     HTMLView.exe is launched with the file name parameter enclosed in double
      quotation marks to ensure correct work even if Windows TEMP path contains
      spaces </li>
  <li>
     Database Setting dialog now displays approximate number of days refering
      to given number of bars selected</li>
  <li>
     AmiBroker now warns the user (once) about using non-certified 3rd party
      plugins</li>
  <li>
     AFL parser now notifies user about missing argument in statement like
      Ref(,-4); (missing 1st argument)</li>
  <li>
    when error occurs inside commentary formula then error message is displayed
       in commentary output window instead of popup error dialog </li>
  <li>
    study properties dialog now uses modern color picker</li>
  <li>
     added &quot;Troubleshoot&quot; button to crash recovery window that
      links to http://www.amibroker.com/troubleshoot.html<br>
  </li>
</ul>
<font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
          4.40.2 (as compared to 4.40.1)</b></font><ul>
  <li>
     garbage collector improvement: memory allocated by single-argument
        math functions<br>
      (ABS, ATAN, CEIL, COS, EXP, FLOOR, FRAC, INT, LOG, LOG10, ROUND, SIN, SQRT) <br>
      applied to arrays is freed as soon as possible. (Previously it was released
        at the formula execution end)<br>
    </li>
  <li>
     added new settings to VAP (Tools-&gt;Preferences-&gt;Main chart), allow
        you to change the style of histogram (line/area fill) and location (on
        top of all plots or behind of all plots)<br>
    </li>
  <li>PlotVAPOverlay now has ability to control style and location<br>
    PlotVAPOverlay( lines = 300, width = 5, color = colorGreen, vapstyle = 0
        );<br>
    where <br>
    vapstyle = 0 - right side, area fill, on top of all plots<br>
    vapstyle = 1 - left side, area fill, on top of all plots<br>
    vapstyle = 2 - right side, lines only, on top of all plots<br>
    vapstyle = 3 - left side, lines only, on top of all plots<br>
    vapstyle = 4 - right side, area fill, behind all plots<br>
    vapstyle = 5 - left side, area fill, behind all plots<br>
    vapstyle = 6 - right side, lines only, behind all plots<br>
    vapstyle = 7 - left side, lines only, behind all plots
     Demo formula (move 'style' slider to see all combinations): Plot( Close, &quot;Price&quot;, colorWhite, styleCandle );<br>
      PlotVAPOverlay( Param(&quot;lines&quot;,300,10,1000,1), Param(&quot;width&quot;,10,1,99,1),
        ParamColor(&quot;color&quot;, colorDarkBlue), Param(&quot;style&quot;,0,0,7,1)
        );<br>
                <br>
    </li>
  <li>
    the AA formula is not copied to equity indicator when there is a syntax
        error in it<br>
    </li>
  <li>
     added ability to stop parsing of AFL formula on first (syntax) error
      (switchable via Tools-&gt;Preferences-&gt;AFL: Stop parsing on first error)</li>
  <li>
    when AFL formula has syntax error, AA does not display warnings about
        missing buy/sell variables, because anyway the error has to be corrected
        first.<br>
    </li>
  <li>added protection against overflowing maximum length of indicator title
      (now 2048 characters) <br>
    </li>
  <li>
     other minor fixes
        </li>
</ul>
<font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.40.1 (as compared to 4.40.</b></font>
  <ul>
  </ul>
<ul>
  <li> added ability to minimize progress window. If progress window is minized
    then the window 'owning' it is HIDDEN. So for example if you minimize AA
    scan progress window then Automatic analysis window will be HIDDEN. To re-show
    simply maximize progress<br>
  </li>
  <li>
    added Volume-At-Price (VAP) histogram chart overlay to price chart added
      new settings for VAP to Tools-&gt;Preferences-&gt;Main price (to turn it
      off go to Tools-&gt;Preferences : Main chart,<br>
      and set &quot;Volume At Price overlay&quot; to &quot;None&quot;<br>
  </li>
  <li>
    added new AFL function <br>
      PlotVAPOverlay( lines = 300, width = 5, color = colorGreen, rightside =
        False);<br>
      that plots Volume-At-Price (VAP) overlay chart. <br>
      Please note that there must be at least one regular Plot function in your
      formula for this to work, and there can be only one PlotVAPOverlay in one
      indicator<br>
      Example:<br>
      Plot( Close, &quot;Price&quot;, colorBlack, styleCandle );<br>
      PlotVAPOverlay( 350, 4, colorYellow, True );<br>
     Example 2:<br>
      Plot( Close, &quot;Price&quot;, colorBlack, styleCandle );<br>
      PlotVAPOverlay( Param(&quot;lines&quot;,300,10,1000,1), Param(&quot;width&quot;,10,1,99,1),
      ParamColor(&quot;color&quot;, colorYellow), Param(&quot;mode&quot;,0,0,1,1)
      );<br>
  </li>
  <li>
    fixed 'X' close button in Param window.</li>
  <li>
     Parameters window now shows parameter list in alphabetical order</li>
  <li>
    fixed problem with plotting zero values at log scale. Note that Log(
      0 ) is minus inifinity and it really can not be plotted, however many people
      attempted to plot zero data in log scale, so AMiBroker now adjusts zero
      to 0.0001 when log scale is used to allow plotting.<br>
      Example faulty code that did not work in 4.40, but works now:<br>
      Plot(IIf(Month() != Ref(Month(),-1),1,0),&quot;&quot;, color, styleHistogram
      | styleOwnScale | styleNoLabel)<br>
  </li>
  <li>
    added new setting to Tools-&gt;Preferences : Charting &quot;draw vertical
      line between months&quot;<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.40.0 (as compared to 4.39.0)</b></font></p>
<ul>
  <li>fixed crash when global or local keyword was used elsewhere than on top
    of the function definition</li>
  <li>fixed crash that occurred when interpretation code part required more bars
    than indicator code part </li>
  <li>fixed handling of 1st hour after midnight in Metastock plugin / intraday
    data</li>
  <li>fixed problem with calling the same user-defined function multiple times
    in single simple arithmetic expression.</li>
  <li>memory allocated by Equity(0) was freed at the end of the formula execution,
    now it is freed immediatelly, making possible to create large loops with
    Equity(0) without memory problems. Note that Equity(1) and Equity(2) released
    memory immediatelly already.</li>
  <li> when Y-axis grid spacing is lower than or equal to 0.02 then Y axis is
    displayed with 4 decimal digits (usefull for currencies)</li>
  <li>logarithmic scaling improved, Y-scale shifting and zooming in log scale
    works better too.</li>
  <li>fixed date column formatting when SetOption(&quot;nodefaultcolumns&quot;,
    flag) is switched off and back on</li>
  <li>Param()s in Indicator Builder are set back to defaults only when formula
    is edited, setting grid line/scalling options do not reset params.</li>
  <li>time compression algorithm modified, now alignment is available in two
    options:<br>
    1. align to midnight (00:00:00) 2. align to trading hours START time <br>
    and four time stamp display modes:<br>
    1. display time of first tick in bar, 2. display time of last tick in bar<br>
    3. display start time of interval bar, 4. display end time of interval bar<br>
    These settings are available in Tools-&gt;Preferences-&gt;Intraday<br>
    Fixed also problems with alignment occurred in some cases in previous versions.</li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.39.0 (as compared to 4.38.0)</b></font></p>
<ul>
  <li> added Param dialog to AA window. Note that AA-defined parameters are reset
    back to defaults only when you LOAD the formula from the file or when you
    click on 'Reset' button in Parameter dialog. <br>
  </li>
  <li>colorAqua now has correct value of 36<br>
  </li>
  <li>when Printing charts (or using Print Preview ) in Real Time mode, <br>
    auto-refresh is temporarily disabled to avoid problems with printing<br>
  </li>
  <li> fixed problem with non-updating last bar of trade arrays by Equity(1) <br>
    applied in exploration when built-in trade delays where greater than zero<br>
  </li>
  <li> operands of arithmetic expressions are evaluated from left to right again
    (as it was in 4.30) so statements like this <br>
    (y = 7)*1000 + y;<br>
    (note assignment within expression) do not cause error messages about uninitialized
    variable<br>
  </li>
  <li>new feature &quot;Wait for Backfill&quot; in Auto-Analysis window. Causes
    scans/explorations/backtests<br>
    to wait for the plugin to finish data backfill.<br>
    The setting applies to real-time plugins only, and only to those that support<br>
    this feature. <br>
  </li>
  <li>three new versions of plugins that support 'wait for backfill' feature
    are included in the beta archive:<br>
    eSignal plugin 1.5.0<br>
    myTrack plugin 1.5.3<br>
    IQFeed plugin 1.3.1<br>
    <br>
    'Wait for backfill' feature is not supported by QT plugin, and it won't be
    supported because<br>
    QuoteTracker has no interface to allow forcing backfills from 3rd party applications.<br>
  </li>
  <li> other minor fixes<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.38.0 (as compared to 4.37.0)</b></font></p>
<ul>
  <li> new setting for candlestick appearance:<br>
    Tools-&gt;Preferences-&gt;Charting<br>
&quot;Use distinct color for&quot; : &quot;None, up candle hollow&quot; - <br>
    it plots entire candle with one color but leaves interior of UP candle body
    hollow.<br>
            <br>
  </li>
  <li> added export chart image to PNG (portable network graphics) file<br>
    Edit-&gt;Image-&gt;Export to PNG file <br>
    (Please don't ask me to add GIF support. GIF is patented and requires $3500
    license fee for Unisys. PNG is free, supported by all browsers, smaller and
    better )<br>
            <br>
  </li>
  <li> added 'send chart by e-mail' feature <br>
    Edit-&gt;Image-&gt;Send by email<br>
    and<br>
    File-&gt;Send chart via e-mail <br>
    <br>
  </li>
  <li>fixed positioning of arrows in image copies (Edit-&gt;Image-&gt;Copy)<br>
  </li>
  <li> fixed crash occurring when printer device context did not support bit
    blit copies. added very simple arrow line drawing for that case (will be
    improved in future releases)<br>
  </li>
  <li> fixed bug in handling Null with new constructs: if, while and for.<br>
    In pre-4.38 versions Null used in if, while for was treated as True, which
      was wrong<br>
            <code>if( Null ) _TRACE(&quot;WRONG&quot;);<br>
    else _TRACE(&quot;CORRECT&quot;);</code><br>
    Now Null in if, while, for is treated as False.</li>
  <li>numbers (floats) are now automatically 'upsized' to arrays on first use
    of l-value array subscript operator without causing error. <br>
    Also r-value subscript can be applied to numbers and return the number itself
    without causing error, but the underlying variable remains just a single
    number.<br>
            <br>
    This allows to easily intialize arrays to any value without need to write
    loops.<br>
            <br>
    Example 1:<br>
    in previous versions you would need to write:<br>
    <br>
    <code>for( i = 0; i &lt; BarCount; i++ ) myarray[ i ] = 0 ; // fill with
    zeros<br>
    myarray[ 5 ] = 6; // write value to 5th element of the array</code><br>
    <br>
    now you can write simply:<br>
    <br>
    <code>myarray = 3; // initialize, at this moment myarray is just a number<br>
    myarray[ 5 ] = 6; // write value to 5th element of the array, the variable
    is automatically<br>
    // upsized to array and all elements are filled with a numeric value <br>
    // that was originally placed in myarray variable<br>
    <br>
    /* myarray is holds now the array filled with values of 3 except element
    5 that has value of 6 */<br>
            <br>
    mynumber = 5;<br>
    test = mynumber[ 7 ]; // previous versions would give an error message here<br>
    // now subscript operator for r-value numeric variable <br>
    // is allowed and returns just the number <br>
    // and variable is not upsized to array unless appears on left side<br>
    // of assignment (l-value)<br>
    /* mynumber variable here is still a number */<br>
    WriteVal( test );</code><br>
  </li>
</ul>

  
    
      
        
          <p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR
                VERSION 4.37.0 (as compared to 4.36.0)</b></font></p>
        <ul>
      <li> printing improved, now all open indicator panes are printed and resolution
        is increased</li>
      <li>Edit-&gt;Copy As Image and Edit-&gt;Copy As Metafile now generate an
        image consisting of all indicator panes (not just one) </li>
      <li>fixed problem with non-resetting sort arrows in AA window</li>
      <li>fixed sometimes occuring crash Signal() function</li>
      <li>increased size of error message text buffer to prevent overflow when
        reporting syntax errors in formulas having long unwrapped lines.</li>
      <li>grid lines are drawn with fine dots instead of small dashes (screen
        output only)</li>
      <li>new AFL functions:<br>
        GetCategorySymbols( category, index ) <br>
        - retrieves comma-separated list of symbols belonging to given category<br>
        <br>
        supported categories:<br>
        categoryMarket categoryGroup categorySector categoryIndustry categoryWatchlist<br>
        categoryFavorite categoryIndex <br>
        <br>
        index = (market/group/industry/sector/watchlist number)<br>
        0..255 for categoryMarket, categoryGroup, categoryIndustry<br>
        0..63 for categorySector, categoryWatchlist<br>
        ignored for categoryFavorite, categoryIndex<br>
        <br>
        StrExtract( list, item )<br>
        - extracts given item (zero-based) from comma-separated string.<br>
        <br>
        Example:<br>
        StrExtract( &quot;MSFT,AAPL,AMD,INTC&quot;, 2 ) <br>
        will return AMD <br>
        <br>
        StrExtract( &quot;MSFT,AAPL,AMD,INTC&quot;, 0 )<br>
        will return MSFT<br>
        <br>
        StrExtract( &quot;MSFT,AAPL,AMD,INTC&quot;, 200 ) <br>
        will return empty string &quot;&quot;<br>
        <br>
        + other minor fixes<br>
        <br>
        Example code for GetCategorySymbols and StrExtract:<br>
        <br>
        <code>/* note: if given watch list contains lots of symbols <br>
        ** performance may be poor <br>
        */<br>
        function CreateAverageForWatchList( listnum )<br>
        {<br>
&nbsp;// retrive comma-separated list of symbols in watch list<br>
&nbsp;list = GetCategorySymbols( categoryWatchlist, listnum );<br>
        <br>
&nbsp;Average = 0; // just in case there are no watch list members<br>
        <br>
&nbsp;for( i = 0; ( sym = StrExtract( list, i ) ) != &quot;&quot;; i++ )<br>
&nbsp;{<br>
&nbsp;&nbsp;&nbsp;f = Foreign( sym, &quot;C&quot; );<br>
&nbsp;&nbsp;&nbsp;if( i == 0 ) Average = f;<br>
&nbsp;&nbsp;&nbsp;else Average = Average + f;<br>
&nbsp;}<br>
        <br>
&nbsp;return Average / i; // divide by number of components<br>
        }<br>
        <br>
        Plot( CreateAverageForWatchList( 1 ), &quot;Avg of WL 1&quot;, colorGreen
        );</code></li>
    </ul>
    <p></p>
    <p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
          4.36.0 (as compared to 4.35.0)</b></font></p>
  <ul>
  <li>
    
      
        fixed problem with affecting 2 or more identifiers referencing the
          same array when using l-value subscript operator []. Thanks Herman
          for pointing this out</li>
  <li>global and local keywords - for explicit visibility/scope declarations
      <p> Allow to override default scope rules that assume that variables defined
        outside function are global, while those identifiers that appear for
        the first time inside functions are local.</p>
      <p> Syntax:</p>
      <p> <code>local var1 [, var2, ... ] ;<br>
      global var1 [, var2, ... ] ;</code></p>
      <p> (as you can see you can declare more than one variable in one line.</p>
      <p> Note: using these keywords outside function definition has no meaning<br>
      (global scope is used).</p>
      <p> Example:</p>
      <p> <code>VariableA = 5; // implict global variable<br>
            <br>
      function Test()<br>
      {<br>
&nbsp;local VariableA; &nbsp;// explicit local variable with the same identifier
as global <br>
&nbsp;global VariableB; // explicit global variable not defined earlier<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//
may be used to return more than one value from the function<br>
            <br>
&nbsp;VariableA = 99;<br>
&nbsp;VariableB = 333;<br>
      } </code></p>
      <p><code> VariableB = 1; // global variable</code></p>
      <p> <code>&quot;Before function call&quot;;<br>
&quot;VariableA = &quot; + VariableA;<br>
&quot;VariableB = &quot; + VariableB;</code></p>
      <p><code> Test(); </code></p>
      <p> <code>&quot;After function call&quot;;<br>
&quot;VariableA = &quot; + VariableA + &quot; (not affected by function call
)&quot;;<br>
&quot;VariableB = &quot; + VariableB + &quot; (affected by the function call
)&quot;;</code></p>
  <li> syntax highligting modified so keywords: #include, if, else, while, do,
    function, procedure, global, local, return are colorised differently than
    built-in constants or functions. Corresponding color/style setting added
    to Preferences-&gt;Editor<br>
        <br>
  </li>
  <li>#pragma nocache <br>
    pre-processor command added to switch off #include file caching mechanism.<br>
    Note: between '#pragma' and 'nocache' there must be exactly SINGLE space<br>
    Note 2: disabling caching may slow down execution of the formula (especially<br>
    in indicators)<br>
    Note 3: #pragma nocache must be placed before #includes<br>
    <br>
    Example: </li>
</ul>
<blockquote>
  <p> <code>#pragma nocache<br>
    #include &lt;myfile.afl&gt;</code></p>
</blockquote>
<ul>
  <li>single line comments now work with #includes (and #pragma too) so you can
    comment out include in regular way:<br>
    //#include &lt;something&gt; - will not include<br>
    <br>
  </li>
  <li>changed error message from &quot;unknown identifier&quot; to &quot;Variable
    'name' used without having been initialized.&quot; which better decribes
    the problem.
        <p></p>
  </li>
</ul>
<blockquote>
  <p> For example:</p>
  <p> <code>function Test( )<br>
    {<br>
&nbsp;global x;<br>
&nbsp;x = 3;<br>
    }</code></p>
  <p><code> WriteVal( x ); // variable used without having been initialized,<br>
    // although declared inside Test() function body<br>
  </code></p>
  <p><code> Test( ); // during function call the value of 3 is assigned to variable
      x</code></p>
  <p><code> WriteVal( x ); // and now no error is reported</code></p>
</blockquote>
<ul>
  <li>implemented shortcut evaluation of logical operators </li>
</ul>
<blockquote>
  <p> The operands of logical-AND and logical-OR expressions are evaluated from
    left to right. Now if the value of the first operand is sufficient to determine
    the result of the operation, the second operand is not evaluated. This is
    called &#147;short-circuit evaluation.&#148; <br>
        <br>
    The left operand of the logical-AND operator is completely evaluated and
    all side effects complete before continuing. If the left operand evaluates
    to false (0), the other operand is not evaluated.<br>
        <br>
    The left operand of the logical-OR operator is completely evaluated <br>
    and all side effects complete before continuing. <br>
    If the left operand evaluates to true (nonzero), the other operand is not
    evaluated. </p>
  <p> (The above description applies to operands that evaluate to single boolean
    value, <br>
    it does not apply to arrays. Operands that evaluate to arrays are evaluated
    always )</p>
  <p> Example:<br>
      <code>for( i = -3; i &lt; BarCount; i++ )<br>
    {<br>
&nbsp;// using old versions of AMiBroker you would get subscipt out of range<br>
&nbsp;// but now<br>
&nbsp;// the second operand (C[ i ] &gt; C[ i - 1 ]) is evaluated <br>
&nbsp;// ONLY if first operand ( i &gt;= 1 ) evaluates to TRUE</code></p>
  <p><code> &nbsp;&nbsp;if( i &gt;= 1 &amp;&amp; C[ i ] &gt; C[ i - 1 ] )<br>
&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_TRACE(&quot;TEST &quot; + i); <br>
&nbsp;&nbsp;}<br>
    }</code></p>
  <p>&nbsp;</p>
</blockquote>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.35.0 (as compared to 4.34.2)</b></font></p>
<ul>
  <li>do-while loop implemented:<br>
    Syntax:<br>
    <br>
    <b> do </b><i>statement</i><b> while </b>( <i>expression</i> ) ;<br>
    <br>
    The expression in a do-while statement is evaluated after the body of the
    loop is executed. <br>
    Therefore, the body of the loop is always executed at least once. <br>
    <br>
    Example:<br>
    <br>
    <code>i=0;<br>
    do<br>
    {<br>
&nbsp;&nbsp;&nbsp;i++;<br>
    }<br>
    while( i &lt; 100 );<br>
    WriteVal( i );</code><br>
    <br>
  </li>
  <li>it is now allowed to 'add' (or rather concatenate) string to a number /
    array. This saves quite a bit of typing. This works as in JScript. The left-hand
    operand of '+' has to be a string. The right-hand operand may be string,
    number or array. Numbers are coerced to strings using %g sprintf formatting
    (prints out decimal point only when necessary) and then concatenated. In
    case of arrays SELECTED VALUE is coerced to string and then concatenated.<br>
        <br>
    So now instead of <br>
    <br>
    <code>i = 100;<br>
&quot;Value is &quot; + WriteVal( i );<br>
&quot;Close : &quot; + WriteVal( Close ) + &quot;, Open : &quot; + WriteVal(
Open ) + &quot;, High : &quot; + WriteVal( High );</code><br>
        <br>
    you can write:<br>
    <br>
    <code>i = 100;<br>
&quot;Value is &quot; + i;<br>
&quot;Close : &quot; + Close + &quot;, Open : &quot; + Open + &quot;, High : &quot; +
High;</code><br>
        <br>
    Note that<br>
    <br>
    <code>&quot;Test &quot; + 100 + 1;</code><br>
    <br>
    will give you &quot;Test 1001&quot; because statements are parsed from left
    to right.<br>
&quot;Test &quot; is added first to &quot;100&quot; giving &quot;Test 100&quot; and
then to &quot;1&quot; giving<br>
&quot;Test 1001&quot;. If you want to perform numeric adding first please use
braces:<br>
        <br>
        <code>&quot;Test &quot; + ( 100 + 1 );</code><br>
    - this will give you &quot;Test 101&quot;<br>
    <br>
  </li>
  <li> additional tweaks in AFL engine &amp; garbage collection, futher speed
    up of execution of very long loops <br>
  </li>
  <li>more error checking in AFL engine - will report using uninitialized variables
    that were accepted silently in 4.31.x - 4.34.x</li>
  <li> #include now accepts new way of specifying file names to include:<br>
      <br>
      <code> #include &lt;filename.afl&gt;</code><br>
      <br>
    (note &lt; &gt; braces instead of &quot; &quot; ) if you specify the file
    name this way AmiBroker will look for<br>
    the file in &quot;standard include path&quot; that is definable using new
    prefs setting in Tools-&gt;Preferences-&gt;AFL<br>
    It makes much shorter to write includes and you can move include folder now
    without changing all AFL codes using #includes.<br>
        <br>
    For example if you have set standard include path to &quot;C:\AFL\MyIncludes&quot; and
    write in your formula:<br>
    <br>
    <code> #include &lt;common.afl&gt;<br>
    </code><br>
    AmiBroker will look for <code>C:\AFL\MyIncludes\common.afl</code> file<br>
    <br>
    Also now #include reports file(s) not found in regular error message box.<br>
    <br>
  </li>
  <li>IIf/Min/Max are now overloaded functions (have two variants each)<br>
    IIF( Condition_ARRAY, True_Array, False_Array ) (old one)<br>
    IIF( BoolValue, TrueValue, FalseValue )<br>
    <br>
    Min( array1, array2 ) (old one)<br>
    Min( number1, number2 ) <br>
    <br>
    Max( array1, array2 ) (old one)<br>
    Max( number1, number2 ) <br>
    <br>
    The second one is choosen when all arguments are numbers and it is much much
    faster and returns number so LastValue() call is not neccessary anymore.<br>
        <br>
    Example:<br>
    <code><br>
    </code><code>// much faster and does not require LastValue()<br>
    </code><code> period = IIF( name() == &quot;MSFT&quot;, 5, 10 );<br>
    </code><code>result = Min( 7, 3 ); <br>
    // (result is still a number not array as in previous versions)</code><br>
    <br>
  </li>
  <li> added 'endless loop detection threshold' setting to Preferences &quot;AFL&quot; tab.
    Recommended value 100000 or higher.<br>
  </li>
  <li>fixed parameter counting in CallFunction plugin callback in case of overloaded
    functions</li>
  <li>fixed problem with premature freeing of arrays passed in default parameters
    fields (causing for example problem with color exploration output - introduced
    in 4.32)</li>
</ul>
<p></p>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.34.2 (as compared to 4.34.0)</b></font></p>
<ul>
  <li> improved crash recovery dialog to include AFL engine state information
    and (in some cases) the source line of the formula that causes an exception</li>
  <li>added ability to catch all exceptions in indicators and commentaries (switchabel
    via Tools-&gt;Preferences-&gt;AFL, &quot;catch system exceptions...&quot;,
    ON by default) - allows you to continue to work even in case of serious problem</li>
  <li>loop break by Shift+BREAK is now more sensitive</li>
  <li>now you can control how often Shift+BREAK key is checked during formula
    execution (Tools-&gt;Preferences-&gt;AFL, &quot;check SHIFT+Break every&quot; (1..100,
    default = 50) (note that specifying low values may degrade performance slightly)</li>
  <li>tweaked AFL memory allocator hash tables to get more speed for large looping
    formulas</li>
  <li>although I never reproduced this problem I made some changes so 'TAB' key
    should not wipe the contents of AFL editor anymore</li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.34.0 (as compared to 4.33.0)</b></font></p>
<ul>
  <li><font face="Arial, Helvetica, sans-serif" size="-1"> user-definable functions
      and procedures with parameters and local variables <br>
  </font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">'A' is NO LONGER predefined
      symbol. I decided to remove it because people tend to use A as user-variable
      forgetting the fact that it was build-in array holding typical price (H+L+C)/3. <b>Use
      'Avg' instead.</b><br>
  </font></li>
  <li>indicator list column width increased in Indicator Builder</li>
  <li>DayOfYear - returns the calendar day number counting from beginning of
    the year January 1st is 1. Maximum number returned is 366</li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.33.0 (as compared to 4.32.2)</b></font></p>
<ul>
  <li>Database purify tool implemented (available via Tools-&gt;Database Purify)<br>
    allows to detect missing/extra quotes, possible splits, invalid OHLC relationship<br>
    <br>
    Apply to/range settings similar to AA window. You can also right click over
    result list to add symbols to watch list and copy the list to the clipboard
    (and paste it later to any other program for futher use)<br>
        <br>
  </li>
  <li>further improvements to AFL garbage collector, now looping regardless of
    loop count requires the same amount of memory as just single pass of the
    code (no growing allocated memory during loops).<br>
    This enormously lowered memory consumption for some formulas and increased
    the speed of some loops 3..4 times.<br>
        <br>
  </li>
  <li>added variable period support to the following functions:<br>
    LinRegSlope,<br>
    LinearReg,<br>
    LinRegIntercept,<br>
    StdErr,<br>
    TSF
    <p> Sample code:</p>
    <p> Plot( Close, &quot;Test&quot;, colorBlack );</p>
    <p> range = 15 * MA( ATR( 15 ), 50 ) / ATR( 15 ); </p>
    <p> //Plot( range, &quot;range&quot;, colorBlue, styleOwnScale );<br>
      Plot( LinearReg( Close, range ), &quot;Test&quot;, colorRed );</p>
  </li>
  <li>
    <p>fixed sometimes incorrect output of variable-period version of LLV/HHV</p>
  </li>
  <li>
    <p>fixed crash occuring when bad arguments were passed to the function (bug
      introduced in 4.32.x).</p>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.32.2 (as compared to 4.32.1)</b></font></p>
<ul>
  <li> second bug in experimental garbage collector fixed.</li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.32.1 (as compared to 4.32.0)</b></font></p>
<ul>
  <li> garbage collector was releasing memory too soon in some cases, now fixed.</li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.32.0 (as compared to 4.31.1)</b></font></p>
<ul>
  <li> added type check in IF/ELSE statements</li>
  <li>added type check in array element assignment</li>
  <li>error messages now numbered and display changed slightly</li>
  <li>you can break running loop by pressing Shift+BREAK (Pause) key combination</li>
  <li>calling COM objects works again (was broken in 4.31.x)</li>
  <li>changed slightly the way TAB works in editor, if TAB is pressed any selection
    is deselected to avoid accidential deletion of text </li>
  <li><i>experimental:</i> added 'agressive garbage collector' that extremely
    decreases the amount<br>
    of memory required to run AFL formula by releasing the memory<br>
    used for temporary variables as soon as possible (previously<br>
    temporary memory was released at the end of formula execution).<br>
    A side-effect of new garbage collector is some speed up in formula execution.</li>
  <li>new tab in preferences for AFL engine settings</li>
  <li><i>experimental feature, NOT for beginners, may be removed/modified in
      future releases</i>: <br>
    new _TRACE( &quot;string&quot; ) AFL function added<br>
    that allows to write debug messages from AFL code to system debug viewer.<br>
    (it calls internally OutputDebugString Win API function).<br>
    To view debug messages you have to run DebugView freeware program <br>
    from http://www.sysinternals.com/ </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.31.1 (as compared to 4.31.0)</b></font></p>
<ul>
  <li> fixed bug introduced in 4.31.0 causing no text output in commentary/interpretation<b></b></li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.31.0 (as compared to 4.30.0)</b></font></p>
<ul>
  <li> Workspace window uses &quot;icon font&quot; set in the Windows settings
    instead of hard coded Tahoma 8</li>
  <li>for better readability and ClearType(tm) compatibility on WinXP, all dialog
    windows use now 'MS Shell Dlg' face name that maps to standard MS Sans Serif
    on Win 9x/Me/NT and Tahoma on Win 2K and XP.</li>
  <li>rewritten AFL parser, now formula is parsed and coverted to syntax tree
    and then interpreted. This would allow further improvements including compilation.
    This allowed also to add loops/if-else statements.</li>
  <li>implemented IF/ELSE statement, WHILE and FOR loops:<br>
    The same basic 'for' loop in AFL is 2..3 times faster than in JScript<br>
    Syntax follows C++/JScript style:
    <p> <i>while( conditional_expression ) statement;</i></p>
    <p><i> for( initializer_part; conditional_expression; iterator_part ) statement;</i></p>
    <p><i> if( conditional_expression ) statement;</i></p>
    <p><i> if( conditional_expression ) <br>
      statement;<br>
      else<br>
      statement;</i></p>
  </li>
  <li>
    <p>implemented compound statements: these are blocks of statements enclosed<br>
      in opening and closing curly brace </p>
    <p> <i>{<br>
      statement1;<br>
      statement2;<br>
      ...<br>
      statementN;<br>
      }</i></p>
    <p>compound statement can appear anywhere when simple statement can.</p>
    <p> For example:</p>
    <p> <code>i = 10;<br>
      while( i &lt; 20 )<br>
      {<br>
      Plot( MA( Close, i ), &quot;MA&quot; + WriteVal( i, 0 ), colorBlack + i
      );<br>
      i = i + 1;<br>
      }</code></p>
  </li>
  <li>
    <p>implemented C-style postfix and prefix increment/decrement operators</p>
    <p> <code>i = 10;<br>
      WriteIf( i++ );<br>
      WriteIf( ++i );<br>
      WriteIf( i );</code></p>
  </li>
  <li>
    <p> implemented array element access (subscript) operator []:</p>
    <p> <code>WriteVal( Close[ 0 ] ); // prints the first bar of close array</code></p>
    <p><code> /* a sample low-level implementation of exponential moving average
        in AFL */</code></p>
    <p><code> myema[ 0 ] = Close[ 0 ];</code></p>
    <p><code> for( i = 1; i &lt; BarCount; i++ )<br>
      {<br>
      myema[ i ] = 0.1 * Close[ i ] + 0.9 * myema[ i - 1 ];<br>
      }</code><br>
      <br>
    </p>
  </li>
  <li>
    <p>added built-in constant 'BarCount' that returns number of bars available
      in arrays (the number of elements of array)<br>
      When QuickAFL is turned on it may be less than true number of bars because
      QuickAFL feature attempts to use only visible bars (and few before). You
      can control how many bars the formula requires using SetBarsRequired()
      function</p>
  </li>
  <li>
    <p>implemented infinite-loop protection. Nice if you forgot to increment
      counter variable in 'for' loop :-)</p>
  </li>
  <li>
    <p>tab key now works without need to press ALT/CTRL in AFL editors</p>
  </li>
  <li>
    <p>added C-like synonyms for logical ADD/OR/NOT: &amp;&amp;, ||, ! </p>
    <p><br>
        <code>/* a sample low-level implementation of Profit-target stop in AFL:
        */</code></p>
    <p><code>Buy = Cross( MACD(), Signal() );</code></p>
    <p><code>priceatbuy=0;</code></p>
    <p><code>for( i = 0; i &lt; BarCount; i++ )<br>
      {<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( priceatbuy == 0 &amp;&amp; Buy[ i ] ) <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;priceatbuy = BuyPrice[ i ];</code></p>
    <p><code> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( priceatbuy &gt; 0 &amp;&amp; SellPrice[
        i ] &gt; 1.1 * priceatbuy )<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sell[ i ] = 1;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SellPrice[ i ] = 1.1 * priceatbuy;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;priceatbuy = 0;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Sell[ i ] = 0;<br>
      }</code></p>
    <p><code>/* sample EMA rainbow */</code></p>
    <p><code>Plot( Close, &quot;Price&quot;, colorBlack, styleCandle );<br>
      for( Range = 15; Range &lt; 100; Range++ )<br>
&nbsp;&nbsp;&nbsp;Plot( EMA( Close, Range ), &quot;MA&quot;+WriteVal(Range,0),
colorRose + Range % 8, styleNoLabel );</code></p>
  </li>
</ul>
<p><strong>CHANGES FOR VERSION 4.30.0 (as compared to 4.29.9)</strong></p>
<ul>
  <li>implemented workaround to Windows XP scroll bar bug.<br>
    (<a href="http://groups.yahoo.com/group/amibroker/message/35446" target="_blank">http://groups.yahoo.com/group/amibroker/message/35446</a>)<br>
    (we disable scroll bar when chart is zoomed out to the max to prevent scroll
    bar locking on WinXP)</li>
  <li>Chart: ScrollPageLeft (default assignment: PAGEUP key), ScrollPageRight
    (default: PAGEDN), ScrollToBegin (default: HOME), ScrollToEnd (default: END)
    available in Keyboard shortcut editor, Fixed ScrollLeft, ScrollRight</li>
  <li>fixed problem with not updating Param dialog when using 2 sheets with single
    pane per sheet. </li>
</ul>
<p></p>
<p><strong>CHANGES FOR VERSION 4.29.9 (as compared to 4.29.8)</strong></p>
<ul>
  <li>added key shortcuts for range mark begin (F12), end (Shift+F12), hide (Ctrl+F12)
    (they are also available in Keyboard editor so assignments can be changed) </li>
  <li>chart scroll left/right are now accessible from keyboard editor (ChartScrollLeft,
    ChartScrollRight) </li>
  <li>if type-in is selected from the main menu then watch list selector dialog
    is displayed. </li>
  <li>fixed sometimes wrong sort when many explorations were run one after another
    with some non-numeric columns. </li>
  <li>Study() works correctly even when trendline is drawn past the last available
    data bar.</li>
</ul>
<p></p>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.29.8 (as compared to 4.29.7)</b></font></p>
<ul>
  <li>updated param info for LastValue, MarketID, GroupID, SectorID, IndustryID
    to match the AFL reference </li>
  <li>decreased delay time for baloon tooltip (status bar area) </li>
  <li>fixed hang of Windows XP when AmiBroker tried to display the tooltip while
    AB was minimized. (cause of crash of WinXP when QT was closed before AB) <br>
  </li>
  <li>infinite numbers are printed now as {INF}, not-a-numbers are printed as
    {NAN} by WriteVal.<br>
    For example:<br>
&quot; 1/0 =&quot; + WriteVal((1/0));<br>
&quot; 0/0 =&quot; + WriteVal(0/0);<br>
&quot; (1/0) / (1/0) =&quot; + WriteVal((1/0)/(1/0));<br>
&quot; 1 / (1/0) =&quot; + WriteVal( 1 / ( 1 / 0 ) );<br>
&quot; Null =&quot; +WriteVal(Null); <br>
  </li>
  <li>3 new AFL functions:<br>
    a) IsNan( x ) - returns a nonzero value (1 or TRUE) if the argument x is
      a NaN; otherwise it returns 0 (FALSE). <br>
    A NaN is generated when the result of a floating-point operation cannot be
    represented in Institute of Electrical and Electronics Engineers (IEEE) format<br>
        <br>
    Example:<br>
    IsNan( 0/0 );<br>
    <br>
    b) IsFinite( x ) - IsFinite returns a nonzero value (1 or TRUE) if its argument
    x is not infinite, <br>
    that is, if &#8211;INF &lt; x &lt; +INF. It returns 0 (FALSE) if the argument
    is infinite or a NaN.<br>
      <br>
    Example:<br>
    IsFinite( 1/0 );<br>
    <br>
    c) Nz( x ) - Null (Null/Nan/Infinity) to zero<br>
    <br>
    You can use the Nz function to return zero, or another specified value when
    argument x is Null or Nan or Infinite. <br>
    For example, you can use this function to convert a Null (empty) value to
    another value and prevent it from propagating through an expression. If the
    optional valueifnull argument is included, <br>
    then the Nz function will return the value specified by that argument if
    the x argument is Null (or Nan or Infinity). <br>
      <br>
    You can use the Nz function as an alternative to the IIf function. <br>
    Instead of:<br>
    varTemp = IIf( IsFinite( (H-L)/(C-L) ), (H-L)/(C-L), 0 );<br>
    You can write:<br>
    varTemp = Nz( (H-L)/(C-L) );<br>
  </li>
  <li>added IsNull() function - it is the synonym to IsEmpty() </li>
</ul>
<p><strong>CHANGES FOR VERSION 4.29.7 (as compared to 4.29.6)</strong></p>
<ul>
  <li>added &quot;ask to save changed data&quot; option to Prefs-&gt;Misc page
    (if it is unchecked AmiBroker saves data without asking) </li>
  <li>Symbol -&gt; WatchList -&gt;Import now accepts all formats of .LST files
    from Quotes Plus <br>
  </li>
  <li>fixed crash when backward ref bar number was too high <br>
  </li>
  <li>date axis drawing modified (should address 'missing oct 2001' problem) <br>
  </li>
  <li>fixed crash when using extreme zoom in factors (via Zoom to range) and
    scrolling max to the right so only blank area is visible. <br>
  </li>
  <li>added check for neg. # of contracts <br>
  </li>
  <li>Apply in Indicator Builder does not scroll to the top </li>
  <li>other minor fixes:</li>
</ul>
<p></p>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.29.6 (as compared to 4.29.5)</b></font></p>
<ul>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">WriteVal has now new
      parameter 'separator' that controls if the number<br>
    should be formatted with thousand separator or not:</font><br>
    <br>
    WriteVal( ARRAY, format = 8.3, separator = True )<br>
    <br>
    WriteVal( Volume, 8.3, True ); // with separators<br>
    WriteVal( Volume, 8.3, False ); // without separators<br>
    <br>
  </li>
  <li> thousand separator is not added to numbers in AA-&gt;Export</li>
  <li>thousand separator does not appear when using<br>
    AddColumn( DateTime(), formatDateTime );</li>
  <li>fixed inconsistency between AA result line (incorrect) and AA report (correct)
    when formula was using <br>
    SetOption(&quot;InitialEquity&quot;, nn) to change the Init. equity set in
    the AA settings<br>
    (thanks Herman)</li>
  <li>fix: % change is displayed again in RT quote window.</li>
  <li>fix: watch list dialog (watch list-&gt;remove) does not show lists above &gt; 32
    if given symbol does not belong to given watch list.</li>
  <li>new AFL function: GetChartID() allows to retrieve current indicator chart
    ID. (returns 0 (zero) in AA window)</li>
  <li> other minor fixes<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.29.5 (as compared to 4.29.1)</b></font></p>
<ul>
  <li> fixed crash in AFL editor that occured when selecting all text and choosing
    right mouse button -&gt; copy</li>
  <li>auto-scaling changed slightly</li>
  <li>user-definable thousand separator (in Tools-&gt;Preferences-&gt;Misc) applied
    automatically to all list views and indicators and WriteVal function</li>
  <li>definable number of decimal places in RT quote window (Tools-&gt;Prefs-&gt;Misc)</li>
  <li>watch-list related functions: (available from context menu in tree and
    Symbol-&gt;Watch list menu)</li>
  <li>quick type-in symbols into watch list</li>
  <li>import/export watch list from/to .LST file and from/to plugin (ext. database
    only for plugins that support this feature. The first one will be FT plugin) </li>
  <li>context menu is displayed over selected watch list (click with right mouse
    button on the watch list name in the Workspace window)</li>
  <li>'dirty' flag is set properly after moving/sizing the study </li>
  <li>Amibroker again displays message box asking to save changes. (this is useful
    to undo some unwanted changes but it works only for most recent 'in-memory'
    symbols (see Tools-&gt;Preferernces-&gt;Data))</li>
  <li>fixed the case when Preferences has log scale switched OFF but Indicator
    Builder has &quot;log scale&quot; turned ON for Price chart.</li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.29.1 (as compared to 4.29.0)</b></font></p>
<ul>
  <li>data tooltips now show study ID and coordinates and point/percent change
    from start to end when you hover the mouse pointer over the trend line or
    other study</li>
  <li>from-to range selector implemented just double click on chart to mark begin
    and then double click in other place to mark end of the range. &gt; and &lt; markers
    will appear above date axis. To delete the markers double click again in
    the same place where vertical line is positioned.</li>
  <li>From-to selected range can be referred from the AFL level via new functions<br>
    BeginValue( ARRAY )<br>
    EndValue( ARRAY )<br>
    - these functions give the single value (number) of the ARRAY at the beginning
    and end of the selected range. If no range is marked then they return the
    value at the first bar and last bar respectively.<br>
        <br>
    Example:<br>
    <br>
    WriteVal( BeginValue( DateTime() ), formatDateTime );<br>
    WriteVal( EndValue( DateTime() ), formatDateTime );<br>
&quot;Precentage change of close is &quot; + <br>
    WriteVal( 100 * (EndValue( Close ) - BeginValue( Close ))/BeginValue( Close
    ) ) + &quot;%&quot;;<br>
        <br>
  </li>
  <li>WriteVal function now handles formatDateTime<br>
    WriteVal( DateTime(), formatDateTime );<br>
    <br>
  </li>
  <li>Zoom to range implemented (View-&gt;Zoom-&gt;Range) or hold down both SHIFT
    and CTRL and click on green zoom in toolbar button (zooms to selected from-to
    range)<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.29.0 (as compared to 4.28.1)</b></font></p>
<ul>
  <li>context help in AFL editor - just press F1 when cursor is over AFL reserved
    function name and it will display full information about that function</li>
  <li>param info/fun reference available also from context menu</li>
  <li>fixed bug in Study function working improperly for trendlines with right
    extend property</li>
  <li>tab order fixed in Study properties box</li>
  <li>usability: &quot;Filter pre/after hours&quot; is available now from View-&gt;Intraday
    menu</li>
  <li>new AFL function:<br>
    Now( format = 0 ) returns current date / time in numerous of formats:<br>
    format = 0 - returns string containing current date/time formatted according
    to system settings<br>
    format = 1 - returns string containing current date only formatted according
    to system settings<br>
    format = 2 - returns string containing current time only formatted according
    to system settings<br>
    format = 3 - returns DATENUM number with current date<br>
    format = 4 - returns TIMENUM number with current time<br>
    format = 5 - returns DATETIME number with current date/time<br>
    See: <a href="http://www.amibroker.com/guide/afl/afl_view.php?name=NOW">http://www.amibroker.com/guide/afl/afl_view.php?name=NOW</a></li>
  <li>new drawing tool: Triangle</li>
  <li>new drawing tool: Andrews' Pitchfork</li>
  <li>Gann Square tool does not draw controlling trenline during move/resize</li>
  <li>added check that prevents freeing memory by Equity(1) function when this
    memory is referenced by other variables</li>
  <li>added Layer combo to the Text properties box</li>
  <li>added link to AFL on-line reference to the Help-&gt;AmiBroker on the Web
    menu.</li>
  <li>switching layers does not cause unnecessary symbol tree refresh</li>
  <li>added switch to AA Settings-&gt;Report tab that allows to turn off optimization
    warning (that is displayed if optimization requires more than 300 steps)</li>
  <li>other minor fixes.<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.28.1 (as compared to 4.28.0)</b></font></p>
<ul>
  <li> fixed problem with missing some short trades when new flag &quot;Reverse
    entry signal forces exit&quot; was turned off</li>
  <li>Null is now highlighted and present in the auto-complete box.</li>
  <li>fixed numeric sorting of colorized columns</li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.28.0 (as compared to 4.27.1)</b></font></p>
<ul>
  <li> ApplyStop has one more parameter <br>
    ApplyStop( Type, Mode, Amount, ExitAtStop, Volatile = False )<br>
    <br>
    new Volatile parameters decides if amount (or distance) (3rd parameter) is
    sampled at the trade entry and remains fixed during the trade (Volatile =
    FALSE - old behaviour) or if can vary during the trade (Volatile = TRUE)<br>
        <br>
    Allows single-line implementation of Chandeliers exit:<br>
    <br>
    <code>ApplyStop(stopTypeTrailing, stopModePoint, 3*ATR(14), True, True );</code><br>
    <br>
  </li>
  <li> ApplyStop handles new N-Bar stop - exits the trade after N bars.<br>
    Type = stopTypeNBar; /* = 3 */<br>
    Mode = stopModeBars; /* = 1 */<br>
    <br>
    <code>ApplyStop( stopTypeNBar, stopModeBars, 5 ); // exits trades on 5th
    bar since entry<br>
        <br>
  </code></li>
  <li>added new &quot;Reverse entry signal forces exit&quot; check box to the
    Backtester settings.<br>
    When it is ON (the default setting) - backtester works as in previous versions
    and closes already open positon if new entry signal in reverse direction
    is encountered. If this switch is OFF - even if reverse signal occurs backtester
    maintains currently open trade and does not close positon until regular exit
    (sell or cover) signal is generated. <br>
    In other words when this switch is OFF backtester ignores Short signals during
    long trades and ignores Buy signals during short trades.<br>
        <br>
  </li>
  <li>added &quot;Allow same bar exit (single bar trade)&quot; option to the
    Settings<br>
    When it is ON (the default settings) - entry and exit at the very same bar
    is allowed (as in previous versions)<br>
    if it is OFF - exit can happen starting from next bar only (this applies
    to regular signals,there is a separate setting for ApplyStop-generated exits).
    Switching it to OFF allows to reproduce the behaviour of MS backtester that
    is not able to handle same day exits.<br>
        <br>
  </li>
  <li> long trades now take precedence over short trades so if signals happen
    on the same bar in both directions only long trade is taken. <br>
        <br>
  </li>
  <li> new AFL functions:<br>
    DateTime() - returns array of encoded date/time values suitable for using
      with<br>
    AddColumn and formatDateTime constant<br>
    to produce date time formated according to your system settings<br>
    <br>
    <code>AddColumn( DateTime(), &quot;Date / Time&quot;, formatDateTime );<br>
    </code><br>
    new formatChar constant allows outputting single ASCII character codes:<br>
    <br>
    Example (produces signal file accepted by various other programs):<br>
    <br>
    <code>Buy=Cross(MACD(),Signal());<br>
    Sell=Cross(Signal(), MACD());<br>
    Filter=Buy OR Sell;<br>
    SetOption(&quot;NoDefaultColumns&quot;, True );<br>
    AddColumn( DateTime(), &quot;Date&quot;, formatDateTime );<br>
    AddColumn( IIf( Buy, 66, 83 ), &quot;Signal&quot;, formatChar ); <br>
    <br>
  </code></li>
  <li>new AFL functions continued:<br>
    BarIndex() - returns zero-based bar number - <br>
    the same as Cum(1)-1 but it is much faster than Cum(1) when used in Indicators <br>
    <br>
    SetOption( &quot;name&quot;, value )<br>
    - sets various options in automatic analysis settings currently available
    options are<br>
&quot;NoDefaultColumns&quot; - if set to True - exploration does not have default
Ticker and Date/Time columns<br>
&quot;InitialEquity&quot;<br>
&quot;AllowSameBarExit&quot; <br>
&quot;ActivateStopsImmediately&quot; <br>
&quot;AllowPositionShrinking&quot; <br>
&quot;FuturesMode&quot; <br>
&quot;InterestRate&quot;<br>
    <br>
  </li>
  <li> if you overwrite AA settings via SetTradeDelays/SetOption <br>
    backtest report gives these actual values instead of originaly set in the
      settings<br>
        <br>
  </li>
  <li> new Null constant is equal to -1e10 (empty value) so you can use it instead
    enigmatic -1e10<br>
        <br>
    obsolete styleLog removed (logarithmic scale setting is not per-line but
    per-pane and it is selectable from Indicator Builder)<br>
        <br>
  </li>
  <li> added PlotGrid( level, color = colorDefault ) function that plots grid
    line using built-in dotted style.<br>
        <br>
  </li>
  <li>fixed problem with QuoteEditor that was introduced with adding color support
    to the list view</li>
  <li>added support for Win XP common controls 6, which results in enhanced XP-look
    (on WinXP only of course)</li>
  <li>fixed zero-size problem with floating control bars on Windows XP</li>
  <li>fixed some compatibility issues with common controls 6.</li>
  <li>added sound when plugin status changes</li>
  <li>fixed problems with Review window sometimes not showing the results</li>
  <li>value label drawing changed slightly</li>
  <li>status bar adjusted so plugin state is visible on smaller displays</li>
  <li>improved windows version checking for bug reports<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.27.1 (as compared to 4.27.0)</b></font></p>
<ul>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">fixed problems with
      auto-complete and param info features appearing on certain Windows versions</font></li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.27.0 (as compared to 4.26.0)</b></font></p>
<blockquote>
  <p> Intellisense-like functionality in AFL editor</p>
</blockquote>
<ul>
  <li>auto-completion feature in AFL editor type a few letters and press Ctrl+SPACE
    and the number of matching functions / reserved words will be displayed</li>
  <li>parameters-info tip, type function name and opening brace ( and you will
    see the tip that shows information about required parameters</li>
  <li>two new checkboxes Preferences-&gt;Editor control Auto-completion / parameter-info
    features</li>
  <li>fixed exception occuring when optimizing systems that generate zero trades
    (very rare case)</li>
  <li>AlertIF called from the custom indicators sometimes displayed wrong date/time
    - now it is fixed</li>
  <li>when fixup = 1 Foreign() is able to align array past the last foreign bar.
    For example when using intraday data you can refer to imported EOD data and
    it will fill intraday data with last value from previous day.<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.26.0 (as compared to 4.25.0)</b></font></p>
<ul>
  <li>List view sorting speed increased significantly:
      <ul>
        <li>sorting of text columns is 2 times faster (on average)</li>
        <li>sorting of numeric column is 5-10 times faster ( sort 660'000 items
          within 2-3 seconds on 1GHz machine)</li>
      </ul>
  </li>
  <li>Explorations now support definable color of cell text and background<br>
    AddColumn and AddTextColumn functions extended to support this feature:<br>
    <br>
    AddColumn( Array, &quot;Title&quot;, format = 1.2, textColor = colorDefault,
    bkgndColor = colorDefault );<br>
    AddTextColumn( &quot;Text&quot;, &quot;Title&quot;, format = 1.2, textColor
    = colorDefault, bkgndColor = colorDefault );<br>
        <br>
    New colorDefault constant (-1) defines default windows color for grid cell.
    <p> <code>Sample code:<br>
      Filter =1;</code></p>
    <p><code> AddColumn( Close, &quot;Close&quot;, 1.2 );<br>
      AddColumn( MACD(), &quot;MACD&quot;, 1.4 , IIf( MACD() &gt; 0, colorGreen,
      colorRed ) );<br>
      AddTextColumn( FullName(), &quot;Full name&quot;, 77 , colorDefault, IIf(
      Close &lt; 10, colorLightBlue, colorDefault ) );</code></p>
  </li>
  <li>
    <p>custom indicators - anchors are not offset vertically from the ends of
      the trend line when Draw dates is selected</p>
  </li>
  <li>
    <p>custom indicators with auto-scaling can be now dragged in Y-direction
      like regular charts</p>
  </li>
  <li>
    <p>Foreign and RelStrength algorithm improved to allow more complex alignment
      cases</p>
  </li>
  <li>PlotShapes works even without any Plot statement (although it is intended
    to use in conjunction with Plot)</li>
  <li>fixed line disappearing bug that occured when using text tool right after
    trend line tool </li>
  <li>Dec is displayed again on date axis</li>
</ul>
<p></p>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.25.0 (as compared to 4.24.0)</b></font></p>
<ul>
  <li> support user-definable parameters:<br>
    new AFL functions<br>
    Param( &quot;name&quot;, default, min, max, step )<br>
    ParamStr( &quot;name&quot;, &quot;default&quot; );<br>
    ParamColor( &quot;name&quot;, defaultcolor );<br>
    <br>
    new Parameters dialog : right click over chart pane and select &quot;Parameters&quot; or
    press Ctrl+R<br>
    allows to change chart parameters - changes are reflected immediatelly
    <p> <u>Sample code 1:</u><br>
        <br>
        <code>ticker = ParamStr( &quot;Ticker&quot;, &quot;MSFT&quot; );<br>
      sp = Param( &quot;MA Period&quot;, 12, 2, 100 );<br>
      PlotForeign( ticker, &quot;Chart of &quot;+ticker, ParamColor( &quot;Price
      Color&quot;, colorLightYellow ), styleCandle );<br>
      Plot( MA( Foreign( ticker, &quot;C&quot; ), sp ), &quot;MA(&quot; + WriteVal(
      sp, 1.0 ) + &quot;)&quot;, ParamColor( &quot;MA Color&quot;, colorRed )
      );</code></p>
    <p><br>
        <u>Sample code 2:</u><br>
        <br>
        <code>sp = Param( &quot;RSI Period&quot;, 12, 2, 100 );<br>
      r = RSI( sp );<br>
      Plot( r, &quot;RSI(&quot;+WriteVal(sp,1.0)+&quot;)&quot;, ParamColor(&quot;RSI
      Color&quot;, colorRed ) );</code></p>
    <p><code> Buy = Cross( r, 30 );<br>
      Sell = Cross( 70, r );</code></p>
    <p><code> PlotShapes( shapeUpArrow * Buy + shapeDownArrow * Sell, IIf( Buy,
        colorGreen, colorRed ) );</code></p>
  </li>
  <li>added missing ':' and '&quot;' characters to the forbidden characters set
    in file names generated from ticker names. All file-system reserved characters
    are converted to underscore. <br>
  </li>
  <li>ticker symbol maximum length increased to 25 characters (from previous
    15).<br>
    (these two fixes above solve problem with using very long symbols like </li>
  <li>default keyboard accelerators changed Ctrl+R is now for Parameters dialog
    F5 is for Refresh </li>
  <li>fixed calculation bug occuring when drawing objects in the blank chart
    area (&quot;jumping&quot; effect)</li>
  <li>new method in Quotations collection for faster retrieval of quotes<br>
    long Retrieve( long Count, Variant *Date, Variant *Open, Variant *High, Variant
      *Low, Variant *Close, Variant *Volume, Variant *OpenInt );</li>
  <li>on Windows Me, 2000 and XP all file dialogs now feature &quot;Places&quot; bar
    and allows to select few recent file names from the combo</li>
  <li>date axis display modified slightly (3 letter month abbrev. used more often</li>
  <li>changed resizing algorithm so if &quot;no min size for resizing dialog&quot; option
    is selected the scroll bar of list / edit is always visible. Also the option
    is active from the start without need to go to Preferences.</li>
  <li> other minor improvements<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.24.0 (as compared to 4.23.0)</b></font></p>
<ul>
  <li> saving/loading Automatic Analysis settings to/from the file</li>
  <li>Axis font now can be made bold/italic/underline</li>
  <li>Text drawing tool uses axis font now</li>
  <li> full control over AA window via new OLE/COM interface:<br>
      <b>Analysis</b> object (accessible via Broker.Application.Analysis)<br>
      <br>
      <b>Methods</b>:<br>
    - Backtest(); - runs backtest <br>
    - Explore(); - runs exploration<br>
    - Scan(); - runs scan<br>
    - Optimize(); - runs optimization<br>
    - bool Report( FileName: String ) - saves report to the file or displays
    it if FileName = &quot;&quot; <br>
    - bool Export( FileName: String ) - exports result list to CSV file<br>
    - bool LoadFormula( FileName: String ) - loads AFL formula<br>
    - bool SaveFormula( FileName: String ) - saves AFL formula<br>
    - bool LoadSettings( FileName: String ) - loads backtest settings<br>
    - bool SaveSettings( FileName: String ) - saves backtest settings<br>
    - ClearFilters() - removes all filters <br>
    <br>
    <b>Properties</b>:<br>
    - long ApplyTo - defines apply to mode: 0 - all stocks, 1 - current stock,
    2 - use filter<br>
    - long RangeMode - defines range mode: 0 - all quotes, 1 - n last quotes,
    2 - n last days, 3 - from-to date<br>
    - long RangeN - defines N (number of bars/days to backtest)<br>
    - DATE RangeFromDate - defines &quot;From&quot; date<br>
    - DATE RangeToDate - defines &quot;To&quot; date<br>
    - Filter( nType: short, Category : String ) - sets/retrieves filter setting<br>
    nType argument defines type of filter 0 - include, 1 - exclude<br>
    Category argument defines filter category:<br>
&quot;index&quot;, &quot;favorite&quot;, &quot;market&quot;, &quot;group&quot;, &quot;sector&quot;, &quot;index&quot;, &quot;watchlist&quot;<br>
    <br>
    <b>Examples</b><br>
    <br>
    <code><font size="2">ClearFilters(); // clear all filters first<br>
    Filter( 0, &quot;index&quot; ) = 1; // include only indices<br>
    Filter( 1, &quot;market&quot; ) = 2; // exclude 2nd market</font></code><br>
    <br>
    <b>Full Example for Windows Scripting Host:</b><br>
    ========================================
    <p> <font size="3"><code>/* create AB object */<br>
      AB = new ActiveXObject(&quot;Broker.Application&quot;);</code></font></p>
    <p><font size="3"><code> /* retrieve automatic analysis object */<br>
      AA = AB.Analysis;</code></font></p>
    <p><font size="3"><code> /* load formula from external file */<br>
      AA.LoadFormula(&quot;afl\\macd_c.afl&quot;);</code></font></p>
    <p><font size="3"><code> /* optional: load settings */<br>
      // AA.LoadSettings(&quot;the_path_to_the_settings_file.abs&quot;);</code></font></p>
    <p><font size="3"><code> /* setup filters */<br>
      /* backtest over symbols present in market 0 only (zero-based number) */<br>
      AA.ClearFilters(); <br>
      AA.Filter( 0, &quot;market&quot; ) = 0;</code></font></p>
    <p><font size="3"><code> /* set apply to and range */<br>
      AA.ApplyTo = 2; // use filters<br>
      AA.RangeMode = 0; // use all available quotes</code></font></p>
    <p><font size="3"><code> /* run backtest and display report */<br>
      AA.Backtest();<br>
      AA.Report(&quot;&quot;); // empty file name means display report</code></font></p>
</ul>
<p>&nbsp;</p>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.23.0 (as compared to 4.22.1)</b></font></p>
<ul>
  <li> chart axis font can be defined by the user. The default is now Arial,
    9pt.<br>
    (Tools-&gt;Preferences-&gt;Miscellaneous: &quot;Axis font&quot;)</li>
  <li>Undo feature added to AFL editor.</li>
  <li>PlotShapes now supports offset (or distance) parameter (by default -12
    ), Offset is expressed in SCREEN pixels.<br>
    Negative offsets shift symbols down, positive offsets shift symbol up. To
    place the shape exactly at ypostion, specify 0 as offset. <br>
    PlotShapes( shape, color, layer = 0, yposition = graph0, offset = -12 );</li>
  <li>yet another bug fixed that caused problems with drawing lines when multiple
    windows were showing same symbol but different intervals.</li>
  <li>if Y-value is less than 1000 the status bar displays four decimal places
    , also bar number is displayed in the status bar (next to date/time)</li>
  <li>Insert Indicator window (Ctrl+I) does not show empty indicator slots anymore.<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.22.1 (as compared to 4.22.0)</b></font></p>
<ul>
  <li> fixed overwrite problem occuring when deleting first indicator in the
    list in Indicator Builder</li>
  <li>fixed shortcut conflict &amp;File and &amp;Format. Now Format menu has
    Alt+o shortcut</li>
  <li>other minor fixes</li>
  <li>added constants for shapes<br>
&quot;shapeNone&quot;, 0 <br>
&quot;shapeUpArrow&quot;, 1 <br>
&quot;shapeDownArrow&quot;, 2 <br>
&quot;shapeHollowUpArrow&quot;, 3 <br>
&quot;shapeHollowDownArrow&quot;, 4 <br>
&quot;shapeSmallUpTriangle&quot;, 5 <br>
&quot;shapeSmallDownTriangle&quot;, 6 <br>
&quot;shapeHollowSmallUpTriangle&quot;, 7 <br>
&quot;shapeHollowSmallDownTriangle&quot;, 8 <br>
&quot;shapeUpTriangle&quot;, 9 <br>
&quot;shapeDownTriangle&quot;, 10 <br>
&quot;shapeHollowUpTriangle&quot;, 11 <br>
&quot;shapeHollowDownTriangle&quot;, 12 <br>
&quot;shapeSmallSquare&quot;, 13 <br>
&quot;shapeHollowSmallSquare&quot;, 15 <br>
&quot;shapeSquare&quot;, 17 <br>
&quot;shapeHollowSquare&quot;, 19 <br>
&quot;shapeSmallCircle&quot;, 21 <br>
&quot;shapeHollowSmallCircle&quot;, 23<br>
&quot;shapeCircle&quot;, 25 <br>
&quot;shapeHollowCircle&quot;, 27 <br>
&quot;shapeStar&quot;, 29 <br>
&quot;shapeHollowStar&quot;, 31 <br>
&quot;shapeDigit0&quot;, 33 <br>
&quot;shapeDigit1&quot;, 35 <br>
&quot;shapeDigit2&quot;, 37 <br>
&quot;shapeDigit3&quot;, 39 <br>
&quot;shapeDigit4&quot;, 41 <br>
&quot;shapeDigit5&quot;, 43 <br>
&quot;shapeDigit6&quot;, 45 <br>
&quot;shapeDigit7&quot;, 47 <br>
&quot;shapeDigit8&quot;, 49 <br>
&quot;shapeDigit9&quot;, 51 <br>
&quot;shapePositionAbove&quot;, 1 <br>
    <br>
    Example: <br>
    PlotShapes( IIF( buy, shapeDigit9 + shapePositonAbove, shapeNone ), colorGreen
    ); <br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.22.0 (as compared to 4.21.1)</b></font></p>
<ul>
  <li> changes made in Indicator Builder are not lost if formula is incorrect
    - instead error message is displayed and formula is saved even if it has
    a syntax error</li>
  <li>if currently displayed indicator formula has an error - the error message
    does not pop up in a separate window but is displayed in the indicator pane.</li>
  <li>empty indicators are not displayed in the Indicator Builder and new buttons &quot;Add&quot;, &quot;Delete&quot; are
    provided to add new indicator and remove existing</li>
  <li>when drawing or moving drawing objects the auto-refresh of the chart is
    temporarily held to solve problems with drawing on RT charts.</li>
  <li>Symbol-&gt;Information window is not reset every 3 sec when working with
    RT data.</li>
  <li>interval between chart updates is now configurable (Preferences-&gt;Intraday)</li>
  <li>Random( seed = none ); function takes new parameter seed.<br>
    If seed is defined it initializes the seed of random number generator this
      allows to produce repetitive series of pseudo-random series. If seed is
      not specified - random number generator continues generation.<br>
    To reinitialize the generator, use 1 as the seed argument. Any other value
    for seed sets the generator to a random starting point. <br>
        <br>
    Example 1:<br>
    Graph0 = Random(); // generates different sequence with each refresh<br>
    <br>
    Example 2:<br>
    Graph0 = Random(1); // generates the same sequence with each refresh<br>
    <br>
  </li>
  <li>new AFL function <br>
    PlotShapes( shape, color, layer = 0, yposition = graph0 );<br>
    that allows to plot arrows and other shapes on any chart.<br>
    Parameters:
    <ul>
      <li><i>shape</i> defines type of the symbol. when shape is zero nothing
        is plotted<br>
        values other than zero cause plotting various pre-defined shapes.<br>
        Odd values plot shape BELOW indicator, even values plot shape ABOVE indicator.</li>
      <li><i>color</i> defines color of shape</li>
      <li><i>layer</i> defines layer number on which shapes are plotted</li>
      <li><i>yposition</i> defines Y-position where shapes are plotted (by default
        they are plotted 'around' graph0 (first indicator) line)</li>
    </ul>
    <br>
    Currently defined shapes are<br>
    UP ARROW = 1, (below indicator)<br>
    DOWN ARROW = 2, (above indicator)<br>
    HOLLOW UP ARROW = 3, (below)<br>
    HOLLOW DOWN ARROW = 4, (above)<br>
    SMALL UP TRIANGLE = 5, (below)<br>
    SMALL DOWN TRIANGLE = 6, (above)<br>
    HOLLOW SMALL UP TRIANGLE = 7, (below)<br>
    HOLLOW SMALL DOWN TRIANGLE = 8 , (above)<br>
    UP TRIANGLE = 9, (below)<br>
    DOWN TRIANGLE = 10, (above)<br>
    HOLLOW UP TRIANGLE = 11, (below)<br>
    HOLLOW DOWN TRIANGLE = 12, (above)<br>
    SMALL SQUARE = 13, (below)<br>
    SMALL SQUARE = 14, (above)<br>
    HOLLOW SMALL SQUARE = 15, (below)<br>
    HOLLOW SMALL SQUARE = 16,<br>
    SQUARE = 17, (below)<br>
    SQUARE = 18, (above)<br>
    HOLLOW SQUARE = 19, (below)<br>
    HOLLOW SQUARE = 20, (above)<br>
    SMALL CIRCLE = 21, (below)<br>
    SMALL CIRCLE = 22, (above)<br>
    HOLLOW SMALL CIRCLE = 23, (below)<br>
    HOLLOW SMALL CIRCLE = 24,(above)<br>
    CIRCLE = 25, (below)<br>
    CIRCLE = 26, (above)<br>
    HOLLOW CIRCLE = 27, (below)<br>
    HOLLOW CIRCLE = 28, (above)<br>
    STAR = 29, (below)<br>
    STAR = 30, (above)<br>
    HOLLOW STAR = 31, (below)<br>
    HOLLOW STAR = 32, (above)<br>
    NUMBER 0 = 33, (below)<br>
    NUMBER 0 = 34, (above)<br>
    NUMBER 1 = 35, (below)<br>
    NUMBER 1 = 36, (above)<br>
    NUMBER 2 = 37, (below)<br>
    NUMBER 2 = 38, (above)<br>
    NUMBER 3 = 39, (below)<br>
    NUMBER 3 = 40, (above)<br>
    NUMBER 4 = 41, (below)<br>
    NUMBER 4 = 42, (above)<br>
    NUMBER 5 = 43, (below)<br>
    NUMBER 5 = 44, (above)<br>
    NUMBER 6 = 45, (below)<br>
    NUMBER 6 = 46, (above)<br>
    NUMBER 7 = 47, (below)<br>
    NUMBER 7 = 48, (above)<br>
    NUMBER 8 = 49, (below)<br>
    NUMBER 8 = 50, (above)<br>
    NUMBER 9 = 51, (below)<br>
    NUMBER 9 = 52, (above)<br>
    <br>
    <br>
    Demo formula:<br>
    <br>
    <code> Graph0=MACD();<br>
    Graph1=Signal();<br>
    Buy=Cross(Graph0, Graph1);<br>
    Sell=Cross(Graph1, Graph0);<br>
    PlotShapes( ( Buy OR Sell ) * ( 1 + Cum( Buy OR Sell ) % 52 ), IIf( Buy,
    colorGreen, colorRed ), 5 );<br>
    GraphXSpace = 5;</code><br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.21.1 (as compared to 4.21.0)</b></font></p>
<ul>
  <li> AddToComposite marks symbol as dirty so timestamp added in the full name
    is stored properly.</li>
  <li>&quot;Align custom minute bars to regular market hours&quot; works OK now
    even if filtering is OFF </li>
  <li>new methods added to COM interface in 4.21.0 caused incompatibility with
    AmiQuote because of changed numbering of methods. Now it is fixed so AmiQuote
    auto-import works again with 4.21.1</li>
  <li>fixed display of watch list &gt;32 in the workspace tree</li>
  <li>fixed possible hangup when attempting to draw objects when currently selected
    layer is hidden<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.21.0 (as compared to 4.20.8)</b></font></p>
<ul>
  <li>layers implemented (layers is a well-know concept in every decent painting/drawing/CAD
    package now it is available to traders for (AFAIK) the first time in technical
    analysis program)</li>
  <li>increased number of watch lists (to 64 watch lists) and sectors (to 64
    sectors) (note that broker.workspace file once saved with new version can
    not be read back with previous versions)</li>
  <li>max. number of bars in File-&gt;Database Settings increased to 500'000.</li>
  <li>ASCII importer: added $STRICT 1 mode it checks if Open, High, Low prices
    are greater than zero</li>
  <li>COM/OLE interface:<br>
    new property Broker.Application.DatabasePath<br>
    new method: Broker.Application.LoadDatabase( Path )<br>
    new method: Broker.Application.SaveDatabase()
    <p> Example VBScript code (Windows Scripting Host):</p>
    <p> <code>Set oAB = CreateObject(&quot;Broker.Application&quot;)</code></p>
    <p><code> WScript.Echo( &quot;Current path to database is &quot; + oAB.DatabasePath
        )</code></p>
    <p><code> if oAB.LoadDatabase(&quot;c:\program files\amibroker\data&quot;)
        = True then<br>
      WScript.Echo( &quot;succesfully loaded new database&quot; )<br>
      end if</code></p>
    <p><code> WScript.Echo( &quot;Current path to database is &quot; + oAB.DatabasePath
        )</code></p>
    <p><code> oAB.SaveDatabase()</code></p>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.20.8 (as compared to 4.20.7)</b></font></p>
<ul>
  <li>fixed #include command (CR/LF pair handling)</li>
  <li>#include now displays error message in the status bar ifincluded file can
    not be found</li>
  <li>when calling function defined in script AFL does not convert the method
    name to lowercase</li>
  <li>filtering after hours works also for EndTime &lt; StartTime case (usefull
    for users from Far East tracking US exchanges) </li>
  <li>fixed bug causing crash on custom indicators using Study() with QuickAFL
    enabled</li>
  <li>protection against crash when the user tries to plot negative values on
    semi-log scale</li>
  <li>new AFL function: GetDatabaseName - gives the name of the database - the
    last part (folder) of the database path </li>
  <li>other minor fixes</li>
  <li>new myTrack plugin</li>
  <li>removed (c) text (4.20.8.3431)<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.20.7 (as compared to 4.20.6)</b></font></p>
<ul>
  <li>fixed crash occuring on exit on Windows XP (CRegistry class - free() )</li>
  <li>fixed problem with saving keyboard editor settings on Win2k</li>
  <li>fixed problem with different ordering of tickers when case sensitivity
    is turned on (symbol array is re-sorted on change and re-sorted after loading
    master file)</li>
  <li>added one more safety check for non-existing directory when saving layout</li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION
      4.20.6 (as compared to 4.20.5)</b></font></p>
<ul>
  <li> possible bug with AFL editor fixed (streamin)</li>
  <li>&quot;space&quot; problem in AFL editor fixed</li>
  <li>fixed bug with switching databases</li>
  <li>fixed crash occuring when user specified non-existing pen</li>
  <li>fixed bug in monthly view display (29.02.2000)</li>
  <li>fixed bug in File-&gt;Save database As (into blank directory)</li>
  <li>fixed title of built-in volume pane</li>
  <li>ROC function accepts additional parameter that defines how negative<br>
    values are handled. ROC( array, periods = 12, absmode = False )<br>
    if absmode = False the value returned is array - ref( array, -periods )/ref(
    array, -periods )<br>
    if absmode = True the value returned is array - ref( array, -periods )/abs(
    ref( array, -periods ) )</li>
  <li>QuoteTracker plugin now accepts also . (dot) as a date separator</li>
  <li>myTrack plugin startup routine improved</li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
    4.20.5 (as compared to 4.19.0)</b></font></p>
<ul>
  <li> Regression channels calculate percent distances (instead of point) when 
    drawn on log-scale chart </li>
  <li>plugin receives now Workspace information via Plugin notification function</li>
  <li>Zoom All - includes now blank bars</li>
  <li>zoom factor and date selection are now independent for each window in multiple-window 
    setup</li>
  <li>moving of vertical lines is now easier (4 pixel &quot;hot&quot; area instead 
    of 1 pixel)</li>
  <li>styleBar gives normal bars instead of thick</li>
  <li>new menus Help-&gt;Search (invokes help in search mode) and Help-&gt;Read 
    Me - displays read me.</li>
  <li>custom n-tick intervals appear also in chart context menu</li>
  <li>deleted databases are removed from MRU list</li>
  <li>fixed handling of case sensitive tickers when working with local database 
    (4.20.2) </li>
  <li>AddToComposite resets OHLCVI values correctly (when flag=1) even if using 
    &quot;dynamic&quot; symbols<br>
    for composites. (4.20.3)</li>
  <li>composite symbol is reset properly even if flused out of in-memory cache 
    (4.20.5) </li>
  <li>when $ALLOWNEG is NOT specified in the ASCII importer definition AmiBroker 
    performs the following range checking and fixup on open, low and high prices<br>
    if( open == 0 ) open = close;<br>
    if( high &lt; max( open, close ) ) high = max( open, close );<br>
    if( low == 0 ) low = min( open, close ); (4.20.5)</li>
  <li>other minor fixes</li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.19.0 (as compared to 4.18.0)</b></font></p>
<ul>
  <li> minor other fixes<br>
    fixed bug with date/time axis <br>
    tree is refreshed after AddtoComposite used in Backtest/Exploration </li>
  <li>right-hand axis zone is now mouse moveable/sizable:<br>
    hover the mouse over right axis and you will see that cursor changes to up/down 
    arrow.<br>
    now you can click and drag up/down Y axis, <br>
    when you press down SHIFT you can scale Y axis by moving your mouse<br>
    when you double click in the right axis area Y axis zoom and position will 
    be reset</li>
  <li>as mouse operation is superior toolbar buttons taller/shorter buttons are 
    removed (moved to View-&gt;Zoom menu)</li>
  <li>View-&gt;Profile is back in the &quot;View&quot; toolbar</li>
  <li>implemented new drawing tools:<br>
    - Raff regression channel<br>
    - Standard error channel<br>
    - Standard deviation channel <br>
    (all available from Insert-&gt;Regression Channel and new toolbar button)<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.18.0 (as compared to 4.17.0)</b></font></p>
<ul>
  <li> fixed too long chart title text bug </li>
  <li>fixed scroll bar thumb sizing</li>
  <li>RMB-&gt;Copy in AA result list works again</li>
  <li>better keyboard operation in AA window (window does not loose focus after 
    Check/Load AFL rules)</li>
  <li>minor fixes / changes <br>
    changed date axis min skip step from 4 to 5 <br>
    added case sensitive check in few more places when Pref.CaseSensitiveTickers 
    is ON<br>
    intraday interval saved in layouts is properly restored</li>
  <li>Real time quote window: DEL works now again </li>
  <li>can now display different N-tick bars for the same symbol</li>
  <li> fixed bug in Status('firstbarinrange') that occured if range exceeded number 
    of quotes<br>
  </li>
  <li>tooltips are protected against displaying more than 25 lines of text (prevents 
    flashing)</li>
  <li>OLE automation application.RefreshAll is asynchronous now</li>
  <li>charts are always refreshed after scan using AddToComposite (even if composite 
    ticker already exists)</li>
  <li>'From' date in AA now works as expected in intraday mode</li>
  <li>Profile view is refreshed when View-&gt;Profile is choosen</li>
  <li>new profile template fields {s} - gives ticker symbol in lowercase <br>
    {S} - gives ticker symbol in UPPERCASE (the old {t} - gives ticker symbol 
    in the orignal case <br>
    (as typed in Information window)</li>
  <li>Categories window saves edits in Profile URL without any extra clicks</li>
  <li>AddToComposite has 2 new flags that allow running AddToComposite in backtest/optimization 
    mode and exploration mode<br>
    <br>
    atcFlagEnableInBacktest = 8 <br>
    atcFlagEnableInExplore = 16 <br>
  </li>
  <li>the following constants were added for readability of formulas using AddToComposite:<br>
    <br>
    atcFlagResetValues = 1 <br>
    atcFlagCompositeGroup = 2 <br>
    atcFlagTimeStamp = 4 <br>
    atcFlagEnableInBacktest = 8 <br>
    atcFlagEnableInExplore = 16 <br>
    atcFlagDefaults = atcFlagResetValues | atcFlagCompositeGroup | atcFlagTimeStamp;<br>
    <br>
  </li>
  <li>shorter/taller bars (compress/expand Y axis) option added on numerous requests 
    (note that this is temporary solution - better one will come, so please don't 
    ask me to change this because it will be changed anyway)<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.17.0 (as compared to 4.16.0)</b></font></p>
<ul>
  <li> added Gann Square and Gann Fan drawing tools with customisation dialogs 
    (angle of line is displayed in the status bar)</li>
  <li>added parallel trend line tool</li>
  <li>studies can be dragged without &quot;shrinking&quot; effect beyond upper 
    and lower chart border and beyond left and right border (but within available 
    quotation range plus right margin)</li>
  <li>New toolbar buttons for ray (right-extend line) and extend (left and right) 
    lines</li>
  <li>Format toolbar controls (color, thick, dotted) change selected drawing style 
    &amp; color</li>
  <li>snap to price was not accurate in v4.15-4.16 now it is accurate again</li>
  <li>snap to price now works in &quot;magnet&quot; mode - so it snaps only if 
    cursor is within 5% distance to high/low price. Snap % threshold is definable 
    in Preferences/Charting</li>
  <li>usability improvement: even when &quot;return to select mode after drawing&quot; 
    is ON, you can draw mutliple studies one after another quickly if you hold 
    down CTRL key while releasing the button.</li>
  <li>usability improvement: you can now draw objects with OR without holding 
    left mouse button pressed while drawing.</li>
  <li>drawing object is now automatically selected when &quot;return to select 
    mode after drawing&quot; is ON and &quot;auto-select last drawn object&quot; 
    is also ON. This makes it easier to delete/copy/cut or see its properties 
    (Alt+Enter) immediatelly.</li>
  <li>#include can now be written also in upper case</li>
  <li>some UI clean-up: 
    <ul>
      <li>added &quot;Format&quot; menu just to conform with MS recommendations 
        for user interface,</li>
      <li>moved &quot;snap to price&quot; to Format menu and moved &quot;Erase 
        watch lists&quot; to &quot;Symbol&quot; menu.</li>
      <li>&quot;Snap to price&quot; now available from toolbar. Right and left 
        extend available from Format menu.</li>
      <li>Added &quot;Properties&quot; and &quot;Delete all&quot; to &quot;Edit&quot; 
        for consistency</li>
      <li>&quot;Quotations...&quot; has been renamed to &quot;Quote Editor&quot; 
        and toolbar icon has been changed</li>
      <li>certain rarely used toolbar icons from &quot;main toolbar&quot; were 
        removed to save space (Add/Delete/Split Symbol - regular menu is more 
        appropriate for that operations)</li>
    </ul>
  </li>
  <li> X-coordinate display pane in status bar enlarged to accommodate time also</li>
  <li>added &quot;Copy Image as Metafile&quot; option to Edit menu. Metafile is 
    a vector format so you can resize copied picture without distortion. (useful 
    for creating documents that are printed later) </li>
  <li>Quote Editor (QE) improvements: 
    <ul>
      <li>you can now delete quotes in QE - select one or more quotes from the 
        list (SHIFT/CTRL to multi-select) and press &quot;Delete&quot; button<br>
      </li>
      <li>QE made several times faster displaying 20'000 bars in &quot;current&quot; 
        symbol mode takes about 2 seconds now.</li>
    </ul>
  </li>
  <li>now tickers can be case-sensitive. This is useful if you want to treat. 
    ABC and ABc as different symbols. Tools-&gt;Preferences &quot;Miscellaneous&quot; 
    : &quot;Case sensitive ticker symbols&quot;<br>
    USE WITH CARE AS CERTAIN PLUGINS (eSignal plugin for example) DO NOT HANDLE 
    CASE SENSITIVITY <br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.16.0 (as compared to 4.15.1)</b></font></p>
<ul>
  <li>completely re-designed Fibonacci retracement tool allowing full customization 
    and more flexibility. Just draw a Fib retracement and double click on it (or 
    choose Edit-&gt;Properties). Customization dialog is available on &quot;Fibonacci&quot; 
    tab.</li>
  <li>new setting in Tools-&gt;Preferences-&gt;Charting &quot;Select quote only 
    by CTRL+LMB&quot; - <br>
    if marked quote selection is accessible only via double click or single click 
    WITH CTRL key depressed (v4.15 style).<br>
    if unmarked quote selection is possible via single click (old style)</li>
  <li>trend line properties dialog moved to property sheet for consistency.</li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.15.1 (as compared to 4.15.0)</b></font></p>
<ul>
  <li> fixed bug with date axis display that appeared in 4.15.0</li>
  <li>fixed problem with moving/sizing objects when multiple windows were open</li>
  <li>removed &quot;Move/Size&quot; toolbar button:<br>
    now editing/moving/sizing is enabled by default in regular &quot;Select&quot; 
    mode (arrow cursor) the old functionality (pick quotation) is available if 
    you hold down CTRL key while clicking once on the chart or by double click 
    on a chart while not being over an object. Double click over object - shows 
    properties.</li>
  <li>added &quot;Return to select mode after drawing&quot; option in Tools-&gt;Preferences-&gt;Charting<br>
    - when it is switched ON (by default) - right after drawing any object it 
    is available for moving/sizing/deletion. </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.15.0 (as compared to 4.14.0)</b></font></p>
<ul>
  <li> moving and sizing of drawing objects (see new &quot;Move/Size&quot; button 
    in draw tool bar)</li>
  <li>cut/copy/paste/delete of drawing objects (Edit menu and standard shortcuts, 
    need to mark object first in Move/Size mode)</li>
  <li>blank space in the right-hand side of the chart for drawing future trend 
    line projections</li>
  <li>moved charting related preferences setting to new tab &quot;Charting&quot;</li>
  <li>new setting for number of blank bars in right margin (Charting tab)</li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.14.0 (as compared to 4.13.1)</b></font></p>
<ul>
  <li> fixed problem with creating new databases that occurred on certain MSVCRT 
    versions</li>
  <li>styleOwnScale adjusts Base level for histogram and area style back to minvalue 
    or zero whichever is less<br>
  </li>
  <li>Plot, PlotOHLC and PlotForeign have 2 additional parameters for specifying 
    fixed minimum and maximum values for Y-axis<br>
    Note that new parameters work only when styleOwnScale is used:<br>
    <br>
    Plot( array, title, color, style = styleLine, min = {empty}, max = {empty} 
    )<br>
    PlotOHLC( open, high, low, close, title, color, style = styleLine, min= {empty}, 
    max = {empty} )<br>
    PlotForeign( ticker, title, color, style = styleLine, min= {empty}, max = 
    {empty} )<br>
    <br>
    New parameters make it easy to plot ribbons, for example: 
    <p> <code>Plot( Close, &quot;Price&quot;, colorBlue, styleCandle );<br>
      Plot( 2, /* defines the height of the ribbon in percent of pane width */<br>
      &quot;Ribbon&quot;,<br>
      IIf( up, colorGreen, IIf( down, colorRed, 0 )), /* choose color */<br>
      styleOwnScale|styleArea|styleNoLabel, -0.5, 100 );</code></p>
    <p>It also makes it easy to plot 2 or more &quot;own scale&quot; plots with 
      the same scaling:</p>
    <p> <code>minimum = LastValue( Lowest( Volume ) );<br>
      maximum = LastValue( Highest( Volume ) );</code></p>
    <p><code> Plot( Close, &quot;Price&quot;, colorBlue, styleCandle );</code></p>
    <p><code> /* two plots below use OwnScale but the scale is common because 
      we set min and max values of Y axis */<br>
      Plot( Volume, &quot;Volume&quot;, colorGreen, styleHistogram | styleThick 
      | styleOwnScale, minimum, maximum );<br>
      Plot( MA( Volume, 15 ), &quot;MA volume&quot;, colorRed, styleLine | styleOwnScale, 
      minimum, maximum );</code></p>
  </li>
</ul>
<ul>
  <li>fixed date axis display for custom intraday intervals longer than 60 minutes</li>
  <li>&quot;dirty&quot; flag is set properly now during ASCII import in $OVERWRITE 
    1 mode (solves import watch list problem)</li>
  <li>when switching layouts ticker bar selection is now synchronized with active 
    window </li>
  <li>after AA-&gt;Scan Foreign symbol cache is flushed </li>
  <li>now styleLeftAxisScale really allows modification of built-in price chart 
    to feature moving average of volume<br>
    <code>// Now plot volume and its moving average using left-hand axis scaling<br>
    Plot( Volume , &quot;Volume&quot;, colorBlue, styleLeftAxisScale | styleHistogram 
    | styleThick | styleNoLabel );<br>
    Plot( MA( Volume,15), &quot;MAV&quot;, colorLightBlue, styleLeftAxisScale 
    | styleNoLabel );</code></li>
  <li>ASCII importer and Import Wizard now allows to import negative prices (useful 
    for spreads). New command is $ALLOWNEG 1 and new check box in Import Wizard 
    is &quot;allow negative prices&quot;. Please note that logarithmic scale can 
    NOT be used to display negative prices because log() function is undefined 
    for negative values. </li>
  <li>four new AFL functions: 
    <ul>
      <li> LinRegIntercept( ARRAY, periods )- calculates intercept of linear regression 
        line the &quot;a&quot; coefficient<br>
        in a + b*x (LinRegSlope calculates b)</li>
      <li>LinearReg( ARRAY, periods )- calculates linear regression line ending 
        value according to<br>
        a + b * x (where a and b are intercept and slope of linear regression 
        line)</li>
      <li>StdErr( ARRAY, periods )- calculates standard error function (standard 
        error of linear regression estimate) - the same as MS' STE function</li>
      <li>TSF( ARRAY, periods ) - calculates time series forecast indicator (similar 
        to LinearReg but differs by<br>
        the value of lin reg slope)<br>
      </li>
    </ul>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.13.1 (as compared to 4.13.0)</b></font></p>
<ul>
  <li> F4 key for Edit | GoToSymbol works again and can be redefined in the shortcut 
    editor</li>
  <li>new style: styleLeftAxisScale = 65536 - allows to plot more than one graph 
    using common scaling but different from regular (right axis) scale.<br>
    Example: price plot plus volume and moving average plot: 
    <p> <code>// Plot price plot and its moving average<br>
      Plot( Close, &quot;Price&quot;, colorWhite, styleCandle );<br>
      Plot( MA( Close, 20 ), &quot;MAC&quot;, colorRed );</code></p>
    <p><code> // Now plot volume and its moving average using left-hand axis scaling<br>
      Plot( Volume , &quot;Volume&quot;, colorBlue, styleLeftAxisScale | styleHistogram 
      | styleThick );<br>
      Plot( MA( Volume,15), &quot;MAV&quot;, colorLightBlue, styleLeftAxisScale 
      );</code></p>
    <p><code> (in one of the future betas you will be able to display ruler for 
      left-hand axis) <br>
      </code> </p>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.13.0 (as compared to 4.12.0)</b></font></p>
<ul>
  <li> fixed bug with loading layouts for stocks that have spaces in the ticker 
    symbol</li>
  <li>new pre-defined shortcut keys: Alt+Left = Next symbol, Alt+Right = Prev 
    symbol,<br>
    Ctrl+NumPadPLUS = Zoom In, Ctrl+NumPadMINUS = Zoom Out,<br>
    Ctrl+PageUp = Prev Sheet, Ctrl+PageDown = Next Sheet</li>
  <li>new keyboard shortcut editor in Tools-&gt;Preferences-&gt;Keyboard allow 
    user-definable keyboard shortcuts</li>
  <li>fixed display bug in Preferences-&gt;Intraday that caused rounding to full 
    hours custom bar intervals of more than 60 minutes</li>
  <li>Layouts-&gt;Save As does not generate duplicate entries in the tree when 
    already existing name is typed in (it was harmless but still not nice)</li>
  <li>A confirmation box is displayed when choosing Edit-&gt;Delete session</li>
  <li>fixed problem with incorrect interval shown in the settings section of the 
    report when hourly periodicity was selected</li>
  <li>new style: styleOwnScale = 32768 allows plotting graphs with independent 
    scalling (like volume graph on price plot)</li>
  <li>implemented PlotForeign(&quot;ticker&quot;, &quot;title&quot;, color, style 
    = styleCandle | styleOwnScale )</li>
  <li>implemented PlotOHLC( open, high, low, close, &quot;title&quot;, color, 
    style = styleCandle | styleOwnScale ) that allows plotting candlesticks/bars 
    from other arrays without need to overwrite existing OHL arrays.<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.12.0 (as compared to 4.10.3)</b></font></p>
<ul>
  <li> color coded and multi-line caption bars in indicators<br>
    colors are selected automatically when using Plot() function or graphNcolor 
    variable.<br>
    If you use Title variable you have to specify colors in the string.<br>
    Colors can be specified using \\cXX sequence where XX is 2 digit number specifying 
    color index \\c38 - defines violet, there is a special sequence \\c-1 that 
    resets to default axis color. <br>
    For example <br>
    <br>
    Title = &quot;This is written in \\c38violet color \\c27and this in green&quot;;<br>
    <br>
    You can also use new AFL function that makes it easier. Function is called<br>
    EncodeColor( colornumber ).<br>
    And you can write the above example like this:<br>
    <br>
    Title = &quot;This is written in &quot; + EncodeColor( colorViolet ) + &quot;violet 
    color &quot; + EncodeColor( colorGreen ) + &quot;and this in green&quot;; 
    <br>
    <br>
    Multi-line caption is possible by simply embedding line break \n, for example:<br>
    Title = &quot;This is 1st line\nThis is second line&quot;;<br>
    <br>
  </li>
  <li>new layout handling code: 
    <ul>
      <li>you can now have unlimited number of <br>
        custom, multiple-window templates that can be switched between with just 
        double click on layout name in the &quot;Layouts&quot; tab of the Workspace 
        window</li>
      <li>you can open/save/delete layout by clicking on the Layout tree with 
        right mouse button and choosing appropriate function. &quot;Save As&quot; 
        option saves current layout under new name.</li>
      <li>Local layouts are per-database while Global layouts are visible from 
        all databases.</li>
      <li>information saved in layouts include: window sizes and postions, maximized/minimized 
        state chart panes available on each sheet (independent for each window), 
        selected bar interval, selected symbol, selected chart sheet </li>
      <li>Most recently used layout can be saved on exit and database switch automatically 
        (see: Tools-&gt;Prefs-&gt;Miscellaneous &quot;Save on exit: Layouts&quot;)</li>
      <li>old single-window layouts are now renamed to &quot;templates&quot;</li>
    </ul>
  </li>
  <li>CCIa( array, period ) function added - works like CCI but accepts input 
    array instead of working on (C+H+L)/3</li>
  <li>implemented a *very* basic pre-processor with single command #include that 
    allows to include external AFL files into your formula. Syntax:<br>
    #include &quot;path\to my file\name path.afl&quot;<br>
    Note 1: include statement need SINGLE backslashes in the path (this is quite 
    the opposite to normal AFL sting<br>
    parsing)<br>
    Note 2: using #include command may slow down formula execution even<br>
    considering the fact that AmiBroker tries to include only once and cache pre-processed 
    text<br>
    Note 3: that currently no error message is given if #include fails and this 
    code<br>
    is experimental.<br>
    Note 4: nesting #include commands is not supported</li>
  <li>balloon tooltips for status bar</li>
  <li>color-coded plugin status pane in the status bar, plus pop-up balloon notifications 
    when connection state changes</li>
  <li>ability to link custom menu to the plugin status pane - new QT plugin (beta) 
    provides Connect/Shutdown options thru such menu. </li>
  <li>data plugins receive UNLOAD notification correctly</li>
  <li>you can sort columns in Quotation Editor by click on column header</li>
  <li>layout of Quick Review window changed to allow smaller window size.</li>
  <li>Intraday settings dialog allows wider time shift -23..+23 hours</li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.10.2 (as compared to 4.10.1)</b></font></p>
<ul>
  <li>several minor fixes</li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.10.1 (as compared to 4.10.0)</b></font></p>
<ul>
  <li> Equity() function now accepts range type = -2<br>
    Equity( 0, -1 ) - calculates Equity using current date range settings while<br>
    Equity( 0, -2 ) - calculates Equity using the most recent backtest settings<br>
    (this mode is now used by built-in equity chart to avoid affecting Equity 
    chart<br>
    by scans/explorations done after backtesting using different range)</li>
  <li>-10000000000.00 in chart caption is replaced by {EMPTY}</li>
  <li>fixed problem selection bar sometimes disapearing</li>
  <li>fixed ALIAS field handling by ASCII importer</li>
  <li>other minor fixes </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.10.0 (as compared to 4.09.0)</b></font></p>
<ul>
  <li> fixed small COM memory leak when calling methods in COM objects</li>
  <li>column widths and ordering in Real time quote window is saved between sessions</li>
  <li>other minor fixes<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.09.0 (as compared to 4.08.2)</b></font></p>
<ul>
  <li>enhanced backtester:<br>
    + support &quot;Futures&quot; mode that use contract PointValue and Margin 
    for calculations<br>
    + support for Round Lot Size allows you to tell backtester to use user-defined 
    round lots<br>
    + support for TickSize - now built-in stops exit trades only at &quot;allowed&quot; 
    price levels<br>
    + new commission type &quot;$ per share/contract&quot;<br>
    + improved commission/position size calculation</li>
  <li>added following fields to trade list: number of shares/contracts, position 
    value, entry, exit prices, % price change, cum. profit, # bars in trade, profit 
    per bar</li>
  <li>report now includes new settings (margin req, futures mode, def. round lots, 
    tick size)</li>
  <li>Symbol-&gt;Information window allows to specify PointValue, Margin, Round 
    Lot Size and Tick Size on symbol-by-symbol basis</li>
  <li>OLE automation interface: added four new properties to Stock object: PointValue, 
    MarginDeposit, RoundLotSize, TickSize</li>
  <li>ASCII Importer handles now the following additional fields in $FORMAT command: 
    ALIAS, MARGIN, POINTVALUE, ROUNDLOTSIZE, TICKSIZE</li>
  <li>double click on entry in the Alert output window displays the chart.</li>
  <li>Buy&amp;hold formula in built-in equity chart modified (positionsize=-100) 
    to allocate 100% of funds in B&amp;H<br>
    (if you modified your formula you may need to add positionsize=-100 to get 
    correct buy-and-hold equity (100% funds invested))<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.08.2 (as compared to 4.08.0)</b></font></p>
<ul>
  <li> added support for margin in backtester (note: pointvalue and futures initial 
    margin support coming up in the next ver)</li>
  <li>Changing range and running scans/explorations after backtest does not affect 
    already displayed equity line. </li>
  <li>Status provides 2 new fields:<br>
    &quot;firstbarintest&quot; and &quot;lastbarintest&quot;.<br>
    The work in a similar way to &quot;firstbarinrange&quot; and &quot;lastbarinrange&quot;<br>
    but they return the settings of last BACKTEST/OPTIMIZATION<br>
    and intermediate scans/explorations do not affect them<br>
    <b>ATTENTION:</b><br>
    This change affects reference BuyAndHold equity formula,<br>
    so it now should use FirstBarInTest and LastBarInTest fields 
    <blockquote> 
      <p> <code>/* buy and hold simulation */<br>
        Short=Cover=0;<br>
        Buy=Status(&quot;firstbarintest&quot;);<br>
        Sell=Status(&quot;lastbarintest&quot;);<br>
        SetTradeDelays(0,0,0,0);<br>
        ApplyStop(0,0,0,0);<br>
        ApplyStop(1,0,0,0);<br>
        ApplyStop(2,0,0,0);<br>
        Plot( Equity(), &quot;Buy&amp;Hold&quot;, -9 );</code></p>
    </blockquote>
    <p>- if you haven't modified default equity plot AmiBroker will update the 
      code, but if you modified it in v4.08.0 you should apply the change yourself.</p>
  </li>
  <li>changed default behaviour of LastValue in commentaries.<br>
    In pre-4.08.1 versions commentary/interpretation/tooltip code evaluation was 
    somewhat special because LastValue returned in fact not the last but the value 
    of array at selected point (by vertical line or by tooltip) This caused some 
    problems in displaying indicator values that used LastValue in its construction. 
    To address this now LastValue used in Commentaries by default returns true 
    last value. So you should modify your existing commentary/interpretation code 
    that used LastValue to use now SelectedValue( array ) function to maintain 
    the same behaviour. Alternatively you can use LastValue( array, 0 ). </li>
  <li>now built-in stops / ApplyStop()s can be activated immediately (at the trade 
    entry bar)</li>
  <li> other minor fixes<br>
  </li>
</ul>
<p></p>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.08.0 (as compared to 4.07.4)</b></font></p>
<ul>
  <li> Metastock importer: group/watch lists assignments and full name is overwritten 
    even if symbols are already present in the database ASCII and Metastock importers 
    now allow to import &quot;foreign&quot; data to databases using external data 
    sources (via plugin). This is done by marking newly added symbols as using 
    local database only. (Note that this does NOT affect symbols already present 
    in the database - otherwise you would break symbols that are provided by the 
    plugin) (Note 2: in case of ASCII importer this does NOT work if NOQUOTES 
    mode is selected - this is because people sometimes use importer to import 
    just symbols (watch lists))</li>
  <li>new chart style styleArea - draws filled area chart</li>
  <li>Equity chart draws also buy-and-hold equity.</li>
  <li>Equity chart is user-definable, you can even add interpretation code to 
    equity chart (use Indicator Builder to modify equity formula. Please note 
    that equity chart code contains of your AA formula actual Equity line plotting 
    code. To modify equity chart you should edit code below //--equity-plot line. 
    Code above that line is replaced by AmiBroker after backtest.</li>
  <li>Status function supports six new fields:<br>
    &quot;firstbarinrange&quot; and &quot;lastbarinrange&quot;. They return 1 
    (or True) on the first/last bar of analysis range. <br>
    &quot;buydelay&quot;, &quot;selldelay&quot;, &quot;shortdelay&quot;, &quot;coverdelay&quot; 
    return delays set in the Settings window</li>
  <li>GraphZOrder variable allows to change the order of plotting indicator lines. 
    When GraphZOrder is not defined or is zero (false) - old ordering (last to 
    first) is used, when GraphZOrder is 1 (true) - reverse ordering is applied.</li>
  <li>point commissions are not taken when positionsize is set to zero.</li>
  <li>new SetTradeDelays( buydelay, selldelay, shortdelay, coverdelay ) function<br>
    allows to overwrite delays set in the Settings from the AFL code.</li>
  <li>fixed problem that occurred when using cover=buy; short=sell; statement 
    AND multiple Equity(1) statements AND ApplyStop()s in one AA formula.<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.07.4 (as compared to 4.07.3)</b></font></p>
<ul>
  <li> fixed bug causing sometimes crash when Interpretation window was open, 
    QuickAFL was enabled </li>
  <li>fixed problem occuring when Nth greater than 1 was used with PeakBars, TroughBars 
  </li>
  <li>'Check' feature in AA window does not consider Equity() function as referencing 
    future <br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.07.3 (as compared to 4.07.2)</b></font></p>
<ul>
  <li> fixed bug causing crash when LastValue() was used and QuickAFL enabled</li>
  <li>reduced memory usage of AFL when evaluating expressions like expr1 (operator) 
    expr2 when one of expr is a number (scalar) and another variable is an array</li>
  <li>reduced memory usage of Equity() function<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.07.2 (as compared to 4.07.1)</b></font></p>
<ul>
  <li> fixed bug causing crash when using formula with Equity() function and QuickAFL 
    enabled</li>
  <li>fixed bug causing crash when using variable-period HHV,LLV functions and 
    QuickAFL enabled</li>
  <li>fixed invisible short/cover arrows problem (arrows are shifted into visible 
    area now if there is not enough space)</li>
  <li>overlaid indicators re-evaluate number of bars required to calculate formula 
    so for example longer averages added to main chart via custom AFL formula 
    are plotted correctly for all bars </li>
  <li>new Status() fields &quot;range....&quot; now work also in Scan and Exploration 
    modes</li>
  <li>text columns in Explorations are sorted correctly by click on the header 
    <br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.07.1 (as compared to 4.07.0)</b></font></p>
<ul>
  <li>Equity plot does not generate alerts anymore</li>
  <li>SOUND command works now (previously only PLAY was working). Additionally 
    an error message is displayed in the status bar when something goes wrong 
    with playing the audio alert. Please note that you should use \\ (double slashes) 
    in the paths in AlertIF function</li>
  <li>small bug fix in displaying Data tooltips and QuickAFL enabled<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.07.0 (as compared to 4.06.1)</b></font></p>
<ul>
  <li>help window is detached from application window</li>
  <li>arrows generated by commentary window are refreshed properly when new rt 
    bars arrive (arrows are shown for active symbol only)</li>
  <li>e-mail alerts: support for servers requiring SMTP authentication. Supported 
    methods:<br>
    AUTH LOGIN (most popular), POP3-before-SMPT (popular), CRAM-MD5, LOGIN PLAIN</li>
  <li>sound alerts: ability to test sound output in Tools-&gt;Preferences-&gt;Alerts</li>
  <li>AFL error box popping up in AA when RT data are flowing does not cause a 
    crash</li>
  <li>custom minute bar compression improved - now you can have &gt;60 minute 
    bars and also bars not evenly dividing the hour. So you can have 39 or 73 
    minute bars for example</li>
  <li>drawing date/time axis improved</li>
  <li>drawing built-in charts optimized for very long histories </li>
  <li>new AFL functions:<br>
    + Interval() returns bar interval in seconds<br>
    + RMI( periods = 20, momentum = 5 ) - Altman's Relative Momentum Index (S&amp;C 
    Feb 1993)<br>
    + Status() function features new fields:<br>
    &quot;rangefromdate&quot;, &quot;rangetodate&quot; - return current auto-analysis 
    From-To range as DateNums <br>
    &quot;rangefromtime&quot;, &quot;rangetotime&quot; - return current auto-analysis 
    From-To range as DateNums <br>
    &quot;barinrange&quot; - returns 1 when current bar is within current auto-analysis 
    From-To range<br>
    &quot;barvisible&quot; - (custom indicators only) returns 1 when current bar 
    is visible in current view <br>
    note: this should be used only if you really have to, indicator should be<br>
    written without need to know how it is displayed<br>
    <br>
    + LastValue has new optional parameter<br>
    LastValue( array, forcelastbar = 0 );<br>
    forcelastbar - changes the behaviour of LastValue when used in Commentary<br>
    or Interpretation windows. By default it uses selected value, but if you<br>
    use LastValue( array, True ) then it always use last bar instead of selected 
    one.<br>
    <br>
    + SelectedValue( array )<br>
    <br>
  </li>
  <li>selection bar updates caption in all chart panes (displaying current values 
    of all indicators). you can move selection-bar with &lt;- and -&gt; cursor 
    arrows on keyboard as before but now when you reach left most or right most 
    bar- the chart starts to scroll automatically</li>
  <li>quote selection and caption display works different now: if selection-bar 
    is NOT visible <br>
    then the last VISIBLE bar data are displayed (not the LAST available), if 
    selection-bar visible then selected bar data are displayed</li>
  <li>new graph style = 8192<br>
    - plots point-and-figure-style O and X symbols instead of candlesticks<br>
    High and Low table are used to determine the height of bar,<br>
    Close-Open distance determines box size. If Close &gt; Open - X's are drawn<br>
    if Close &lt; Open - O's are drawn. </li>
  <li>added bitwise-and '&amp;' and bitwise-or '|' operators to AFL language (note 
    that floating point number are converted (truncated) to integers before applying 
    bitwise operators)</li>
  <li> new pre-defined constants for more descriptive code<br>
    <br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.06.1 (as compared to 4.06.0)</b></font></p>
<ul>
  <li> fixed tab order in Analysis window (Range radio buttons) (appeared in 4.06beta) 
  </li>
  <li>fixed problem with using AFL.Var with uppercase letters (appeared in 4.06beta) 
  </li>
  <li>fixed problem with using gSite.SetVariable / gSite.GetVariable with uppercase 
    letters (appeared in 4.06beta)</li>
  <li>fixed problem with exploration (appeared in 4.06beta)</li>
  <li>fixed small display issue in the data tooltips (-1e10 displayed instead 
    of {EMPTY})</li>
  <li>disabled QuickAFL until all issues are resolved<br>
    <br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.06.0 (as compared to 4.02.1)</b></font></p>
<ul>
  <li>New Interpretation window (View-&gt;Interpretation) displays chart-sensitive 
    commentaries</li>
  <li>new AlertIF function allows to generate visual, sound, e-mail alerts. It 
    also allows to launch any external program on signal generated by AFL formula.</li>
  <li>Automatic Analysis window now allows periodical scans (Scan every n minutes)</li>
  <li>new Check feature in Automatic Analysis window allowing you to find out 
    if your formula references future quotes or not.</li>
  <li>Data tips show indicator values now and can show also interpretations of 
    indicators </li>
  <li>n QuickAFL technology implemented (Tools-&gt;Preferences-&gt;Miscellaneous 
    -&gt; Enable QuickAFL for indicators) - provides &gt;10x speed-up in custom 
    indicator charting with long histories (&gt;1000 bars) </li>
  <li>ability to modify / overlay additional graphs over built-in charts (Indicator 
    Builder-&gt;Built-in tab)</li>
  <li>ability to create your own interpretation commentaries in Indicator Builder</li>
  <li>new AFL functions: 
    <ul>
      <li>AlertIf( BOOLEAN_EXPRESSION, command, text, type = 0, flags = 1+2+4+8, 
        lookback = 1 );</li>
      <li>SetBarsRequired( backward, forward= -1) - overwrites heuristic guessing 
        algotithm used by QuickAFL technology. Allows to specify the number of 
        previous (backward), and future (forward) quotes required by the formula 
        to properly calculate - for advanced users only</li>
      <li>GetBaseIndex() - retrieves symbol of base index as defined in Symbol-&gt;Categories. 
        To plot base security chart just use graph0 = Foreign( GetBaseIndex(), 
        &quot;C&quot; ); </li>
      <li>EnableTextOutput( flag ) - enables output of strings into commentary 
        / interpretation window. When flag = 0 no string is printed into commentary 
        window, 1 - strings are printed</li>
      <li>_N( text ) - the function that prohibits writing the values of assignment 
        of string variables: _N( text = &quot;this is a text&quot; ); this does 
        not print out the text being assigned into commentary window.<br>
        <br>
      </li>
    </ul>
  </li>
  <li>filtering weekends (File-&gt;Database Settings-&gt;Intraday settings-&gt;Filter 
    weekends)</li>
  <li>Commentary and Interpretation window are automatically refreshed when charts 
    are refreshed</li>
  <li>OLE automation Quotation.Date (GetDate) includes time also</li>
  <li>AFL engine symbol lookup optimized so AFL engine initializes 2x faster and 
    symbol lookup is also faster</li>
  <li>when scrolling zoomed-out chart (that displays more than 2048 data bars) 
    the refresh is delayed a little. This makes scroll bar more responsive and 
    it takes much less to scroll to desired position when working with &gt;100000 
    bars. </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.02.1 (as compared to 4.02.0)</b></font></p>
<ul>
  <li> added automatic ruin stop that closes all trades loosing more than 99.96% 
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.02.0 (as compared to 4.01.0)</b></font></p>
<ul>
  <li> added ability to filter after-hours trading (File-&gt;Database Settings-&gt;Intraday 
    settings : Filter after-hours box plus definable session start/end (per-workspace 
    settings)</li>
  <li>added ability to shift time displayed on charts/dialogs File-&gt;Database 
    Settings-&gt;Intraday settings : Time Shift (AmiBroker uses computer local 
    time, so it displays realtime quotes using the time of the timezone you are 
    in. For example if you live in Warsaw - NYSE-quotes stocks will start 15:30 
    local (Warsaw) time. If you want however to display time as it is in New York 
    (-6 hours -&gt; 9:30) you have to set Time Shift to -6.</li>
  <li>fixed problem with importing very long intraday histories &gt; 300000 bars 
    (if you want to import that long histories you have to go to File-&gt;Database 
    Settings and change &quot;Default number of bars&quot; to at least 3000)</li>
  <li>fixed a bug in intraday -&gt; daily time compression </li>
  <li>fixed &quot;no trade list&quot; display of Exposure and RAR</li>
  <li>when writing the formula to HTML report &lt; and &gt; characters are encoded 
    to &amp;lt; and &amp;gt; to ensure that formula is not truncated.</li>
  <li>&quot;Apply&quot; button in Indicator Builder inserts/modifies the custom 
    indicator only if the formula is correct. This avoids continuously displayed 
    error messages when working with real time streaming data.</li>
  <li>fixed bug in list view sorting of numeric columns containing small values</li>
  <li>fixed crash occuring when Equity() function was called from Commentary window</li>
  <li>fixed display of huge numbers in the chart grid</li>
  <li>added option to color up/down (traditional) bars : Preferences -&gt; Main 
    chart</li>
  <li>other minor fixes<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.01.0 (as compared to 4.00.0)</b></font></p>
<ul>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">Customisable N-tick 
    charts in Real Time version (see Preferences -&gt; Intraday tab) and new View-&gt;Intraday 
    menu </font></li>
  <li>Ability to backtest custom N-tick bars</li>
  <li>Backtester now makes better decisions on desired order of execution of signals 
    that occur the same day. (if both buy and sell (or short and cover) signals 
    occur on the very same bar and there is already open trade from the any of 
    the previous bars this open trade is closed first, and a new trade is opened 
    next. Otherwise the usual order (buy first then sell) is used. </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  4.00.0 (as compared to 3.99.2)</b></font></p>
<ul>
  <li>ASCII importer now handles also HMM time format (in addition to HHMM)</li>
  <li>file dialogs store its most recently used directory properly again (not 
    one level higher) </li>
  <li>other minor changes</li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.99.2 (as compared to 3.99.0)</b></font></p>
<ul>
  <li> fixed bug occuring on exit when no document window was open</li>
  <li>double click on ticker tree displays a chart window if no window was open</li>
  <li>Foreign() function does not show error message box if referenced symbol 
    does not exits in the database - instead it returns {EMPTY_VAL}</li>
  <li>user text holds on chart again (fix to the bug induced by 3.97) </li>
  <li>caption of weekly bar shows friday as end date in &quot;show bar begin time&quot; 
    mode </li>
  <li>focus switches back to AFL editor on AFL error in AA/Indicator Builder windows</li>
  <li>backtester checks if high and low prices are different than zero<br>
    - before trying to adjust buy/sell/short/coverprice arrays to high-low range. 
    In normal case this was not the case but if you were backtesting composite 
    equity (you should not but...) which has only close array != 0 you got Profit 
    N/A and other strange numbers in previous version (this was really user-error, 
    you should not include composite equity tickers in the backtest because it 
    makes no sense)</li>
  <li>by default AddToComposite function adds new tickers to market 253 (instead 
    of 0) now</li>
  <li>fixed bug in handling points-only mode by Equity function</li>
  <li>fixed predefining of BuyPrice/SellPrice/ShortPrice/CoverPrice arrays in 
    Ind. Builder</li>
  <li>obsolete controls removed from Preferences/Data tab</li>
  <li>some RT improvements (3.99.1)<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.99.0 (as compared to 3.98.1)</b></font></p>
<ul>
  <li>Equity function has new syntax<br>
    SYNTAX:<br>
    Equity( Flags = 0, RangeType = -1, From = 0, To = 0 );<br>
    <br>
    where<br>
    NEW PARAMETER<br>
    Flags - defines the behaviour of Equity function<br>
    0 : (default) Equity works as in 3.98 - just calculates the equity array<br>
    1 : works as 0 but additionally updates buy/sell/short/cover arrays so<br>
    all redundant signals are removed exactly as it is done internally by the 
    backtester<br>
    plus all exits by stops are applied so it is now possible to <br>
    visualise ApplyStop() stops.<br>
    2 : (advanced) works as 1 but updated signals are not moved back to their 
    original positions<br>
    if buy/sell/short/cover delays set in preferences are non-zero<br>
    Note: this flag is documented but in 99% of cases should not be used in your 
    formula.<br>
    Other values are reserved for the future.<br>
    <br>
    RangeType, From, To - arguments as described in v3.98<br>
    <br>
    Example:<br>
    Buy = High &gt; Ref( HHV( High, 20 ), -1 );<br>
    Sell = 0;<br>
    ApplyStop( 1, 1, 5, 1 );<br>
    Equity( 1 );<br>
    <br>
    exit is made only by apply stop, thanks to new equity(1)<br>
    you can see sell arrow generated by ApplyStop <br>
    <br>
  </li>
  <li>in Automatic analysis window you are now able to display buy/sell/short/cover 
    arrows for ALL actual trades (a new option is available from right mouse button 
    menu over the result list,<br>
    and via double click + ALT key)<br>
    <br>
  </li>
  <li> Backtester now reports the type of stop that exited the trade (max loss), 
    (profit), (trail) - are added to mark trades that were closed by max. loss 
    stop, profit target stop and trailing stop respectively.<br>
    You can also mark your own reasons for exit by assigning numerical value<br>
    to sell, cover arrays:<br>
    1 - means normal exit, 2 - max loss, 3- profit target, 4-trailing stop,<br>
    5 - 9 reserved for future use (other types of built-in stops.<br>
    10 and above - custom exits labelled by Long (n) or Short(n) where n is a 
    number &gt; 10<br>
    <br>
    Example:<br>
    cond1 = Cross( EMA( Close, 20 ), Close );<br>
    cond2 = Cross( Signal(), MACD() );<br>
    Buy = Cross( MACD(), 0 );<br>
    Sell = IIf( cond1, 10, IIf( cond2, 11, 0 ) );<br>
    <br>
  </li>
  <li>new AFL function:<br>
    ExRemSpan( Array, NumBars )<br>
    <br>
    FUNCTION:<br>
    Removes excessive signals that span NumBars bars since initial signal.<br>
    (In other words first non-zero bar passes through, then all subsequent non-zero 
    bars are ignored (zero is returned) until NumBars bars have passed since initial 
    signal. From then on a new signal may pass through)<br>
    <br>
    This function makes easy writing exits after a fixed number of bars, for example 
    if you want to sell always 5 bars after the buy you should now use combination 
    of ExRemSpan and Ref(). It will work even if initial buy array has lots of 
    redundant signals:<br>
    <br>
    Buy = 1;<br>
    Buy = ExRemSpan( Buy, 5 );<br>
    Sell = Ref( Buy, -5 );<br>
    <br>
  </li>
  <li> some minor bug fixes</li>
</ul>
<p></p>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.98.1 (as compared to 3.98.0)</b></font></p>
<ul>
  <li> fixed &quot;freezing&quot; problem when AmiBroker was re-launched with 
    an empty Equity chart</li>
  <li>equity graph is plotted correctly even if your system uses graph/Plot statements</li>
  <li>previously saved AA settings are restored at the application startup so, 
    Equity plots use correct settings without the need to re-open AA window.<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.98.0 (as compared to 3.97.1)</b></font></p>
<ul>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">Equity() function implemented</font><font face="Arial, Helvetica, sans-serif" size="-1"><br>
    <br>
    <b>SYNTAX:</b><br>
    Equity( RangeType = -1, From = 0, To = 0 );</font><br>
    <br>
    where<br>
    RangeType - defines quotations range being used:<br>
    -1 : (default) use range set in the Automatic analysis window<br>
    0 : all quotes<br>
    1 : n last quotes (n defined by 'From' parameter)<br>
    2 : n last days (n defined by 'From' parameter)<br>
    3 : From/To dates<br>
    <br>
    From : defines start date (datenum) (when RangeType == 3) or &quot;n&quot; 
    parameter (when RangeType == 1 or 2)<br>
    To: defines end date (datenum) (when RangeType == 3) otherwise ignored<br>
    <br>
    datenum defines date the same way as DateNum() function as YYYMMDD<br>
    where YYY is (year - 1900)<br>
    MM is month<br>
    DD is day<br>
    <br>
    December 31st, 1999 has a datenum of 991231<br>
    May 21st, 2001 has a datenum of 1010521<br>
    <br>
    <b>FUNCTION:</b><br>
    returns Equity line based on buy/sell/short/cover, **price, all apply stops, 
    and all other backtester settings.<br>
    <br>
    <b>NOTES:<br>
    </b>All these parameters are evaluated at the time of the call of Equity function. 
    Complete equity array is generated at once. Changes to buy/sell/short/cover 
    rules made after the call have no effect. Equity function can be called multiple 
    times in single formula.<br>
    <br>
    <b> EXAMPLE USAGE:</b><br>
    <br>
    buy = your buy rule;<br>
    sell = your sell rule;<br>
    graph0 = Equity();<br>
    <br>
    <br>
  </li>
  <li>automatic Equity plot (Automatic Analysis window -&gt; click on Equity button 
    (after backtesting))</li>
  <li>BuyPrice, SellPrice, ShortPrice, CoverPrice, PositionSize variables are 
    predefined also in the Indicator Builder (no &quot;undefined identifier&quot; 
    error in IB)</li>
  <li>AA scan mode displays also short/cover signals now</li>
  <li>Value Label is not displayed when graph has {EMPTY} value </li>
  <li>new graphNstyle value = 4096 - don't draw value label for this graph line</li>
  <li>immediate refresh after bars are received from eSignal plugin</li>
  <li>eSignal plugin now works with afterhours data (FormT)</li>
  <li>new docking windows (supporting multiple windows in one row) + renamed window 
    titles</li>
  <li>an option to automatically tile mutliple chart windows</li>
  <li>zoom out toolbar button added</li>
  <li>hourly/intraday periodicity toolbar buttons added</li>
  <li>fixed positionsize handling for short trades it is now checked at short 
    signal (not cover as before) </li>
  <li>other fixes<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.97.1 (as compared to 3.97.0)</b></font></p>
<ul>
  <li> value labels do not overlap (greetings to AmiBroker group:-)</li>
  <li>value labels text is written in white or black depending on the brightness 
    of the label</li>
  <li>vertical line should be visible much better</li>
  <li>fixed problem with overwriting OHLC price arrays in AFL formula<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.97.0 (as compared to 3.95.0)</b></font></p>
<ul>
  <li>Realtime Market watch (RT only) window implemented (disabled when data plugin 
    is not RT-enabled) + internal improvements for RT handling</li>
  <li>UNDO for Drawing tools implemented (Ctrl+Z, or Edit-&gt;Undo)</li>
  <li>StrLeft( string, count ), StrRight( string, count ), StrMid( string, start, 
    count ) AFL functions implemented</li>
  <li>improvements to AddToComposite function: 
    <ul>
      <li>AddToComposite( array, &quot;artif_ticker&quot;, &quot;X&quot;, flags 
        = 7 )<br>
        accepts &quot;X&quot; field definition (in addition to regular OHLCVI)<br>
        &quot;X&quot; means update O, H, L, C fields simultaneously<br>
        <br>
      </li>
      <li>flags parameter is the sum of the following <br>
        1 - reset values at the beginning of scan (recommended)<br>
        2 - put composite ticker into group 253 and EXCLUDE all other tickers 
        from group 253<br>
        (avoids adding composite to composite)<br>
        NEW: 4 - put last scan date/time stamp into FullName field<br>
        <br>
      </li>
      <li>when a AddToComposite() adds a new ticker stock tree is automatically 
        refreshed</li>
    </ul>
  </li>
  <li>when &quot;continuous quotations&quot; box is unchecked - intraday and daily 
    charts default to line chart </li>
  <li>candlesticks can be now drawn in 4 different styles - seePreferences - Miscellaneous 
    tab &quot;Use distinct color for candlestick....&quot;- the default settings 
    gives you &quot;classic&quot; AmiBroker look but I suggest to check all 4 
    possibilities because color bars look much better in &quot;Shadows only&quot; 
    mode for example</li>
  <li>vertical line separating days in intraday and years in EOD charts is now 
    optional</li>
  <li>added labels showing the end value of each graph line (to switch off go 
    to Preferences - Miscellaneous - &quot;Show value labels&quot;)</li>
  <li>new style for graphNstyle variable: 2048 - do not rescale Y axis.</li>
  <li>new database dialog suggests a following path for a new database<br>
    &lt;current working directory&gt;\MyNewDatabase</li>
  <li>time out for slow external COM objects is increased to 10sec (should help 
    slow responding TC2000 server)<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.95.0 (as compared to 3.93.1)</b><br>
  </font></p>
<ul>
  <li>new functions in AFL:<br>
    Weighted Moving Average - WMA( array, periods ) - accepts variable periods 
    (array)<br>
    Double Exponential Moving Average - DEMA( array, periods ) - accepts variable 
    periods (array)<br>
    Triple Exponential Moving Average - TEMA( array, periods ) - accepts variable 
    periods (array)<br>
    TimeNum() - returns bar time HHMMSS: 15 hours 23 minutes and 30 seconds is 
    represented by 152330 <br>
    Hour(), Minute(), Second() - return bar hour, minute and second</li>
  <li>AFL Open/Save As file dialogs remember also file name of the most recently 
    saved formula</li>
  <li>Printing directly from AFL editors implemented - right mouse button over 
    the formula window then choose &quot;Print&quot;</li>
  <li>no overlaping texts on date axis anymore<br>
  </li>
  <li>selected quotation (vertical line) does not disapear when chart is scrolled 
    or refreshed</li>
  <li>price chart now display vertical line dividing days (in intraday modes) 
    and years (in daily/weekly/monthly modes) </li>
  <li>Refresh feature fixed (once again) + simultaneous refresh of mutliple symbol 
    charts implemented</li>
  <li>Auto-refresh driven by plugin implemented (now only eSignal plugin utilises 
    this feature)</li>
  <li>if only it is possible, scroll bar is NOT moved to the last bar after chart 
    refresh (but new bars arriving from RT plugin show up :-)) </li>
  <li>Edit-&gt;Delete quotation and Edit-&gt;Delete session force chart refresh</li>
  <li>AmiBroker now notifies previously used data plugin when user chooses a different 
    one or loads the database that uses a different plugin (this allows closing 
    internet connections for example)</li>
  <li>when ExitAtStop is switched OFF - max. loss and profit target stops are 
    triggered <br>
    by examining SellPrice/CoverPrice tables instead of High/Low<br>
    (trailing stop worked that way since the beginning)</li>
  <li>trendline properties dialog works correctly also for intraday charts now 
    (additional edit boxes for start/end time)</li>
  <li>OLE automation: new method added to Stocks collection:<br>
    string GetTickerList( long type ) (type = -1 - all tickers)<br>
    - returns comma separated ticker list </li>
  <li>fixed problem tha occured with &quot;show current trade arrows&quot; applied 
    to intraday charts</li>
  <li>fixed crash that occured when one tried to import empty tickers using $NOQUOTES 
    mode</li>
  <li>fixed hangup when displaying charts of values greater than 10^15<br>
  </li>
  <li>fixed crash when importing ASCII files with time given in format HH:MM (without 
    seconds)</li>
  <li>minor bug fixes</li>
  <li>HTMLView.exe program: only Save As... option is now left and it works OK. 
    <br>
    Also reduced program size from 36KB to 19KB :-)</li>
  <li>TC2000 plugin now provides the access to Wordens proprietary indicators<br>
    Balance Of Power and Money Stream via GetExtraData call:<br>
    GetExtraData(&quot;BOP&quot;) and GetExtraData(&quot;MoneyStream&quot;)<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.93.1 (as compared to 3.93.0)</b><br>
  </font></p>
<ul>
  <li> AddToComposite works ONLY in scan mode now</li>
  <li>fixed &quot;Delete&quot; feature in Symbol-&gt;Organize assignments</li>
  <li>fixed &quot;Edit formula&quot; feature</li>
  <li>cosmetic fix in charting: when only flat line = X is plotted scale is set 
    from X to 1.1*X <br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.93.0 (as compared to 3.92.0)</b><br>
  </font></p>
<ul>
  <li><font face="Arial, Helvetica, sans-serif" size="-1"> Custom intervals for 
    intraday bars implemented (new Preferences-&gt;Intraday page)</font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="-1"> new AFL function AddToComposite( 
    array, &quot;ticker&quot;, &quot;field&quot;, flags = 3 )<br>
    single function replacement of JScript/VBScript composite formula described 
    in newsletter 12/2001. Allows you to create composite indicators with ease.<br>
    Parameters:<br>
    array - the array of values to be added to &quot;field&quot; in &quot;ticker&quot; 
    composite symbol <br>
    &quot;ticker&quot; - the ticker of composite symbol. It is advised to use 
    ~comp (tilde at the beginning)<br>
    newly added composites are assigned to group 253 by default and<br>
    have &quot;use only local database&quot; feature switched on for proper operation 
    with external sources<br>
    <br>
    flags - contains the sum of following values<br>
    1 - reset values at the beginning of scan (recommended)<br>
    2 - put composite ticker into group 253 and EXCLUDE all other tickers from 
    group 253<br>
    (avoids adding composite to composite)</font><br>
    <br>
    AddToComposite function also detects the context in which it is run<br>
    and does NOT affect composite ticker when run in Indicator or Commentary mode,<br>
    so it is now allowed to join scan and indicator into single formula.<br>
    <br>
    Simple usage example:<br>
    <br>
    AddToComposite( MACD() &gt; 0, &quot;~BullMACD&quot;, &quot;V&quot;);<br>
    graph0 = Foreign(&quot;~BullMACD&quot;, &quot;V&quot;);<br>
    <br>
    (now you can use the same formula in scan and indicator)<br>
    <br>
  </li>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">Ultimate() indicator 
    now uses H/L prices instead of just close</font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">Status() function supports 
    new argument:<br>
    Status(&quot;action&quot;) - gives information in what context given formula 
    is run<br>
    1 - INDICATOR, 2 - COMMENTARY, 3 - SCAN, 4 - EXPLORATION, 5 - BACKTEST / OPTIMIZE</font></li>
  <li>Quotations editor now allows easy adding new quotes in Single symbol mode 
    (note (new) entry at the beginning of the quote list - select it and edit 
    new quote)</li>
  <li>Stock menu renamed to &quot;Symbol&quot;</li>
  <li>Market, Group, Sector and Industry information is shown in the status bar</li>
  <li>Fixed synchronization between tree and ticker bar<br>
  </li>
  <li>Deleting stock selects next symbol (not 2nd next)<br>
  </li>
  <li>View-&gt;Refresh fixed</li>
  <li>Metastock importer and plug-in now support also intraday MS databases<br>
  </li>
  <li>Double click on the result list in Auto-Analysis window switches correctly 
    the periodicity also for intraday charts</li>
  <li>buy arrows are green and sell arrows are red regardless of custom palette 
    settings</li>
  <li>removed warning for running backtest over 1000 issues in no-trade mode </li>
  <li>when new database is loaded charts are switched automatically to DB's base 
    interval.<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><br>
  <b>CHANGES FOR VERSION 3.92.0 (as compared to 3.90.6)</b><br>
  </font></p>
<ul>
  <li> intra-day support implemented in charting engine<br>
  </li>
  <li>ASCII importer &amp; wizard now feature new field definition: TIME (allowable 
    formats: HHMM, HH:MM, HHMMSS, HH:MM:SS )<br>
  </li>
  <li>intra-day support added to the backtester/optimizer<br>
  </li>
  <li>Database settings window features time base setting<br>
  </li>
  <li>sorting by ticker after backtest in no-trades mode works OK now<br>
  </li>
  <li>number of rows in the result list is reported in exploration/scan modes<br>
  </li>
  <li>AA export to CSV file does not include formula when you unmark &quot;formula&quot; 
    check box in the settings<br>
  </li>
  <li>Find feature implemented in all AFL editors - press Ctrl+F to find text</li>
  <li>specifying graphNstyle 64 or 128 causes scaling based on H/L array in custom 
    indicators </li>
  <li>added &quot;Edit formula&quot; option in the chart context menu that allows 
    instant editing of custom indicator formula.</li>
  <li>other minor fixes </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.90.5 (as compared to 3.90.4)</b></font></p>
<ul>
  <li> Assignment organizer: Delete option asks for confirmation and allows you 
    to cancel</li>
  <li>Assignment organizer: Tooltip texts updated: more appropriate &quot;Move&quot; 
    is used instead of &quot;Copy&quot;<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.90.4 (as compared to 3.90.3)</b></font></p>
<ul>
  <li>the fixup file name procedure checks also for CON, AUX, NUL reserved words, 
    also it matches only full strings not substrings so tickers like LPTH, WBPRN 
    are no longer translated to LP_H and WBPR_</li>
  <li>Foreign and RelStrength functions now have one additional argument <br>
    Foreign( &quot;ticker&quot;, &quot;field&quot;, fixup = 1 ) <br>
    RelStrength( &quot;ticker&quot;, fixup = 1 )<br>
    the default value of fixup is 1 and causes filling the holes in data with 
    previous values (behaviour introduced in 3.90.3), if fixup is 0 - the holes 
    are not fixed (the old, pre-3.90.3 behaviour)<br>
    Note: you can still use Foreign/RelStrength in the old way:<br>
    Foreign( &quot;ticker&quot;, &quot;field&quot; ), RelStrength( &quot;ticker&quot; 
    ) - then the holes will be fixed.</li>
  <li>Plugins: QP2 and TC2000 plugins always refresh the most recent bar data<br>
    (useful for performing intra-day updates of the last daily bar)</li>
  <li>other minor fixes and checks<b><br>
    </b></li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.90.3 (as compared to 3.90.2)</b></font></p>
<ul>
  <li> safety check added to AA/Scan to prevent occasional access violation exceptions 
    while running scans that add quotes to the current symbol</li>
  <li>added safety check for too long graph title strings specified in Plot() 
    function</li>
  <li>stock tree is properly refreshed after Edit-&gt;Erase watch list(s)</li>
  <li>now View-&gt;Refresh updates just charts and 'in-memory' cache so after 
    updating your external source it is enough just to click View-&gt;Refresh. 
    &quot;View-&gt;Refresh ALL&quot; additionally refills symbol tree and ticker 
    list </li>
  <li>Database settings dialog does &quot;Flush cache&quot; automatically if &quot;number 
    of bars&quot; or &quot;data source&quot; have changed</li>
  <li>a new setting in the Preferences-&gt;Misc allowing you to switch off the 
    display of data plugin activity (this provides a little speed-up)</li>
  <li>a confirmation box added to &quot;Delete all studies&quot;</li>
  <li>Tab order fixed in quotations editor</li>
  <li>a new checkbox &quot;Load this database at startup&quot; added to the &quot;File-&gt;New 
    Database&quot; dialog - this allows to automatically set newly created database 
    as a default one.</li>
  <li>if there are data holes / misalignment in the foreign security Foreign() 
    function returns a previous quotation value instead of {EMPTY}</li>
  <li>bug report window now provides memory status and cache stats. </li>
  <li>new button &quot;copy to clip&quot; added to the bug report window to make 
    copying the text of the report easier.</li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.90.2 (as compared to 3.90.1)</b></font></p>
<ul>
  <li> fixed random crashes occuring when list view column was clicked for sorting</li>
  <li>2 digit year window changed to cover 1920-2019 instead of 1950-2049 so ASCII 
    importer treats YY as 19YY when YY &gt;= 20 and 20YY when YY &lt; 20</li>
  <li>fixed sorting of very large numbers (bug was present only in 3.90.x)</li>
  <li>AmiBroker now protects the user from saving the database into the folder 
    that contains other applications' data files - this avoids problems when user 
    does not recognize the fact that AmiBroker database is different than MS, 
    QP2 or TC2000 databases and should be stored in a separate folder.</li>
  <li>AmiBroker estimates the optimal size of &quot;in memory&quot; cache at start-up 
    when the user hasn't changed the default 10. (here is how it works: AmiBroker 
    checks your Preferences-&gt;Data &quot;in memory cache&quot; setting at startup 
    (only) - if it is equal to &quot;10&quot; (the old default) - it calculates 
    the estimate according to the following formula:<br>
    25% * (total RAM memory in your computer)/( (size of single quotation) * (default 
    number of bars loaded) ). So the goal is to utilise 25% of physical RAM for 
    the cache.) </li>
  <li>Optimizer uses more accurate calculations for fractional step, min, max 
    values</li>
  <li>Bug report button handling modified: spaces in mailto: string are replaced 
    with %20 sequences - this should address the problems with Outlook</li>
  <li>a nice &quot;N/A&quot; is shown instead of ugly &quot;1.#R&quot; in the 
    backtester</li>
  <li>a &quot;system % drawdown&quot; figure in optimization result list matches 
    the correct value shown in the backtest report (multiple security test/optimize).<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.90.1 (as compared to 3.90.0)</b></font></p>
<ul>
  <li> OLE automation Quotations.Add method initializes the fields to zeroas pre-3.84 
    versions did, so VB/JScript composite formulas work OK again.</li>
  <li>adding a new symbol in the formula (via Stocks.Add) sometimes caused reallocation 
    of the symbol table and misplaced pointers - a check and fixup after parsingis 
    added</li>
  <li>risk/yield map now shows progress window during calculation</li>
  <li>workaround over the limitation of Windows progress bar (65536 items max.) 
    implemented to display bar properly for more than 65K steps of optimization</li>
  <li>review window layout changed, introduced a &quot;Show&quot; button and a 
    new 'entertaining' mode: &quot;Show immediately&quot;</li>
  <li>other minor fixes<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.90.0 (as compared to 3.88.0)</b></font></p>
<ul>
  <li>Automatic Analysis result list works now in virtual mode which is much faster: 
    <ul>
      <li> Now &quot;Removing items&quot; time is virtually eliminated :-) (&gt;100 
        times faster)</li>
      <li>scans/backtests/explorations run 20%-70% faster</li>
      <li>sorting by columns is approx. 2 times faster</li>
      <li>copying contents to the clipboard is &gt;20 times faster (200'000 rows 
        (1MB) below 1 sec.)</li>
    </ul>
  </li>
  <li>stock tree works faster and better (actually I could write a book on this 
    point :-))</li>
  <li>&quot;Use only local database&quot; box in the Stock-&gt;Information window 
    allows to store certain symbols in local database while the others are retrieved 
    from external database (as set in File-&gt;Database Settings)</li>
  <li>OLE Automation interface: 2 new properties of Stock object:<br>
    DataSource ( 0 - default, 1 - local only ) <br>
    DataLocalMode ( 0 - default, 1 - store locally, 2 - don't store locally) </li>
  <li>new AFL function Version( minrequired = 0 ) that returns the AmiBroker version 
    number as float ( 3.88 for example ). Additionally when you specify Version( 
    4.0 ) AmiBroker will issue an error message when running the formula on AB 
    earlier than 4.0 :) </li>
  <li>new AFL function: Random() returns an array of random values in 0..1 range 
    (to get single random value use LastValue( Random() ) )</li>
  <li>info tip added to list view controls (to see truncated cell items...)</li>
  <li>fixed bug causing double delay when using short = sell; cover = buy; in 
    your formula and setting non-zero delays for all buy/short/sell/cover </li>
  <li>Clicking &quot;OK&quot; in File-&gt;Database Settings dialog marks database 
    as &quot;changed&quot; so it gets saved automatically. </li>
  <li>ASCII importer now supports retrieving date from filename use $DATE_YMD, 
    $DATE_DMY, $DATE_MDY in .format file to specify the date format</li>
  <li>every module uses its separate progress bar so potential conflicts are eliminated</li>
  <li>progress bar shows only changes greater or equal to 1% - this provides a 
    little speed up</li>
  <li>a progress window is shown also for single-symbol optimization</li>
  <li>an estimated time left for multiple symbol optimization shown in the progress 
    window is a time needed to complete the whole process (not just the single 
    step)</li>
  <li>data field names in Foreign() function are no longer case sensitive</li>
  <li>AFL editor preferences now allow to switch on/off word wrap (requires re-run)</li>
  <li>Automatic analysis window now contains Ln/Col indicator</li>
  <li>AFL errors are now reported with a line and column numbers and the place 
    where error occurred is automatically selected in the editor </li>
  <li>JScript/VBScript errors are now reported with the absolute line number (not 
    relative to the beginning of the script block) and automatically selected 
    in the editor (caveat: due to the way how JScript/VBScript engines work the 
    line number is correct when lines are not wrapped in the editor (line numbers 
    in AFL-only are always OK) )</li>
  <li>optimizer displays error message &quot;missing buy/sell variables&quot; 
    only once</li>
  <li>other minor fixes<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.88.0 (as compared to 3.87.2)</b></font></p>
<ul>
  <li> position sizing in backtester implemented: new reserved variable <br>
    PositionSize = &lt;size array&gt; </li>
  <li>new checkbox in the AA settings window:<br>
    &quot;Allow position size shrinking&quot; - this controls how backtester handles 
    the situation when requested position size (via PositionSize variable) exceeds 
    available cash: 
    <ul>
      <li>when this flag is checked the position is entered with size shinked 
        to available cash</li>
      <li>if it is unchecked the position is not entered</li>
    </ul>
  </li>
  <li>new report mode in AA settings window: &quot;Trade list with prices and 
    pos. size&quot;</li>
</ul>
<p></p>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.87.2 (as compared to 3.87.1)</b></font></p>
<ul>
  <li> the most recently used AFL path is now saved separately for Systems, Indicators 
    and Commentaries</li>
  <li>caption bar's maximize button works now also in Indicator builder and Commentary 
    windows</li>
  <li>&quot;Flush cache&quot; button added in the File-&gt;Database settings window 
    to clear in memory cache without exiting AmiBroker</li>
  <li>a safety check added for GetQuotationAt() function</li>
  <li>fixed the problem with running AmiBroker on Windows 2000 as a restricted 
    user causing harmless but annoying message &quot;Failed to update the system 
    registry. Please try using REGEDIT&quot; (This is a bug of Windows 2000 described 
    in MSDN: Q254957 )</li>
  <li>fixed problem with handling C++ like comment (//) at the end of the formula</li>
  <li>fixed bug with converting empty AmiVar to array (at @42ecc7/3.87.1)</li>
  <li>fixed problem with &quot;Save database AS&quot; (into a new directory)</li>
  <li>QP2 plugin: GetExtraData(&quot;HasOptions&quot;) returns true (1) when stock 
    is optionable false (0) otherwise<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.87.1 (as compared to 3.87.0)</b></font></p>
<ul>
  <li> fixed bug occuring when there was a syntax error at the end of a very long 
    single-line statement (&gt;256 characters in single line) and AFL tried to 
    display the error message.</li>
  <li>fixed bug causing infinite loop when running auto-analysis in weekly/monthly 
    mode (bug appeared in 3.84 beta)</li>
  <li>fixed small bug in Metastock plugin causing duplication of last bar quote<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.87.0 (as compared to 3.86.0)</b></font></p>
<ul>
  <li>in &quot;report no trades&quot; mode backtester generates a summary result 
    list instead of listing every trade - this consumes less memory and makes 
    backtesting 2-3 times faster and it is recommended for backtesting more than 
    1000 symbols at one time it also allows to export performance statistics to 
    CSV file</li>
  <li>status bar now shows DB changed state as yellow icon - also it displays 
    additional information - number of symbols loaded and the path to the database 
    when you hover the mouse over the status bar icon. </li>
  <li>fixed bug when recalculating composites</li>
  <li>fixed bug sometimes causing access violation when accessing weekly/monthly 
    data</li>
  <li>fixed potential bug in progress bar causing FLT INVALID OPERATION at address 
    10007dd9</li>
  <li>fixed problem with weekly data compression of pre-1970 dates </li>
  <li>About box shows more links</li>
  <li>fixed problem with interference between buy/sell/short/coverprice tables 
    and built-in trailing stops (ApplyStop) when testing both short &amp; long</li>
  <li>Quotations editor now displays a progress bar in All Stocks/Single quote 
    mode</li>
  <li>COM message filter implemented allowing proper operation of slow, out-proc 
    data plugins like TC2000</li>
  <li>QuotesPlus plugin (QP2.DLL) exposes 2 new extra data:<br>
    GetExtraData(&quot;briefing&quot;) - gives briefing text (STRING)<br>
    GetExtraData(&quot;QRS&quot;) - gives Quotes Plus relative strength (ARRAY)</li>
  <li>QuotesPlus plugin (QP2.DLL) checks for qp_ticker_invalid to exclude invalid 
    tickers </li>
  <li>TC2000 data plugin implemented featuring direct quote read, sector/industry 
    retrieving, exchange/index grouping</li>
  <li>Metastock data plugin implemented featuring support for unlimited MS data 
    directories (so you can setup AmiBroker to use multiple MS directories to 
    overcome MS 4096 symbols per folder limit)</li>
  <li>Tools-&gt;Plugins dialog does not load DLLs multiple times when &quot;Load&quot; 
    button is hit more than once.</li>
  <li>Tools-&gt;Plugins dialog now shows if given DLL is certified. (&quot;certified 
    plugin&quot; means it was tested by AmiBroker.com for stability and compatibility 
    with AmiBroker)<br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.86.0 (as compared to 3.85.0)</b></font></p>
<ul>
  <li> num of winners / num of loosers figures in the backtesting reports take 
    commissions into acount (previously only gross profit (without subtracting 
    commission) decided if given trade was considered winner or looser)</li>
  <li>optimization results now include point gain (in addtion to % gain) so &quot;point 
    only&quot; optimization results are sorted correctly</li>
  <li>optimization results now list &quot;N/A&quot; instead of ugly &quot;-1.$&quot; 
    or &quot;-1.#&quot; when the figure is not available</li>
  <li>after &quot;optimization&quot; mode is run &quot;Report&quot; button is 
    disabled because it always gives last optimize step result which in most cases 
    is not the best one - and thus may be confusing</li>
  <li>Metastock importer handles correctly dates before 1950 </li>
  <li>names like PRN, LPT, AUX are converted to PR_, LP_, and AU_ to avoid problems 
    with Windows file system reserved words <br>
  </li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><b>CHANGES FOR VERSION 
  3.85.0 (as compared to 3.84.0)</b></font></p>
<ul>
  <li><font face="Arial, Helvetica, sans-serif" size="-1"> new AFL function GetExtraData() 
    - allows retrieving vendor-specific data (QP2 plugin demonstrates accessing 
    fundamental data) </font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">fixed bug causing crash 
    when saving database after copying AA result list to watch list</font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">adding full name in 
    tree and ticker bar works again</font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">&quot;In memory cache&quot; 
    setting in Preferences/Data had no effect on real cache size - this is fixed 
    now</font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">Quotes Plus plugin (QP2.DLL) 
    retrieves now also mutual funds, futures, in addition to sectors/industries 
    it sets up also markets and groups</font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">Quotes Plus plugin allows 
    access (via AFL function GetExtraData( &lt;fieldname&gt; ) ) to the following 
    fundamental figures:<br>
    &quot;AnnDividend&quot; ,&quot;Shares&quot;, &quot;SharesFloat&quot;, &quot;SharesOut&quot;, 
    &quot;SharesShort&quot;, &quot;TTMsales&quot;, &quot;Beta&quot;, &quot;TTMEps&quot;, 
    &quot;HiPERange&quot;, &quot;LoPERange&quot; , &quot;PEG&quot;, &quot;InstHolds&quot;, 
    &quot;LTDebtToEq&quot;, &quot;CashFlowPerShare&quot;, &quot;ROE&quot;,&quot;TTMSales&quot;, 
    &quot;Yr1EPSGrowth&quot;, &quot;Yr5EPSGrowth&quot;, &quot;Yr1ProjEPSGrowth&quot;, 
    &quot;Yr2ProjEPSGrowth&quot;, &quot;Yr3to5ProjEPSGrowth&quot; , &quot;BookValuePerShare&quot; 
    </font></li>
</ul>
<p><font face="Arial, Helvetica, sans-serif" size="-1"><br>
  <b>CHANGES FOR VERSION 3.84.0 (as compared to 3.80.4)</b><br>
  </font></p>
<ul>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">internal database handling 
    rewritten for more speed and external data link capability </font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">data plug-ins interface 
    implemented</font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">Open Interest displayed 
    in the data tip</font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">a new settings in Preferences 
    window for Data feed selection</font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">local caching (both 
    in-memory and file-based) implemented</font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">tree filling optimized 
    for large number of stocks &gt;1000</font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">ticker bar rewritten 
    - now allows direct typing of ticker name (F4 - hot key)</font></li>
  <li><font face="Arial, Helvetica, sans-serif" size="-1">trailing stops work 
    correct when testing both long &amp; short trades</font></li>
</ul>
<p><b>VERSION 3.80 RELEASE NOTES</b></p>
<p>Version 3.80.2 (November 18th, 2001) includes following new features and bug-fixes 
  (as compared to 3.70.0)</p>
<ul>
  <li>text box uses the color set in the toolbar color picker</li>
  <li>&quot;Exclude&quot; variable works correctly also with arrays</li>
  <li>ASCII Importer accepts also comma (,) as a decimal part separator if fields 
    are delimited by different separator</li>
  <li>Import wizard generates correct $SEPARATOR \t command when Tab separator 
    is selected</li>
  <li>the color indexes in graphNcolor, graphNbarcolor, Plot() are now consistently 
    encoded </li>
  <li>a default argument mode = 0 added to the following functions: GroupID( mode 
    = 0 ), MarketID( mode = 0 ), SectorID( mode = 0 ), IndustryID( mode = 0 )<br>
    when <br>
    mode = 0 (or no argument is given)- these functions return numerical ID (as 
    in 3.79)<br>
    mode = 1 - these functions return name of the category (text)<br>
  </li>
  <li>added predefined symbols True = 1 and False = 0</li>
  <li>Avg and A are highlighted by the AFL editor now</li>
  <li>The number of chart sheet tabs is now definable by the user (from 1 upto 
    20 tabs)<br>
    The default was increased to 8. A pager control added to scroll the tabs if 
    there is not enough space to fit all tabs and the horizontal scroll bar</li>
  <li>New AFL functions: <br>
    AddColumn( array, name, format = 1.2 );<br>
    AddTextColumn( text, name );<br>
    Plot( array, name, color/barcolor, style = 1 )</li>
  <li>New reserved variable<br>
    GraphNname = &quot;string&quot;;</li>
  <li>&quot;show current trade arrows&quot; in AA window works correct also for 
    &quot;open long&quot; and &quot;open short&quot;</li>
  <li>AND, OR, NOT are highlighted in AFL editor</li>
  <li>BuyPrice, SellPrice, ShortPrice, CoverPrice arrays are checked against High/Low 
    range for every bar and adjusted if they are outside of the allowed range 
    due to the wrong formula. Also these arrays are checked for {empty} values 
    and fixed to back to the default set in Settings if an {empty} is encountered.</li>
  <li>data tooltip is less sensitive to the mouse movement when a chart is zoomed 
    in</li>
  <li>sharing violation exception is now caught when trying to save AFL/CSV over 
    the file that is opened exclusively by another application. </li>
  <li>The on/off status of format toolbar buttons (thick line, dotted, right extend) 
    is preserved between sessions </li>
  <li> points only test for futures (prelim.) - commission handling adjusted to 
    this kind of test</li>
  <li>snap to price mode is active only in main price chart</li>
  <li>show current trade arrows scrolls chart correctly also for short trades 
  </li>
  <li>bug report window lists also cooltool and mfc versions</li>
  <li>if broker.prefs file is missing charts are not black anymore (bug occurred 
    in 3.78)</li>
  <li>additional safety check when loading layout files implemented</li>
  <li>ability to sort custom indicators by name (ascending/descending) in Indicator 
    Builder and Insert Indicator dialogs ( just click on the caption bar)</li>
  <li>indicators are alpha-sorted now in all Insert menus and Indicator Builder</li>
  <li>&quot;Display in quick insert menu&quot; option added in the Indicator Builder 
    allowing to control which custom indicators appear in the menu.</li>
  <li>when no data is available &quot;N/A&quot; is displayed in the backtesting 
    reports instead of ugly 1.#J or 1.$</li>
  <li>plugin interface has GetVariable( name ), SetVariable( name, value ) functions 
    this in fact was present in 3.78 - but not mentioned :-)</li>
  <li>ability to add entry/exit prices to the back test report, precision selectable 
    2 or 4 decimal digits</li>
  <li>Buy/sell arrows are not shown for out-positions </li>
  <li>5 new AFL functions: GroupID(), MarketID(), SectorID(), IndustryID(), InWatchList( 
    listno )</li>
  <li>a new option in Automatic Analysis window menu to add only *selected* items 
    from the results list to the watch list(s) - multiple selection as usual Click+SHIFT, 
    +CTRL</li>
  <li>snap to price does not affect horizontal line and text tools anymore</li>
  <li>fixed bug with handling unterminated C-like comments</li>
  <li>progress dialog does not flicker during optimization</li>
  <li>dynamic (time-variable) stops implemented (ApplyStop() function accepts 
    now array as a third parameter)</li>
  <li>trailing stops implemented</li>
  <li>syntax highlighting editor: fixed bug causing deletion of the last character 
    in the editor after delete (and other) command choosen from right mouse button 
    menu. </li>
  <li>palette size increased to 56 colours - 40 pre-defined + 16 custom (from 
    only 16 custom colours)</li>
  <li>Preferences now use new-style colour pickers</li>
  <li>a new toolbar to select study colour, dot/thick style and right-extend mode</li>
  <li>fixed problem with reporting a short trade followed immediately by single 
    day long trade</li>
  <li>fixed problem with changing font face/size during paste via Ctrl-V</li>
  <li>fixed problem with uninitialized **price arrays in optimization mode </li>
  <li>log scale in custom indicator works now correctly: 
    <ul>
      <li>a new check box in the Indicator Builder added (Grid: Logarithmic)</li>
      <li>graphNstyle = 32 is not needed anymore (has no effect now) (this is 
        to avoid confusion having different styles (log/lin) in multiple graphs)</li>
    </ul>
  </li>
  <li>zooming does not scroll the chart to the end anymore</li>
  <li>wheel zoom/scroll is two times more sensitive (allows faster zooming/scrolling)</li>
  <li>Right-mouse-button menu came back in AFL editor</li>
  <li>Snap-to-price is 100% exact now</li>
  <li>AFL editor colorizes graphX*** and columnX*** variables also for X&gt;2 
    (upto 29)</li>
  <li>AFL editor supports drag-and-drop operation</li>
  <li>AFL: GetScriptObject() function allows calling functions in the script part<br>
  </li>
  <li>New AFL Syntax Highlighting editor (highlights AFL code only)</li>
  <li>New preferences settings for AFL editor font/colors/highlighting features</li>
  <li>New color picker implemented (currently used only in AFL editor settings)</li>
  <li>Edit-&gt;Snap to price - enables &quot;snap to high/low&quot; mode when 
    drawing trend lines</li>
  <li>Edit-&gt;Copy (as bitmap) implemented</li>
  <li>Copy to clipboard list of results in AA and Quick Review implemented (press 
    Ctrl-C to copy)</li>
  <li>AFL engine - DLL Plug-in interface implemented (separate specification available)</li>
  <li>Plugin dialog implemented: (Tools-&gt;Plugins menu) allows loading/unloading 
    plugins without closing AmiBroker (useful in development work, when you need 
    to replace the DLL)</li>
  <li>AFL engine - COM support added: 
    <ul>
      <li>CreateObject( &quot;server.class&quot; ) </li>
      <li>CreateStaticObject( &quot;server.class&quot; )</li>
      <li>ability to call methods in COM objects directly from AFL: ob.MethodName( 
        param1, .... );<br>
        this allows writing/debugging your trading system in Visual Basic/Delphi 
        and similar COM-enabled languages</li>
    </ul>
  </li>
  <li>AFL: scripting host - added 2 new methods to AFL host object: 
    <ul>
      <li>AFL.CreateObject( &quot;server.class&quot; ) - mainly for completeness 
        (duplicates new ActiveXObject functionality)</li>
      <li>AFL.CreateStaticObject( &quot;server.class&quot; ) - this one is very 
        useful for COM objects that are slow to initialize (like QP2 objects). 
        Thanks to this function initialization is done only once per AmiBroker 
        session</li>
    </ul>
  </li>
  <li>AFL: parser stops after first error </li>
  <li>AFL: RelStrength() and Foreign() functions now two times faster<br>
  </li>
</ul>
<p><b>VERSION 3.70 RELEASE NOTES</b></p>
<p>Version 3.70.1 (September 3rd, 2001) includes following new features and bug-fixes 
  (as compared to 3.65.1)</p>
<ul>
  <li> Optimization engine implemented<br>
  </li>
  <li>added simple crosshair display (View-&gt;Crosshair)</li>
  <li>added refresh all views feature (View-&gt;Refresh)</li>
  <li>added Rectangle and Ellipse drawing tools</li>
  <li>added Arc tool</li>
  <li>added Fibonacci Fan tool</li>
  <li>added Fibonacci Arc tool</li>
  <li>Activation of child dialog makes also main frame active (currently works 
    only for non-modal dialogs) </li>
  <li>AmiBroker MS importer now attempts to read Metastock's MASTER file first 
    (before EMASTER) - this is changed because there is a bug in QuotesPlus MS 
    export functionality - it does not update EMASTER properly so the dates in 
    UI are displayed wrong even if they are imported correctly.</li>
  <li>Mouse wheel zooms the chart when CTRL key is depressed</li>
  <li>Variable-period simple moving average (MA function) does not crash if periods 
    array has {empty} entries at the beginning</li>
  <li>a new button added to automatic analysis window allowing you to enlarge 
    result list </li>
  <li>changing selected date automatically refreshes Guru chart commentary</li>
  <li>commentary output window background is now white by default</li>
  <li>reorganized toolbars and Insert menu</li>
  <li>double click on a study (in select mode) brings properties dialog</li>
  <li>Exploration does not crash anymore when a columnX has string value assigned 
    to</li>
  <li>Exploration handles text columns (limitation: only the value of string at 
    the ending point of analysis range is reported)</li>
  <li>new property of OLE Automation Stock object: <br>
    WatchListBits (long) - each bit 0..31 represents assignment to one of 32 watch 
    lists to add a stock to nth watch list write (JScript example): <br>
    Stock.WatchListBits |= 1 &lt;&lt; nth;</li>
  <li>AFL: modulo operator (%) added. Example 10 % 7 gives 3.</li>
  <li>fixed bug in reading filter settings in AA window causing (rarely) crash 
    on Windows NT/2000 (3.69.0 only)</li>
  <li>added $WATCHLIST &lt;n&gt; command and WATCHLIST field type to ASCII importer 
  </li>
  <li>Import Wizard now allows to select destination group and watch list</li>
  <li>Metastock(TM) importer now allows to select destination group and watch 
    list</li>
  <li>Crosshairs are hidden when mouse is outside of chart windows</li>
  <li>A Ctrl-H hot key is added for switching Crosshairs on/off</li>
  <li>Chart context menu works OK when mouse is set to left-handed mode</li>
  <li>Commentary buy/sell arrows are refreshed when switching from one stock to 
    another (as in pre-3.68 versions)</li>
  <li>AFL: ApplyStop( type, mode, amount, exitatstop ) function added that allows 
    controlling stops from the formula level (overrides settings). This enables 
    optimization of stops.<br>
    Parameters:<br>
    type = 0 - maximum loss stop, 1 - profit target stop, (more to be added)<br>
    mode = 0 - disable stop, 1 - amount in percent, 2 - amount in points<br>
    amount = percent/point loss/profit trigger amount<br>
    exitatstop = 0 - exits at defined price field, 1 - exits at stop level</li>
  <li>ability to change the number of custom indicators (Tools-&gt;Preferences-&gt;Other 
    indicators : &quot;Custom indicators&quot; )</li>
  <li>Automatic analysis Range, Type, Date From/to and Filters are saved between 
    sessions </li>
  <li>AFL now recognizes &quot;\t&quot; escape sequence and converts it to the 
    tab character (this allows easier columnized output in commentary window)</li>
  <li>Recently used commentary formula is preserved between sessions</li>
  <li>Editing study properties marks stock as &quot;dirty&quot; therefore causes 
    proper saving</li>
  <li>ASCII importer now allows space as year/month/day separators in date fields 
    so dates like &quot;20 Jan 2001&quot; are accepted </li>
  <li>variable-period version of Sum() is immune to {empty} values in periods 
    table</li>
  <li>variable-period versions of High/LowestSinceBars functions are more robust<br>
  </li>
  <li>other minor fixes</li>
</ul>
<p><b>VERSION 3.65 RELEASE NOTES</b></p>
<p>Version 3.65.1 (August 6th, 2001) includes following new features and bug-fixes 
  (as compared to 3.64.1)</p>
<p></p>
<ul>
  <li> AFL: Highest/LowestSinceBars accessed one array element too much when working 
    with very short histories this is fixed now.</li>
  <li>AFL scripting host: fixed passing string variables from AFL to the script</li>
  <li>added a switch in Automatic Analysis Settings window to include/exclude 
    listing out-of-market positions</li>
  <li>Preferences &quot;cancel&quot; behaviour fixed</li>
  <li>An underscore ('_') character can be now used in AFL identifiers </li>
  <li>new look of &quot;About&quot; window</li>
  <li>application code is optimized so it is both smaller and at least 10% faster</li>
  <li>AFL: a new function status( &quot;what&quot; ) added for now only one propery 
    is available &quot;stocknum&quot; which reports the ordinal number of the 
    stock being currently scanned/explored/back tested in the future more run-time 
    properties will be available<br>
  </li>
  <li>support for mouse wheel (scrolling charts)<br>
  </li>
  <li>back-testing reports now can include formula listing and settings<br>
  </li>
  <li>assignment organizer has ability to delete multiple stocks<br>
  </li>
  <li>stocks could be moved between watch lists using assignment organizer<br>
  </li>
  <li>eliminated memory leaks in AFL scripting host<br>
  </li>
  <li>AFL scripting host is at least 20% faster <br>
  </li>
  <li>AFL scripting host gives meaningful error messages<br>
  </li>
  <li>comments after script block are handled correctly<br>
  </li>
</ul>
<p><b>VERSION 3.64.1 RELEASE NOTES</b></p>
<p>Version 3.64.1 (July 24th, 2001) includes following new features and bug-fixes 
  (compared to 3.64.0)</p>
<p></p>
<ul>
  <li>Intraday drawdowns calculated through all timespan of the system added </li>
  <li>Switching periodicity to monthly/weekly works correctly now (previous version 
    required switching to another stock first)</li>
  <li>Compound annual returns are calculated correctly now</li>
  <li>Fixed hang happening when backtesting very short date ranges<br>
  </li>
</ul>
<p><b>VERSION 3.64 RELEASE NOTES</b></p>
<p>Version 3.64 (July 22th, 2001) includes following new features and bug-fixes 
  (compared to 3.61):</p>
<ul>
  <li> Backtester: Interest rate could be earned when out of the market</li>
  <li>Out of the market positions are shown in the result list</li>
  <li>Open trades are shown in the trade list</li>
  <li>New backtest statistics: annual % profit for system and B&amp;H, days in 
    test, bars out of market, interest earned<br>
  </li>
  <li>Exposure and risk adjusted return stats added<br>
  </li>
  <li>Minor fixes in report statistics<br>
  </li>
  <li>Setting 1 day/quote range in AA gives really one day/quote in the results 
    (instead of 2)<br>
  </li>
  <li>Metastock importer saves recently used selection list in import.tls file 
    inside metastock data dir, so when you choose this directory again, your previous 
    selection will be applied automatically.</li>
  <li>Max. point and percent intraday drawdown calculation for system and buy&amp;hold 
    added<br>
  </li>
  <li>Backtesting report output uses separate CSS styles for &lt;TH&gt; and &lt;TD&gt; 
    tags to avoid ALIGN=RIGHT in every cell that needs right alignment</li>
  <li>Buy&amp;hold profit and open positions reporting do not depend on at least 
    one trade generated anymore - they are now reported regardless of any trades</li>
  <li>a new reserved variable &quot;exclude&quot; added to handle cases when you 
    want to exclude completely certain tickers from back testing AND buy&amp;hold 
    calculation </li>
  <li>Metastock importer supports now more than 256 securities per folder</li>
  <li>Metastock importer dialog features new mark all/none/add selection functions 
    and allows sorting ticker list by symbol, full name, dates and type</li>
  <li>Histogram custom indicator charts look better now (no lines below minimum 
    drawn) </li>
  <li>Date axis in the main chart looks better now (no overlapping month names 
    when chart is zoomed out)</li>
  <li> Backtest, scan and exploration support now also weekly and monthly mode</li>
  <li>Auto-analyser settings allow you to choose different periodicity and show 
    buy/sell arrows swith the chart to the current test mode automatically</li>
  <li>Weekly/monthly mode time-compression now sets the date to the last day of 
    each week/month for which quotes are available- this matches reality better 
    (weekly mode is &quot;end-of-week&quot; and monthly is &quot;end-of-month&quot;)</li>
  <li>Small fix in weekly date handling 
    <p></p>
  </li>
</ul>
<p><b>VERSION 3.61 RELEASE NOTES</b></p>
<p>Version 3.61 (July 8th, 2001) includes following new features and bug-fixes 
  (compared to 3.60):</p>
<ul>
  <li> Fixed garbling text when storing the most recently used formula to registry 
    after saving the AFL to file</li>
  <li>AFL formula in automatic analysis is saved to registry BEFORE running any 
    scan/explore/backtest so in case of crash the edited formula is preserved.</li>
  <li>Fixed Stock-&gt;Split date handling (was broken since AmiBroker is handling 
    date display according to system settings)</li>
  <li>Second parameter (data field) in Foreign() function is not case sensitive 
    anymore</li>
  <li>Indicator Builder: when custom scaling Min/Max levels are equal AmiBroker 
    switches to automatic scaling </li>
  <li>Comparative Relative Strength chart, relstrength() and foreign() AFL functions 
    work properly now also in Weekly and Monthly modes.<br>
  </li>
</ul>
<p><b>VERSION 3.60 RELEASE NOTES</b></p>
<p>Version 3.60 (June 5th/11th, 2001) includes following new features and bug-fixes 
  (compared to 3.55):</p>
<ul>
  <li>SAR overlay in the main price pane uses accel. step/max defined in preferences</li>
  <li>SAR preferences edit boxes now accept typing dot . (ES_NUMBER style removed)</li>
  <li>Back testing settings are preserved between sessions </li>
  <li>buyprice, sellprice, coverprice, shortprice arrays are now available in 
    scan/exploration (to avoid &quot;undefined variable&quot; errors)</li>
  <li>More detailed version info in About box.<br>
  </li>
  <li>Analyser now supports displaying arrows in two modes - 
    <ul>
      <li> all (dbl. click on result list) - shows all signals/trades</li>
      <li>current trade/signal (dbl. click with SHIFT key pressed)</li>
    </ul>
  </li>
  <li>When showing current trade arrows the chart is automatically scrolled to 
    ensure that they are visible</li>
  <li>Stochastic %K and %D as well as stochk stochd use the most common formulation 
    with simple moving average smoothing instead of Wilder's smoothing.</li>
  <li>AFL scripting host now implements IActiveScriptSiteWindow interface (this 
    enables MsgBox and InputBox functions in VBScript)</li>
  <li>Fixed bug in analysis settings - sell price field combo now works OK again</li>
  <li>Improvement: buyprice, sellprice, shortprice, coverprice arrays available 
    in AFL formula for reading (pre-initialized properly by the engine)</li>
  <li>Tickers are not truncated to 3 letters in Risk/Yield map anymore. </li>
  <li>Short/Cover arrows have the same color as sell/buy but they are hollow</li>
  <li>Show dates setting in Indicator builder allows to add date axis to any custom 
    indicator pane</li>
  <li>AFL formula entry fields accept now upto 65535 characters on Win95,98,Me 
    and 1 million characters on Win NT/2000</li>
  <li>Lexical analyser in AFL handles scripting begin/end (&lt;% and %&gt;) tags 
    better</li>
  <li>Stops are now working more precisely</li>
  <li>Buy/sell arrows after backtesting show only currently selected trade entry 
    and exit points.</li>
  <li>Built-in stochastics use High and Low prices (not only close)</li>
  <li>Trades closed out by stops are marked in the result list accordingly</li>
  <li>Implemented AFL Active Scripting Host that enable mixing AFL with JScript/VBScript 
    - (EXPERIMENTAL)</li>
  <li>Prefs/Misc setting - No minimum size for resizing dialogs<br>
  </li>
  <li>Buy and sell at the same bar possible </li>
  <li>Added separate variables for Short trades short/cover <br>
  </li>
  <li>Ability to control trade price : buyprice, sellprice, shortprice, coverprice 
    (simulation of stop orders possible) </li>
  <li>Added missing Broker.Application.Markets read-only property</li>
  <li>Watch lists implemented: Add/Remove to/from watch list from stock tree context 
    menu</li>
  <li>Add/Remove favourites, info, delete and split from context menu</li>
  <li>Erase watch list(s) (Edit menu)</li>
  <li>Analysis results can be now added to a watch list automatically (context 
    menu over result list)</li>
  <li>Filters now include watch list selection</li>
  <li>Fixed Bug in BAck-tester - stops do not generate false buys when testing 
    long only</li>
  <li>Implemented Profit Target stops</li>
  <li> Fixed LLVBars, HHVBars problem appearing with very short histories (6 quotes)</li>
  <li>&quot;Exit at stop&quot; option in Automatic Analysis allows to close the 
    position at exact stop price (no slippage)<br>
  </li>
  <li>Automatic analysis window now support &quot;Exploration&quot; - for generating 
    user-defined reports from database screens.<br>
    Short instructions:<br>
    You need to: 
    <ul>
      <li> define filter variable that equals &quot;1&quot; for stock accepted</li>
      <li>define numcolumns variable that defines the number of columns in the 
        report</li>
      <li>define column0, column1, column2, ...., columnX variables that get the 
        values displayed in the report</li>
      <li>optionally: define column0name, column1name, ... to name column headers 
        accordingly</li>
      <li>optionally: define column0format, column1format, ... to change the default 
        2 decimal digits output (1.5 gives 5 decimal digits, 1.0 gives no decimal 
        digits)<br>
        <br>
        After running Exploration you can export the report to the CSV file using 
        &quot;Export&quot; button.<br>
      </li>
    </ul>
  </li>
  <li>Variable period MA()</li>
  <li>Small fix to variable period Sum()<br>
  </li>
  <li>Layouts can be now saved to a file, enabling unlimited user-definable layouts 
    possible - accessible by Right Mouse button menu over the chart &quot;Layout&quot; 
    submenu options: Load, Save, Load default, Save as default</li>
  <li>Switchable Excel-like chart sheets </li>
  <li>Variable-period HHV, HHVBars, LLV, LLVBars, Sum(), Ref() functions (EXPERIMENTAL)</li>
  <li>Polymorphic AFL function dispatcher choosing optimized version of the function 
    depending if parameters are time-variant or not</li>
  <li>Fixed problem with saving corrupted layout (happened when closing main frame 
    when document frame was already closed by the user) </li>
  <li> fixed &quot;return from portfolio&quot; figures shown in Automatic Analysis 
    bottom line (reports worked well all the time) (v3.60.3)</li>
  <li>showing buy/sell arrows works OK now if routines use *price fields (v3.60.3)</li>
  <li>fixed yet another issue with chart sheets causing crash with very narrow 
    panes (v3.60.3)</li>
</ul>
<p><b>VERSION 3.55 RELEASE NOTES</b></p>
<p>Version 3.55 (April 22nd, 2001) includes following new features and bug-fixes 
  (compared to 3.50):</p>
<ul>
  <li>Export Auto-Analysis trade list to a CSV file</li>
  <li>Fibonacci retracement tool enhanced 
    <ul>
      <li>now works in 4 different modes depending on the direction of trend line 
        drawn:<br>
        NE - gives (old-style) retracement in up trend<br>
        SE - gives retracement in down trend<br>
        NW - gives extension in up trend<br>
        SW - gives extension in down trend</li>
      <li>Added also 261.8% and 423.6% levels</li>
    </ul>
  </li>
  <li>Added very simple ASCII export of portfolio contents</li>
  <li>AmiBroker now automatically saves preferences and current chart layout on 
    exit - this can be changed back however (to the old behaviour) using new settings 
    in Preferences-&gt;Miscellanous</li>
  <li>&quot;Current&quot; button in Prefs/Miscellaneous sets the default database 
    path to currently loaded database path</li>
  <li>Merge Quotes feature (with overwrite/delete switchable and optional merged 
    Ticker-&gt;Alias)</li>
  <li>Double-click in Indicator builder list inserts chart pane when not already 
    present</li>
  <li>Open Interest field type available in ASCII Import wizard</li>
  <li>Minor bug fixes</li>
  <li>Metastock importer now handles correctly also 6-field binary Metastock format 
    (in addition to 5- and 7-field formats)</li>
  <li>100 custom indicators + more indicators dialog</li>
  <li>Apply in Indicator builder inserts chart pane when not already present</li>
  <li>Study ID field added to study properties window</li>
  <li>StrLen( String ) implemented</li>
  <li>AMA( Array, SmoothingFactor ) implemented<br>
  </li>
  <li>AMA2( Array, ForwardFactor, FeedbackFactor ) implemented<br>
  </li>
  <li>Study( StudyID, ChartID = 1 ); implemented<br>
  </li>
  <li>ExRem( Array1, Array2 ) implemented<br>
  </li>
  <li>Flip( Array1, Array2 ) implemented<br>
  </li>
  <li>IsEmpty( Array ) implemented<br>
  </li>
  <li>IsTrue( Array ) implemented<br>
  </li>
  <li>Foreign( Ticker, DataField ) implemented<br>
  </li>
  <li>sorting by date works correctly in all list views</li>
  <li>additional check for existing workspace directory is made during save</li>
  <li> fixed bug occuring when blank pane was inserted and the user tried to read 
    X,Y coords from it</li>
  <li> auto-colouring bar trends possible from AFL (i.e. up in green, down in 
    red, )</li>
  <li>date formatting works according to system settings</li>
  <li>show currently selected &quot;Guru Commentary&quot; and &quot;Auto-Analyser&quot; 
    in menu bar. </li>
  <li>fixed display problem when using &quot;Large fonts&quot; Windows setting</li>
  <li>Logical AFL operators cast {EMPTY} to FALSE automatically</li>
</ul>
<p><b>VERSION 3.50 RELEASE NOTES</b></p>
<p>Version 3.50 (February 25th, 2001) includes following new features and bug-fixes 
  (compared to 3.45):</p>
<ul>
  <li>fixed calculation of percentage profits for short trades in Automatic Analysis 
    window </li>
  <li>graphxspace parameter for custom indicators (defines % extra space added 
    at the top and the bottom of the chart)</li>
  <li>live display of X (date) and Y (value) co-ordinates in the status bar</li>
  <li>charting engine now supports styles 512 (staircase) and 1024 (swing dots) 
    needed for Gann Swing chart</li>
  <li>ASCII importer capable of importing non-quotation data ($NOQUOTES 1 command)</li>
  <li>fixed ASCII import wizard (user settings are accepted now without the need 
    to switch back and forward again)</li>
  <li>ASCII import wizard handles non quotation data formats</li>
  <li>Automatic analysis and commentary windows display now currently loaded file 
    name (in the title bar)</li>
  <li>buy/sell arrows generated from Automatic Analysis are now cleared when switching 
    to another stock</li>
  <li>Sizable Find window</li>
  <li>Sizable Assignments organizer</li>
  <li>Sizable Categories window</li>
  <li>Sizable Quotations editor</li>
  <li>Automatically generated bug-report now features history of commands <br>
  </li>
  <li>fixed DateNum() function: due to the limited resolution of single precision 
    floating point number (7 significant digits) it was imposible to represent 
    numbers like 20011231 accuratelly - the result was rounding to the nearest 
    even number -&gt; 20011232 which was wrong. <br>
    Therefore I decided that datenum() function will return numbers calculated 
    as follows: <br>
    10000 * (year - 1900) + 100 * month + day<br>
    So 20011231 becomes 1011231 and 19951231 becomes 991231 </li>
  <li>fixed handling of both c-like comments and c++ like comments (consecutive 
    comments are handled correctly)</li>
  <li>ValueWhen() accepts negative (and zero) occurence index allowing referencing 
    future (needed for true Gann swing chart)</li>
  <li>charting engine now support individually coloured bars (graphNbarcolor variable 
    in AFL)</li>
  <li>Buy/sell arrows after screening/system test (When the result list in Auto 
    Analysis window is clicked AmiBroker draws now buy/sell arrows on the chart 
    (like Commentary does))</li>
  <li>Fixed lots of potential access violation holes when using empty database 
    and/or stocks with no quotes</li>
  <li> New setting for Volume/Turnover chart in Preferences</li>
  <li>Turnover chart caption display fixed</li>
  <li>Crash recovery system implemented</li>
  <li>Fixed bugs in ASCII importer <br>
    a) Full Name as a last field does not need quotation marks anymore<br>
    b) Data conversion is more fault tolerant</li>
  <li>Sectors and Industries in the tree</li>
  <li>Find window remebers last search type (name/ticker)<br>
  </li>
  <li>Fixed bug in Automatic analysis &quot;Load all when selected&quot; feature 
    causing partial data loss when saving data </li>
  <li>Tree does not always start with &quot;All&quot; node open - instead &quot;Favourite&quot; 
    node is preferred</li>
</ul>
<p><b>VERSION 3.45 RELEASE NOTES</b></p>
<p>Version 3.45 (January 6th, 2001) includes following new features and bug-fixes 
  (compared to 3.42):</p>
<p><b>I User interface / usability enhancements </b></p>
<ul>
  <li>ASCII Import Wizard<br>
  </li>
  <li>improved Stock Finder window (single click select, sorting columns, remebers 
    last search, asynchronous (non-modal) window)</li>
  <li>sizing Quick Review</li>
  <li>sorting columns in Quick Review<br>
  </li>
  <li>sorting columns in Automatic Analysis<br>
  </li>
  <li>sorting columns in Portfolio manager<br>
  </li>
  <li>full row select in Indicator builder</li>
</ul>
<p><b>II AFL - 17 new built-in functions<br>
  </b> </p>
<ul>
  <li>HighestSince( expr, array, nth )</li>
  <li>HighestSinceBars( expr, array, nth )</li>
  <li>LowestSince( expr, array, nth )</li>
  <li>LowestSinceBars( expr, array, nth )</li>
  <li>Wilders() averaging</li>
  <li>LinRegSlope( array, periods )<br>
  </li>
  <li>RWILo( minperiods, maxperiods)</li>
  <li>RWIHi( minperiods, maxperiods)<br>
  </li>
  <li>RWI( minperiods, maxperiods )<br>
  </li>
  <li>StDev( array, periods )</li>
  <li>DateNum()</li>
  <li> Year()</li>
  <li>Month()</li>
  <li>Day()</li>
  <li>DayOfWeek()</li>
  <li>Correlation( array1, array2, periods ) </li>
  <li>Prefs( index )</li>
</ul>
<p><b>III Fixes and other enhancements</b></p>
<ul>
  <li> 
    <p> Fixed PeakBars(), TroughBars functions (Nth parameter was working correctly 
      only for Nth=1, now they work correctly for all Nth values)</p>
  </li>
  <li> ADX/DMI and SAR charts now use proper colors and parameters (taken from 
    prefs) (also ADX/DMI now prints +DI -DI in the title bar - less confusion)</li>
  <li>Printout background is always white and white chart elements are replaced 
    with screen background color for printing</li>
  <li>News URL edit box in categories is disabled (will be used in the future)</li>
  <li>Traditional bars are plotted now with open (left) tick</li>
  <li>Fixed date handling in Quotations Editor, Review dialog, and Split dialog</li>
</ul>
<p><b>VERSION 3.42 RELEASE NOTES</b></p>
<blockquote> 
  <p>Version 3.42 (December 16th, 2000) includes following new features and bug-fixes 
    (compared to 3.41):</p>
</blockquote>
<ul>
  <li>A bug with OLE Automation fixed: in all pre 3.42 versions when you assigned 
    (from the script) a different ticker to a stock using Ticker property of Stock 
    object AmiBroker updated the ticker but didn't sort the ticker list. Because 
    many internal functions assume that stock list is sorted correctly this caused: 
    duplicate entries, crashes, wrong update of quotes, etc. Also when given ticker 
    already exists it is overwritten with a new one correctly (no duplicate entries). 
    All these problems should be gone now.</li>
  <li>A new method of Broker.Application object: Log( Action). Where possible 
    values for Action are: 0 - delete import log, 1 - display import.log, 2- ask 
    the user and display import.log.</li>
  <li>Sharenet importer now handles all possible locations of Sharenet downloader 
    and data folder. The location of Sharenet downloader is defined by &quot;Initial 
    directory&quot; parameter in Tools-&gt;Customize dialog, and location of data 
    folder is now defined by &quot;Arguments&quot; parameter in Tools-&gt;Customize. 
    The defaults for these parameters are: C:\Program Files\Sharenet\Sharenet 
    Download Service and C:\snet. If you installed Sharenet downloader to other 
    than default locations you may change these parameters accordingly and importer 
    script will work correctly</li>
  <li>Sharenet importer now uses new Log() method so it displays warning messages 
    if there were any erroneous lines in the data file(s).</li>
  <li>Risk yield map now handles high standard deviation (risk) better (this was 
    included in 3.41 just forgot to mention)</li>
</ul>
<p><b>VERSION 3.41 RELEASE NOTES</b></p>
<blockquote> 
  <p>Version 3.41 (December 10th, 2000) includes following new features and bug-fixes 
    (compared to 3.40):</p>
</blockquote>
<ul>
  <li>Automatic analysis, Indicator Builder and Commentary windows are now resizable 
    (see the sizing gripper in the bottom right corner of these dialogs) and could 
    be also minimized;</li>
  <li>ASCII importer now warns that errors occurred during import process and 
    displays the log on your request;</li>
  <li>&quot;Rename&quot; button added to Indicator Builder window for easier change 
    of custom indicator names;</li>
  <li>A brand new installer (using InnoSetup technology) with modern look and 
    much better functionality: 
    <ul>
      <li>now setup includes new script for Sharenet Downloader</li>
      <li>additional tools (Export and Cleanup) are added to the custom Tools 
        menu</li>
      <li>upgrade procedure is much easier (no need to manually replace files)</li>
    </ul>
  </li>
  <li>All import format definition files (<i>*.format</i>) and <i>import.types</i> 
    file are moved to <i>\Formats</i> subdirectory. Additional import formats 
    added. </li>
</ul>
<p><b>VERSION 3.40 RELEASE NOTES</b></p>
<blockquote> 
  <p>Version 3.40 (November 1st, 2000) includes following new features and bug-fixes 
    (compared to 3.32):</p>
  <p><b>I AFL</b></p>
  <p>1.1 New built-in functions in AFL: </p>
  <ul>
    <li>sar( accel = 0.02, max = 0.2 ) - Parabolic Stop-And-Reverse </li>
    <li>pdi( period = 14) - Plus Directional Movement +DI </li>
    <li>mdi( period = 14 ) - Minus Directional Movement -DI </li>
    <li>adx( period = 14) - Average Directional Movement </li>
    <li>atr( period ) - Average True Range </li>
    <li>relstrength( tickername ) - comparative Relative Strength </li>
  </ul>
  <p>1.2 Detailed statistics after back-testing your system </p>
  <p>1.3 New report viewer allows PRINTING reports (and saving in HTML format) 
  </p>
  <p>1.4 Definable back testing parameters: </p>
  <ul>
    <li>initial equity</li>
    <li>buy/sell price fields </li>
    <li>buy/sell delay</li>
    <li>commissions </li>
    <li>max. loss stop </li>
    <li>reporting options </li>
  </ul>
  <p>1.5 Automatic analysis window:</p>
  <ul>
    <li> now allows scanning for only buy or only sell signals </li>
    <li>saves recently used formula automatically instead of macd() crossover 
    </li>
    <li>allows scanning and back testing in user-defined from/to date range </li>
    <li>allows to analyse/back test all quotes even if partial loading is switched 
      on</li>
  </ul>
  <p>1.6 Indicator builder: </p>
  <ul>
    <li> new graphXstyle and graphXcolor allow more control over custom chart 
      appearance </li>
    <li>now custom indicators can include even candlestick charts </li>
  </ul>
  <p>1.7 AFL engine now supports overwriting built-in O, H, L, C, V arrays so 
    you can calculate all built-in functions from different data. </p>
  <blockquote> 
    <p>For example you can calculate macd() from rsi(): </p>
  </blockquote>
  <ul>
    <blockquote> 
      <p>close = rsi(); // overwrite built-in close with rsi()<br>
        macd_from_rsi = macd(); // macd indirectly uses close but this is overwritten 
        with rsi </p>
    </blockquote>
  </ul>
  <h5>II USER INTERFACE & GRAPHICS TOOLS </h5>
  <p>2.1 More graphical analysis tools, enhanced existing ones: </p>
  <ul>
    <li>definable colors and styles for trend lines</li>
    <li>auto left- and right- extending trend lines</li>
    <li>vertical and horizontal line tools</li>
    <li>Fibonacci retracement tool</li>
    <li>Fibonacci time zones tool</li>
    <li>Text box tool </li>
  </ul>
  <p>2.2 Study properties can be modified using special "Properties" dialog </p>
  <p>2.3 Main chart:</p>
  <ul>
    <li>moving averages calculation could be simple or exponential </li>
    <li>Parabolic SAR can be added to a main price chart </li>
    <li>Price chart can be now displayed using Traditional bars </li>
  </ul>
  <p>2.4 Candlestick fill colors definable and much more color settings </p>
  <p>2.5 New built-in indicators: ADX/DMI, SAR </p>
  <p>2.6 The ability to search for a stock by name, for when the ticker is unknown 
    ( Stock Finder window (F3) ) </p>
  <p>2.7 The OPEN price in the grab bar of the main chart </p>
  <p>2.8 Full name can be added to ticker in both tree/ticker windows </p>
  <p>2.9 Ticker window is now resizeable </p>
  <p>2.10 WebID field in Stock Information window works correctly now </p>
  <h5>III IMPORT / DATABASE ENGINE </h5>
  <p>3.1 $PRICEFACTOR command allowing multiplying prices by definable factor 
  </p>
  <p>3.2 Reorganized database file layout and enhanced database engine </p>
  <blockquote> 
    <p>Using separate sub-directories for tickers beginning with each letter and 
      digit improves database loading/saving times dramatically (up to 3 times 
      when partial loading is on) </p>
  </blockquote>
  <p>3.3 Import of long histories (for example AmiQuote .AQH files) speeded up 
    to 10 times </p>
  <p>3.4 Database and program is enabled for storing OpenInterest data. Support 
    for OpenInterest is added to:</p>
  <ul>
    <li>ASCII importer</li>
    <li>Metastock(R) importer</li>
    <li>OLE Automation interface</li>
    <li>Quotation editor</li>
    <li>AFL (openint predefined array)</li>
  </ul>
  <p>3.6 OLE Automation interface:</p>
  <ul>
    <li>Added IndustryID property in Stock object </li>
    <li>Added IsDirty property - this property marks &quot;changed&quot; state 
      of the stock and it is automatically updated when setting other Stock object 
      properties </li>
  </ul>
  <h5>IV OTHER</h5>
  <p>4.1 Fixed directory structure creation (bug occurred in 3.40 beta)</p>
  <p>4.2 A directory does not get appended to the recently used list if it does 
    not contain valid AmiBroker database</p>
  <p><a name="sharenet"></a>4.3 <font color="#FF0000">For SHARENET users:</font> 
    Sharenet DN format definition added (sharenet.format file) and six.js script 
    file modified in order to use new file - this should solve the problems with 
    upgrading. Now you can import .DN files from directly from ASCII importer 
    file dialog choosing appropriate type from &quot;Files of type&quot; combo</p>
</blockquote>
<p><b>VERSION 3.32 RELEASE NOTES</b></p>
<blockquote> 
  <p>Version 3.32 (August 9th, 2000) includes following new features and bug-fixes 
    (compared to 3.31):</p>
  <ul>
    <li>Any changes made using <b>Assignments Organizer</b> are now correctly 
      saved</li>
    <li>New options in View/Toolbars allowing to re-show hidden toolbars without 
      tweaking the registry</li>
    <li>OLE automation method Stocks.Remove() and Stock.Ticker property (setting 
      the value) are working correctly now changing the file name accordingly</li>
    <li>A new option &quot;New workspace&quot; added allowing you to create a 
      directory for a new workspace</li>
    <li>File/New removed (previous versions opened new chart window). This functionality 
      is now provided by Window/New menu, that creates new window for simultaneous 
      viewing charts of two or more stocks. Also new option Window/Clone allows 
      you to open a new window for the same stock giving you the chance to see 
      charts of the stock from different time ranges.</li>
    <li>The update archive contains fixed aqd.format and import.types files for 
      using with AmiQuote 1.1 </li>
  </ul>
</blockquote>
<p><b>VERSION 3.31 RELEASE NOTES</b></p>
<blockquote> 
  <p>Version 3.31 (July 4th, 2000) includes following bug-fixes (compared to 3.30):</p>
  <ul>
    <li>Metastock importer now handles prices lower than 2.00 correctly (there 
      was a bug in floating point conversion routine - Metastock uses very old 
      Microsoft basic floating point format in the data file instead of standard 
      IEEE format)</li>
    <li>Metastock importer removes trailing spaces in ticker symbol and full name 
      strings</li>
  </ul>
</blockquote>
<p><b>VERSION 3.30 RELEASE NOTES</b></p>
<blockquote> 
  <p>Version 3.30 (Jun 29th, 2000) includes following new features and fixes(compared 
    to 3.25):</p>
  <ul>
    <li>the ability to save the location of a custom indicator's window (&quot;Save 
      layout&quot; option in the right mouse button menu)</li>
    <li> the current price to the Portfolio manager's details </li>
    <li> upto 8 recent database locations are available in File menu for quick 
      open </li>
    <li>the ability to skip what AmiBroker thinks are splits, then find the next</li>
    <li>individual RS settings for group/industry/market (evaluated in this order)</li>
    <li>the ability to have custom indicators display upon booting (&quot;Save 
      layout&quot; option(</li>
    <li>a visible indicator of when the database is changed</li>
    <li>Enhanced database engine: ability to load database partially at start 
      and load the rest on demand. This feature speeds up both loading and savind 
      and allows to use AmiBroker on machines equipped with less memory (Preferences/Miscellanous)</li>
    <li>Enhanced analysis support: Stop conditions and short-positions available 
      during auto-analysis.</li>
    <li>Enhanced quick-review and analysis windows support now filtering by market, 
      group, sector, industry. Also double-click on the quick-review list will 
      display its chart immediatelly</li>
    <li>indicate the price under the pointer's hot spot (Price data tooltips - 
      Prefs/Miscellanous) </li>
    <li>Assignments to sectors/industries. </li>
    <li>Position and state of toolbars is remembered between runs</li>
    <li>Fixed out-of-bound array access when using AFL with very short quotation 
      histories</li>
    <li>Fixed minor memory leak when using Review/Analysis tools</li>
    <li>Handling $DATE_*** format definition commands fixed Bug fix Import & export 
      tools </li>
    <li>Built-in company Profile view using embedded web-browser (Win32) or multiview(Amiga) 
    </li>
    <li>Built-in assignment organizer</li>
    <li> Handling composites: automatic recalculation of number of advancing/declining/unchanged 
      issues</li>
    <li>Adjusting trendlines after split</li>
    <li>Removed excessive line-feeds added when saving AFL formulas to a file</li>
    <li>Market/Group/Sector/Industry information is now workspace-related (not 
      global anymore)</li>
    <li>Fixed handling quotation marks in ASCII importer</li>
    <li>Better handling of sizing of the splitter window</li>
    <li>TRIN indicator added (with two simple moving averages 15 + 45day) + settings 
      in preferences</li>
    <li>A number of new AFL functions added: AdvIssues(), DecIssues(), UncIssues(), 
      AdvVolume(), DecVolume(), UncVolume(), Trin()</li>
    <li>Fixed right-mouse-button + SHIFT (chart reselection) menu handling</li>
    <li>Added $APPENDTICKER, $OVERWRITE, $FULLNAME, $INDUSTRY, $RECALCVOL, $RECALCAD 
      commands and APPENDTICKER, ADVISSUES, ADVVOLUME, DECISSUES, DECVOLUME, UNCISSUES, 
      UNCVOLUME field identifiers to the ASCII importer definitions</li>
    <li>Fixed memory handling bug sometimes causing crashes of Automatic analysis 
      window</li>
    <li>&quot;Save Results&quot; option in Automatic analysis window now works 
      (worked in Amiga version but it didn't in Win32)</li>
    <li>Ticker symbols now can contain file-system reserved characters such as 
      *, ?, #, &lt;, &gt;, |, /, \. These characters are replaced by underscore 
      _ in appropriate file name (ticker however remains unchanged).</li>
    <li>Added full support for composite data handling (advances, declines, unchanged) 
      to the OLE automation interface: new objects Markets (collection), Market, 
      ADQuotations (collection), ADQuotation</li>
    <li>AFL interpreter now displays meaningful error messages in AFL error window 
      (already implemented on Amiga)</li>
    <li>AD-Line indicator added</li>
    <li>Preferences dialog now handles &quot;Apply now&quot; button correctly</li>
    <li>AFL file dialog now &quot;remebers&quot; its last directory (Win32)</li>
    <li>ADLine() function in AFL added</li>
    <li>WebID property to the Stock automation class added</li>
    <li>Custom tool menu items are displayed now correctly after adding items 
      to the empty list in Customize Tools dialog</li>
    <li>&quot;Toggle&quot; button in Metastock importer added to simplify selection/deselection 
      of multiple items</li>
    <li>Found workaround for extremely slow DeleteAllItems() method in Windows 
      list control: now removing all items from list-view control is about 5 times 
      faster (especially noticeable in Auto-Analysis window) </li>
    <li>More toolbar and menu icons, added &quot;AmiBroker on the Web&quot; menu 
      with quick web links, a couple of cosmetic changes</li>
    <li>Double clicking on the analysis results and in the portfolio shares list 
      automatically selects given stock chart</li>
    <li>P/E and P/BV comparisons in Quick review dialog shows values even if they 
      are negative</li>
  </ul>
</blockquote>
<p><b>VERSION 3.25 RELEASE NOTES</b></p>
<blockquote> 
  <p>Version 3.25 (Apr 26th, 2000) includes following fixes &amp; new features(compared 
    to 3.24):</p>
  <ul>
    <li>Progress indicator is displayed now on the status bar during ASCII import</li>
    <li>Quotation database handling is now optimized for fast access to the most 
      recent data. The most often operation: adding new/updating recent quotations 
      is 2-3 times faster. This is noticeable when working with large databases 
      (&gt;40MB) </li>
    <li>&quot;About&quot; dialog closes automatically after loading the database 
      (registered version only).</li>
    <li>Fixed crash when deleting trend lines in weekly/monthly mode.</li>
    <li>Refreshing stock tree &amp; combo is now optimized (2-3 times faster)</li>
  </ul>
</blockquote>
<p><b>VERSION 3.24 RELEASE NOTES</b></p>
<blockquote> 
  <p>Version 3.24 (Mar 23rd, 2000) includes following fixes (compared to 3.23):</p>
  <ul>
    <li>Fixed bug in Metastock importer which appeared in v3.23</li>
    <li>Deleting vertical trend lines now works without problems</li>
    <li>File open dialogs for Import ASCII, Teletext and Metastock &quot;remember&quot; 
      recently used directories</li>
  </ul>
</blockquote>
<p><b>VERSION 3.23 RELEASE NOTES</b></p>
<blockquote> 
  <p>Version 3.23 (Mar 21st, 2000) includes following new features and fixes (compared 
    to 3.22):</p>
  <ul>
    <li>New format definition commands in ASCII import:<br>
      Added $CONT, $MARKET, $GROUP, $HYBRID commands and MARKET, GROUP, INFO, 
      REDUCTION fields descriptions</li>
    <li>Added user-definable file types and formats</li>
    <li>Ticker aliases added (recognizable by ASCII, Metastock and Teletext importers)</li>
    <li>Stock information enhancements: address field in enlarged to 128 characters, 
      country and currency fields added (now informative only, but in future currency 
      information will be used in portfolio for calculations)</li>
    <li>Bug fix: Stock list is now refreshed after ASCII import</li>
    <li>Fixed some stability issues</li>
  </ul>
  <p><strong>New format definition commands in ASCII import</strong></p>
  <p>The following new commands are available:</p>
  <ul>
    <li>$CONT &lt;0 or 1&gt; - continuous quotations flag<br>
      this affects $AUTOADD 1 mode - if this is set, newly added stocks are switched 
      to continuous quotation mode (this means enabling candlestick charts for 
      example)</li>
    <li>$MARKET &lt;number&gt;<br>
      this affects $AUTOADD 1 mode - if this is specified, newly added stocks 
      are assigned to market with given number. </li>
    <li>$GROUP &lt;number&gt;<br>
      this affects $AUTOADD 1 mode - if this is specified, newly added stocks 
      are assigned to group with given number</li>
    <li>$HYBRID &lt;0 or 1&gt; - combine data in hybrid mode switch<br>
      when this flag is set, you can combine quotations from multiple files - 
      for example one file can contain only open prices and volume and the other 
      file can contain high/low/close data. Useful especially for Warsaw Stock 
      Exchange for combining the data from fixing and later continuous quotations.</li>
  </ul>
  <p>Moreover followin new field definitions are accepted now by $FORMAT command:</p>
  <ul>
    <li>MARKET<br>
      specify a field that contains market ID (affects $AUTOADD mode only)</li>
    <li>GROUP<br>
      specify a field that contains group ID (affects $AUTOADD mode only)</li>
    <li>INFO<br>
      specify a field with additional information (WSE specific: nk, ns, rk, rs, 
      ok, os, zd, bd )</li>
    <li>REDUCTION<br>
      specify a field with reduction rate in percents (WSE specific)</li>
  </ul>
  <p><strong>User-definable file types and formats</strong></p>
  <p>Now AmiBroker can use not only default.format definition file but also other 
    user-specified files. File types, filters and format definition files are 
    specified in <strong>import.types</strong> file (example is included in the 
    update package). Now user can prepare/modify <strong>import.types</strong> 
    file with the description of supported ASCII formats and filters to use. The 
    format of <strong>import.types</strong> file is:</p>
  <blockquote> 
    <p><code>&lt;Descriptive name&gt;|&lt;File filter&gt;|&lt;definition file 
      name&gt;</code></p>
  </blockquote>
  <p>Note vertical line characters between these three fields. Example import.types 
    file looks as follows:</p>
  <blockquote> 
    <p><code>Default ASCII (*.*)|*.*|default.format<br>
      Yahoo's CSV (*.csv)|*.csv|yahoo.format<br>
      Metastock ASCII (*.mst)|*.mst|metastock.format<br>
      Omega SC ASCII (*.txt)|*.txt|omega.format<br>
      S-Files (s*.*)|s*.*|sfile.format<br>
      C-Files (c*.*)|c*.*|cfile.format<br>
      Sharenet DAT (*.dat)|*.dat|dat.format</code></p>
  </blockquote>
  <p>If such file exists you will see your types in the &quot;Files of type&quot; 
    combo-box and when you select one - appropriate filter will be used and after 
    selecting some files and clicking OK - importer will use specified &quot;.format&quot; 
    file.</p>
  <p>In that way you can define as many text-based data formats as you like and 
    AmiBroker will be able to &quot;understand&quot; them all.</p>
  <p><strong>Ticker aliases</strong></p>
  <p>Now each ticker can have an alias assigned, so the AmiBroker's built-in importers 
    can recognize that stock by both ticker and alias names. This is useful when 
    you are using two data sources that are using slighty different stock naming 
    convention or if you want to give the stocks more intuitive name while retaining 
    the ability to use importers without problems.</p>
</blockquote>
<p><b>VERSION 3.22 RELEASE NOTES</b></p>
<blockquote> 
  <p>Version 3.22 (Mar 5th, 2000) includes following new features and fixes (compared 
    to 3.21):</p>
  <ul>
    <li>ASCII import is fixed now. Moreover the ASCII importer offers now much 
      more flexibility thru format definition files (see <em>Data management</em> 
      chapter of AmiBroker User's Guide for details). Example *.format files are 
      included in the AmiBroker main directory.</li>
    <li>AFL analysis tools have been moved to a new &quot;Analysis&quot; menu</li>
    <li>Tools menu has been redesigned. Now it is customizable, so user can assign 
      his new command/tools to the menu. You can lanuch executables (*.exe), Scripts 
      (*.js, *vbs), HTML web pages (*.html) and any other type of file thru this 
      custom tools mechanism.</li>
    <li>Save workspace now saves only those stocks that have changed. Save Workspace 
      As.. now works and saves all stocks to a new directory.</li>
    <li>Stock information window works better now</li>
  </ul>
</blockquote>
<p><b>VERSION 3.21 RELEASE NOTES</b></p>
<blockquote> 
  <p>Version 3.21 (Feb 16th, 2000) includes following fixes (compared to 3.20):</p>
  <ul>
    <li>manual quotation editor works fine now</li>
    <li>commentary buy/sell arrows are drawn below/above candlesticks instead 
      overwriting them</li>
    <li>deleting stock fixed</li>
    <li>when renaming the ticker AmiBroker checks now for already existing name</li>
    <li>commentary works correctly also on weekly/monthly charts now</li>
  </ul>
</blockquote>
</body>
</html>
